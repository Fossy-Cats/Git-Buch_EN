<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<meta name="author" content="Valentin Haenel, Julius Plenz">
<title>Git: Distributed Version Control for Code and Documents</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Git: Distributed Version Control for Code and Documents</h1>
<div class="details">
<span id="author" class="author">Valentin Haenel</span><br>
<span id="author2" class="author">Julius Plenz</span><br>
<span id="revnumber">version 3.0</span>
<br><span id="revremark">WIP Translation</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#ch.preface">Preface</a>
<ul class="sectlevel2">
<li><a href="#sec.reader">Who is this book intended for?</a></li>
<li><a href="#sec.structure">How to read the book?</a></li>
<li><a href="#sec.conventions">Conventions</a></li>
<li><a href="#sec.install-git-repo">Installation and &#8220;The Git-Repository&#8221;</a></li>
<li><a href="#sec.docs">Documentation and help</a></li>
<li><a href="#sec.contact">Downloads and contacts</a></li>
<li><a href="#sec.acknowledgements">Acknowledgements</a></li>
<li><a href="#sec.preface-2nd-edition">Preface to the 2nd edition</a></li>
<li><a href="#sec.preface-cc-edition">Preface to the CreativeCommons edition</a></li>
</ul>
</li>
<li><a href="#ch.intro">1. Introduction and First Steps</a>
<ul class="sectlevel2">
<li><a href="#sec.terminology">1.1. Basic Terminology</a></li>
<li><a href="#sec.first-steps">1.2. First Steps with Git</a>
<ul class="sectlevel3">
<li><a href="#sec.first-repo">1.2.1. The First Repository</a></li>
<li><a href="#sec.first-commit">1.2.2. The First Commit</a></li>
<li><a href="#sec.viewing-commits">1.2.3. Viewing Commits</a></li>
</ul>
</li>
<li><a href="#chap.git-config">1.3. Configuring Git</a>
<ul class="sectlevel3">
<li><a href="#sec.git-alias">1.3.1. Git Aliases</a></li>
<li><a href="#chap.color-defaults">1.3.2. Adjusting Colours</a></li>
<li><a href="#chap.config-encoding">1.3.3. Configuring Character Sets</a></li>
<li><a href="#sec.config-eol">1.3.4. Line End Settings</a></li>
<li><a href="#chap.ext-tools">1.3.5. Editor, Pager and Browser Settings</a></li>
<li><a href="#chap.conf-env">1.3.6. Configuration via Environment Variables</a></li>
<li><a href="#chap.correct-errors">1.3.7. Automatic Error Correction</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ch.basics">2. The Basics</a>
<ul class="sectlevel2">
<li><a href="#sec.basics">2.1. Git Commands</a>
<ul class="sectlevel3">
<li><a href="#sec.index">2.1.1. Index</a>
<ul class="sectlevel4">
<li><a href="#sec.diff-color-words">2.1.1.1. Word-Based Diff</a></li>
</ul>
</li>
<li><a href="#sec.add-p">2.1.2. Creating Commits Step by Step</a></li>
<li><a href="#sec.commit">2.1.3. Creating Commits</a>
<ul class="sectlevel4">
<li><a href="#sec.ci-amend">2.1.3.1. Improving a Commit</a></li>
<li><a href="#sec.commit-msg">2.1.3.2. Good Commit Messages</a></li>
</ul>
</li>
<li><a href="#sec.git-mv-rm">2.1.4. Moving and Deleting Files</a></li>
<li><a href="#sec.grep">2.1.5. Using Grep on a Repository</a></li>
<li><a href="#sec.git-log">2.1.6. Examining the Project History</a>
<ul class="sectlevel4">
<li><a href="#sec.git-log-dates">2.1.6.1. Time Constraints</a></li>
<li><a href="#sec.git-log-files">2.1.6.2. File-Level Restrictions</a></li>
<li><a href="#sec.git-log-grep">2.1.6.3. Grep for Commits</a></li>
</ul>
</li>
<li><a href="#sec.commit-ranges-intro">2.1.7. Commit-Ranges</a></li>
<li><a href="#sec.git-diff">2.1.8. Differences between Commits</a></li>
</ul>
</li>
<li><a href="#sec.object-model">2.2. The Object Model</a>
<ul class="sectlevel3">
<li><a href="#sec.sha1">2.2.1. SHA-1&#8201;&#8212;&#8201;The Secure Hash Algorithm</a></li>
<li><a href="#sec.objects">2.2.2. The Git Objects</a></li>
<li><a href="#sec.od">2.2.3. The Object Database</a></li>
<li><a href="#sec.explore-od">2.2.4. Examining the Object Database</a></li>
<li><a href="#sec.deduplication">2.2.5. Deduplication</a></li>
<li><a href="#sec.git-graph">2.2.6. The Graph Structure</a>
<ul class="sectlevel4">
<li><a href="#sec.graph-references">2.2.6.1. References: Branches and Tags</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#ch.praxis">3. Practical Version Control</a>
<ul class="sectlevel2">
<li><a href="#sec.branches">3.1. References: Branches and Tags</a>
<ul class="sectlevel3">
<li><a href="#sec.branch-refs">3.1.1. HEAD and Other Symbolic References</a></li>
<li><a href="#sec.branch-management">3.1.2. Managing Branches</a>
<ul class="sectlevel4">
<li><a href="#sec.branch-checkout">3.1.2.1. Changing Branches: checkout</a></li>
<li><a href="#sec.branch-naming">3.1.2.2. Conventions for Naming Branches</a></li>
<li><a href="#sec.no-ref-commits">3.1.2.3. Deleted Branches and &#8220;Lost&#8221; Commits</a></li>
</ul>
</li>
<li><a href="#sec.tags">3.1.3. Tags&#8201;&#8212;&#8201;Marking Important Versions</a>
<ul class="sectlevel4">
<li><a href="#sec.managing-tags">3.1.3.1. Managing Tags</a></li>
<li><a href="#sec.lightweight-tags">3.1.3.2. Lightweight Tags</a></li>
<li><a href="#sec.annotated-tags">3.1.3.3. Annotated Tags</a></li>
<li><a href="#sec.signed-tags">3.1.3.4. Signed Tags</a></li>
<li><a href="#sec.deleting-tags">3.1.3.5. Deleting and Overwriting Tags</a></li>
<li><a href="#sec.tags-lightweight-vs-heavyweight">3.1.3.6. Lightweight vs. Annotated Tags</a></li>
<li><a href="#sec.non-commit-tags">3.1.3.7. Non-Commit Tags</a></li>
<li><a href="#sec.git-describe">3.1.3.8. Describing Commits</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec.undo">3.2. Restoring Versions</a>
<ul class="sectlevel3">
<li><a href="#sec.detached-head">3.2.1. Detached HEAD</a></li>
<li><a href="#sec.revert">3.2.2. Rolling Back Commits</a></li>
<li><a href="#sec.reset">3.2.3. Reset and the Index</a>
<ul class="sectlevel4">
<li><a href="#sec.reset-usage">3.2.3.1. Using reset</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec.merge">3.3. Merging Branches</a>
<ul class="sectlevel3">
<li><a href="#sec.merge-detail">3.3.1. Two-Branches Merge</a></li>
<li><a href="#sec.merge-ff">3.3.2. Fast Forward Merges: Fast Forwarding One Branch</a></li>
<li><a href="#sec.merge-strategies">3.3.3. Merging Strategies</a></li>
<li><a href="#sec.recursive-options">3.3.4. Options for the Recursive Strategy</a></li>
</ul>
</li>
<li><a href="#sec.merge-conflicts">3.4. Resolving Merge Conflicts</a>
<ul class="sectlevel3">
<li><a href="#sec.mergetool">3.4.1. Help with Merging: Mergetool</a></li>
<li><a href="#sec.rerere">3.4.2. rerere: Reuse Recorded Resolution</a>
<ul class="sectlevel4">
<li><a href="#sec.rerere-explained">3.4.2.1. Why Rerere Makes Sense</a></li>
<li><a href="#sec.rerere-usage">3.4.2.2. Using Rerere</a></li>
</ul>
</li>
<li><a href="#sec.avoid-conflicts">3.4.3. Avoiding Conflicts</a></li>
</ul>
</li>
<li><a href="#sec.cherry-pick">3.5. Taking over Individual Commits: Cherry Pick</a></li>
<li><a href="#sec.visualization">3.6. Visualizing Repositories</a>
<ul class="sectlevel3">
<li><a href="#rev-list">3.6.1. Revision Parameters</a>
<ul class="sectlevel4">
<li><a href="#rev-list-explained">3.6.1.1. Reference vs. List of References</a></li>
</ul>
</li>
<li><a href="#sec.gitk">3.6.2. Gitk</a></li>
</ul>
</li>
<li><a href="#sec.reflog">3.7. Reflog</a></li>
</ul>
</li>
<li><a href="#ch.advanced">4. Advanced Concepts</a>
<ul class="sectlevel2">
<li><a href="#sec.rebase">4.1. Move commits - Rebase</a>
<ul class="sectlevel3">
<li><a href="#sec.rebase-bsp">4.1.1. An example</a></li>
<li><a href="#sec.rebase-extended">4.1.2. Extended syntax and conflicts</a></li>
<li><a href="#sec.rebase-sense">4.1.3. Why rebase makes sense</a></li>
<li><a href="#sec.rebase-vs-merge">4.1.4. When rebase is <em>not</em> useful - rebase vs. merge</a></li>
<li><a href="#sec.rebase-warning">4.1.5. A word of warning</a></li>
<li><a href="#sec.rebase-cp">4.1.6. Avoid code duplication</a></li>
<li><a href="#sec.rebase-ps">4.1.7. Manage patch stacks</a></li>
<li><a href="#sec.rebase-onto">4.1.8. Restrict rebase with --onto</a></li>
<li><a href="#sec.rebase-onto-ci-amend">4.1.9. Improving a commit</a></li>
<li><a href="#sec.rebase-options">4.1.10. Fine adjustment of rebase</a></li>
</ul>
</li>
<li><a href="#sec.rebase-i">4.2. Rewriting the story - interactive rebase</a>
<ul class="sectlevel3">
<li><a href="#sec.rebase-i-squash">4.2.1. Correct small errors: bug squashing</a></li>
<li><a href="#sec.rebase-i-edit">4.2.2. Edit commits arbitrarily</a>
<ul class="sectlevel4">
<li><a href="#sec.rebase-split-cmmits">4.2.2.1. Split commits</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec.blame">4.3. Who made these changes? - git blame</a>
<ul class="sectlevel3">
<li><a href="#sec.blame-gui">4.3.1. Blame graphically</a></li>
</ul>
</li>
<li><a href="#sec.ignore">4.4. Ignore files</a>
<ul class="sectlevel3">
<li><a href="#sec.pattern">4.4.1. Syntax for pattern</a></li>
<li><a href="#sec.retroactive-ignore">4.4.2. Ignore or version later</a></li>
<li><a href="#sec.git-clean">4.4.3. Delete ignored and unknown files</a></li>
</ul>
</li>
<li><a href="#sec.stash">4.5. Outsource changes - git stash</a>
<ul class="sectlevel3">
<li><a href="#sec.stash-benutzung">4.5.1. Basic usage</a></li>
<li><a href="#sec.stash-conflicts">4.5.2. Solve conflicts</a></li>
<li><a href="#sec.stash-fail">4.5.3. If you can not apply the stash&#8230;&#8203;</a></li>
<li><a href="#sec.stash-message">4.5.4. Adjust message</a></li>
<li><a href="#sec.multi-stash">4.5.5. View stashes</a></li>
<li><a href="#sec.stash-delete">4.5.6. Delete stashes</a></li>
<li><a href="#sec.stash-implementation">4.5.7. How is the stash implemented?</a></li>
</ul>
</li>
<li><a href="#sec.notes">4.6. Annotate commits - git notes</a></li>
<li><a href="#sec.multi-root">4.7. Multiple root commits</a></li>
<li><a href="#sec.bisect">4.8. Find regressions - git bisect</a>
<ul class="sectlevel3">
<li><a href="#sec.bisect-usage">4.8.1. Usage</a></li>
<li><a href="#sec.bisect-run">4.8.2. Automation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ch.distributed-git">5. Distributed Git</a>
<ul class="sectlevel2">
<li><a href="#sec.distributed-systems">5.1. How Does Distributed Version Control Work?</a></li>
<li><a href="#sec.clone">5.2. Cloning Repositories</a>
<ul class="sectlevel3">
<li><a href="#sec.repository-url">5.2.1. Repository URLs</a></li>
<li><a href="#sec.remote-tracking-branches">5.2.2. Remote-Tracking-Branches</a></li>
</ul>
</li>
<li><a href="#sec.downloading-commits">5.3. Downloading Commits</a>
<ul class="sectlevel3">
<li><a href="#sec.git-fetch">5.3.1. git fetch</a>
<ul class="sectlevel4">
<li><a href="#sec.refspec">5.3.1.1. Refspec</a></li>
<li><a href="#sec.prune">5.3.1.2. Deleting Expired Remote Tracking Branches</a></li>
<li><a href="#sec.local-working-branches">5.3.1.3. Working with Local Branches</a></li>
</ul>
</li>
<li><a href="#sec.pull">5.3.2. git pull</a>
<ul class="sectlevel4">
<li><a href="#sec.upstream">5.3.2.1. Upstream Branches</a></li>
</ul>
</li>
<li><a href="#sec.fetch-vs-pull">5.3.3. git fetch vs. git pull</a>
<ul class="sectlevel4">
<li><a href="#sec.push-pull">5.3.3.1. Distributed Git for Beginners</a></li>
<li><a href="#sec.fetch-push">5.3.3.2. Distributed Git for Advanced Users</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec.uploading-commits">5.4. Uploading Commits: git push</a>
<ul class="sectlevel3">
<li><a href="#sec.push-delete">5.4.1. Deleting Remote References</a></li>
<li><a href="#sec.push-default">5.4.2. Pushing without Arguments: push.default</a></li>
<li><a href="#sec.upstream-config">5.4.3. Configuring the Upstream Branch</a></li>
</ul>
</li>
<li><a href="#sec.remotes-check">5.5. Examining Remotes</a>
<ul class="sectlevel3">
<li><a href="#sec.remotes-show">5.5.1. Overview of a Remote</a></li>
<li><a href="#sec.remote-branch-vv">5.5.2. Comparison with the Upstream</a></li>
</ul>
</li>
<li><a href="#sec.multi-remote">5.6. Distributed Workflow with Multiple Remotes</a></li>
<li><a href="#sec.managing-remotes">5.7. Managing Remotes</a>
<ul class="sectlevel3">
<li><a href="#sec.pull-request">5.7.1. Pull-Request</a></li>
</ul>
</li>
<li><a href="#sec.remote-tags">5.8. Exchanging Tags</a>
<ul class="sectlevel3">
<li><a href="#sec.tags-download">5.8.1. Downloading Tags</a></li>
<li><a href="#sec.uploading-tags">5.8.2. Uploading Tags</a></li>
</ul>
</li>
<li><a href="#sec.patch-queue">5.9. Patches via E-mail</a>
<ul class="sectlevel3">
<li><a href="#sec.exporting-patches">5.9.1. Exporting Patches</a></li>
<li><a href="#sec.sending-patches">5.9.2. Sending Patches</a></li>
<li><a href="#sec.applying-patches">5.9.3. Applying Patches</a></li>
</ul>
</li>
<li><a href="#sec.dictator">5.10. A Distributed, Hierarchical Workflow</a></li>
<li><a href="#sec.subprojects">5.11. Managing Subprojects</a>
<ul class="sectlevel3">
<li><a href="#sec.submodules">5.11.1. Submodules</a>
<ul class="sectlevel4">
<li><a href="#sec.submodule-mod">5.11.1.1. Changes in Submodules</a></li>
<li><a href="#sec.submodule-userview">5.11.1.2. From a User Perspective</a></li>
</ul>
</li>
<li><a href="#sec.subtrees">5.11.2. Subtrees</a>
<ul class="sectlevel4">
<li><a href="#sec.split-off-subtree">5.11.2.1. Splitting off a Subdirectory</a></li>
</ul>
</li>
<li><a href="#sec.submodule-vs-subtree">5.11.3. Submodules vs. Subtrees</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ch.workflows">6. Workflows</a>
<ul class="sectlevel2">
<li><a href="#sec.workflows-user">6.1. User</a></li>
<li><a href="#sec.branching-model">6.2. A Branching Model</a></li>
<li><a href="#sec.releases-management">6.3. Release Management</a>
<ul class="sectlevel3">
<li><a href="#sec.release-check-branches">6.3.1. Exploring tasks</a></li>
<li><a href="#sec.release-create">6.3.2. Create Release</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ch.server">7. Git Servers</a>
<ul class="sectlevel2">
<li><a href="#sec.server">7.1. Hosting a Git Server</a>
<ul class="sectlevel3">
<li><a href="#sec.git-protocol">7.1.1. The Git Protocol</a></li>
<li><a href="#sec.git-pack-same-machine">7.1.2. Repositories on the Same Computer</a></li>
<li><a href="#sec.bare-repos">7.1.3. Bare Repositories: Repositories Without Working Tree</a></li>
<li><a href="#sec.permissions">7.1.4. Repository Access Permissions</a></li>
<li><a href="#sec.git-shell">7.1.5. Access via SSH: The Git Shell</a></li>
<li><a href="#sec.ssh-pubkey">7.1.6. Access via SSH: Public Keys</a></li>
<li><a href="#sec.two-users">7.1.7. Example: Two Users Want to Collaborate</a></li>
</ul>
</li>
<li><a href="#sec.gitolite">7.2. Gitolite: Simple Git Hosting</a>
<ul class="sectlevel3">
<li><a href="#sec.installing-gitolite">7.2.1. Installing Gitolite</a></li>
<li><a href="#sec.gitolite-config">7.2.2. Configuring Gitolite</a></li>
<li><a href="#sec.gitweb-name">7.2.3. Ownership and Description</a></li>
<li><a href="#sec.file-access">7.2.4. Access Rights on File or Branch Level</a></li>
<li><a href="#sec.personal-namespaces">7.2.5. Personal Namespaces</a></li>
<li><a href="#sec.file-level-acl">7.2.6. File-Level Access Control</a></li>
<li><a href="#sec.gl-deny">7.2.7. Explicitly Prohibiting Actions</a></li>
<li><a href="#sec.enforcing-policies">7.2.8. Should Policies Be Enforced?</a></li>
</ul>
</li>
<li><a href="#sec.git-daemon">7.3. Git Daemon: Anonymous Read-Only Access</a>
<ul class="sectlevel3">
<li><a href="#sec.git-daemon-inetd">7.3.1. Git-Daemon and Inetd</a></li>
<li><a href="#sec.git-daemon-sv">7.3.2. The Debian Way: Git Daemon SV</a></li>
<li><a href="#sec.git-daemon-production">7.3.3. The Git Daemon on Production Systems</a></li>
<li><a href="#sec.gitolite-export">7.3.4. Specifying Exportable Repositories on Gitolite</a></li>
</ul>
</li>
<li><a href="#sec.gitweb">7.4. Gitweb: The Integrated Web Frontend</a>
<ul class="sectlevel3">
<li><a href="#sec.gitweb-installation">7.4.1. Installing Gitweb Globally</a></li>
<li><a href="#sec.gitweb-apache">7.4.2. Gitweb and Apache</a></li>
<li><a href="#sec.gitweb-Lighttpd">7.4.3. Gitweb and Lighttpd</a></li>
</ul>
</li>
<li><a href="#sec.cgit">7.5. CGit&#8201;&#8212;&#8201;CGI for Git</a>
<ul class="sectlevel3">
<li><a href="#sec.cgit-integration">7.5.1. CGit, Apache and Lighttpd</a></li>
<li><a href="#sec.cgit-config">7.5.2. Configuration</a></li>
<li><a href="#sec.cgit-special-config">7.5.3. Special Configuration of Individual Repositories</a></li>
<li><a href="#sec.cgit-cache">7.5.4. Exploiting Caching</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ch.automation">8. Git Automation</a>
<ul class="sectlevel2">
<li><a href="#sec.attributes">8.1. Git attributes - treat files separately</a>
<ul class="sectlevel3">
<li><a href="#sec.smudge-clean">8.1.1. Filter: Smudge and Clean</a></li>
<li><a href="#sec.smudge-clean-keywords">8.1.2. Keywords in files</a>
<ul class="sectlevel4">
<li><a href="#sec.smudge-clean-dontuse">8.1.2.1. Restrictions</a></li>
</ul>
</li>
<li><a href="#sec.external-diff">8.1.3. Own diff programs</a>
<ul class="sectlevel4">
<li><a href="#sec.external-diff-parameters">8.1.3.1. API for external diff programs</a></li>
<li><a href="#sec.diff-config">8.1.3.2. Configure External Diffs</a></li>
<li><a href="#sec.diff-immages">8.1.3.3. Compare pictures</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec.hooks">8.2. Hooks</a>
<ul class="sectlevel3">
<li><a href="#sec.hooks-commit">8.2.1. Commits</a></li>
<li><a href="#sec.hooks-server">8.2.2. Server side</a>
<ul class="sectlevel4">
<li><a href="#sec.hooks-receive-format">8.2.2.1. The format of the receive hooks</a></li>
<li><a href="#sec.hooks-email">8.2.2.2. Sending e-mails</a></li>
<li><a href="#sec.hooks-update">8.2.2.3. The update hook</a></li>
<li><a href="#sec.hooks-deploy">8.2.2.4. Deployment via hooks</a></li>
</ul>
</li>
<li><a href="#sec.hooks-am">8.2.3. Apply patches</a></li>
<li><a href="#sec.hooks-misc">8.2.4. Other Hooks</a></li>
</ul>
</li>
<li><a href="#sec.scripting">8.3. Writing your own Git commands</a>
<ul class="sectlevel3">
<li><a href="#sec.scripting-init">8.3.1. Initialization</a></li>
<li><a href="#sec.scripting-pos">8.3.2. Position in the repository</a></li>
<li><a href="#sec.scripting-rev-list">8.3.3. List references: rev-list</a></li>
<li><a href="#sec.scripting-find-changes">8.3.4. Find changes</a></li>
<li><a href="#sec.od-explore">8.3.5. The object database and rev-parse</a></li>
<li><a href="#sec.for-each-ref">8.3.6. Iterate references: for-each-ref</a></li>
<li><a href="#sec.git-update-ref">8.3.7. Rewrite references: git update-ref</a></li>
<li><a href="#sec.git-extended-aliases">8.3.8. Extended Aliases</a></li>
</ul>
</li>
<li><a href="#sec.filter-branch">8.4. Rewrite version history</a>
<ul class="sectlevel3">
<li><a href="#sec.fb-censor">8.4.1. Remove sensitive information afterwards</a>
<ul class="sectlevel4">
<li><a href="#sec.fb-censor-string">8.4.1.1. Remove strings from files</a></li>
<li><a href="#sec.fb-developer">8.4.1.2. Rename a developer</a></li>
</ul>
</li>
<li><a href="#sec.fb-subdir">8.4.2. Extract subdirectory</a></li>
<li><a href="#sec.fb-grafts">8.4.3. Grafts: Subsequent Merges</a></li>
<li><a href="#sec.fb-clean">8.4.4. Delete old commits</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec.git-svn-cvs">9. Interacting with Other Version Control Systems</a>
<ul class="sectlevel2">
<li><a href="#sec.subversion">9.1. Subversion</a>
<ul class="sectlevel3">
<li><a href="#sec.git-svn-convert">9.1.1. Conversion</a>
<ul class="sectlevel4">
<li><a href="#sec.git-svn-preparation">9.1.1.1. Preparation</a></li>
<li><a href="#sec.git-svn-metadata">9.1.1.2. SVN Metadata</a></li>
<li><a href="#sec.git-svn-username">9.1.1.3. Specify a Username</a></li>
<li><a href="#sec.git-svn-convert-command">9.1.1.4. Converting Standard Layouts</a></li>
<li><a href="#sec.git-svn-nonstdlayout">9.1.1.5. Non-Standard Layouts</a></li>
<li><a href="#sec.git-svn-postprocessing">9.1.1.6. Postprocessing</a></li>
<li><a href="#sec.git-svn-merges">9.1.1.7. Subversion Merges</a></li>
</ul>
</li>
<li><a href="#sec.git-svn-conduit">9.1.2. Bidirectional Communication</a>
<ul class="sectlevel4">
<li><a href="#sec.git-svn-clone">9.1.2.1. Cloning a Subversion Repository</a></li>
<li><a href="#sec.git-svn-examine">9.1.2.2. Examining a Repository</a></li>
<li><a href="#sec.git-svn-exchange">9.1.2.3. Exchanging Commits</a></li>
<li><a href="#sec.git-svn-branches-tags">9.1.2.4. Subversion Branches and Tags</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec.fast-import">9.2. Custom Importers</a></li>
</ul>
</li>
<li><a href="#ch.shell-integration">10. Shell integration</a>
<ul class="sectlevel2">
<li><a href="#sec.bash-integration">10.1. Git and the Bash</a>
<ul class="sectlevel3">
<li><a href="#sec.bash-completion">10.1.1. Completion</a></li>
<li><a href="#sec.bash-prompt">10.1.2. Prompt</a></li>
</ul>
</li>
<li><a href="#sec.zsh-integration">10.2. Git and the Z-Shell</a>
<ul class="sectlevel3">
<li><a href="#sec.zsh-completion">10.2.1. Completion</a></li>
<li><a href="#sec.zsh-prompt">10.2.2. Prompt</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ch.github">11. GitHub</a></li>
<li><a href="#app.installation">Appendix A: Installation</a>
<ul class="sectlevel2">
<li><a href="#linux">A.1. Linux</a>
<ul class="sectlevel3">
<li><a href="#sec.debian-ubuntu">A.1.1. Debian/Ubuntu</a></li>
<li><a href="#sec.fedora">A.1.2. Fedora</a></li>
<li><a href="#sec.gentoo">A.1.3. Gentoo</a></li>
<li><a href="#sec.quellcode-installation">A.1.4. Installation from the sources</a></li>
</ul>
</li>
<li><a href="#sec.osx">A.2. Mac OS X</a></li>
<li><a href="#sec.windows">A.3. Windows</a></li>
</ul>
</li>
<li><a href="#app.git-repository-layout">Appendix B: Repository Structure</a>
<ul class="sectlevel2">
<li><a href="#sec.gc">B.1. Cleaning up</a></li>
<li><a href="#sec.gc-performance">B.2. Performance</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="ch.preface"><a class="anchor" href="#ch.preface"></a>Preface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Git was developed in early 2005 by Linus Torvalds, the creator and current maintainer of the Linux kernel.
For the management of the kernel sources, the development team had initially decided to use the commercial version control system <em>BitKeeper</em>.
Problems arose when the company behind BitKeeper, which provided the tool to the project free of charge, accused a developer of revealing the mechanisms of the software by reverse engineering.
As a result, Torvalds decided to write a new version control system.</p>
</div>
<div class="paragraph">
<p>Simply switching to another system was not an option: The alternatives had a centralized architecture and did not scale well enough.
The kernel project&#8217;s requirements for a version control system are hugely demanding: Between a revision jump (e.g. 2.6.35 to 2.6.36) there are over 500,000 changed lines in almost 1000 files.
Responsible for this are over 1000 individuals.</p>
</div>
<div class="paragraph">
<p>So what were the design goals of the new program?
Two characteristics quickly emerged as design goals: speed or performance and verifiable integrity of the managed data.</p>
</div>
<div class="paragraph">
<p>After only a few weeks of work, a first version of Git was able to manage its own source code.
Implemented as a small shell script collection with performance-critical parts in C, this version was still far from being a &#8220;full-fledged&#8221; version control system.</p>
</div>
<div class="paragraph">
<p>Since version 1.5 (February 2007), Git offers a new and tidier user interface and extensive documentation, allowing people not directly involved in Git development to use it.</p>
</div>
<div class="paragraph">
<p>The basic concepts have remained the same up to current versions: First and foremost, the object model and index, key features that distinguish Git from other VCS.
The Unix philosophy of &#8220;one tool, one job&#8221; is also consistently applied here; the subcommands of Git are each independent, executable programs or scripts.
Even in the 2.0 version, some subcommands are still implemented with shell scripts (e.g. <code>git pull</code>).</p>
</div>
<div class="paragraph">
<p>Linus Torvalds himself does hardly any programming on Git these days; a few months after the first release, Junio C. Hamano took over as maintainer.</p>
</div>
<div class="paragraph">
<p>Not only the revolutionary approach of Git, but also the fact that the entire kernel development was migrated to Git quickly and successfully has given Git a steep rise.
Many projects, some of them very large, now use Git and benefit from the flexibility it has gained.</p>
</div>
<div class="sect2">
<h3 id="sec.reader"><a class="anchor" href="#sec.reader"></a>Who is this book intended for?</h3>
<div class="paragraph">
<p>The book is aimed at both professional software developers and users who want to work on small scripts, web pages or other documents or who want to get actively involved in an (open source) project.
It teaches basic version control techniques, introduces the basics of Git, and explains all the major use cases.</p>
</div>
<div class="paragraph">
<p>Work that you don&#8217;t manage with a version control system is work that you might have to do again&#8212;&#8203;whether it&#8217;s because you accidentally delete a file or consider parts obsolete that you need later.
For any form of productive text and development work, you need a tool that can record and manage changes to files.
Git is flexible, fast, and equally suited for small projects by individuals or large projects involving hundreds of developers, such as the Linux kernel.</p>
</div>
<div class="paragraph">
<p>Developers who already use a different version control system can benefit from switching to Git.
Git allows a much more flexible way of working and is in many respects not as restrictive as comparable systems.
It supports true merging and guarantees the integrity of managed data.</p>
</div>
<div class="paragraph">
<p>Git also benefits open source projects, because each developer has his or her own repository, which prevents disputes over commit privileges.
Git also makes it much easier for newcomers to get started.</p>
</div>
<div class="paragraph">
<p>Although most of the examples and techniques presented refer to source code, there is no fundamental difference to managing documents written in LaTeX, HTML, AsciiDoc or related formats.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec.structure"><a class="anchor" href="#sec.structure"></a>How to read the book?</h3>
<div class="paragraph">
<p><a href="#ch.intro">Chapter 1, <em>Introduction and First Steps</em></a> gives a brief overview: How do you initialize a git repository and manage files in it?
It also covers the most important configuration settings.</p>
</div>
<div class="paragraph">
<p><a href="#ch.basics">Chapter 2, <em>The Basics</em></a> covers two key concepts of Git: the index and the object model.
Along with other important commands that are introduced there, understanding these two concepts is essential to the safe use of Git.</p>
</div>
<div class="paragraph">
<p><a href="#ch.praxis">Chapter 3, <em>Practical Version Control</em></a> discusses practical aspects of version control.
In particular, it covers the branches and merges that are so central to Git.
It also discusses how to resolve merge conflicts in detail.</p>
</div>
<div class="paragraph">
<p><a href="#ch.advanced">Chapter 4, <em>Advanced Concepts</em></a> discusses advanced concepts, with a special focus on the Rebase command, an essential tool for any git professional.
Other important commands follow, including Blame, Stash, and Bisect.</p>
</div>
<div class="paragraph">
<p>Only <a href="#ch.distributed-git">Chapter 5, <em>Distributed Git</em></a> looks at the distributed aspects of Git: how to share changes between repositories, how developers can collaborate.
Then <a href="#ch.workflows">Chapter 6, <em>Workflows</em></a> provides an overview of strategies for coordinating development work in a project.</p>
</div>
<div class="paragraph">
<p>We recommend that you read at least the first five chapters in a row.
They describe all the important concepts and techniques for using Git safely in large projects.
You can read the following chapters in any order, depending on your interests and needs.</p>
</div>
<div class="paragraph">
<p><a href="#ch.server">Chapter 7, <em>Git Servers</em></a> covers installation and maintenance of Git services: two web-based repository browsers and access management for hosted repositories using Gitolite.</p>
</div>
<div class="paragraph">
<p><a href="#ch.automation">Chapter 8, <em>Git Automation</em></a> summarizes various aspects of automation: How to write hooks and custom Git commands, and how to rewrite the complete version history if necessary.</p>
</div>
<div class="paragraph">
<p>Finally, <a href="#sec.git-svn-cvs">Chapter 9, <em>Interacting with Other Version Control Systems</em></a> discusses migration from other systems to Git.
The focus here is on converting existing Subversion repositories, and on the ability to talk to Subversion from within Git.</p>
</div>
<div class="paragraph">
<p>The appendices deal with the installation and integration of Git into the shell.
An outlook on the hosting service <em>Github</em> and a detailed description of the structure and maintenance mechanisms of a git repository provide further background information.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec.conventions"><a class="anchor" href="#sec.conventions"></a>Conventions</h3>
<div class="paragraph">
<p>The examples are only executed on the shell.
Even though some editors and IDEs now offer quite a good Git integration, and even though there are a lot of graphical front-ends for Git, you should first learn the basics with the real Git commands.</p>
</div>
<div class="paragraph">
<p>The shell prompt is a single dollar sign (<code>$</code>); keyboard input is printed in semi-bold, like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git status</strong></pre>
</div>
</div>
<div class="paragraph">
<p>To find your way around the shell faster and better, we strongly recommend adding git functionality to the shell, such as displaying the branch in the prompt (see <a href="#ch.shell-integration">Chapter 10, <em>Shell integration</em></a>).</p>
</div>
<div class="paragraph">
<p>Unless otherwise noted, we refer to Git version 2.0, and the examples all run with English local settings.
Although German translations have been available for the output texts of most Git commands since 2012, these sound very stilted and are often confusing due to the choice of words.
In addition, you can find quick help online for original, i.e. English error messages.</p>
</div>
<div class="paragraph">
<p>Newly introduced terms are written in <em>italics</em>, partly with German equivalents in brackets behind them.
We use most Git-specific terms in the original with articles derived from the translation, e.g. the &#8220;branch&#8221; instead of the &#8220;branch&#8221;.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec.install-git-repo"><a class="anchor" href="#sec.install-git-repo"></a>Installation and &#8220;The Git-Repository&#8221;</h3>
<div class="paragraph">
<p>The installation of Git is described in detail in <a href="#app.installation">Appendix A, <em>Installation</em></a>.
Some examples use the Git source repository, the repository where Git is actively developed.
In English documentation, this repository is also called <em>Git-via-Git</em> or <em>git.git</em>.</p>
</div>
<div class="paragraph">
<p>After you have installed Git, you can download the repository with the following command</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone git://git.kernel.org/pub/scm/git/git.git</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The process takes a few minutes, depending on the connection speed and server load.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec.docs"><a class="anchor" href="#sec.docs"></a>Documentation and help</h3>
<div class="paragraph">
<p>A comprehensive documentation of Git is available in the form of pre-installed man pages.
Almost every subcommand has its own man page, which you can call in three equivalent ways, here for the <code>git status</code> command, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git help status</strong>
$ <strong>git status --help</strong>
$ <strong>man git-status</strong></pre>
</div>
</div>
<div class="paragraph">
<p>On the Git website&#8288;<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> you can also find links to the official tutorial and other free documentation.</p>
</div>
<div class="paragraph">
<p>A large, vibrant community has formed around Git.
The Git mailing list&#8288;<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup> is the lynchpin of the development: patches are sent in, new features are discussed, and questions about using Git are answered.
However, the list, with sometimes more than 100 emails a day, some of them very technical, is only suitable for beginners to a limited extent.</p>
</div>
<div class="paragraph">
<p>The Git Wiki&#8288;<sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup> contains documentation as well as an extensive link collection of tools based on Git&#8288;<sup class="footnote">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup> and FAQs&#8288;<sup class="footnote">[<a id="_footnoteref_5" class="footnote" href="#_footnotedef_5" title="View footnote.">5</a>]</sup>.</p>
</div>
<div class="paragraph">
<p>Alternatively, the <code>#git</code> IRC channel on the Freenode network provides a place to get rid of questions not already answered in the FAQs or documentation.</p>
</div>
<div class="paragraph">
<p>For those switching from the Subversion environment, the <em>Git-SVN Crash Course</em>&#8288;<sup class="footnote">[<a id="_footnoteref_6" class="footnote" href="#_footnotedef_6" title="View footnote.">6</a>]</sup> is recommended, a comparison of Git and Subversion commands that will help you transfer your Subversion knowledge to the Git world.</p>
</div>
<div class="paragraph">
<p>Also worth mentioning is <em>Stack Overflow</em>&#8288;<sup class="footnote">[<a id="_footnoteref_7" class="footnote" href="#_footnotedef_7" title="View footnote.">7</a>]</sup>, a platform by programmers for programmers, on which technical issues, including Git, are discussed.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec.contact"><a class="anchor" href="#sec.contact"></a>Downloads and contacts</h3>
<div class="paragraph">
<p>The sample repositories of the first two chapters and a collection of all longer scripts are available for download at <a href="http://gitbu.ch/" class="bare">http://gitbu.ch/</a>.</p>
</div>
<div class="paragraph">
<p>If you have any comments, please contact us by e-mail at one of the following addresses: <a href="mailto:kontakt@gitbu.ch">kontakt@gitbu.ch</a>, <a href="mailto:valentin@gitbu.ch">valentin@gitbu.ch</a> or <a href="mailto:julius@gitbu.ch">julius@gitbu.ch</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec.acknowledgements"><a class="anchor" href="#sec.acknowledgements"></a>Acknowledgements</h3>
<div class="paragraph">
<p>First of all, we&#8217;d like to thank all the developers and maintainers of the Git project as well as the mailing list and the IRC channel.</p>
</div>
<div class="paragraph">
<p>Many thanks to Sebastian Pipping and Frank Terbeck for comments and tips. Special thanks to Holger Weiß for his review of the manuscript and helpful ideas.
We thank the entire Open Source Press Team for the good and efficient cooperation.</p>
</div>
<div class="paragraph">
<p>Our thanks go especially to our parents, who have always supported and encouraged us.</p>
</div>
<div class="paragraph text-right">
<p>Valentin Haenel and Julius Plenz&#8201;&#8212;&#8201;Berlin, June 2011</p>
</div>
</div>
<div class="sect2">
<h3 id="sec.preface-2nd-edition"><a class="anchor" href="#sec.preface-2nd-edition"></a>Preface to the 2nd edition</h3>
<div class="paragraph">
<p>In the 2nd edition, we have limited ourselves to carefully recording the changes in the use of Git that were introduced up to version 2.0&#8201;&#8212;&#8201;in fact, many commands and error messages are now more consistent, so that in some places this represents a significant simplification of the text.
Inspired by questions from Git training courses and our own experience, new hints on problems, solutions, and interesting features are included.</p>
</div>
<div class="paragraph">
<p>We thank all those who sent in corrections to the first edition: Philipp Hahn, Ralf Krüdewagen, Michael Prokop, Johannes Reinhold, Heiko Schlichting, Markus Weber.</p>
</div>
<div class="paragraph text-right">
<p>Valentin Haenel and Julius Plenary Session&#8201;&#8212;&#8201;Berlin, September 2014</p>
</div>
</div>
<div class="sect2">
<h3 id="sec.preface-cc-edition"><a class="anchor" href="#sec.preface-cc-edition"></a>Preface to the CreativeCommons edition</h3>
<div class="paragraph">
<p>The publisher <em>Open Source Press</em>, who initially convinced us to write this book at all and published it over the past few years, has ceased operations as of 31.12.2015 and has transferred all rights to the published texts back to the authors.
We especially thank Markus Wirtz for the always good and productive collaboration that has connected us over many years.</p>
</div>
<div class="paragraph">
<p>Due to mainly very positive feedback on this text we decided to make it freely available under a CreativeCommons-License.</p>
</div>
<div class="paragraph text-right">
<p>Valentin Haenel and Julius Plenz&#8201;&#8212;&#8201;Berlin/Sydney, January 2016</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch.intro"><a class="anchor" href="#ch.intro"></a>1. Introduction and First Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following chapter provides a concise introduction to the basic concepts and configuration settings of Git.
A small sample project shows how to put a file under version control with Git, and the commands you use to perform the most important tasks.</p>
</div>
<div class="sect2">
<h3 id="sec.terminology"><a class="anchor" href="#sec.terminology"></a>1.1. Basic Terminology</h3>
<div class="paragraph">
<p>Some important technical terms will be used repeatedly in the following and therefore require a brief explanation.
If you have experience with another version control system, you will be familiar with some of the concepts involved, though perhaps under a different name.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Version Control System</em> (VCS) </dt>
<dd>
<p>A system for managing and versioning software or other digital information.
Prominent examples are Git, Subversion, CVS, Mercurial (hg), Darcs and Bazaar.
Synonyms are <em>Software Configuration Management</em> (SCM) and <em>Revision Control System</em>.</p>
<div class="paragraph">
<p>We distinguish between <em>centralized</em> and <em>distributed</em> systems.
In a centralized system, such as Subversion, there must be a central server where the history of the project is stored.
All developers must connect to this server to view the version history or make changes.
In a distributed system like Git, there are many equivalent instances of the repository, so each developer has their own repository.
The exchange of changes is more flexible, and does not necessarily take place through a central server.</p>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Repository</em></dt>
<dd>
<p>The repository is a database where Git stores the different states of each file in a project over time.
In particular, every change is packaged and saved as a commit.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Working Tree</em></dt>
<dd>
<p>The working directory of Git (sometimes called <em>sandbox</em> or <em>checkout</em> in other systems).
This is where you make all modifications to the source code.
It&#8217;s often called the <em>Working Directory</em>.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Commit</em></dt>
<dd>
<p>Changes to the working tree, such as modified or new files, are stored in the repository as commits.
A commit contains both these changes and metadata, such as the author of the changes, the date and time, and a commit message that describes the changes.
A commit always references the status of <em>all</em> managed files at a particular point in time. The various Git commands are used to create, manipulate, view, or change the relationships between commits.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>HEAD</code></dt>
<dd>
<p>A symbolic reference to the latest commit in the current branch.
This reference determines which files you find in the working tree for editing.
It is therefore the &#8220;head&#8221; or tip of a development branch (not to be confused with <code>HEAD</code> in systems like CVS or SVN).</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>SHA-1</em></dt>
<dd>
<p>The <em>Secure Hash Algorithm</em> creates a unique 160 bit checksum (40 hexadecimal characters) for any digital information.
All commits in Git are named after their SHA-1 sum (<em>commit ID</em>), which is calculated from the contents and metadata of the commit.
It is, so to speak, a <em>content-dependent</em> version number, such as <code>f785b8f9ba1a1f5b707a2c83145301c807a7d661</code>.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Object model</em></dt>
<dd>
<p>A git repository can be modeled as a graph of commits, manipulated by git commands.
This modeling makes it very easy to describe how Git works in detail.
For a detailed description of the object model, see <a href="#sec.object-model">Section 2.2, &#8220;The Object Model&#8221;</a>.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Index</em></dt>
<dd>
<p>The index is an intermediate level between the working tree and the repository, where you prepare a commit.
The index therefore <em>indexes</em> which changes to which files you want to package as commits.
This concept is unique to Git, and is often difficult for beginners and people who are new to Git.
We discuss the index in detail in <a href="#sec.index">Section 2.1.1, &#8220;Index&#8221;</a>.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Clone</em></dt>
<dd>
<p>When you download a Git repository from the Internet, you create a clone of that repository.
The clone contains all the information contained in the source repository, especially the entire version history including all commits.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Branch</em></dt>
<dd>
<p>A branch in the development.
Branches are used in practice, for example, to develop new features, prepare releases, or to provide old versions with bug fixes.
Branches are&#8201;&#8212;&#8201;just like the merging of branches (<em>Merge</em>)&#8201;&#8212;&#8201;extremely easy to handle in Git and an outstanding feature of the system.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>master</code></dt>
<dd>
<p>Because you need at least one branch to work with Git, the Branch <code>master</code> is created when you initialize a new repository.
The name is a convention (similar to <code>trunk</code> in other systems); you can rename or delete this branch as you wish, as long as at least one other branch is available.
The <code>master</code> is technically no different from other branches.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Tag</em></dt>
<dd>
<p>Tags are symbolic names for SHA-1 values that are difficult to remember.
You can use tags to mark important commits, such as releases.
A tag can simply be an identifier, such as <code>v1.6.2</code>, or it can contain additional metadata such as author, description, and GPG signature.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="sec.first-steps"><a class="anchor" href="#sec.first-steps"></a>1.2. First Steps with Git</h3>
<div class="paragraph">
<p>To get you started, we&#8217;ll use a small example to illustrate the workflow with Git.
We create a repository and develop a one-liner, a &#8220;Hello, World!&#8221; program in Perl.</p>
</div>
<div class="paragraph">
<p>In order for Git to assign a commit to an author, you need to enter your name and email address:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global user.name "Max Mustermann"</strong>
$ <strong>git config --global user.email "max.mustermann@example.com"</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Note that a <em>subcommand</em> is specified when Git is called, in this case <code>config</code>.
Git provides all operations through such subcommands.
It is also important that no equal sign is used when calling <code>git config</code>.
The following call is therefore <em>incorrect</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global user.name = "Max Mustermann"</strong></pre>
</div>
</div>
<div class="paragraph">
<p>This is a trip hazard, especially for beginners, because Git does not output an error message, but takes the equals sign as the value to set.</p>
</div>
<div class="sect3">
<h4 id="sec.first-repo"><a class="anchor" href="#sec.first-repo"></a>1.2.1. The First Repository</h4>
<div class="paragraph">
<p>Before we use Git to manage files, we need to create a repository for the sample project.
The repository will be created <em>locally</em>, so it will only be on the file system of the machine you are working on.</p>
</div>
<div class="paragraph">
<p>It&#8217;s generally recommended that you practice using Git locally first, and only later dive into the decentralized features and functions of Git.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git init beispiel</strong>
Initialized empty Git repository in /home/esc/beispiel/.git/</pre>
</div>
</div>
<div class="paragraph">
<p>First, Git creates the directory <code>example/</code> if it doesn&#8217;t already exist.
Git then initializes an empty repository in this directory and creates a subdirectory <code>.git/</code> for it, which is used to manage internal data.
If the <code>example/</code> directory already exists, Git creates a new Git repository in it.
If both the directory and a repository already exist, Git does nothing.
We change to the directory and look at the current state with <code>git status</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd beispiel</strong>
$ <strong>git status</strong>
On branch master

Initial commit

nothing to commit (create/copy files and use "git add" to track)</pre>
</div>
</div>
<div class="paragraph">
<p>Git weist uns darauf hin, dass wir vor dem ersten Commit stehen (<code>Initial commit</code>), hat aber nichts gefunden, was in diesen Commit einfließen könnte (<code>nothing to commit</code>).
Dafür liefert es einen Hinweis, welche Schritte sich als nächste anbieten (das tun übrigens die meisten Git-Kommandos): &#8220;Erstellen oder kopieren Sie Dateien, und verwenden Sie <code>git add</code>, um diese mit Git zu verwalten.&#8221;</p>
</div>
<div class="paragraph">
<p>Git tells us that we&#8217;re about to commit (<code>Initial commit</code>), but hasn&#8217;t found anything to commit (<code>nothing to commit</code>).
Instead, it gives a hint as to what the next steps should be (most Git commands do that, by the way): &#8220;Create or copy files, and use <code>git add</code> to manage them with Git.&#8221;</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.first-commit"><a class="anchor" href="#sec.first-commit"></a>1.2.2. The First Commit</h4>
<div class="paragraph">
<p>Now let&#8217;s give Git a first file to manage, which is a &#8220;Hello World!&#8221; program in Perl.
Of course, you can write any program in the programming language of your choice instead.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll first create the <code>hello.pl</code> file with the following content</p>
</div>
<div class="listingblock">
<div class="content">
<pre>print "Hello World!\n";</pre>
</div>
</div>
<div class="paragraph">
<p>and execute the script once:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>perl hello.pl</strong>
Hello World!</pre>
</div>
</div>
<div class="paragraph">
<p>That means we&#8217;re ready to manage the file with Git.
But let&#8217;s take a look at the output of <code>git status</code> first:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git status</strong>
On branch master

Initial commit

Untracked files:
  (use "git add &lt;file&gt;..." to include in what will be committed)

      hello.pl
nothing added to commit but untracked files present (use "git add" to track)</pre>
</div>
</div>
<div class="paragraph">
<p>While the first commit is still pending, Git registers that there are already files in that directory, but the system is unaware of them&#8201;&#8212;&#8201;Git calls them <code>untracked</code>.
This is, of course, our little Perl program.
To manage it with Git, we use the command <code>git add &lt;file&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git add hello.pl</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>add</code> generally stands for &#8220;add changes&#8221;&#8201;&#8212;&#8201;so you will need it whenever you have edited files, not just when you first add them!</p>
</div>
<div class="paragraph">
<p>Git doesn&#8217;t provide output for this command.
Use <code>git status</code> to check if the call was successful:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git status</strong>
On branch master

Initial commit

Changes to be committed:
  (use "git rm --cached &lt;file&gt;..." to unstage)

      new file:   hello.pl</pre>
</div>
</div>
<div class="paragraph">
<p>Git will apply the changes&#8201;&#8212;&#8201;our new file&#8201;&#8212;&#8201;at the next commit.
However, this commit is not yet complete&#8201;&#8212;&#8201;we&#8217;ve only prepared it so far.</p>
</div>
<div class="paragraph">
<p>To be precise, we&#8217;ve added the file to the <em>Index</em>, an intermediate stage where you collect changes that will be included in the next commit.
For further explanation of this concept, see <a href="#sec.index">Section 2.1.1, &#8220;Index&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>With <code>git status</code>, under <code>Changes to be committed</code>, you can always see which files are in the Index, i.e., will be included in the next commit.</p>
</div>
<div class="paragraph">
<p>Alles ist bereit für den ersten Commit mit dem Kommando <code>git commit</code>.
Außerdem übergeben wir auf der Kommandozeile die Option <code>-m</code> mit einer Commit-Nachricht (<em>Commit Message</em>), in der wir den Commit beschreiben:</p>
</div>
<div class="paragraph">
<p>Everything is ready for the first commit with the <code>git commit</code> command.
We also pass the <code>-m</code> option on the command line with a commit message describing the commit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git commit -m "Erste Version"</strong>
[master (root-commit) 07cc103] Erste Version
 1 file changed, 1 insertion(+)
 create mode 100644 hello.pl</pre>
</div>
</div>
<div class="paragraph">
<p>Git will confirm that the process has been successfully completed and the file will be managed from now on.
The somewhat cryptic output means Git has created the initial commit (<code>root-commit</code>) with the appropriate message.
A line has been added to a file, and the file has been created with Unix permissions <code>0644</code>.&#8288;<sup class="footnote">[<a id="_footnoteref_8" class="footnote" href="#_footnotedef_8" title="View footnote.">8</a>]</sup></p>
</div>
<div class="paragraph">
<p>As you&#8217;ve no doubt noticed by now, <code>git status</code> is an indispensable command in your daily work&#8201;&#8212;&#8201;we&#8217;ll use it again here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git status</strong>
On branch master
nothing to commit, working directory clean</pre>
</div>
</div>
<div class="paragraph">
<p>Our sample repository is now &#8220;clean&#8221;, because there are no changes in the Working Tree or Index, nor are there any files that are not managed with Git (<em>untracked files</em>).</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.viewing-commits"><a class="anchor" href="#sec.viewing-commits"></a>1.2.3. Viewing Commits</h4>
<div class="paragraph">
<p>To conclude this brief introduction, we&#8217;ll introduce you to two very useful commands that you&#8217;ll often use to examine the version history of projects.</p>
</div>
<div class="paragraph">
<p>First, <code>git show</code> allows you to examine a single commit&#8201;&#8212;&#8201;it&#8217;s the most recent one, with no arguments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show</strong>
commit 07cc103feb393a93616842921a7bec285178fd56
Author: Valentin Haenel &lt;valentin.haenel@gmx.de&gt;
Date:   Tue Nov 16 00:40:54 2010 +0100

    Erste Version

diff --git a/hello.pl b/hello.pl
new file mode 100644
index 0000000..fa5a091
--- /dev/null
+++ b/hello.pl
@@ -0,0 +1 @@
+print "Hello World!\n";</pre>
</div>
</div>
<div class="paragraph">
<p>You see all relevant information about the commit: the <em>commit ID</em>, the author, the date and time of the commit, the commit message, and a summary of the changes in <em>Unified-Diff</em> format.</p>
</div>
<div class="paragraph">
<p>By default, <code>git show</code> always prints the <code>HEAD</code> (a symbolic name for the most recent commit), but you could also specify, for example, the commit ID, which is the SHA-1 checksum of the commit, a unique prefix to it, or the branch (<code>master</code> in this case).
Thus, the following commands are equivalent in this example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show</strong>
$ <strong>git show HEAD</strong>
$ <strong>git show master</strong>
$ <strong>git show 07cc103</strong>
$ <strong>git show 07cc103feb393a93616842921a7bec285178fd56</strong></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to view more than one commit, <code>git log</code> is recommended.
More commits are needed to demonstrate the command in a meaningful way; otherwise, the output would be very similar to <code>git show</code>, since the sample repository currently contains only a single commit.
So let&#8217;s add the following comment line to the &#8220;Hello World!&#8221; program_</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Hello World! in Perl</pre>
</div>
</div>
<div class="paragraph">
<p>Schauen wir uns der Übung halber noch einmal mit <code>git status</code> den aktuellen Zustand an:</p>
</div>
<div class="paragraph">
<p>For the sake of the exercise, let&#8217;s take another look at the current status with <code>git status</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git status</strong>
On branch master
Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git checkout -- &lt;file&gt;..." to discard changes in working
   directory)

      modified:   hello.pl

no changes added to commit (use "git add" and/or "git commit -a")</pre>
</div>
</div>
<div class="paragraph">
<p>Then, as described in the output of the command, use <code>git add</code> to add the changes to the Index.
As mentioned earlier, <code>git add</code> is used both to add new files and to add changes to files already managed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git add hello.pl</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Then create a commit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git commit -m "Kommentar-Zeile"</strong>
[master 8788e46] Kommentar-Zeile
 1 file changed, 1 insertion(+)</pre>
</div>
</div>
<div class="paragraph">
<p>Now <code>git log</code> shows you the two commits:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log</strong>
commit 8788e46167aec2f6be92c94c905df3b430f6ecd6
Author: Valentin Haenel &lt;valentin.haenel@gmx.de&gt;
Date:   Fri May 27 12:52:58 2011 +0200

    Kommentar-Zeile

commit 07cc103feb393a93616842921a7bec285178fd56
Author: Valentin Haenel &lt;valentin.haenel@gmx.de&gt;
Date:   Tue Nov 16 00:40:54 2010 +0100

    Erste Version</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="chap.git-config"><a class="anchor" href="#chap.git-config"></a>1.3. Configuring Git</h3>
<div class="paragraph">
<p>Like most text-based programs, Git offers a wealth of configuration options.
So now&#8217;s the time to do some basic configuration.
These include color settings, which are turned on by default in newer versions, to make it easier to capture the output of Git commands, and small aliases (abbreviations) for frequently used commands.</p>
</div>
<div class="paragraph">
<p>You configure Git with the <code>git config</code> command.
The configuration is saved in a format similar to an INI file.
If you do not specify any other parameters, the configuration only applies to the current Git repository (<code>.git/config</code>).
With the <code>--global</code> option, it is stored in the <code>.gitconfig</code> file in the user&#8217;s home directory, and is then valid for all repositories.&#8288;<sup class="footnote">[<a id="_footnoteref_9" class="footnote" href="#_footnotedef_9" title="View footnote.">9</a>]</sup></p>
</div>
<div class="paragraph">
<p>Important settings that you should always configure are the user name and e-mail address:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global user.name "Max Mustermann"</strong>
$ <strong>git config --global user.email "max.mustermann@example.com"</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Beachten Sie, dass Sie Leerzeichen im Wert der Einstellung schützen müssen (durch Anführungszeichen oder Backslashes).
Außerdem folgt der Wert direkt auf den Namen der Option&#8201;&#8212;&#8201;ein Gleichheitszeichen ist auch hier nicht nötig.
Das Ergebnis des Kommandos findet sich anschließend in der Datei <code>~/.gitconfig</code>:</p>
</div>
<div class="paragraph">
<p>Note that you must protect spaces in the setting value (using quotation marks or backslashes).
Also, the value follows the name of the option directly&#8201;&#8212;&#8201;an equal sign is not necessary here either.
The result of the command can be found in the file <code>~/.gitconfig</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>less ~/.gitconfig</strong>
[user]
    name = Max Mustermann
    email = max.mustermann@example.com</pre>
</div>
</div>
<div class="paragraph">
<p>The settings are now &#8220;global&#8221;, meaning they apply to all repositories you edit under that user name.
If you want to specify an e-mail address other than your globally defined one for a particular project, simply change the setting there (this time, of course, without adding <code>--global</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config user.email maintainer@project.example.com</strong></pre>
</div>
</div>
<div class="paragraph">
<p>When Git queries an option, it will first use the setting in the current Git repository, if it exists, otherwise it will use the setting from the global <code>.gitconfig</code>; if it doesn&#8217;t, it will revert to the default value.&#8288;<sup class="footnote">[<a id="_footnoteref_10" class="footnote" href="#_footnotedef_10" title="View footnote.">10</a>]</sup>
The latter is available for all options in the man page <code>git-config</code>.
You can get a list of all the settings you have set using <code>git config -l</code>.</p>
</div>
<div class="paragraph">
<p>You can also edit the <code>.gitconfig</code> file (or the repository <code>.git/config</code>) by hand.
This is especially useful for deleting a setting&#8201;&#8212;&#8201;although <code>git config</code> also offers a <code>--unset</code> option, it is easier to delete the corresponding line in an editor.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The commands <code>git config -e</code> or <code>git config --global -e</code> launch the editor configured for Git on the local or global configuration file.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note, however, that when you <em>set</em> options with an appropriate command, Git automatically protects problematic characters in the option&#8217;s value so that no bad configuration files are created.</p>
</div>
<div class="sect3">
<h4 id="sec.git-alias"><a class="anchor" href="#sec.git-alias"></a>1.3.1. Git Aliases</h4>
<div class="paragraph">
<p>Git uses <em>aliases</em> to allow you to abbreviate individual commands and even entire command sequences.
The syntax is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config alias.&lt;alias-name&gt; &lt;entsprechung&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>To set <code>st</code> as an alias for <code>status</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global alias.st status</strong>
$ <strong>git st</strong>
On branch master
...</pre>
</div>
</div>
<div class="paragraph">
<p>You can also include options in an alias, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global alias.gconfig 'config --global'</strong></pre>
</div>
</div>
<div class="paragraph">
<p>You will find more useful aliases later in the book; how to create more complex aliases is described in <a href="#sec.git-extended-aliases">Section 8.3.8, &#8220;Extended Aliases&#8221;</a>.
But first, some useful abbreviations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[alias]
    st = status
    ci = commit
    br = branch
    co = checkout
    df = diff
    he = help
    cl = clone</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="chap.color-defaults"><a class="anchor" href="#chap.color-defaults"></a>1.3.2. Adjusting Colours</h4>
<div class="paragraph">
<p>Very helpful is the <code>color.ui</code> option, which checks whether Git should color the output of various commands.
Deleted files and lines will appear red, new files and lines green, commit IDs yellow, and so on.
In newer Git versions (1.8.4 and later) this setting is already set automatically, so you don&#8217;t need to do anything.</p>
</div>
<div class="paragraph">
<p>The <code>color.ui</code> option should be set to <code>auto</code>&#8201;&#8212;&#8201;if Git is output to a terminal, colours are used.
If the command is written to a file instead, or the output is piped to another program, Git will not output color sequences, as this could interfere with automatic processing.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global color.ui auto</strong></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="chap.config-encoding"><a class="anchor" href="#chap.config-encoding"></a>1.3.3. Configuring Character Sets</h4>
<div class="paragraph">
<p>Unless set otherwise, Git assumes UTF-8 as the character encoding for all text, especially author names and the commit message.
If you want a different encoding, you should configure it explicitly:&#8288;<sup class="footnote">[<a id="_footnoteref_11" class="footnote" href="#_footnotedef_11" title="View footnote.">11</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config i18n.commitEncoding ISO-8859-1</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, the setting <code>i18n.logOutputEncoding</code> determines the character set Git converts names and commit messages to before outputting them.</p>
</div>
<div class="paragraph">
<p>The encoding of the <em>files</em> managed by Git is not important here and is not affected by these settings&#8201;&#8212;&#8201;files are only bit streams that Git does not interpret.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you have to handle files encoded according to ISO-8859-1 in a UTF-8 environment, you should adjust the setting of your pager (see below) accordingly.
The following setting is recommended for authors:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config core.pager 'env LESSCHARSET=iso8859 less'</strong></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec.config-eol"><a class="anchor" href="#sec.config-eol"></a>1.3.4. Line End Settings</h4>
<div class="paragraph">
<p>Since Git runs on Windows systems like it does on unixoid systems, it has to solve the problem of different line-end conventions.
(This only affects text files&#8201;&#8212;&#8201;binaries that Git recognizes as such are excluded from this treatment).</p>
</div>
<div class="paragraph">
<p>The <code>core.eol</code> setting, which can take one of the values <code>lf</code>, <code>crlf</code> or <code>native</code>, is mainly relevant for this.
The default setting <code>native</code> lets Git use the system default&#8201;&#8212;&#8201;Unix: Line Feed (<code>lf</code>) only, Windows: Carriage Return &amp; Line Feed (<code>crlf</code>).
The file is automatically converted to get line feeds only, but is checked out with CRLF if necessary.</p>
</div>
<div class="paragraph">
<p>Git can convert between the two types when you check out the file, but it&#8217;s important not to mix the two.
For this, the <code>core.safecrlf</code> option provides a mechanism to warn the user (value <code>warn</code>) or even disallow the commit (value <code>true</code>).</p>
</div>
<div class="paragraph">
<p>Eine sichere Einstellung, die auch mit älteren Git-Versionen unter Windows-Systemen funktioniert, ist <code>core.autocrlf</code> auf <code>input</code> zu setzen: Dadurch wird automatisch beim <em>Einlesen</em> der Dateien vom Dateisystem CRLF durch LF ersetzt.
Ihr
Editor muss dann entsprechend mit LF-Enden umgehen können.</p>
</div>
<div class="paragraph">
<p>A safe setting, which also works with older Git versions on Windows systems, is to set <code>core.autocrlf</code> to <code>input</code>: This will automatically replace CRLF with LF when <em>reading</em> files from the filesystem.
Your editor must then be able to handle LF line endings accordingly.</p>
</div>
<div class="paragraph">
<p>You can also specify these settings explicitly per file or subdirectory, so that the format is the same across all platforms (see <a href="#sec.attributes">Section 8.1, &#8220;Git attributes - treat files separately&#8221;</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="chap.ext-tools"><a class="anchor" href="#chap.ext-tools"></a>1.3.5. Editor, Pager and Browser Settings</h4>
<div class="paragraph">
<p>Git automatically starts an editor, pager, or browser for certain actions.
Usually reasonable defaults are used, but if not, you can configure your preferred program with the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>core.editor</code></p>
</li>
<li>
<p><code>core.pager</code></p>
</li>
<li>
<p><code>web.browser</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A word about the pager: By default, Git uses the <code>less</code> program, which is installed on most basic systems.
The command is <em>always</em> started whenever a Git command produces output on a terminal.
However, <code>less</code> is automatically configured by an environment variable to quit when the output is completely fit on the terminal.
So, if a command produces a lot of output, <code>less</code> will automatically come to the foreground&#8201;&#8212;&#8201;and remain invisible otherwise.</p>
</div>
<div class="paragraph">
<p>If <code>core.pager</code> is set to <code>cat</code>, Git will not use a pager.
However, this behavior can be achieved from command to command using the <code>--no-pager</code> parameter.
In addition, you can use <code>git config pager.diff false</code> to ensure that the output of the diff command is never sent to the pager.</p>
</div>
</div>
<div class="sect3">
<h4 id="chap.conf-env"><a class="anchor" href="#chap.conf-env"></a>1.3.6. Configuration via Environment Variables</h4>
<div class="paragraph">
<p>Einige Optionen lassen sich auch durch Umgebungsvariablen überschreiben.
Auf diese Weise können in einem Shell-Script oder in einem Alias Optionen lediglich für ein einzelnes Kommando gesetzt werden.</p>
</div>
<div class="paragraph">
<p>Some options can also be overridden by environment variables.
In this way, options can be set in a shell script or alias for a single command only.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>GIT_EDITOR</code> </dt>
<dd>
<p>the editor that Git starts, for example, to create the commit message.
Alternatively, Git uses the <code>EDITOR</code> variable.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>GIT_PAGER</code> </dt>
<dd>
<p>the pager to be used.
The value <code>cat</code> switches the pager off.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>GIT_AUTHOR_EMAIL</code>, <code>GIT_COMMITTER_EMAIL</code> </dt>
<dd>
<p>uses the appropriate email address for the author or committer field when creating a commit.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>GIT_AUTHOR_NAME</code>, <code>GIT_COMMITTER_NAME</code> </dt>
<dd>
<p>analogous to the name.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>GIT_DIR</code> </dt>
<dd>
<p>Directory in which the Git repository is located; only makes sense if a repository is explicitly stored under a directory other than <code>.git</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The latter variable is useful, for example, if you want to access the version history of another repository within a project without changing directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>GIT_DIR="~/proj/example/.git" git log</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Alternativ können Sie über die Option <code>-c</code>&#160; <em>vor dem Subkommando</em> eine Einstellung nur für diesen Aufruf überschreiben.
So könnten Sie zum Beispiel Git anweisen, für den kommenden Aufruf die Option <code>core.trustctime</code> zu deaktivieren:</p>
</div>
<div class="paragraph">
<p>Alternatively, you can use the <code>-c</code> option <em>before the subcommand</em> to overwrite a setting for this call only.
For example, you could tell Git to disable the <code>core.trustctime</code> option for the upcoming call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git -c core.trustctime=false status</strong></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="chap.correct-errors"><a class="anchor" href="#chap.correct-errors"></a>1.3.7. Automatic Error Correction</h4>
<div class="paragraph">
<p>The value of the <code>help.autocorrect</code> option determines what Git should do if it can&#8217;t find the subcommand you entered, for example if you accidentally type <code>git statsu</code> instead of <code>git status</code>.</p>
</div>
<div class="paragraph">
<p>If the option is set to a number <code>n</code> greater than zero and Git only finds a subcommand similar to the typed command, this command is executed after <code>n</code> tenths of a second.
A value of <code>-1</code> executes the command immediately.
Unset or with the value <code>0</code>, only the possibilities are listed.</p>
</div>
<div class="paragraph">
<p>So to correct a typo after one second, set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global help.autocorrect 10</strong>
$ <strong>git statsu</strong>
WARNING: You called a Git command named 'statsu', which does not exist.
Continuing under the assumption that you meant 'status'
in 1.0 seconds automatically...
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>You can of course cancel the command during this time with <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>C</kbd></span>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch.basics"><a class="anchor" href="#ch.basics"></a>2. The Basics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this chapter, we&#8217;ll introduce you to the most important Git commands that you can use to manage your project files in Git.
Understanding the Git object model is essential for advanced usage; we&#8217;ll cover this important concept in the second section of the chapter.
While these explanations may seem overly theoretical at first, we encourage you to read them carefully.
All further actions will be much easier for you with the knowledge of this background.</p>
</div>
<div class="sect2">
<h3 id="sec.basics"><a class="anchor" href="#sec.basics"></a>2.1. Git Commands</h3>
<div class="paragraph">
<p>The commands you learned to get started (especially <code>add</code> and <code>commit</code>) work on the index.
In the following, we will take a closer look at the index and the extended use of these commands.</p>
</div>
<div class="sect3">
<h4 id="sec.index"><a class="anchor" href="#sec.index"></a>2.1.1. Index</h4>
<div class="paragraph">
<p>The content of files for Git resides on three levels: the <em>working tree</em>, the <em>index</em>, and the Git <em>repository</em>.
The working tree corresponds to the files as they reside on your workstation&#8217;s file system&#8201;&#8212;&#8201;so if you edit files with an editor, search in them with <code>grep</code>, etc., you always operate on the working tree.</p>
</div>
<div class="paragraph">
<p>The repository is the repository for commits, that is, changes, with author, date, and description.
The commits together make up the <em>version history</em>.</p>
</div>
<div class="paragraph">
<p>Unlike many other version control systems, Git now introduces a new feature, the index.
It&#8217;s a somewhat elusive intermediate level between the working tree and the repository.
Its purpose is to prepare commits.
This means that you don&#8217;t always have to check in <em>all</em> the changes you have made to a file as commits.</p>
</div>
<div class="paragraph">
<p>The Git commands <code>add</code> and <code>reset</code> act (in their basic form) on the index, making changes to the index and deleting them again; only the <code>commit</code> command transfers the file to the repository as it is held in the index (<a href="#fig.index">Figure 1, &#8220;Commands <code>add</code>, <code>reset</code> and <code>commit</code>&#8221;</a>).</p>
</div>
<div id="fig.index" class="imageblock text-center">
<div class="content">
<img src="images/index.svg" alt="index" width="90%">
</div>
<div class="title">Figure 1. Commands <code>add</code>, <code>reset</code> and <code>commit</code></div>
</div>
<div class="paragraph">
<p>In the initial state, i.e. when <code>git status</code> outputs the message <code>nothing to commit</code>, the working tree and index are synchronized with <code>HEAD</code>.
The index is therefore not &#8220;empty&#8221;, but contains the files in the same state as they are in the working tree.</p>
</div>
<div class="paragraph">
<p>Usually, the workflow is then as follows: First, you make a change to the working tree using an editor.
This change is transferred to the index by <code>add</code> and finally saved in the repository by <code>commit</code>.</p>
</div>
<div class="paragraph">
<p>You can display the differences between these three levels using the <code>diff</code> command.
A simple <code>git diff</code> shows the differences between the working tree and the index&#8201;&#8212;&#8201;the differences between the (actual) files on your working system and the files as they would be checked in if you called <code>git commit</code>.</p>
</div>
<div class="paragraph">
<p>The <code>git diff --staged</code> command, on the other hand, shows the differences between the index (also called the staging area) and the repository, that is, the differences that a commit would commit to the repository.
In the initial state, when the working tree and index are in sync with <code>HEAD</code>, neither <code>git diff</code> nor <code>git diff --staged</code> produces output.</p>
</div>
<div class="paragraph">
<p>If you want to apply all changes to all files, there are two shortcuts: First, the <code>-u</code> or <code>--update</code> option of <code>git add</code>.
This transfers all changes to the index, but does not yet create a commit.
You can further abbreviate it with the <code>-a</code> or <code>--all</code> option of <code>git commit</code>.
This is a combination of <code>git add -u</code> and <code>git commit</code>, which puts all changes to all files into one commit, bypassing the index.
Avoid getting into the habit of using these options&#8201;&#8212;&#8201;they may be handy as shortcuts on occasion, but they reduce flexibility.</p>
</div>
<div class="sect4">
<h5 id="sec.diff-color-words"><a class="anchor" href="#sec.diff-color-words"></a>2.1.1.1. Word-Based Diff</h5>
<div class="paragraph">
<p>An alternative output format for <code>git diff</code> is the so-called <em>Word-Diff</em>, which is available via the <code>--word-diff</code> option.
Instead of the removed and added lines, the output of <code>git diff</code> shows the added (green) and removed (red) words with an appropriate syntax and color-coded.&#8288;<sup class="footnote">[<a id="_footnoteref_12" class="footnote" href="#_footnotedef_12" title="View footnote.">12</a>]</sup>
This is useful when you are only changing single words in a file, for example when correcting AsciiDoc or LaTeX documents, because a diff is difficult to read if added and removed lines differ by only one word:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git diff</strong>
...
-   die Option `--color-words` zur Verfgung steht. Statt der entfernten
+   die Option `--color-words` zur Verfügung steht. Statt der entfernten
...</pre>
</div>
</div>
<div class="paragraph">
<p>However, if you use the <code>--word-diff</code> option, only words that have been changed will be displayed marked accordingly; in addition, line breaks are ignored, which is also very practical because a reorientation of the words is not included as a change in the diff output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git diff --word-diff</strong>
...
--color-words zur [-Verfgung-]{Verfügung} steht.
...</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you work a lot with continuous text, it is a good idea to set up an alias to abbreviate this command, so that you only have to type <code>git dw</code>, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global alias.dw "diff --word-diff"</strong></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.add-p"><a class="anchor" href="#sec.add-p"></a>2.1.2. Creating Commits Step by Step</h4>
<div class="paragraph">
<p>But why create commits step-by-step&#8201;&#8212;&#8201;don&#8217;t you always want to check in all changes?</p>
</div>
<div class="paragraph">
<p>Yes, of course, you usually want to commit your changes completely.
However, it can be useful to check them in step by step, for example, to better reflect the development history.</p>
</div>
<div class="paragraph">
<p>An example: You have worked intensively on your software project for the past three hours, but because it was so exciting, you forgot to pack the four new features into handy commits.
In addition, the features are scattered over various files.</p>
</div>
<div class="paragraph">
<p>At best, you want to be selective, that is, you don&#8217;t want to commit all changes from one file, but only certain lines (functions, definitions, tests, &#8230;&#8203;), and from different files.</p>
</div>
<div class="paragraph">
<p>Git&#8217;s index provides the flexibility you need for this.
You collect some changes in the index and pack them into a commit&#8201;&#8212;&#8201;but all other changes are still preserved in the files.</p>
</div>
<div class="paragraph">
<p>Wir wollen das anhand des &#8220;Hello World!&#8221;-Beispiels aus dem vorigen Kapitel illustrieren.
Zur Erinnerung der Inhalt der Datei <code>hello.pl</code>:</p>
</div>
<div class="paragraph">
<p>We&#8217;ll illustrate this using the &#8220;Hello World!&#8221; example from the previous chapter.
As a reminder, the contents of the <code>hello.pl</code> file</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Hello World! in Perl
print "Hello World!\n";</pre>
</div>
</div>
<div class="paragraph">
<p>Now we prepare the file so that it has several independent changes that we <em>don&#8217;t</em> want to combine into a single commit.
First, we add a shebang line at the beginning.&#8288;<sup class="footnote">[<a id="_footnoteref_13" class="footnote" href="#_footnotedef_13" title="View footnote.">13</a>]</sup>
We also add a line naming the author, and the Perl statement <code>use strict</code>, which tells the Perl interpreter to be as strict as possible in its syntax analysis.
It is important for our example that the file has been changed in several places:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/usr/bin/perl
# Hello World! in Perl
# Author: Valentin Haenel
use strict;
print "Hello World!\n";</pre>
</div>
</div>
<div class="paragraph">
<p>With a simple <code>git add hello.pl</code> all new lines would be added to the index&#8201;&#8212;&#8201;so the state of the file in the index would be the same as in the working tree.
Instead, we use the <code>--patch</code> option or short <code>-p</code>.&#8288;<sup class="footnote">[<a id="_footnoteref_14" class="footnote" href="#_footnotedef_14" title="View footnote.">14</a>]</sup>
This has the effect that we are interactively asked which changes we want to add to the index.
Git offers us each change one by one, and we can decide on a case-by-case basis how we want to handle them:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git add -p</strong>
diff --git a/hello.pl b/hello.pl
index c6f28d5..908e967 100644
--- a/hello.pl
+++ b/hello.pl
@@ -1,2 +1,5 @@
+&num;!/usr/bin/perl
 &num; Hello World! in Perl
+&num; Author: Valentin Haenel
+use strict;
 print "Hello World!\n";
Stage this hunk [y,n,q,a,d,/,s,e,?]?</pre>
</div>
</div>
<div class="paragraph">
<p>This is where Git shows all changes, since they&#8217;re very close together in the code.
If the changes are far apart or spread across different files, they&#8217;re offered separately.
The term <em>hunk</em> refers to loosely connected lines in the source code.
Some of the options we have at this point include the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Stage this hunk[y,n,q,a,d,/,s,e,?]?</pre>
</div>
</div>
<div class="paragraph">
<p>Die Optionen sind jeweils nur einen Buchstaben lang und schwierig zu merken.
Eine kleine Erinnerung erhalten Sie immer durch <em>[?]</em>.
Die wichtigsten Optionen haben wir im Folgenden zusammengefasst.</p>
</div>
<div class="paragraph">
<p>The options are each only one letter long and difficult to remember.
A small reminder is always given by <em>[?]</em>.
We have summarized the most important options below.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>y</code> (<em>yes</em>)   
</td>
<td class="hdlist2">
<p>Transfer the current hunk to the index.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>n</code> (<em>no</em>)    
</td>
<td class="hdlist2">
<p>Don&#8217;t pick up the current hunk.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>q</code> (<em>quit</em>)  
</td>
<td class="hdlist2">
<p>Do not pick up the current hunk or any of the following ones.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>a</code> (<em>all</em>)   
</td>
<td class="hdlist2">
<p>Pick up the current hunk and all those that follow (in the current file).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>s</code> (<em>split</em>) 
</td>
<td class="hdlist2">
<p>Try to split the current hunk.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>e</code> (<em>edit</em>)  
</td>
<td class="hdlist2">
<p>Edit the current hunk.&#8288;<sup class="footnote">[<a id="_footnoteref_15" class="footnote" href="#_footnotedef_15" title="View footnote.">15</a>]</sup></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the example we split the current hunk and enter <code>s</code> for <em>split</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Stage this hunk [y,n,q,a,d,/,s,e,?]? <strong>[s]</strong>
Split into 2 hunks.
@@ -1 +1,2 @@
+#!/usr/bin/perl
 # Hello World! in Perl</pre>
</div>
</div>
<div class="paragraph">
<p>Git confirms that the hunk was successfully split, and now offers us a diff that contains only the shebang line.&#8288;<sup class="footnote">[<a id="_footnoteref_16" class="footnote" href="#_footnotedef_16" title="View footnote.">16</a>]</sup>
We specify <code>y</code> for <em>yes</em> and <code>q</code> for <em>quit</em> on the next hunk.
To check if everything worked, we use <code>git diff</code> with the <code>--staged</code> option, which shows the difference between index and <code>HEAD</code> (the latest commit):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git diff --staged</strong>
diff --git a/hello.pl b/hello.pl
index c6f28d5..d2cc6dc 100644
--- a/hello.pl
+++ b/hello.pl
@@ -1,2 +1,3 @@
+#!/usr/bin/perl
 # Hello World! in Perl
 print "Hello World!\n";</pre>
</div>
</div>
<div class="paragraph">
<p>To see which changes are <em>not</em> yet in the index, a simple call to <code>git diff</code> is enough to show us that&#8201;&#8212;&#8201;as expected&#8201;&#8212;&#8201;there are still two lines in the working tree:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git diff</strong>
diff --git a/hello.pl b/hello.pl
index d2cc6dc..908e967 100644
--- a/hello.pl
+++ b/hello.pl
@@ -1,3 +1,5 @@
 &num;!/usr/bin/perl
 &num; Hello World! in Perl
+&num; Author: Valentin Haenel
+use strict;
 print "Hello World!\n";</pre>
</div>
</div>
<div class="paragraph">
<p>At this point we could create a commit, but for demonstration purposes we want to start from scratch.
So we use <code>git reset HEAD</code> to reset the index.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git reset HEAD</strong>
Unstaged changes after reset:
M   hello.pl</pre>
</div>
</div>
<div class="paragraph">
<p>Git confirms and names the files that have changes in them; in this case, it&#8217;s just the one.</p>
</div>
<div class="paragraph">
<p>The <code>git reset</code> command is in a sense the counterpart of <code>git add</code>: Instead of transferring differences from the working tree to the index, <code>reset</code> transfers differences from the repository to the index.
Committing changes <em>to</em> the working tree is potentially destructive, as your changes may be lost.
Therefore, this is only possible with the <code>--hard</code> option, which we discuss in <a href="#sec.reset">Section 3.2.3, &#8220;Reset and the Index&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>If you frequently use <code>git add -p</code>, it is only a matter of time before you accidentally select a hunk you didn&#8217;t want.
If the index was empty, this is not a problem since you can reset it to start over.
It only becomes a problem if you have already recorded many changes in the index and don&#8217;t want to lose them, i.e. you remove a particular hunk from the index without wanting to touch the other hunks.</p>
</div>
<div class="paragraph">
<p>Analogous to <code>git add -p</code> there is the command <code>git reset -p</code>, which removes single hunks from the index.
To demonstrate this, let&#8217;s first apply all changes with <code>git add hello.pl</code> and then run <code>git reset -p</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git reset -p</strong>
diff --git a/hello.pl b/hello.pl
index c6f28d5..908e967 100644
--- a/hello.pl
+++ b/hello.pl
@@ -1,2 +1,5 @@
+&num;!/usr/bin/perl
 &num; Hello World! in Perl
+&num; Author: Valentin Haenel
+use strict;
 print "Hello World!\n";
Unstage this hunk [y,n,q,a,d,/,s,e,?]?</pre>
</div>
</div>
<div class="paragraph">
<p>As in the example with <code>git add -p</code>, Git offers hunks one by one, but this time all the hunks in the index.
Accordingly, the question is: <code>Unstage this hunk [y,n,q,a,d,/,s,e,?]?</code>, i.e. whether we want to remove the hunk from the index again.
As before, by entering the question mark we get an extended description of the available options.
At this point we press <code>s</code> once for <em>split</em>, <code>n</code> once for <em>no</em> and <code>y</code> once for <em>yes</em>.
Now only the shebang line should be in the index:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git diff --staged</strong>
diff --git a/hello.pl b/hello.pl
index c6f28d5..d2cc6dc 100644
--- a/hello.pl
+++ b/hello.pl
@@ -1,2 +1,3 @@
+#!/usr/bin/perl
 # Hello World! in Perl
 print "Hello World!\n";</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In the interactive modes of <code>git add</code> and <code>git reset</code>, you must press the <kbd>Enter</kbd> key after entering an option.
The following configuration setting will save you this extra keystroke.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global interactive.singlekey true</strong></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A word of warning: A <code>git add -p</code> may tempt you to check in versions of a file that are not executable or syntactically correct (e.g. because you forgot an essential line).
So don&#8217;t rely on your commit being correct just because <code>make</code>&#8201;&#8212;&#8201;which works on working tree files! -- runs successfully.
Even if a later commit fixes the problem, it will still be a problem, among other things, with automated debugging via bisect (see <a href="#sec.bisect">Section 4.8, &#8220;Find regressions - git bisect&#8221;</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.commit"><a class="anchor" href="#sec.commit"></a>2.1.3. Creating Commits</h4>
<div class="paragraph">
<p>You now know how to exchange changes between working tree, index, and repository.
Let&#8217;s turn to the <code>git commit</code> command, which you use to &#8220;commit&#8221; changes to the repository.</p>
</div>
<div class="paragraph">
<p>A commit keeps track of the state of all the files in your project at any given time, and also contains meta-information:&#8288;<sup class="footnote">[<a id="_footnoteref_17" class="footnote" href="#_footnotedef_17" title="View footnote.">17</a>]</sup></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Name of the authors and e-mail address</p>
</li>
<li>
<p>Name of the committer and e-mail address</p>
</li>
<li>
<p>Creation date</p>
</li>
<li>
<p>Commit date</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In fact, the name of the author <em>does not</em> have to be the name of the committer (who commits).
Often, commits are integrated or edited by maintainers (for example, by rebase, which also adjusts the committer information, see <a href="#sec.rebase">Section 4.1, &#8220;Move commits - Rebase&#8221;</a>).
The committer information is usually of secondary importance, though&#8201;&#8212;&#8201;most programs only show the author and the date the commit was made.</p>
</div>
<div class="paragraph">
<p>When you create a commit, Git uses the <code>user.name</code> and <code>user.email</code> settings configured in the previous section to identify the commit.</p>
</div>
<div class="paragraph">
<p>If you call <code>git commit</code> without any additional arguments, Git will combine all changes in the index into one commit, and open an editor to create a commit message.
However, the message will always contain instructions commented out with hash marks (<code>#</code>), or information about which files are changed by the commit.
If you call <code>git commit -v</code>, you will still get a diff of the changes you will check in, below the instructions.
This is especially useful for keeping track of the changes, and for using the auto-complete feature of your editor.</p>
</div>
<div class="paragraph">
<p>Once you exit the editor, Git creates the commit.
If you don&#8217;t specify a commit message or delete the entire contents of the file, Git will abort and not create a commit.</p>
</div>
<div class="paragraph">
<p>If you only want to write one line, you can use the <code>--message</code> option, or short <code>-m</code>, which allows you to specify the message directly on the command line, thus bypassing the editor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git commit -m "Dies ist die Commit-Nachricht"</strong></pre>
</div>
</div>
<div class="sect4">
<h5 id="sec.ci-amend"><a class="anchor" href="#sec.ci-amend"></a>2.1.3.1. Improving a Commit</h5>
<div class="paragraph">
<p>If you rashly entered <code>git commit</code>, but want to make the commit slightly better, the <code>--amend</code> (&#8220;correct&#8221;) option helps.
The option causes git to &#8220;add&#8221; the changes in the index to the commit you just made.&#8288;<sup class="footnote">[<a id="_footnoteref_18" class="footnote" href="#_footnotedef_18" title="View footnote.">18</a>]</sup>
You can also customize the commit message.
Note that the SHA-1 sum of the commit will change in any case.</p>
</div>
<div class="paragraph">
<p>The <code>git commit --amend</code> call only changes the current commit on a branch.
<a href="#sec.rebase-onto-ci-amend">Section 4.1.9, &#8220;Improving a commit&#8221;</a> describes how to improve past commits.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Calling <code>git commit --amend</code> automatically starts an editor, so you can edit the commit message as well.
Often, however, you will only want to make a small correction to a file without adjusting the message.
For authors, an alias <code>fixup</code> is useful in this situation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global alias.fixup "commit --amend --no-edit"</strong></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec.commit-msg"><a class="anchor" href="#sec.commit-msg"></a>2.1.3.2. Good Commit Messages</h5>
<div class="paragraph">
<p>What should a commit message look like?
Not much can be changed in the outer form: The commit message must be at least one line long, but preferably no longer than 50 characters.
This makes lists of commits easier to read.
If you want to add a more detailed description (which is highly recommended!), separate it from the first line with a blank line.
No line should be longer than 76 characters, as is usual for email.</p>
</div>
<div class="paragraph">
<p>Commit messages often follow the habits or specifics of a project.
There may be conventions, such as references to the bug tracking or issue system, or a link to the appropriate API documentation.</p>
</div>
<div class="paragraph">
<p>Note the following points when writing a commit description:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Never create empty commit messages.
Commit messages such as <code>Update</code>, <code>Fix</code>, <code>Improvement</code>, etc. are just as meaningful as an empty message&#8201;&#8212;&#8201;you might as well leave it at that.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Very important: Describe <em>why</em> something was changed and what the implications are.
<em>What</em> has been changed is always obvious from the diff!</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Be critical and note if you think there is room for improvement or the commit may introduce bugs elsewhere.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>The first line should not be longer than 50 characters, so the output of the version history always remains well formatted and readable.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>If the message becomes longer, a short summary (with the important keywords) should be in the first line.
After a blank line follows an extensive description.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We can&#8217;t stress enough how important a good commit description is.
When committing, a developer remembers the changes well, but after a few days, the motivation behind them is often forgotten.
Your colleagues or project members will thank you, too, because they can commit changes much faster.</p>
</div>
<div class="paragraph">
<p>Writing a good commit message also helps to briefly reflect on what has been done and what is still to come.
You may find that you&#8217;ve forgotten one important detail as you write it.</p>
</div>
<div class="paragraph">
<p>You can also argue about a timeline: The time it takes you to write a good commit message is a minute or two.
But how much less time will the bug-finding process take if each commit is well documented?
How much time will you save others (and yourself) if you provide a good description of a diff, which may be hard to understand?
Also, the blame tool, which annotates each line of a file with the commit that last changed it, will become an indispensable tool for detailed commit descriptions (see <a href="#sec.blame">Section 4.3, &#8220;Who made these changes? - git blame&#8221;</a>).</p>
</div>
<div class="paragraph">
<p>If you are not used to writing detailed commit messages, start today.
Practice makes perfect, and once you get used to it, the work will go quickly&#8201;&#8212;&#8201;you and others will benefit.</p>
</div>
<div class="paragraph">
<p>The Git repository is a prime example of good commit messaging.
Without knowing the details of Git, you&#8217;ll quickly know who changed what and why.
You can also see how many hands a commit goes through before it&#8217;s integrated.</p>
</div>
<div class="paragraph">
<p>Unfortunately, the commit messages in most projects are still very spartan, so don&#8217;t be disappointed if your peers are lazy about writing, but rather set a good example and provide detailed descriptions.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.git-mv-rm"><a class="anchor" href="#sec.git-mv-rm"></a>2.1.4. Moving and Deleting Files</h4>
<div class="paragraph">
<p>If you want to delete or move files managed by Git, use <code>git rm</code> or <code>git mv</code>.
They act like the regular Unix commands, but they also modify the index so that the action is included in the next commit.&#8288;<sup class="footnote">[<a id="_footnoteref_19" class="footnote" href="#_footnotedef_19" title="View footnote.">19</a>]</sup></p>
</div>
<div class="paragraph">
<p>Like the standard Unix commands, <code>git rm</code> also accepts the <code>-r</code> and <code>-f</code> options to recursively delete or force deletion.
<code>git mv</code> also offers an option <code>-f</code> (<em>force</em>) if the new filename already exists and should be overwritten.
Both commands accept the option <code>-n</code> or <code>--dry-run</code>, which simulates the process and does not modify files.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To delete a file from the index only, use <code>git rm --cached</code>.
It then remains in the working tree.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You will often forget to move a file via <code>git mv</code> or delete it via <code>git rm</code>, and use the standard Unix commands instead.
In this case, simply mark the file (already deleted by <code>rm</code>) as deleted in the index, too, using <code>git rm &lt;file&gt;</code>.</p>
</div>
<div class="paragraph">
<p>To rename the file, proceed as follows: First mark the old file name as deleted using <code>git rm &lt;old-name&gt;</code>.
Then add the new file: <code>git add &lt;new-name&gt;</code>.
Then check via <code>git status</code> whether the file is marked as &#8220;renamed&#8221;.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Internally, it doesn&#8217;t matter to Git whether you move a file regularly via <code>mv</code>, then run <code>git add &lt;new-name&gt;</code> and <code>git rm &lt;old-name&gt;</code>.
In any case, only the reference to a blob object is changed (see<a href="#sec.object-model">Section 2.2, &#8220;The Object Model&#8221;</a>).</p>
</div>
<div class="paragraph">
<p>However, Git comes with a so-called <em>Rename Detection</em>: If a blob is the same and is only referenced by a different file name, Git interprets this as a rename.
If you want to examine the history of a file and follow it if it is renamed, use the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log --follow -- &lt;file&gt;</strong></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec.grep"><a class="anchor" href="#sec.grep"></a>2.1.5. Using Grep on a Repository</h4>
<div class="paragraph">
<p>If you want to search for an expression in all files of your project, you can usually use <code>grep -R &lt;expression&gt; .</code>.</p>
</div>
<div class="paragraph">
<p>However, Git offers its own grep command, which you can call up using <code>git grep &lt;expression&gt;</code>.
This command usually searches for the expression in all files managed by Git.
If you want to examine only some of the files instead, you can specify the pattern explicitly.
With the following command you can find all occurrences of <code>border-color</code> in all CSS files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git grep border-color -- '*.css'</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The grep implementation of Git supports all common flags that are also present in GNU Grep.
However, calling <code>git grep</code> is usually an order of magnitude faster, since Git has significant performance advantages due to the object database and the multithreaded design of the command.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The popular <code>grep</code> alternative <code>ack</code> is characterized mainly by the fact that it combines the lines of a file matching the search pattern under a corresponding &#8220;heading&#8221;, and uses striking colors.
You can emulate the output of <code>ack</code> with <code>git grep</code> by using the following alias:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config alias.ack '!git -c color.grep.filename="green bold" \
  -c color.grep.match="black yellow" -c color.grep.linenumber="yellow bold" \
  grep -n --break --heading --color=always --untracked'</strong></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec.git-log"><a class="anchor" href="#sec.git-log"></a>2.1.6. Examining the Project History</h4>
<div class="paragraph">
<p>Use <code>git log</code> to examine the project&#8217;s version history.
The options of this command (most of which also work for <code>git show</code>) are very extensive, and we will introduce the most important ones below.</p>
</div>
<div class="paragraph">
<p>Without any arguments, <code>git log</code> will output the author, date, commit ID, and the full commit message for each commit.
This is handy when you need a quick overview of who did what and when.
However, the list is a bit cumbersome when you&#8217;re looking at a lot of commits.</p>
</div>
<div class="paragraph">
<p>If you only want to look at recently created commits, limit <code>git log</code>&#8217;s output to <em>n</em> commits with the <code>-&lt;n&gt;</code> option.
For example, the last four commits are shown with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log -4</strong></pre>
</div>
</div>
<div class="paragraph">
<p>To display a single commit, enter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log -1 &lt;commit&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>&lt;commit&gt;</code> argument is a legal name for a single commit, such as the commit ID or SHA-1 sum.
However, if you do not specify anything, Git automatically uses <code>HEAD</code>.
Apart from single commits, the command also understands so-called <em>commit ranges</em> (series of commits), see <a href="#sec.commit-ranges-intro">Section 2.1.7, &#8220;Commit-Ranges&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>The <code>-p</code> (<code>--patch</code>) option appends the full patch in Unified-Diff format below the description.
Thus, a <code>git show &lt;commit&gt;</code> from the output is equivalent to <code>git log -1 -p &lt;commit&gt;</code>.</p>
</div>
<div class="paragraph">
<p>If you want to display the commits in compressed form, we recommend the <code>--oneline</code> option: It summarizes each commit with its abbreviated SHA-1 sum and the first line of the commit message.
It is therefore important that you include as much useful information as possible in this line!
For example, this would look like this:&#8288;<sup class="footnote">[<a id="_footnoteref_20" class="footnote" href="#_footnotedef_20" title="View footnote.">20</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log --oneline</strong>
<strong>25f3af3</strong> Correctly report corrupted objects
<strong>786dabe</strong> tests: compress the setup tests
<strong>91c031d</strong> tests: cosmetic improvements to the repo-setup test
<strong>b312b41</strong> exec_cmd: remove unused extern</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--oneline</code> option is only an alias for <code>--pretty=oneline</code>.
There are other ways to customize the output of <code>git log</code>.
The possible values for the <code>--pretty</code> option are:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>oneline</code> 
</td>
<td class="hdlist2">
<p>Commit-ID and first line of the description.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>short</code> 
</td>
<td class="hdlist2">
<p>Commit ID, first line of the description and author of the commit; output is four lines.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>medium</code> 
</td>
<td class="hdlist2">
<p>Default; output of commit ID, author, date and complete description.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>full</code> 
</td>
<td class="hdlist2">
<p>Commit ID, author&#8217;s name, name of the committer and full description&#8201;&#8212;&#8201;<em>no</em> date.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>fuller</code> 
</td>
<td class="hdlist2">
<p>Like <code>medium</code>, but additionally date and name of the committer.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>email</code> 
</td>
<td class="hdlist2">
<p>Formats the information from <code>medium</code> so that it looks like an e-mail.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>format:&#8288;&lt;string&gt;</code> 
</td>
<td class="hdlist2">
<p>Any format can be adapted by placeholders; for details see the man page <code>git-log(1)</code>, section &#8220;Pretty Formats&#8221;.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Independently of this, you can display more information about the changes made by the commit below the commit message.
Consider the following examples, which clearly show which files were changed in how many places:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log -1 --oneline 4868b2ea</strong>
4868b2e setup: officially support --work-tree without --git-dir

$ git log -1 --oneline <strong>--name-status</strong> 4868b2ea
4868b2e setup: officially support --work-tree without --git-dir
M       setup.c
M       t/t1510-repo-setup.sh

$ git log -1 --oneline <strong>--stat</strong> 4868b2ea
4868b2e setup: officially support --work-tree without --git-dir
 setup.c               |   19
 t/t1510-repo-setup.sh |  210 +++++++++++++++++------------------
 2 files changed, 134 insertions(), 95 deletions(-)

$ git log -1 --oneline <strong>--shortstat</strong> 4868b2ea
4868b2e setup: officially support --work-tree without --git-dir
 2 files changed, 134 insertions(+), 95 deletions(-)</pre>
</div>
</div>
<div class="sect4">
<h5 id="sec.git-log-dates"><a class="anchor" href="#sec.git-log-dates"></a>2.1.6.1. Time Constraints</h5>
<div class="paragraph">
<p>You can restrict the time of the commits to be displayed using the <code>--after</code> or <code>--since</code> and <code>--until</code> or <code>--before</code> options.
The options are all synonymous, so they give the same results.</p>
</div>
<div class="paragraph">
<p>You can specify absolute dates in any common format, or relative dates, here are some examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log --after='Tue Feb 1st, 2011'</strong>
$ <strong>git log --since='2011-01-01'</strong>
$ <strong>git log --since='two weeks ago' --before='one week ago'</strong>
$ <strong>git log --since='yesterday'</strong></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec.git-log-files"><a class="anchor" href="#sec.git-log-files"></a>2.1.6.2. File-Level Restrictions</h5>
<div class="paragraph">
<p>If you specify one or more file or directory names after a <code>git log</code> call, Git will only display the commits that affect at least one of the specified files.
Provided a project is well structured, the output of commits can be severely limited and a particular change can be found quickly.</p>
</div>
<div class="paragraph">
<p>Since filenames may collide with branches or tags, you should be sure to specify the filenames after a <code>--</code> which means that only file arguments follow.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log -- main.c</strong>
$ <strong>git log -- *.h</strong>
$ <strong>git log -- Documentation/</strong></pre>
</div>
</div>
<div class="paragraph">
<p>These calls only output the commits in which changes were made to the <code>main.c</code> file, an <code>.h</code> file, or a file under <code>Documentation/</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.git-log-grep"><a class="anchor" href="#sec.git-log-grep"></a>2.1.6.3. Grep for Commits</h5>
<div class="paragraph">
<p>You can also search for commits in the style of <code>grep</code>, where the <code>--author</code>, <code>--committer</code>, and <code>--grep</code> options are available.</p>
</div>
<div class="paragraph">
<p>The first two options filter commits by author or committer name or address, as expected.
For example, list all commits that Linus Torvalds has made since early 2010:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log --since='2010-01-01' --author='Linus Torvalds'</strong></pre>
</div>
</div>
<div class="paragraph">
<p>You can also enter only part of the name or e-mail address here, so searching for 'Linus' would produce the same result.</p>
</div>
<div class="paragraph">
<p>For example, you can use <code>--grep</code> to search for keywords or phrases in the commit message, such as all commits that contain the word &#8220;fix&#8221; (not case-sensitive):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log -i --grep=fix</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>-i</code> (or <code>--regexp-ignore-case</code>) option causes <code>git log</code> to ignore the pattern case (also works with <code>--author</code> and <code>--committer</code>).</p>
</div>
<div class="paragraph">
<p>All three options treat the values as regular expressions, just like <code>grep</code> (see the <code>regex(7)</code> man page).
The <code>-E</code> and <code>-F</code> options change the behaviour of the options in the same way as <code>egrep</code> and <code>fgrep</code>: to use extended regular expressions or to search for the literal search term (whose special characters lose their meaning).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To search for <em>changes</em>, use the so-called <em>Pickaxe</em> tool.
This will help you find commits whose diffs contain a certain regular expression (&#8220;<code>grep</code> for diffs&#8221;):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log -p -G&lt;regex&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>&lt;regex&gt;</code> must be specified directly, i.e. without spaces, after the <code>-G</code> pickaxe option.
The <code>--pickaxe-all</code> option causes all changes to the commit to be listed, not just those containing the change you are looking for.</p>
</div>
<div class="paragraph">
<p>Note that in earlier versions of Git, this operation was performed by the <code>-S</code> option, but it differs from <code>-G</code> in that it only finds the commits that change the number of times the pattern occurs&#8201;&#8212;&#8201;especially code shifts, i.e., removals and additions elsewhere in a file, are not found.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Equipped with these tools, you can now tame masses of commits yourself.
Just specify as many criteria as you need to reduce the number of commits.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.commit-ranges-intro"><a class="anchor" href="#sec.commit-ranges-intro"></a>2.1.7. Commit-Ranges</h4>
<div class="paragraph">
<p>So far, we&#8217;ve only looked at commands that require only a single commit as an argument, explicitly identified by its commit ID, or implicitly by the symbolic name <code>HEAD</code>, which references the most recent commit.</p>
</div>
<div class="paragraph">
<p>Das Kommando <code>git show</code> zeigt Informationen zu einem Commit an, das Kommando <code>git log</code> beginnt bei einem Commit, und geht dann so weit in der Versionsgeschichte zurück, bis der Anfang des Repositorys (der sogenannte <em>Root-Commit</em>) erreicht ist.</p>
</div>
<div class="paragraph">
<p>The <code>git show</code> command displays information about a commit, while the <code>git log</code> command starts at a commit, and then goes back in the version history until the beginning of the repository (called the <code>root commit</code>) is reached.</p>
</div>
<div class="paragraph">
<p>An important tool for specifying a series of commits is the so-called commit ranges in the form <code>&lt;commit1&gt;..&lt;commit2&gt;</code>.
Since we have not yet worked with multiple branches, this is simply a range of commits in a repository, from <code>&lt;commit1&gt;</code> exclusive to <code>&lt;commit2&gt;</code> inclusive.
If you omit one of the two boundaries, Git will take the value <code>HEAD</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.git-diff"><a class="anchor" href="#sec.git-diff"></a>2.1.8. Differences between Commits</h4>
<div class="paragraph">
<p>The command <code>git show</code> or <code>git log -p</code> has been used to show only the difference from the previous commit.
If you want to see the differences between several commits, the command <code>git diff</code>.</p>
</div>
<div class="paragraph">
<p>The diff command performs several tasks.
As already seen, you can examine the differences between the working tree and the index without specifying any commits, or the differences between index and <code>HEAD</code> with the <code>--staged</code> option.</p>
</div>
<div class="paragraph">
<p>However, if you pass two commits or a commit range to the command, the difference between these commits is displayed instead.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.object-model"><a class="anchor" href="#sec.object-model"></a>2.2. The Object Model</h3>
<div class="paragraph">
<p>Git is based on a simple but extremely powerful object model.
It is used to map the typical elements of a repository (files, directories, commits) and the development over time.
Understanding this model is very important, and it helps to abstract from typical Git steps to better understand them.</p>
</div>
<div class="paragraph">
<p>In the following, we will again use a &#8220;Hello World!&#8221; program as an example, this time in the Python programming language.&#8288;<sup class="footnote">[<a id="_footnoteref_21" class="footnote" href="#_footnotedef_21" title="View footnote.">21</a>]</sup></p>
</div>
<div id="fig.object-model-program" class="imageblock">
<div class="content">
<img src="images/objektmodell-programm-crop.png" alt="objektmodell programm crop" width="25%">
</div>
<div class="title">Figure 2. &#8220;Hello World!&#8221; Program in Python</div>
</div>
<div class="paragraph">
<p>The project consists of the file <code>hello.py</code> as well as a <code>README</code> file and a directory <code>test</code>.
If you run the program with the command <code>python hello.py</code>, you will get the output: <code>Hello World!</code>.
In the directory <code>test</code> is a simple shell script, <code>test.sh</code>, which displays an error message if the Python program does not output the string <code>Hello World!</code> as expected.</p>
</div>
<div class="paragraph">
<p>The repository for this project consists of the following four commits:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log --oneline</strong>
e2c67eb Kommentar fehlte
8e2f5f9 Test Datei
308aea1 README Datei
b0400b0 Erste Version</pre>
</div>
</div>
<div class="sect3">
<h4 id="sec.sha1"><a class="anchor" href="#sec.sha1"></a>2.2.1. SHA-1&#8201;&#8212;&#8201;The Secure Hash Algorithm</h4>
<div class="paragraph">
<p>SHA-1 is a secure hash algorithm that calculates a checksum of digital information: the SHA-1 sum.
The algorithm was introduced in 1995 by the American <em>National Institute of Standards and Technology</em> (NIST) and the <em>National Security Agency</em> (NSA).
SHA-1 was developed for cryptographic purposes and is used for checking the integrity of messages and as a basis for digital signatures.
<a href="#fig.sha-1">Figure 3, &#8220;SHA-1 Algorithm&#8221;</a> shows how it works, where we calculate the checksum of <code>hello.py</code>.</p>
</div>
<div class="paragraph">
<p>The algorithm is a mathematical one-way function that maps a bit sequence of maximum length 2<sup>64</sup>-1 bits (about 2 exbibytes) to a checksum of length 160 bits (20 bytes).
The checksum is usually represented as a hexadecimal character string of length 40.
The algorithm results in 2<sup>160</sup> (approx. 1.5 · 10<sup>49</sup>) different combinations for this length of checksum, and therefore it is very, very unlikely that two bit sequences have the same checksum.
This property is called <em>collision safety</em>.</p>
</div>
<div id="fig.sha-1" class="imageblock">
<div class="content">
<img src="images/sha.svg" alt="sha" width="90%">
</div>
<div class="title">Figure 3. SHA-1 Algorithm</div>
</div>
<div class="paragraph">
<p>Despite all efforts of cryptologists, several years ago various theoretical attacks on SHA-1 became known, which are supposed to make the generation of collisions possible with a considerable computing effort.&#8288;<sup class="footnote">[<a id="_footnoteref_22" class="footnote" href="#_footnotedef_22" title="View footnote.">22</a>]</sup>
For this reason, NIST today recommends the use of the successors of SHA-1: SHA-256, SHA-384 and SHA-512, which have longer checksums and thus make the generation of collisions more difficult.
On the Git mailing list there was a debate about switching to one of these alternatives, but this step was not considered necessary.&#8288;<sup class="footnote">[<a id="_footnoteref_23" class="footnote" href="#_footnotedef_23" title="View footnote.">23</a>]</sup></p>
</div>
<div class="paragraph">
<p>This is because, although there is a theoretical attack vector on the SHA-1 algorithm, this does not compromise the security of Git.
In fact, the integrity of a repository is not primarily protected by the collision resistance of an algorithm, but by the fact that many developers have identical copies of the repository.</p>
</div>
<div class="paragraph">
<p>The SHA-1 algorithm plays a central role in Git because it is used to build checksums of the data stored in the Git repository, the <em>Git objects</em>.
This makes them easy to reference as SHA-1 sums of their contents.
In your daily work with Git, you will usually only use SHA-1 sums of commits, known as commit IDs.
This reference can be passed to many Git commands, such as <code>git show</code> and <code>git diff</code>.
Depending on the repository, you often only need to specify the first few characters of an SHA-1 sum, since in practice a prefix is sufficient to uniquely identify a commit.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.objects"><a class="anchor" href="#sec.objects"></a>2.2.2. The Git Objects</h4>
<div class="paragraph">
<p>All data stored in a Git repository is available as <em>Git objects</em>.
There are four types:&#8288;<sup class="footnote">[<a id="_footnoteref_24" class="footnote" href="#_footnotedef_24" title="View footnote.">24</a>]</sup></p>
</div>
<table id="tab.cgit-options" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Git Objects</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 28.5714%;">
<col style="width: 28.5715%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Object</th>
<th class="tableblock halign-left valign-top">Saves&#8230;&#8203;</th>
<th class="tableblock halign-left valign-top">References other objects</th>
<th class="tableblock halign-left valign-top">Correspondence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Blob</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File content</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tree</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Blobs and Trees</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Commit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Project state</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes, a tree and further commits</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Snapshot/Archive at a time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tag information</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes, an object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Naming important snapshots or blobs</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#fig.git-objects">Figure 4, &#8220;Git Objects&#8221;</a> shows three objects from the example project&#8201;&#8212;&#8201;a blob, a tree, and a commit.&#8288;<sup class="footnote">[<a id="_footnoteref_25" class="footnote" href="#_footnotedef_25" title="View footnote.">25</a>]</sup>
The representation of each object includes the object type, the size in bytes, the SHA-1 sum, and the contents.
The blob contains the content of the file <code>hello.py</code> (but not the file name).
The tree contains references to one blob for each file in the project, i.e. one for <code>hello.py</code> and one for <code>README</code>, plus one tree per subdirectory, i.e. in this case only one for <code>test</code>.
The files in the subdirectories are referenced separately in the respective trees that map these subdirectories.</p>
</div>
<div id="fig.git-objects" class="imageblock text-center">
<div class="content">
<img src="images/git-objects.svg" alt="git objects" width="90%">
</div>
<div class="title">Figure 4. Git Objects</div>
</div>
<div class="paragraph">
<p>So the commit object contains exactly <em>one</em> reference to a tree, and that reference is to the tree of the project content&#8201;&#8212;&#8201;this is a snapshot of the state of the project.
The commit object also contains a reference to its direct ancestors, along with the metadata &#8220;author&#8221; and &#8220;committer&#8221; and the commit message.</p>
</div>
<div class="paragraph">
<p>Many Git commands expect a tree as an argument.
However, because a commit, for example, references a tree, this is called a <em>tree-ish</em> argument.
This refers to any object that can last be resolved to a tree.
This category also includes tags (see <a href="#sec.tags">Section 3.1.3, &#8220;Tags&#8201;&#8212;&#8201;Marking Important Versions&#8221;</a>).
Similarly, <em>commit-ish</em> is an argument that can be resolved to a commit.</p>
</div>
<div class="paragraph">
<p>File contents are always stored in blobs.
Trees only contain references to blobs and other trees in the form of the SHA-1 sums of these objects.
A commit in turn references <em>a</em> tree.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.od"><a class="anchor" href="#sec.od"></a>2.2.3. The Object Database</h4>
<div class="paragraph">
<p>All Git objects are stored in the <em>object database</em> and are identifiable by their unique SHA-1 sum, i.e. you can find an object in the database by its SHA-1 sum once it has been stored.
Thus, the object database basically functions like a large <em>hash table</em>, where the SHA-1 sums serve as keys for the stored contents:&#8288;<sup class="footnote">[<a id="_footnoteref_26" class="footnote" href="#_footnotedef_26" title="View footnote.">26</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>e2c67eb &xrarr; <strong>commit</strong>
8e2f5f9 &xrarr; <strong>commit</strong>
308aea1 &xrarr; <strong>commit</strong>
b0400b0 &xrarr; <strong>commit</strong>
a26b00a &xrarr; <strong>tree</strong>
6cf9be8 &xrarr; <strong>blob</strong>  (README)
52ea6d6 &xrarr; <strong>blob</strong>  (hello.py)
c37fd6f &xrarr; <strong>tree</strong>  (test)
e92bf15 &xrarr; <strong>blob</strong>  (test/test.sh)
5b4b58b &xrarr; <strong>tree</strong>
dcc027b &xrarr; <strong>blob</strong>  (hello.py)
e4dc644 &xrarr; <strong>tree</strong>
a347f5e &xrarr; <strong>tree</strong></pre>
</div>
</div>
<div class="paragraph">
<p>You will first see the four commits that make up the Git repository, including the <code>e2c67eb</code> commit shown in <a href="#fig.git-objects">Figure 4, &#8220;Git Objects&#8221;</a>.
This is followed by trees and blobs, each with file or directory correspondence.
So-called <em>top-level trees</em> have no directory name: They refer to the top level of a project.
A commit always references a top-level tree, so there are four of them.</p>
</div>
<div class="paragraph">
<p>The hierarchical relationship of the objects listed above is shown in <a href="#fig.git-objects-hierarchy">Figure 5, &#8220;Hierarchical Relationship of Git Objects&#8221;</a>.
On the left-hand side, you can see the four commits that are already in the repository, and on the right-hand side, the referenced contents of the most recent commit (C4).
As described above, each commit contains a reference to its direct predecessor (the resulting graph of commits is discussed below).
This relationship is illustrated by the arrows pointing from one commit to the next.</p>
</div>
<div id="fig.git-objects-hierarchy" class="imageblock">
<div class="content">
<img src="images/git-objects-hierarchy.svg" alt="git objects hierarchy" width="65%">
</div>
<div class="title">Figure 5. Hierarchical Relationship of Git Objects</div>
</div>
<div class="paragraph">
<p>Each commit references the top-level tree&#8201;&#8212;&#8201;including the C4 commit in the example.
The top-level tree in turn references the files <code>hello.py</code> and <code>README</code> in the form of blobs, and the subdirectory <code>test</code> in the form of another tree.
Because of this hierarchical structure and the relationship of the individual objects to one another, Git is able to map the contents of a hierarchical file system as Git objects and store them in the object database.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.explore-od"><a class="anchor" href="#sec.explore-od"></a>2.2.4. Examining the Object Database</h4>
<div class="paragraph">
<p>In a short digression we will go into how to examine the object database of Git.
To do this, Git provides so-called <em>plumbing</em> commands, a group of low-level tools for Git, as opposed to the <em>porcelain</em> commands you usually work with.
These commands are therefore not important for Git beginners, but are simply intended to give you a different approach to the concept of the object database.
For more information, see <a href="#sec.scripting">Section 8.3, &#8220;Writing your own Git commands&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s first look at the current commit.
We&#8217;ll use the <code>git show</code> command with the <code>--format=raw</code> option, so let&#8217;s output the commit in raw format, so that everything this commit contains is displayed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show --format=raw e2c67eb</strong>
<strong>commit</strong> e2c67ebb6d2db2aab831f477306baa44036af635
<strong>tree</strong> a26b00aaef1492c697fd2f5a0593663ce07006bf
<strong>parent</strong> 8e2f5f996373b900bd4e54c3aefc08ae44d0aac2
<strong>author</strong> Valentin Haenel &lt;valentin.haenel@gmx.de&gt; 1294515058 +0100
<strong>committer</strong> Valentin Haenel &lt;valentin.haenel@gmx.de&gt; 1294516312 +0100

    Kommentar fehlte
...</pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, all the information in <a href="#fig.git-objects">Figure 4, &#8220;Git Objects&#8221;</a> is output: the SHA-1 sums of the commit, tree, and direct ancestor, plus the author and committer (including the date as a Unix timestamp), and the commit description.
The command also provides the diff output for the previous commit&#8201;&#8212;&#8201;but this is not part of the commit, strictly speaking, and is therefore omitted here.</p>
</div>
<div class="paragraph">
<p>Next, let&#8217;s take a look at the tree referenced by this commit, using <code>git ls-tree</code>, a plumbing command to list the contents stored in a tree.
It&#8217;s similar to <code>ls -l</code>, except that it is in the object database.
With <code>--abbrev=7</code> we shorten the output SHA-1 sums to seven characters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git ls-tree --abbrev=7 a26b00a</strong>
100644 <strong>blob</strong> 6cf9be8  <strong>README</strong>
100644 <strong>blob</strong> 52ea6d6  <strong>hello.py</strong>
040000 <strong>tree</strong> c37fd6f  <strong>test</strong></pre>
</div>
</div>
<div class="paragraph">
<p>As in <a href="#fig.git-objects">Figure 4, &#8220;Git Objects&#8221;</a> the tree referenced by the commit contains one blob for each of the two files, and one tree (also: <em>subtree</em>) for the <code>test</code> directory.
We can look at its contents again with <code>ls-tree</code>, since we now know the SHA-1 sum of the tree.
As expected, you can see that the <code>test</code> tree references exactly one blob, the blob for the file <code>test.sh</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git ls-tree --abbrev=7 c37fd6f</strong>
100755 <strong>blob</strong> e92bf15  <strong>test.sh</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, we make sure that the blob for <code>hello.py</code> really contains our &#8220;Hello World!&#8221; program and that the SHA-1 sum is correct.
The command <code>git show</code> shows any objects.
If we pass the SHA-1 sum of a blob, its contents are output.
To check the SHA-1 sum we use the plumbing command <code>git hash-object</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show 52ea6d6</strong>
#! /usr/bin/env python

""" Hello World! """

print 'Hello World!'
$ <strong>git hash-object hello.py</strong>
52ea6d6f53b2990f5d6167553f43c98dc8788e81</pre>
</div>
</div>
<div class="paragraph">
<p>A note for curious readers: <code>git hash-object hello.py</code> does not produce the same output as the Unix command <code>sha1sum hello.py</code>.
This is because not only the file content is stored in a blob.
Instead, the object type, in this case <code>blob</code>, and the size, in this case 67 bytes, are stored in a <em>header</em> at the beginning of the blob.
The <code>hash-object</code> command therefore does not calculate the checksum of the file content, but of the blob object.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.deduplication"><a class="anchor" href="#sec.deduplication"></a>2.2.5. Deduplication</h4>
<div class="paragraph">
<p>The four commits that make up the sample repository are shown again in <a href="#fig.repository-content">Figure 6, &#8220;Repository Content&#8221;</a>, but in a different way: The dashed bordered tree and blob objects indicate unchanged objects, all others were added or changed in the corresponding commit.
The reading direction here is from bottom to top: at the bottom is C1, which contains only the file <code>hello.py</code>.</p>
</div>
<div class="paragraph">
<p>Since trees only contain references to blobs and other trees, each commit stores the status of all files, but not their contents.
Normally, only a few files change during a commit.
New blob objects (and therefore new tree objects) are now created for the new files or those to which changes have been made.
However, the references to the unchanged files remain the same.</p>
</div>
<div id="fig.repository-content" class="imageblock">
<div class="content">
<img src="images/repository-content.svg" alt="repository content" width="80%">
</div>
<div class="title">Figure 6. Repository Content</div>
</div>
<div class="paragraph">
<p>Even more: A file that exists twice only exists once in the object database.
The contents of this file are stored as a blob in the object database and are <em>referenced</em> by a tree in two places.
This effect is known as <em>deduplication</em>: Duplicates are not only prevented, but not made possible in the first place.
Deduplication is an essential feature of <em>Content-Addressable File Systems</em>, i.e. file systems that know files only by their contents (such as Git, for example, by giving an object the SHA-1 sum of itself as &#8220;name&#8221;).</p>
</div>
<div class="paragraph">
<p>Consequently, a repository in which the same 1&#160;MB file exists 1000 times takes up only slightly more than 1&#160;MB.
Git essentially has to manage the blob, plus a commit and a tree with 1000 blob entries (20 bytes each plus the length of the filename).
A <em>checkout</em> of this repository, on the other hand, consumes about 1&#160;GB of space on the filesystem because Git resolves deduplication.&#8288;<sup class="footnote">[<a id="_footnoteref_27" class="footnote" href="#_footnotedef_27" title="View footnote.">27</a>]</sup></p>
</div>
<div class="paragraph">
<p>The <code>git checkout</code> and <code>git reset</code> commands restore a previous state (see also <a href="#sec.undo">Section 3.2, &#8220;Restoring Versions&#8221;</a>): You specify the reference of the corresponding commit, and Git searches for it in the object database.
The reference is then used to find the tree object of this commit from the object database.
Finally, Git uses the references contained in the tree object to find all other tree and blob objects in the object database and replicates them as directories and files on the file system.
This allows you to restore exactly the project state that was saved with the commit at the time.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.git-graph"><a class="anchor" href="#sec.git-graph"></a>2.2.6. The Graph Structure</h4>
<div class="paragraph">
<p>Because each commit stores its direct ancestors, a graph structure is created.
More precisely, the arrangement of the commits creates a <em>Directed Acyclic Graph</em> (DAG).
A graph consists of two core elements: the <em>nodes</em> and the <em>edges</em> connecting these nodes.
In a <em>directed</em> graph, the edges are also characterized by a direction, which means that when you run the graph, you can only use the edges that point in the appropriate direction to move from one node to the next.
The <em>acyclic</em> property rules out that you can find your way back to a node by any route through the graph.
So you cannot move in a circle.&#8288;<sup class="footnote">[<a id="_footnoteref_28" class="footnote" href="#_footnotedef_28" title="View footnote.">28</a>]</sup></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Most Git commands are used to manipulate the graph: to add/remove nodes or to change the relation of the nodes to each other.
You&#8217;ll know you&#8217;ve reached an advanced level of Git competency when you&#8217;ve internalized this rather abstract concept, and when you&#8217;re working with branches on a daily basis, you always think of the graph behind them.
Understanding Git at this level is the first and only real hurdle to mastering Git safely in everyday life.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The graph structure is derived from the object model, because each commit knows its direct ancestor (possibly several in the case of a merge commit).
The commits form the nodes of this graph&#8201;&#8212;&#8201;the references to ancestors form the edges.</p>
</div>
<div class="paragraph">
<p>An example graph is shown in <a href="#fig.commit-graph">Figure 7, &#8220;A Commit Graph&#8221;</a>.
It consists of several commits, which are colored to make it easier to distinguish between their affiliations to different development branches.
First, the commits A, B, C, and D were made.
They form the main development branch.
Commits E and F contain feature development, which was transferred to the main development branch with commit H.
Commit G is a single commit that has not yet been integrated into the main development branch.</p>
</div>
<div id="fig.commit-graph" class="imageblock text-center">
<div class="content">
<img src="images/commit-graph.svg" alt="commit graph" width="70%">
</div>
<div class="title">Figure 7. A Commit Graph</div>
</div>
<div class="paragraph">
<p>One result of the graph structure is the cryptographically secured <em>integrity</em> of a repository.
Git uses the SHA-1 sum of a commit to reference not only the contents of the project files at a given point in time, but also <em>all</em> commits executed up to that point, and their relationship to each other, i.e. the complete version history.</p>
</div>
<div class="paragraph">
<p>The object model makes this possible: each commit stores a reference to its ancestors.
These references are then used to calculate the SHA-1 sum of the commit itself.
So you get a different commit if you reference another ancestor.</p>
</div>
<div class="paragraph">
<p>Since the predecessor in turn references predecessors, and its SHA-1 sum depends on the predecessors, and so on, this means that the <em>complete</em> version history is implicitly encoded in the commit ID.
Implicit here means: If even one bit of a commit changes anywhere in the version history, then the SHA-1 sum of subsequent commits, especially the topmost one, is no longer the same.
The SHA-1 sum doesn&#8217;t say anything detailed about the version history, though; it&#8217;s just a checksum of it.</p>
</div>
<div class="sect4">
<h5 id="sec.graph-references"><a class="anchor" href="#sec.graph-references"></a>2.2.6.1. References: Branches and Tags</h5>
<div class="paragraph">
<p>However, there is not much you can do with a pure commit graph.
To reference (i.e., work with) a node, you need to know its name, which is the SHA-1 sum of the commit.
In everyday use, however, you rarely use the SHA-1 sum of a commit directly, but instead use symbolic names, called <em>references</em>, which Git can resolve to the SHA-1 sum.</p>
</div>
<div class="paragraph">
<p>Git basically offers two types of references, <em>branches</em> and <em>tags</em>.
These are <em>pointers</em> to a commit graph, which are used to mark specific nodes.
Branches have a &#8220;moving&#8221; character, meaning that they move up as new commits are added to the branch.
Tags, on the other hand, are static in nature, and mark important points in the commit graph, such as releases.</p>
</div>
<div class="paragraph">
<p><a href="#fig.commit-graph-with-refs">Figure 8, &#8220;Example of a Commit Graph with Branches and Tags&#8221;</a> shows the same commit graph with the <code>master</code>, <code>HEAD</code>, <code>feature</code>, and <code>bugfix</code> branches.
And the <code>v0.1</code> and <code>v0.2</code> tags.</p>
</div>
<div id="fig.commit-graph-with-refs" class="imageblock text-center">
<div class="content">
<img src="images/commit-graph-with-refs.svg" alt="commit graph with refs" width="70%">
</div>
<div class="title">Figure 8. Example of a Commit Graph with Branches and Tags</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch.praxis"><a class="anchor" href="#ch.praxis"></a>3. Practical Version Control</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following chapter introduces all the essential techniques you&#8217;ll use in your daily work with Git.
In addition to a more detailed description of the index and how to restore old versions, the focus is on working effectively with branches.</p>
</div>
<div class="sect2">
<h3 id="sec.branches"><a class="anchor" href="#sec.branches"></a>3.1. References: Branches and Tags</h3>
<div class="paragraph">
<p>In the CVS/SVN environment, &#8220;Branch&#8221; and &#8220;Merge&#8221; are often a book with seven seals for newcomers, but for experts they are a regular cause for hair-raising.
In Git, <em>branching</em> and <em>merging</em> are commonplace, simple, transparent, and fast.
It&#8217;s common for a developer to create multiple branches and perform multiple merges in one day.</p>
</div>
<div class="paragraph">
<p>The tool Gitk is helpful in order not to lose the overview of several branches.
With <code>gitk --all</code> you show all branches.
The tool visualizes the commit graph explained in the previous section.
Each commit represents one line.
Branches are displayed as green labels, tags as yellow pointers.
For more information, see <a href="#sec.gitk">Section 3.6.2, &#8220;Gitk&#8221;</a>.</p>
</div>
<div id="fig.gitk-basic" class="imageblock">
<div class="content">
<img src="images/gitk-basic.png" alt="gitk basic" width="90%">
</div>
<div class="title">Figure 9. The sample repository from <a href="#ch.basics">Chapter 2, <em>The Basics</em></a>. For illustration purposes, the second commit has been tagged <code>v0.1</code>.</div>
</div>
<div class="paragraph">
<p>Because branches in Git are &#8220;cheap&#8221; and merges are easy, you can afford to use branches excessively.
Want to try something, prepare a small bug fix, or start with an experimental feature?
You can create a new branch for each of these.
You want to test if one branch is compatible with the other?
Merge them together, test everything, then delete the merge again and continue developing.
This is common practice among developers using Git.</p>
</div>
<div class="paragraph">
<p>First, let&#8217;s look at references in general.
References are nothing more than symbolic names for the hard to remember SHA-1 sums of commits.</p>
</div>
<div class="paragraph">
<p>These references are stored in <code>.git/refs/</code>.
The name of a reference is determined by the file name, and the target is determined by the contents of the file.
For example, the master branch you have been working on all along looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cat .git/refs/heads/master</strong>
89062b72afccda5b9e8ed77bf82c38577e603251</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If Git needs to manage a lot of references, they may not be stored as files under <code>.git/refs/</code>.
Instead, Git creates a container that contains packed references (<em>Packed Refs</em>): One line per reference with name and SHA-1 sum.
This makes sequential resolution of many references faster.
Git commands search for branches and tags in the <code>.git/packed-refs</code> file if the corresponding <code>.git/refs/&lt;name&gt;</code> file does not exist.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Under <code>.git/refs/</code> there are several directories that represent the &#8220;type&#8221; of reference.
There is no fundamental difference between these references, only when and how they are used.
The references you will use most often are branches.
They are stored under <code>.git/refs/heads/</code>.
<em>Heads</em> refers to what is sometimes called a &#8220;tip&#8221; in other systems: The latest commit on a development branch.&#8288;<sup class="footnote">[<a id="_footnoteref_29" class="footnote" href="#_footnotedef_29" title="View footnote.">29</a>]</sup>
Branches move up when you make commits on a branch, so they remain at the top of the version history.</p>
</div>
<div id="fig.commit" class="imageblock text-center">
<div class="content">
<img src="images/commit.svg" alt="commit" width="60%">
</div>
<div class="title">Figure 10. A branch always references the most recent commit</div>
</div>
<div class="paragraph">
<p>Branches in other developers' repositories (e.g. the master branch of the official repository), so-called remote tracking branches, are stored under <code>.git/refs/remotes/</code> (see <a href="#sec.remote-tracking-branches">Section 5.2.2, &#8220;Remote-Tracking-Branches&#8221;</a>).
Tags, static references, which are mostly used for versioning, are stored under <code>.git/refs/tags/</code> (see <a href="#sec.tags">Section 3.1.3, &#8220;Tags&#8201;&#8212;&#8201;Marking Important Versions&#8221;</a>).</p>
</div>
<div class="sect3">
<h4 id="sec.branch-refs"><a class="anchor" href="#sec.branch-refs"></a>3.1.1. HEAD and Other Symbolic References</h4>
<div class="paragraph">
<p>Eine Referenz, die Sie selten explizit, aber ständig implizit benutzen, ist <code>HEAD</code>.
Sie referenziert meist den gerade ausgecheckten Branch, hier <code>master</code>:</p>
</div>
<div class="paragraph">
<p>One reference that you rarely use explicitly, but always implicitly, is <code>HEAD</code>.
It usually refers to the branch you just checked out, in this case <code>master</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cat .git/HEAD</strong>
ref: refs/heads/master</pre>
</div>
</div>
<div class="paragraph">
<p><code>HEAD</code> can also point directly to a commit if you type <code>git checkout &lt;commit-id&gt;</code>.
However, you are then in so-called <em>detached-head</em> mode, in which commits may get lost, see also <a href="#sec.detached-head">Section 3.2.1, &#8220;Detached HEAD&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>The <code>HEAD</code> determines which files are found in the working tree, which commit becomes the predecessor when a new one is created, which commit is displayed by <code>git show</code>, and so on.
When we speak of &#8220;the current branch&#8221;, we mean the <code>HEAD</code> in a technically correct sense.</p>
</div>
<div class="paragraph">
<p>The simple commands <code>log</code>, <code>show</code>, and <code>diff</code> take <code>HEAD</code> as their first argument, without any further arguments.
The output of <code>git log</code> is the same as the output of <code>git log HEAD</code>, and so on&#8201;&#8212;&#8201;this applies to most commands that operate on a commit if you don&#8217;t specify one explicitly.
<code>HEAD</code> is thus similar to the shell variable <code>PWD</code>, which specifies &#8220;where you are&#8221;.</p>
</div>
<div class="paragraph">
<p>When we talk about a commit, a command usually doesn&#8217;t care whether you specify the commit ID in full or in abbreviated form, or whether you access the commit by reference, such as a tag or branch.
However, such a reference may not always be unique.
What happens if there is a branch <code>master</code> and a tag with the same name?
Git checks if the following references exist:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>.git/&lt;name&gt;</code> (mostly only useful for <code>HEAD</code> or similar)</p>
</li>
<li>
<p><code>.git/refs/&lt;name&gt;</code></p>
</li>
<li>
<p><code>.git/refs/tags/&lt;name&gt;</code></p>
</li>
<li>
<p><code>.git/refs/heads/&lt;name&gt;</code></p>
</li>
<li>
<p><code>.git/refs/remotes/&lt;name&gt;</code></p>
</li>
<li>
<p><code>.git/refs/remotes/&lt;name&gt;/HEAD</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Git will take the first matching reference it finds.
So you should always give tags a unique scheme so that they don&#8217;t get confused with branches.
This way you can address branches directly by name instead of <code>heads/&lt;name&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Especially important are the suffixes <code>^</code> and <code>~&lt;n&gt;</code>.
The syntax <code>&lt;ref&gt;^</code> indicates the direct ancestor of <code>&lt;ref&gt;</code>.
This does not always have to be unique: If two or more branches were merged, the merge commit has several direct ancestors.
<code>&lt;ref&gt;^</code> or <code>&lt;ref&gt;^1</code> then denotes the first direct ancestor, <code>&lt;ref&gt;^2</code> the second, and so on.&#8288;<sup class="footnote">[<a id="_footnoteref_30" class="footnote" href="#_footnotedef_30" title="View footnote.">30</a>]</sup>
So the syntax <code>HEAD^^</code> means &#8220;the two-level previous direct ancestor of the current commit&#8221;.
Note that <code>^</code> may have a special meaning in your shell and you may need to protect it with quotes or a backslash.</p>
</div>
<div id="fig.relative-refs" class="imageblock">
<div class="content">
<img src="images/relative-refs.svg" alt="relative refs" width="65%">
</div>
<div class="title">Figure 11. Relative References, <code>^</code> and <code>~&lt;n&gt;</code></div>
</div>
<div class="paragraph">
<p>The syntax <code>&lt;ref&gt;~&lt;n&gt;</code> is equivalent to repeating <code>^</code> <em>n</em> times: <code>HEAD~10</code> thus denotes the tenth direct predecessor of the current commit.
Note: This does not mean that only eleven commits are stored between <code>HEAD</code> and <code>HEAD~10</code>: Since <code>^</code> only follows the first string in any merge, the eleven commits stored between the two references, and all the other commits integrated by a merge, are the same.
The syntax is documented in the <code>git-rev-parse(1)</code> man page in the &#8220;Specifying Revisions&#8221; section.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.branch-management"><a class="anchor" href="#sec.branch-management"></a>3.1.2. Managing Branches</h4>
<div class="paragraph">
<p>A branch is created in Git in no time.
All Git needs to do is identify the currently checked out commit and store the SHA-1 sum in the <code>.git/refs/heads/&lt;branch-name&gt;</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>time git branch neuer-branch</strong>
git branch neuer-branch  0.00s user 0.00s system 100% cpu 0.008 total</pre>
</div>
</div>
<div class="paragraph">
<p>The command is so fast because (unlike other systems) no files need to be copied and no additional metadata needs to be stored.
Information about the structure of the version history can always be derived from the commit that a branch references and its ancestors.</p>
</div>
<div class="paragraph">
<p>Here is an overview of the most important options:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>git branch [-v]</code> </dt>
<dd>
<p>Lists local branches.
The currently checked-out branch is marked with an asterisk.
You can also use <code>-v</code> to display the commit IDs to which the branches point and the first line of the description of the corresponding commits.</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git branch -v</strong>
  maint  65f13f2 Start 1.7.5.1 maintenance track
* master 791a765 Update draft release notes to 1.7.6
  next   b503560 Merge branch _master_ into next
  pu     d7a491c Merge branch _js/info-man-path_ into pu</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>git branch &lt;branch&gt; [&lt;ref&gt;]</code> </dt>
<dd>
<p>Creates a new branch <code>&lt;branch&gt;</code> pointing to commit <code>&lt;ref&gt;</code> (<code>&lt;ref&gt;</code> can be the SHA-1 sum of a commit, another branch, etc.).
If you do not specify a reference, this is HEAD, the current branch.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>git branch -m  &lt;new-name&gt;</code> </dt>
<dd>
<p></p>
</dd>
<dt class="hdlist1"><code>git branch -m  &lt;old-name&gt; &lt;new-name&gt;</code> </dt>
<dd>
<p>In the first form the current branch is renamed to <code>&lt;new-name&gt;</code>.
In the second form <code>&lt;old-name&gt;</code> is renamed to <code>&lt;new-name&gt;</code>.
The command fails if this would overwrite another branch.</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git branch -m master</strong>
fatal: A branch named 'master' already exists.</pre>
</div>
</div>
<div class="paragraph">
<p>If you rename a branch, Git will not display a message.
So you can check afterwards to make sure the renaming was successful:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git branch</strong>
* master
  test
$ <strong>git branch -m test pu/feature</strong>
$ <strong>git branch</strong>
* master
  pu/feature</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>git branch -M &#8230;&#8203;</code> </dt>
<dd>
<p>Like <code>-m</code>, except that a branch is also renamed if it overwrites another branch.
Attention: Commits of the overwritten branch may be lost!</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>git branch -d &lt;branch&gt;</code> </dt>
<dd>
<p>Delete <code>&lt;branch&gt;</code>.
You can specify several branches at once.
Git refuses to delete a branch if it is not yet fully integrated into its upstream branch, or, if it does not exist, into <code>HEAD</code>, the current branch.
(For more on upstream branches, see <a href="#sec.pull">Section 5.3.2, &#8220;git pull&#8221;</a>).</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>git branch -D &#8230;&#8203;</code> </dt>
<dd>
<p>Deletes a branch, even if it contains commits that have not yet been integrated into the upstream or current branch.
Note: These commits may be lost unless they are referenced differently.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="sec.branch-checkout"><a class="anchor" href="#sec.branch-checkout"></a>3.1.2.1. Changing Branches: checkout</h5>
<div class="paragraph">
<p>You can change branches with <code>git checkout &lt;branch&gt;</code>.
If you create a Branch and want to switch directly to it, use <code>git checkout -b &lt;branch&gt;</code>.
The command is equivalent to <code>git branch &lt;branch&gt; &amp;&amp; git checkout &lt;branch&gt;</code>.</p>
</div>
<div class="paragraph">
<p>What happens during a checkout?
Each branch references a commit, which in turn references a tree, that is, the image of a directory structure.
A <code>git checkout &lt;branch&gt;</code> now resolves the reference <code>&lt;branch&gt;</code> to a commit and replicates the commit&#8217;s tree to the index and to the working tree (i.e., the filesystem).</p>
</div>
<div class="paragraph">
<p>Since Git knows which version of files are currently in the index and working tree, only the files that differ on the current and new branches need to be checked out.</p>
</div>
<div class="paragraph">
<p>Git makes it hard for users to lose information.
Therefore, a checkout is more likely to fail than overwrite any unsaved changes in a file.
This happens in the following two cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The checkout would overwrite a file in the working tree that contains changes.
Git will display the following error message: <code>error: Your local changes to the following files would be overwritten by checkout: file</code>.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>The checkout would overwrite an untracked file, i.e. a file that is not managed by Git.
Git then aborts with the error message: error: <code>The following untracked working tree files would be overwritten by checkout: file.</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If, however, changes are stored in the working tree or index that are compatible with both branches, a checkout takes over these changes.
This would look like this, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout master</strong>
A   neue-datei.txt
Switched to branch <em>master</em></pre>
</div>
</div>
<div class="paragraph">
<p>This means that the file <code>new-file.txt</code> was added, which does not exist on either branch.
So since no information can be lost here, the file is simply transferred.
The message: <code>A new-file.txt</code> reminds you which files you should still take care of.
<code>A</code> stands for <em>added</em>, <code>D</code> for <em>deleted</em> and <code>M</code> for <em>modified</em>.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re sure you don&#8217;t need your changes anymore, you can use <code>git checkout -f</code> to ignore the error messages and run the checkout anyway.</p>
</div>
<div class="paragraph">
<p>If you want to keep the changes and change the branch (e.g., interrupt your work and fix a bug on another branch), <code>git stash</code> will help (<a href="#sec.stash">Section 4.5, &#8220;Outsource changes - git stash&#8221;</a>).</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.branch-naming"><a class="anchor" href="#sec.branch-naming"></a>3.1.2.2. Conventions for Naming Branches</h5>
<div class="paragraph">
<p>In principle, you can name branches almost arbitrarily.
Exceptions are spaces, some special characters with special meaning for Git (e.g. <code>*</code>, <code>^</code>, <code>:</code>, <code>~</code>), as well as two consecutive dots (<code>..</code>) or a dot at the beginning of the name.&#8288;<sup class="footnote">[<a id="_footnoteref_31" class="footnote" href="#_footnotedef_31" title="View footnote.">31</a>]</sup></p>
</div>
<div class="paragraph">
<p>It makes sense to always enter branch names completely in lower case letters.
Since Git manages branch names under <code>.git/refs/heads/</code> as files, it is essential that you use upper and lower case.</p>
</div>
<div class="paragraph">
<p>You can group branches into &#8220;namespaces&#8221; by using a <code>/</code> as a separator.
Branches that are related to the translation of a software can then be named e.g. <code>i18n/german</code>, <code>i18n/english</code> etc.
If several developers share a repository, you can also create &#8220;private&#8221; branches under <code>&lt;username&gt;/&lt;topic&gt;</code>.
These namespaces are represented by a directory structure, so that a directory <code>&lt;username&gt;/</code> with the branch file <code>&lt;topic&gt;</code> is created under <code>.git/refs/heads/</code>.</p>
</div>
<div class="paragraph">
<p>The main development branch of your project should always be called <code>master</code>.
Bugfixes are often managed on a branch <code>maint</code> (short for &#8220;maintenance&#8221;).
The next release is usually prepared for <code>next</code>.
Features that are still in an experimental state should be developed in <code>pu</code> (for &#8220;proposed updates&#8221;) or in <code>pu/&lt;feature&gt;</code>.
For a more detailed description of how to use branches to structure development and organize release cycles, see <a href="#ch.workflows">Chapter 6, <em>Workflows</em></a> on Workflows.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.no-ref-commits"><a class="anchor" href="#sec.no-ref-commits"></a>3.1.2.3. Deleted Branches and &#8220;Lost&#8221; Commits</h5>
<div class="paragraph">
<p>Commits each have one or more predecessors.
Therefore, you can walk through the commit graph &#8220;directed&#8221;, that is, from newer to older commits, until you reach a root commit.</p>
</div>
<div class="paragraph">
<p>It&#8217;s not the other way around: if a commit knew its successor, that version would have to be stored somewhere.
This would change the SHA-1 sum of the commit, and the successor would have to reference the corresponding new commit, which would give it a new SHA-1 sum, so the predecessor would have to be changed, and so on.
So Git can only go through the commits from a named reference (such as a branch or <code>HEAD</code>) in the direction of earlier commits.</p>
</div>
<div class="paragraph">
<p>Therefore, if the &#8220;top&#8221; of a branch is deleted, the topmost commit is no longer referenced (in Git jargon: <em>unreachable</em>).
As a result, the predecessor is no longer referenced, and so on, until the next commit comes along that is referenced in some way (either by a branch, or by having a successor that is itself referenced by a branch).</p>
</div>
<div class="paragraph">
<p>So when you delete a branch, the commits on that branch are not deleted, they are just &#8220;lost&#8221;.
Git simply doesn&#8217;t find them anymore.</p>
</div>
<div class="paragraph">
<p>However, they will still be present in the object database for a while.&#8288;<sup class="footnote">[<a id="_footnoteref_32" class="footnote" href="#_footnotedef_32" title="View footnote.">32</a>]</sup>
So you can easily restore a branch by explicitly specifying the previous (and supposedly deleted) commit as a reference:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git branch -D test</strong>
Deleted branch test (was e32bf29).
$ <strong>git branch test e32bf29</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Another way to retrieve deleted commits is the <em>reflog</em> (see <a href="#sec.reflog">Section 3.7, &#8220;Reflog&#8221;</a>).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.tags"><a class="anchor" href="#sec.tags"></a>3.1.3. Tags&#8201;&#8212;&#8201;Marking Important Versions</h4>
<div class="paragraph">
<p>SHA-1 sums are a very elegant solution to describe versions decentrally, but they are semantically poor and unwieldy for humans.
Unlike linear revision numbers, commit IDs alone tell us nothing about the order of versions.</p>
</div>
<div class="paragraph">
<p>During the development of software projects, different &#8220;important&#8221; versions need to be marked so that they can be easily found in the repository.
The most important ones are usually those that are released, called <em>releases</em>.
<em>Release candidates</em> are also often marked in this way, i.e. versions that form the basis for the next version and are checked for critical bugs in the course of quality assurance without adding new features.
Depending on the project and development model, there are different conventions for marking releases and procedures for preparing and publishing them.</p>
</div>
<div class="paragraph">
<p>In the open source area, two versioning schemes have become established: the classic <em>major</em>/<em>minor</em>/<em>micro versioning</em> scheme and, more recently, <em>date-based versioning</em>.
With major/minor/micro versioning, which is used e.g. with the Linux kernel and also Git, a version is identified by three (often four) numbers: <code>2.6.39</code> or <code>1.7.1</code>.
With date-based versioning, on the other hand, the designation is derived from the time of the release, e.g.: <code>2011.05</code> or <code>2011-05-19</code>.
This has the great advantage that the age of a version is easily identifiable.&#8288;<sup class="footnote">[<a id="_footnoteref_33" class="footnote" href="#_footnotedef_33" title="View footnote.">33</a>]</sup></p>
</div>
<div class="paragraph">
<p>Git offers <em>tags</em> (&#8220;labels&#8221;) that can be used to mark any Git object&#8201;&#8212;&#8201;usually commits&#8201;&#8212;&#8201;to highlight prominent states in its development history.
Like branches, tags are implemented as references to objects.
Unlike branches, however, tags are static, meaning that they are not moved when new commits are added, and always point to the same object.
There are two types of tags: <em>annotated</em> and <em>lightweight</em>.
Annotated tags are tagged with metadata, such as author, description, or GPG signature.
Lightweight tags, on the other hand, &#8220;simply&#8221; point to a specific Git object.
For both types of tags, Git creates references under <code>.git/refs/tags/</code> or <code>.git/packed-refs</code>.
The difference is that for each annotated tag, Git creates a special Git object&#8201;&#8212;&#8201;a <em>tag object</em>&#8201;&#8212;&#8201;in the Object Database to store the metadata and SHA-1 sum of the selected object, while a Lightweight tag points directly to the selected object.
<a href="#fig.tag-object">Figure 12, &#8220;The Tag Object&#8221;</a> shows the contents of a tag object; compare also the other git objects, <a href="#fig.git-objects">Figure 4, &#8220;Git Objects&#8221;</a>.</p>
</div>
<div id="fig.tag-object" class="imageblock text-center">
<div class="content">
<img src="images/tags.svg" alt="tags" width="90%">
</div>
<div class="title">Figure 12. The Tag Object</div>
</div>
<div class="paragraph">
<p>The tag object shown has both a size (158 bytes) and a SHA-1 sum.
It contains the name (<code>0.1</code>), the object type and the SHA-1 sum of the referenced object as well as the name and e-mail of the author, which is called <em>tagger</em> in Git jargon.
In addition, the tag contains a tag message that describes the version, for example, and optionally a GPG signature.
In the Git project, for example, a tag message consists of the current version designation and the signature of the maintainer.</p>
</div>
<div class="paragraph">
<p>In the following, let&#8217;s first look at how you manage tags locally.
<a href="#sec.remote-tags">Section 5.8, &#8220;Exchanging Tags&#8221;</a> describes how you exchange tags between repositories.</p>
</div>
<div class="sect4">
<h5 id="sec.managing-tags"><a class="anchor" href="#sec.managing-tags"></a>3.1.3.1. Managing Tags</h5>
<div class="paragraph">
<p>You can manage tags with the command <code>git tag</code>.
Without arguments it shows all existing tags.
Depending on the size of the project, it is worth limiting the output with the <code>-l</code> option and a corresponding pattern.
With the following command you display all variants of version 1.7.1 of the git project, i.e. both the release candidates with the addition <code>-rc*</code> and the (four-digit) maintenance releases:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tag -l v1.7.1*</strong>
v1.7.1
v1.7.1-rc0
v1.7.1-rc1
v1.7.1-rc2
v1.7.1.1
v1.7.1.2
v1.7.1.3
v1.7.1.4</pre>
</div>
</div>
<div class="paragraph">
<p>The content of a tag is provided by <code>git show</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show 0.1 | head</strong>
tag 0.1
Tagger: Valentin Haenel &lt;valentin.haenel@gmx.de&gt;
Date:   Wed Mar 23 16:52:03 2011 +0100

Erste Veröffentlichung

commit e2c67ebb6d2db2aab831f477306baa44036af635
Author: Valentin Haenel &lt;valentin.haenel@gmx.de&gt;
Date:   Sat Jan 8 20:30:58 2011 +0100</pre>
</div>
</div>
<div class="paragraph">
<p>Gitk presents tags as yellow, arrow-like boxes that are clearly distinguishable from the green, rectangular branches:</p>
</div>
<div id="fig.tag-gitk" class="imageblock">
<div class="content">
<img src="images/tag-screenshot.png" alt="tag screenshot" width="90%">
</div>
<div class="title">Figure 13. Tags in Gitk</div>
</div>
</div>
<div class="sect4">
<h5 id="sec.lightweight-tags"><a class="anchor" href="#sec.lightweight-tags"></a>3.1.3.2. Lightweight Tags</h5>
<div class="paragraph">
<p>To add a lightweight tag to the <code>HEAD</code>, pass the desired name to the command (in this example, to mark an important commit)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tag api-aenderung</strong>
$ <strong>git tag</strong>
api-aenderung</pre>
</div>
</div>
<div class="paragraph">
<p>To add a lightweight tag to the <code>HEAD</code>, pass the desired name to the command (in this example, to mark an important commit)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tag pre-regression HEAD~23</strong>
$ <strong>git tag</strong>
api-aenderung
pre-regression</pre>
</div>
</div>
<div class="paragraph">
<p>Tags are unique&#8201;&#8212;&#8201;if you try to recreate a tag, Git will abort with an error message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tag pre-regression</strong>
fatal: tag 'pre-regression' already exists</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec.annotated-tags"><a class="anchor" href="#sec.annotated-tags"></a>3.1.3.3. Annotated Tags</h5>
<div class="paragraph">
<p>Annotated tags are created with the <code>-a</code> option.
As with <code>git commit</code>, an editor will open and allow you to write the tag message.
Or you can pass the tag message with the option <code>-m</code>&#8201;&#8212;&#8201;in which case the option <code>-a</code> is redundant:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tag -m "Zweite Veröffentlichung" 0.2</strong></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec.signed-tags"><a class="anchor" href="#sec.signed-tags"></a>3.1.3.4. Signed Tags</h5>
<div class="paragraph">
<p>To verify a signed tag, use the <code>-v</code> (<em>verify</em>) option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tag -v v1.7.1</strong>
object d599e0484f8ebac8cc50e9557a4c3d246826843d
type commit
tag v1.7.1
tagger Junio C Hamano &lt;gitster@pobox.com&gt; 1272072587 -0700

Git 1.7.1
gpg: Signature made Sat Apr 24 03:29:47 2010 CEST using DSA key ID F3119B9A
gpg: Good signature from "Junio C Hamano &lt;junkio@cox.net&gt;"
...</pre>
</div>
</div>
<div class="paragraph">
<p>Of course, this assumes that you have both GnuPG installed and that you have already imported the signer&#8217;s key.</p>
</div>
<div class="paragraph">
<p>In order to sign tags yourself, you must first set the preferred key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global user.signingkey &lt;GPG-Key-ID&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can create signed tags with the <code>-s</code> (<em>sign</em>) option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tag -s -m "Dritte Veröffentlichung" 3.0</strong></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec.deleting-tags"><a class="anchor" href="#sec.deleting-tags"></a>3.1.3.5. Deleting and Overwriting Tags</h5>
<div class="paragraph">
<p>Use the <code>-d</code> and <code>-f</code> options to delete or overwrite tags:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tag -d 0.2</strong>
Deleted tag '0.2' (was 4773c73)</pre>
</div>
</div>
<div class="paragraph">
<p>The options should be used with caution, especially if you use the tags not only locally, but also publish them.
Under certain circumstances, tags may indicate different commits&#8201;&#8212;&#8201;version <code>1.0</code> in repository X points to a different commit than version <code>1.0</code> in repository Y.
But see also <a href="#sec.remote-tags">Section 5.8, &#8220;Exchanging Tags&#8221;</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.tags-lightweight-vs-heavyweight"><a class="anchor" href="#sec.tags-lightweight-vs-heavyweight"></a>3.1.3.6. Lightweight vs. Annotated Tags</h5>
<div class="paragraph">
<p>For public versioning of software, annotated tags are generally more useful.
Unlike lightweight tags, they contain meta-information that shows who created a tag and when&#8201;&#8212;&#8201;the person contact is unique.
Users of software can also find out who has approved a particular version.
For example, it&#8217;s clear that Junio C. Hamano has tagged Git version 1.7.1&#8201;&#8212;&#8201;so it has his &#8220;seal of approval&#8221;.
The statement also confirms the cryptographic signature, of course.
Lightweight tags, on the other hand, are particularly suitable for applying local markers, for example to identify certain commits relevant to the current task.
However, make sure not to upload such tags to a public repository (see <a href="#sec.remote-tags">Section 5.8, &#8220;Exchanging Tags&#8221;</a>), as they might spread.
If you only use the tags locally, you can also delete them once they have fulfilled their service (see above).</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.non-commit-tags"><a class="anchor" href="#sec.non-commit-tags"></a>3.1.3.7. Non-Commit Tags</h5>
<div class="paragraph">
<p>With tags you can mark any Git object, not only commits, but also trees, blobs and even tag objects themselves!
The classic example is to put the GPG public key used by the maintainer of a project to sign tags in a blob.</p>
</div>
<div class="paragraph">
<p>For example, the tag <code>junio-gpg-pub</code> in the Git repository of Git points to the key of Junio C. Hamano:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show junio-gpg-pub | head -5</strong>
tag junio-gpg-pub
Tagger: Junio C Hamano &lt;junkio@cox.net&gt;
Date:   Tue Dec 13 16:33:29 2005 -0800

GPG key to sign git.git archive.</pre>
</div>
</div>
<div class="paragraph">
<p>Because this blob object is not referenced by any tree, the file is virtually separate from the actual code, but still exists in the repository.
In addition, a tag on a &#8220;lonely&#8221; blob is necessary so that it is not considered unreachable and is deleted during repository maintenance.&#8288;<sup class="footnote">[<a id="_footnoteref_34" class="footnote" href="#_footnotedef_34" title="View footnote.">34</a>]</sup></p>
</div>
<div class="paragraph">
<p>To use the key, proceed as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git cat-file blob junio-gpg-pub | gpg --import</strong>
gpg: key F3119B9A: public key "Junio C Hamano &lt;junkio@cox.net&gt;" imported
gpg: Total number processed: 1
gpg:               imported: 1</pre>
</div>
</div>
<div class="paragraph">
<p>You can then verify all tags in the Git-via-Git repository, as described above.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.git-describe"><a class="anchor" href="#sec.git-describe"></a>3.1.3.8. Describing Commits</h5>
<div class="paragraph">
<p>Tags are very useful for describing any commit &#8220;better&#8221;.
The <code>git describe</code> command gives a description consisting of the most recent tag and its relative position in the commit graph.
Here&#8217;s an example from the git project: we describe a commit with the SHA-1 prefix <code>28ba96a</code>, which is located in the commit graph seven commits after version <code>1.7.1</code>:</p>
</div>
<div id="fig.describe" class="imageblock">
<div class="content">
<img src="images/describe-screenshot.png" alt="describe screenshot" width="90%">
</div>
<div class="title">Figure 14. The commit to be described highlighted in gray</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git describe --tags</strong>
v1.7.1-7-g28ba96a</pre>
</div>
</div>
<div class="paragraph">
<p>The output of <code>git describe</code> is formatted as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;tag&gt;-&lt;position&gt;-g&lt;SHA-1&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The tag is <code>v1.7.1</code>; the position indicates that there are seven new commits between the tag and the described commit.&#8288;<sup class="footnote">[<a id="_footnoteref_35" class="footnote" href="#_footnotedef_35" title="View footnote.">35</a>]</sup>
The <code>g</code> before the ID indicates that the description is derived from a Git repository, which is useful in environments with multiple version control systems.
By default, <code>git describe</code> only searches for annotated tags, but the <code>--tags</code> option extends the search to include lightweight tags.</p>
</div>
<div class="paragraph">
<p>The command is very useful because it translates a content-based identifier into something useful for humans: <code>v1.7.1-7-g28ba96a</code> is much closer to <code>v1.7.1</code> than <code>v1.7.1-213-g3183286</code>.
This allows you to compile the output directly into the software in a way that makes sense, just like in the Git project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git describe</strong>
v1.7.5-rc2-8-g0e73bb4
$ <strong>make</strong>
GIT_VERSION = 1.7.5.rc2.8.g0e73bb
...
$ <strong>./git --version</strong>
git version 1.7.5.rc2.8.g0e73bb</pre>
</div>
</div>
<div class="paragraph">
<p>This way a user knows roughly what version he has, and can track which commit the version was compiled from.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.undo"><a class="anchor" href="#sec.undo"></a>3.2. Restoring Versions</h3>
<div class="paragraph">
<p>The goal of version control software is not just to examine changes between commits.
Above all, it is also important to restore older versions of a file or entire directory trees, or to undo changes.
In Git, the commands <code>checkout</code>, <code>reset</code>, and <code>revert</code> are particularly useful for this.</p>
</div>
<div class="paragraph">
<p>The Git command <code>checkout</code> can not only change branches, but also restore files from previous commits.
The syntax is general:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git checkout [-f] &lt;referenz&gt; -- &lt;muster&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><code>checkout</code> resolves the given reference (and <code>HEAD</code> if missing) to a commit and extracts all files matching <code>&lt;pattern&gt;</code> to the working tree.
If <code>&lt;pattern&gt;</code> is a directory, it refers to all files and subdirectories in it.
Unless you explicitly specify a pattern, all files are checked out.
Changes to a file are not simply overwritten, unless you specify the <code>-f</code> option (see above).
<code>HEAD</code> is also set to the corresponding commit (or branch).</p>
</div>
<div class="paragraph">
<p>However, if you specify a pattern, <code>checkout</code> overwrites this file(s) without prompting.
So to discard all changes to <code>&lt;file&gt;</code>, enter <code>git checkout&#8201;&#8212;&#8201;&lt;file&gt;</code>: Git then replaces <code>&lt;file&gt;</code> with the version in the current branch.
This way, you can also reconstruct the older state of a file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout ce66692 -- &lt;datei&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The double minus separates the patterns from the options or arguments.
It is not necessary, however: If there are no branches or other references with that name, Git will try to find one.
So the separation only makes it clear that you want to recover the file(s) in question.</p>
</div>
<div class="paragraph">
<p>To view the contents of a file from a particular commit without checking it out, use the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show ce66692:&lt;file&gt;</strong></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Use <code>--patch</code> or <code>-p</code> to call <code>git checkout</code> in interactive mode.
The procedure is the same as for <code>git add -p</code> (see <a href="#sec.add-p">Section 2.1.2, &#8220;Creating Commits Step by Step&#8221;</a>), but here you can reset hunks of a file step-by-step.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec.detached-head"><a class="anchor" href="#sec.detached-head"></a>3.2.1. Detached HEAD</h4>
<div class="paragraph">
<p>If you check out a commit that is not referenced by a branch, you are in <em>detached-HEAD</em> mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout 3329661</strong>
Note: checking out '3329661'.

You are in 'detached HEAD' state. You can look around, make
experimental changes and commit them, and you can discard any
commits you make in this state without impacting any branches
by performing another checkout.

If you want to create a new branch to retain commits you create,
you may do so (now or later) by using -b with the checkout command
again. Example:

  git checkout -b new_branch_name

HEAD is now at 3329661... Add LICENSE file</pre>
</div>
</div>
<div class="paragraph">
<p>As the explanation, which you can hide by setting the option <code>advice.detachedHead</code> to <code>false</code>, already warns you, changes you make now will be lost in case of doubt: Since your <code>HEAD</code> is the only direct reference to the commit after that, further commits are not directly referenced by a branch (they are <em>unreachable</em>, see above).</p>
</div>
<div class="paragraph">
<p>So working in detached HEAD mode is especially useful if you want to try something quickly: Has the bug actually already appeared in commit <code>3329661</code>? Was there actually a <code>README</code> file at the time of <code>3329661</code>?</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to do more than just look around from the commit you checked out, for example, to see if your software already had a particular bug at the time, you should create a branch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout -b &lt;temp-branch&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Then you can make commits as usual without fear of losing them.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec.revert"><a class="anchor" href="#sec.revert"></a>3.2.2. Rolling Back Commits</h4>
<div class="paragraph">
<p>If you want to undo all the changes a commit makes, the <code>revert</code> command helps.
However, it does not delete a commit, but creates a new one whose changes are exactly the opposite of the other commit: Deleted lines become added lines, and vice versa.</p>
</div>
<div class="paragraph">
<p>Suppose you have a commit that creates a <code>LICENSE</code> file.
The patch of the corresponding commit looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>--- /dev/null
+++ b/LICENSE
@@ -0,0 +1 @@
+This software is released under the GNU GPL version 3 or newer.</pre>
</div>
</div>
<div class="paragraph">
<p>Now you can undo the changes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git revert 3329661</strong>
Finished one revert.
[master a68ad2d] Revert "Add LICENSE file"
 1 files changed, 0 insertions(+), 1 deletions(-)
 delete mode 100644 LICENSE</pre>
</div>
</div>
<div class="paragraph">
<p>Git creates a new commit on the current branch&#8201;&#8212;&#8201;unless you specify otherwise&#8201;&#8212;&#8201;with the description <code>Revert "&lt;Old commit message&gt;"</code>.
This commit looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show</strong>
commit a68ad2d41e9219383449d703521573477ee7da48
Author: Julius Plenz &lt;feh@mali&gt;
Date:   Mon Mar 7 05:28:47 2011 +0100

    Revert "Add LICENSE file"

    This reverts commit 3329661775af3c52e6b2ad7e9e7e7d789ba62712.

diff --git a/LICENSE b/LICENSE
deleted file mode 100644
index 3fd9c20..0000000
--- a/LICENSE
+++ /dev/null
@@ -1 +0,0 @@
-This software is released under the GNU GPL version 3 or newer.</pre>
</div>
</div>
<div class="paragraph">
<p>Note that from now on, both the commit and the revert will appear in the version history of a project.
You therefore only undo the <em>changes</em>, but do not delete any information from the version history.</p>
</div>
<div class="paragraph">
<p>You should therefore only use <code>revert</code> if you need to undo a change that has already been published.
However, if you are developing locally in a separate branch, it makes more sense to delete these commits completely (see the following section on <code>reset</code> and the topic <em>Rebase</em>, <a href="#sec.rebase">Section 4.1, &#8220;Move commits - Rebase&#8221;</a>).</p>
</div>
<div class="paragraph">
<p>If you want to perform a rebase, but not for all changes to the commit, but only for those to a file, you can use this procedure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show -R 3329661 -- LICENSE | git apply --index</strong>
$ <strong>git commit -m 'Revert change to LICENSE from 3329661'</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>git show</code> command prints the changes from commit <code>3329661</code> that apply to the <code>LICENSE</code> file.
The <code>-R</code> option causes the unified-diff format to be displayed &#8220;the other way around&#8221; (<em>reverse</em>).
The output is passed to <code>git apply</code> to make the changes to the file and index.
The changes are then checked in.</p>
</div>
<div class="paragraph">
<p>Another way to undo a change is to check out a file from a previous commit, add it to the index, and check it in again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout 3329661 -- &lt;datei&gt;</strong>
$ <strong>git add &lt;datei&gt;</strong>
$ <strong>git commit -m 'Reverting &lt;datei&gt; to resemble 3329661'</strong></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.reset"><a class="anchor" href="#sec.reset"></a>3.2.3. Reset and the Index</h4>
<div class="paragraph">
<p>If you are deleting a commit completely, not just undoing it, use <code>git reset</code>.
The reset command sets the <code>HEAD</code> (and thus the current branch), and optionally the index and working tree, to a particular commit.
The syntax is <code>git reset [&lt;option&gt;] [&lt;commit&gt;]</code>.</p>
</div>
<div class="paragraph">
<p>The most important types of resets are the following:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>-&#8288;-&#8288;soft</code> 
</td>
<td class="hdlist2">
<p>Resets only the <code>HEAD</code>; index and working tree remain unaffected.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>-&#8288;-&#8288;mixed</code> 
</td>
<td class="hdlist2">
<p>Default setting if you do not specify an option.
Sets <code>HEAD</code> and index to the specified commit, but the files in the working tree are not affected.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>-&#8288;-&#8288;hard</code> 
</td>
<td class="hdlist2">
<p>Synchronizes <code>HEAD</code>, Index and Working Tree and sets them to the same commit.
Changes in the working tree may be lost!</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you call <code>git reset</code> without any options, this is equivalent to a <code>git reset --mixed HEAD</code>.
We&#8217;ve already seen this command: Git sets the current <code>HEAD</code> to <code>HEAD</code> (so it doesn&#8217;t change it) and the index to <code>HEAD</code>&#8201;&#8212;&#8201;in this case, the changes you added before are lost.</p>
</div>
<div class="paragraph">
<p>The possible uses of this command are many and varied and will reappear in the various command sequences.
Therefore it is important to understand the functionality, even if there are sometimes alternative commands that have the same effect.</p>
</div>
<div class="paragraph">
<p>Suppose you have made two commits to <code>master</code> that you actually want to move to a new branch to work on further.
The following command sequence creates a new branch pointing to <code>HEAD</code>, and then resets <code>HEAD</code> and the current branch <code>master</code> two commits.
Then check out the new branch <code>&lt;new-feature&gt;</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git branch &lt;neues-feature&gt;</strong>
$ <strong>git reset --hard HEAD^^</strong>
$ <strong>git checkout &lt;neues-feature&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, the following sequence has the same effect: you create a Branch <code>&lt;new-feature&gt;</code> that points to the current commit.
Then you delete <code>master</code> and re-create it so that it points to the second predecessor of the current commit.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout -b &lt;new-feature&gt;</strong>
$ <strong>git branch -D master</strong>
$ <strong>git branch master HEAD^^</strong></pre>
</div>
</div>
<div class="sect4">
<h5 id="sec.reset-usage"><a class="anchor" href="#sec.reset-usage"></a>3.2.3.1. Using reset</h5>
<div class="paragraph">
<p>With <code>reset</code> you do not delete any commits, but only move references.
As a result, the commits that are no longer referenced are lost, and are therefore deleted (<em>unreachable</em>).
So you can use <code>reset</code> to delete only the topmost commits on a branch, not arbitrary commits &#8220;somewhere in the middle,&#8221; as this would destroy the commit graph.
(For the somewhat more complicated deletion of commits &#8220;in the middle,&#8221; see <em>rebase</em>, <a href="#sec.rebase">Section 4.1, &#8220;Move commits - Rebase&#8221;</a>).</p>
</div>
<div class="paragraph">
<p>Git always stores the original <code>HEAD</code> under <code>ORIG_HEAD</code>.
So if you have performed a reset by mistake, use <code>git reset --hard ORIG_HEAD</code> to undo it (even if the commit was supposedly deleted).
However, this <em>does not</em> affect lost changes to the working tree (which you have not yet checked in)&#8201;&#8212;&#8201;they are deleted irrevocably.</p>
</div>
<div class="paragraph">
<p>The result from above (moving two commits to a new branch) can also be achieved this way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git reset --hard HEAD^^</strong>
$ <strong>git checkout -b &lt;new-feature&gt; ORIG_HEAD</strong></pre>
</div>
</div>
<div class="paragraph">
<p>A common use of <code>reset</code> is to discard changes on a test basis.
You want to try a patch?
Add some debugging output?
Change a few constants?
If you don&#8217;t like the result, a <code>git reset --hard</code> deletes all changes to the working tree.</p>
</div>
<div class="paragraph">
<p>You can also use <code>reset</code> to &#8220;make your version history nice.&#8221;
For example, if you have a few commits on a branch <code>&lt;feature&gt;</code> based on <code>master</code>, but they are not well structured (or much too large), you can create a branch <code>&lt;reorder-feature&gt;</code> and pack all changes into new commits:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout -b &lt;reorder-feature&gt; &lt;feature&gt;</strong>
$ <strong>git reset master</strong>
$ <strong>git add -p</strong>
$ <strong>git commit</strong>
$ ...</pre>
</div>
</div>
<div class="paragraph">
<p>The command <code>git reset master</code> sets index and <code>HEAD</code> to the state of <code>master</code>.
However, your changes in the working tree are preserved, i.e. all changes that distinguish the branch <code>&lt;feature&gt;</code> from <code>master</code> are now only contained in the files in the working tree.
Now you can add the changes <em>incrementally</em> using <code>git add -p</code> and package them into (several) handy commits.&#8288;<sup class="footnote">[<a id="_footnoteref_36" class="footnote" href="#_footnotedef_36" title="View footnote.">36</a>]</sup></p>
</div>
<div class="paragraph">
<p>Suppose you are working on a change and want to check it in temporarily (to continue working on it later).
You can then use the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git commit -m 'feature (noch unfertig)'</strong>
(später)
$ <strong>git reset --soft HEAD^</strong>
(weiterarbeiten)</pre>
</div>
</div>
<div class="paragraph">
<p>The command <code>git reset --soft HEAD^</code> resets the <code>HEAD</code> one commit, but leaves the index and the working tree untouched.
So all changes from your temporary commit are still in the index and working tree, but the actual commit is lost.
You can now make further changes and create a new commit later.
Similar functionality is provided by the <code>--amend</code> option for <code>git commit</code>, as well as the <code>git stash</code> command, which is explained in <a href="#sec.stash">Section 4.5, &#8220;Outsource changes - git stash&#8221;</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.merge"><a class="anchor" href="#sec.merge"></a>3.3. Merging Branches</h3>
<div class="paragraph">
<p>Merging branches is called <em>merging</em> in Git; the commit that merges two or more branches together is called a <em>merge commit</em>.</p>
</div>
<div class="paragraph">
<p>Git provides the <code>merge</code> subcommand, which allows you to merge one branch into another.
This means that any changes you make to the branch will be reflected in the current one.</p>
</div>
<div class="paragraph">
<p>Note that the command integrates the specified branch into the <em>currently checked-out branch</em> (i.e., <code>HEAD</code>).
The command therefore only needs one argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git merge &lt;branch-name&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>If you handle your branches carefully, there should be no problems with merging.
If there are, then this section also presents strategies for resolving merge conflicts.</p>
</div>
<div class="paragraph">
<p>First, we will look at an object-level merge process.</p>
</div>
<div class="sect3">
<h4 id="sec.merge-detail"><a class="anchor" href="#sec.merge-detail"></a>3.3.1. Two-Branches Merge</h4>
<div class="paragraph">
<p>The two branches, <code>topic</code> and <code>master</code>, that you want to merge, each reference the most recent commit in a chain of commits (F and D), and these two commits in turn reference a tree (corresponding to the top-level directory of your project).</p>
</div>
<div class="paragraph">
<p>First, Git calculates a so-called <em>merge base</em>, that is, a commit that both of the commits to be merged have as common ancestors.
Usually there are several such bases&#8201;&#8212;&#8201;in the diagram below, A and B&#8201;&#8212;&#8201;and then the most recent one (which has the other bases as ancestors) is used.&#8288;<sup class="footnote">[<a id="_footnoteref_37" class="footnote" href="#_footnotedef_37" title="View footnote.">37</a>]</sup>
In simple terms, this is the commit where the branches diverged (i.e., B).</p>
</div>
<div class="paragraph">
<p>Now, if you want to merge two commits (D and F to M), then the trees referenced by the commits must be merged.</p>
</div>
<div id="fig.merge-base-commit" class="imageblock">
<div class="content">
<img src="images/merge-base-commit.svg" alt="merge base commit" width="70%">
</div>
<div class="title">Figure 15. Merge base and merge commit</div>
</div>
<div class="paragraph">
<p>Git does this as follows:&#8288;<sup class="footnote">[<a id="_footnoteref_38" class="footnote" href="#_footnotedef_38" title="View footnote.">38</a>]</sup> If a tree entry (another tree or a blob) is the same in both commits, then that very tree entry will be taken over in the merge commit.
This happens in two cases:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A file has not been changed by either commit, or a subdirectory does not contain a changed file: In the first case, the blob SHA 1 sum of this file is the same in both commits.
In the second case, the same tree object is referenced by both commits.
The referenced blob or tree is therefore the same as the one referenced in the merge base.</p>
</li>
<li>
<p>A file was changed <em>on both sides</em> and <em>equivalently</em> (same blobs).
This happens, for example, if all changes to a file were copied from one branch using <code>git cherry-pick</code> (see <a href="#sec.cherry-pick">Section 3.5, &#8220;Taking over Individual Commits: Cherry Pick&#8221;</a>).
The referenced blob is then <em>not</em> the same as in the merge base.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If a tree entry disappears in one of the commits, but is still present in the other, and is the same as in the merge base, then it is not taken over.
This is equivalent to deleting a file or directory if no changes have been made to the file on the other side.
Similarly, if a commit brings a new tree entry, it is copied to the merge tree.</p>
</div>
<div class="paragraph">
<p>Now what happens if a file from the commits has different blobs, that is, the file has been changed at least on one side?
In the event that one of the blobs is the same as in the merge base, only one side of the file has been changed, so Git can simply adopt those changes.</p>
</div>
<div class="paragraph">
<p>However, if <em>both</em> blobs are different from the merge base, you might run into problems.
First, Git tries to apply the changes on both sides.</p>
</div>
<div class="paragraph">
<p>A <em>3-way merge</em> algorithm is usually employed for this purpose.
Unlike the classic 2-way merge algorithm, which is used when you have two different versions A and B of a file and want to merge them, this 3-way algorithm involves a third version C of the file, extracted from the above merge base.
Therefore, because a common ancestor of the file is known, the algorithm can in many cases better (that is, not only based on the line number or context) decide how to merge changes.
In practice, so many trivial merge conflicts are already solved automatically without user intervention.</p>
</div>
<div class="paragraph">
<p>However, there are conflicts that no merge algorithm, no matter how good, can merge.
This happens, for example, if the context in version A of the file was changed just before a change in file B, or, worse still, version A and B and C have different versions of a line.</p>
</div>
<div class="paragraph">
<p>Such a case is called a <em>merge conflict</em>.
Git merges all the files as best it can, and then presents the conflicting changes to the user so they can manually merge them (and thus resolve the conflict) (see <a href="#sec.merge-conflicts">Section 3.4, &#8220;Resolving Merge Conflicts&#8221;</a>).</p>
</div>
<div class="paragraph">
<p>Although it is basically possible to generate a syntactically correct resolution with an algorithm that is specially designed for the respective programming language, an algorithm cannot look beyond the <em>semantics</em> of the code, i.e., cannot grasp the meaning of the code.
Therefore, a solution generated in this way would usually not make sense.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.merge-ff"><a class="anchor" href="#sec.merge-ff"></a>3.3.2. Fast Forward Merges: Fast Forwarding One Branch</h4>
<div class="paragraph">
<p>The <code>git merge</code> command does not always create a merge commit.
A trivial case, but one that does occur frequently, is the so-called <em>fast-forward merge</em>, i.e. a fast forward merge of the branch.</p>
</div>
<div class="paragraph">
<p>A fast forward merge occurs when a branch, for example <code>topic</code>, is the child of a second branch, <code>master</code>:</p>
</div>
<div id="fig.merge-ff-before" class="imageblock text-center">
<div class="content">
<img src="images/ff-before.svg" alt="ff before" width="70%">
</div>
<div class="title">Figure 16. Before the <em>fast forward</em> merge</div>
</div>
<div class="paragraph">
<p>A simple <code>git merge topic</code> in Branch <code>master</code> now causes <code>master</code> to simply be moved forward&#8201;&#8212;&#8201;no merge commit is created.</p>
</div>
<div id="fig.merge-ff-after" class="imageblock text-center">
<div class="content">
<img src="images/ff-after.svg" alt="ff after" width="70%">
</div>
<div class="title">Figure 17. After the <em>fast forward</em> merge&#8201;&#8212;&#8201;no merge commit was created</div>
</div>
<div class="paragraph">
<p>Of course, such a behavior only works if the two branches have not diverged, i.e. if the merge base of both branches is one of the two branches itself, in this case <code>master</code>.</p>
</div>
<div class="paragraph">
<p>This behavior is often desirable:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You want to integrate upstream changes, that is, changes from another Git repository.
You typically use a command like <code>git merge origin/master</code> to do this.
A <code>git pull</code> will also perform a merge.
To learn how to merge changes between git repositories, see <a href="#ch.distributed-git">Chapter 5, <em>Distributed Git</em></a>.</p>
</li>
<li>
<p>You want to add an experimental branch.
Because it&#8217;s quick and easy to create branches in Git, it&#8217;s a good idea to start a new branch for each feature.
If you&#8217;ve tried something experimental on a branch and want to integrate it without being able to tell when it&#8217;s &#8220;time to integrate&#8221;, you can do so by <em>fast-forwarding</em>.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>With the options <code>--ff-only</code> and <code>--no-ff</code> you can adjust the merge behavior.
If you use the first option and the branches cannot be merged using fast-forward, Git will abort with an error message.
The second option forces Git to create a merge commit even though fast forward would have been possible.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are different opinions on whether changes should always be integrated via fast-forward or whether it is better to create a merge commit, although this is not absolutely necessary.
The results are the same in both cases: Changes from one branch are integrated into another.</p>
</div>
<div class="paragraph">
<p>However, when you create a Merge-Commit, the <em>integration</em> of a feature becomes clear.
Consider the following two excerpts from the version history of a project:</p>
</div>
<div id="fig.ff-vergleich" class="imageblock">
<div class="content">
<img src="images/ff-no-ff-vergleich.png" alt="ff no ff vergleich" width="80%">
</div>
<div class="title">Figure 18. Integration of a feature with and without fast forward</div>
</div>
<div class="paragraph">
<p>In the above case, you cannot easily see which commits were previously developed in branch <code>sha1-caching</code>, that is, they have to do with a specific feature of the software.</p>
</div>
<div class="paragraph">
<p>In the lower version, however, you can see at first glance that there were exactly four commits on that branch, and that it was then integrated.
Since nothing was developed in parallel, the merge commit would in principle be unnecessary, but it does make the integration of the feature clear.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>So instead of relying on the magic of <code>git merge</code>, it makes sense to create two aliases (see <a href="#sec.git-alias">Section 1.3.1, &#8220;Git Aliases&#8221;</a>) that force or forbid fast forward merge:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>nfm = merge --no-ff     # no-ff-merge
ffm = merge --ff-only   #    ff-merge</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An explicit merge commit is also helpful because you can undo it with a single command.
This is useful, for example, if you have integrated a branch but it has bugs: If the code is running in production, it is often desirable to merge the entire change back in until the bug is fixed.
Use for this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git revert -m 1 &lt;merge-commit&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Git then produces a new commit that reverses any changes made by the merge.
The <code>-m 1</code> option here specifies which &#8220;side&#8221; of the merge should be considered the <em>mainline</em>, or stable line of development: its changes are preserved.
In the above example, <code>-m 1</code> would cause the changes made by the four commits from branch <code>sha1-caching</code>, the second string of the merge, to be undone.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.merge-strategies"><a class="anchor" href="#sec.merge-strategies"></a>3.3.3. Merging Strategies</h4>
<div class="paragraph">
<p>Git has five different merge strategies, some of which can be further adjusted by strategy options.
You determine the strategy by <code>-s</code>, so a merge call is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git merge -s &lt;strategy&gt; &lt;branch&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Some of these strategies can only merge two branches, others any number.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>resolve</code> </dt>
<dd>
<p>The <code>resolve</code> strategy can merge two branches using a 3-way merge technique.
The newest (best) of all possible bases is used as the merge base.
This strategy is fast and generally produces good results.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>recursive</code> </dt>
<dd>
<p>This is the standard strategy that Git uses to merge two branches.
A 3-way merge algorithm is also used here.
However, this strategy is more clever than <code>resolve</code>: If several merge bases exist, all of which have &#8220;equal rights,&#8221;&#8288;<sup class="footnote">[<a id="_footnoteref_39" class="footnote" href="#_footnotedef_39" title="View footnote.">39</a>]</sup> then Git first merges these bases together, and then uses the result as the merge base for the 3-way merge algorithm.
In addition to the fact that merges with file renames can be processed more easily as a result, a test run on the version history of the Linux kernel has shown that these strategies result in fewer merge conflicts than the <code>resolve</code> strategy.
The strategy can be adapted by various options (see below).</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>octopus</code> </dt>
<dd>
<p>Standard strategy when three or more branches are merged.
In contrast to the two strategies mentioned above, the octopus strategy can only perform merges if no error occurs, i.e. if no manual conflict resolution is necessary.
The strategy is especially designed to integrate many topic branches that are known to be compatible with the mainline (main development strand).</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ours</code> </dt>
<dd>
<p>Can merge any number of branches, but does not use a merge algorithm.
Instead, the blobs or trees of the current branch (that is, the branch from which you entered <code>git merge</code>) are always used.
This strategy is mainly used when you want to overwrite old developments with the current state of affairs.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>subtree</code> </dt>
<dd>
<p>Works like <code>recursive</code>, but the strategy does not compare the trees &#8220;on equal footing,&#8221; but tries to find the tree of one side as a subtree of the other side and only then merge them.
This strategy is useful, for example, if you manage the <code>Documentation/</code> subdirectory of your project in a separate repository.
Then you can merge the changes from that repository into the master repository by using <code>git pull -s subtree &lt;documentation-repo&gt;</code> to apply the <code>subtree</code> strategy, which recognizes the contents of <code>&lt;documentation-repo&gt;</code> as a subdirectory of the master repository and applies the merge process only to that subdirectory.
This topic is discussed in more detail in <a href="#sec.subprojects">Section 5.11, &#8220;Managing Subprojects&#8221;</a>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec.recursive-options"><a class="anchor" href="#sec.recursive-options"></a>3.3.4. Options for the Recursive Strategy</h4>
<div class="paragraph">
<p>The default strategy <code>recursive</code> knows several options that adjust the behavior especially with regard to conflict resolution.
You specify them with the option <code>-X</code>; the syntax is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git merge -s recursive -X &lt;option&gt; &lt;branch&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>If you only merge two branches, you do not need to explicitly specify the <code>recursive</code> strategy by <code>-s recursive</code>.</p>
</div>
<div class="paragraph">
<p>Since the strategy can only merge two branches, it is possible to speak of <em>our</em> version and <em>theirs</em>: <em>our</em> version is the checked-out branch in the merge process, while <em>their</em> version references the branch you want to integrate.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ours</code> </dt>
<dd>
<p>If a merge conflict occurs that would normally need to be resolved manually, <em>our</em> version is used instead.
The strategy <em>option</em> is different from <code>ours</code>, however, because it ignores any changes made by the other side(s).
The <code>ours</code> option, on the other hand, takes all changes made by our side and the other side, and only gives priority in the event of a conflict and only at the points of conflict on <em>our</em> side.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>theirs</code> </dt>
<dd>
<p>Like <code>ours</code>, except that the opposite is true: in case of conflicts, <em>their</em> version is preferred.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ignore-space-change</code>, <code>ignore-all-space</code>, <code>ignore-space-at-eol</code> </dt>
<dd>
<p>Since whitespace does not play a syntactic role in most languages, these options allow you to tell Git to try to resolve a merge conflict automatically if whitespace is not important.
A common use case is when an editor or IDE has automatically reformatted source code.</p>
<div class="paragraph">
<p>The option <code>ignore-space-at-eol</code> ignores whitespace at the end of the line, which is especially helpful if both sides use different line-end conventions (LF/CRLF).
If you specify <code>ignore-space-change</code>, whitespace is also treated as a pure separator: Thus, when comparing a line, it is irrelevant how many spaces or tabs are in one place&#8201;&#8212;&#8201;indented lines remain indented, and separated words remain separated.
The option <code>ignore-all-space</code> ignores any whitespace.</p>
</div>
<div class="paragraph">
<p>This is the general strategy: If <em>their</em> version brings in only whitespace changes covered by the specified option, they are ignored and <em>our</em> version is used; if they bring in further changes and <em>our</em> version has only whitespace changes, <em>their</em> version is used.
However, if both sides have not only whitespace changes, there is still a merge conflict.</p>
</div>
<div class="paragraph">
<p>In general, after a merge that you could only solve by using one of these options, it is recommended to normalize the corresponding files again, i.e. to make the line endings and indentations uniform.</p>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>subtree=&lt;tree&gt;</code> </dt>
<dd>
<p>Similar to the <code>subtree</code> <em>strategy</em>, but an explicit path is specified here.
Similar to the above example, you would use:</p>
<div class="listingblock">
<div class="content">
<pre>git pull -Xsubtree=Documentation &lt;documentation-repo&gt;</pre>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.merge-conflicts"><a class="anchor" href="#sec.merge-conflicts"></a>3.4. Resolving Merge Conflicts</h3>
<div class="paragraph">
<p>As already described, some conflicts cannot be resolved by algorithms&#8201;&#8212;&#8201;in this case manual rework is necessary.
Good team coordination and fast integration cycles can minimize major merge conflicts.
But especially in early development, when possibly the internals of a software are changed instead of adding new features, conflicts can occur.</p>
</div>
<div class="paragraph">
<p>If you are working in a larger team, the developer who has done most of the work on the conflicted code is usually responsible for finding a solution.
However, such a conflict resolution is usually not difficult if the developer has a good overview of the software in general and of his piece of code and its interaction with other parts in particular.</p>
</div>
<div class="paragraph">
<p>We will go through the solution of a merge conflict using a simple example in C.
Take a look at the following <code>output.c</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>int i;

for(i = 0; i &lt; nr_of_lines(); i++)
    output_line(i);

print_stats();</pre>
</div>
</div>
<div class="paragraph">
<p>The piece of code goes through all lines of an output and outputs them one after the other.
Finally it returns a small statistic.</p>
</div>
<div class="paragraph">
<p>Now two developers change something in this code.
The first one, Axel, writes a function that wraps the lines before they are output and replaces <code>output_line</code> in the above piece of code with his improved version <code>output_wrapped_line</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>int i;
int tw = 72;

for(i = 0; i &lt; nr_of_lines(); i++)
    output_wrapped_line(i, tw);

print_stats();</pre>
</div>
</div>
<div class="paragraph">
<p>The second developer, Beatrice, modifies the code so that her newly introduced configuration setting <code>max_output_lines</code> is honored and not too many lines are output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>int i;

for(i = 0; i &lt; nr_of_lines(); i++) {
    if(i &gt; config_get("max_output_lines"))
        break;
    output_line(i);
}

print_stats();</pre>
</div>
</div>
<div class="paragraph">
<p>So Beatrice uses the &#8220;obsolete&#8221; version <code>output_line</code>, and Axel does not yet have the construct that checks the configuration setting.</p>
</div>
<div class="paragraph">
<p>Now Beatrice tries to transfer her changes on Branch B to the branch <code>master</code>, where Axel has already integrated his changes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout master</strong>
$ <strong>git merge B</strong>
Auto-merging output.c
CONFLICT (content): Merge conflict in output.c
Automatic merge failed; fix conflicts and then commit the result.</pre>
</div>
</div>
<div class="paragraph">
<p>In the <code>output.c</code> file, Git now places <em>conflict markers</em>, highlighted in semi-bold at the bottom to indicate where changes overlap.
There are two pages: The first is <code>HEAD</code>, i.e. the branch to which Beatrice wants to apply the changes&#8201;&#8212;&#8201;in this case <code>master</code>.
The other side is the branch to be integrated&#8201;&#8212;&#8201;B.
The two sides are separated by a series of equal signs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>int i;
int tw = 72;

<strong>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</strong>
for(i = 0; i &lt; nr_of_lines(); i++)
    output_wrapped_line(i, tw);
<strong>=======</strong>
for(i = 0; i &lt; nr_of_lines(); i++) {
    if(i &gt; config_get("max_output_lines"))
        break;
    output_line(i);
}
<strong>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</strong>

print_stats();</pre>
</div>
</div>
<div class="paragraph">
<p>It should be noted here that only the actual <em>conflicting changes</em> are objected to by Beatrice.
Axel&#8217;s definition of <code>tw</code> above is accepted without any problems, although it is not yet available in Beatrice.</p>
</div>
<div class="paragraph">
<p>Beatrice must now resolve the conflict.
This is done by first editing the file directly, modifying the code as it should be, and then removing the conflict markers.
If Axel has documented in detail in his commit message&#8288;<sup class="footnote">[<a id="_footnoteref_40" class="footnote" href="#_footnotedef_40" title="View footnote.">40</a>]</sup> how his new function works, this should be done quickly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>int i;
int tw = 72;

for(i = 0; i &lt; nr_of_lines(); i++) {
    if(i &gt; config_get("max_output_lines"))
        break;
    output_wrapped_line(i, tw);
}

print_stats();</pre>
</div>
</div>
<div class="paragraph">
<p>Beatrice must then add the changes using <code>git add</code>.
If no conflict markers remain in the file, Git will indicate that a conflict has been resolved.
Finally, the result has to be checked in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git add output.c</strong>
$ <strong>git commit</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The commit message should definitely state how this conflict was resolved.
It should also mention possible side effects on other parts of the program.</p>
</div>
<div class="paragraph">
<p>Normally, merge commits are &#8220;empty&#8221;, i.e., there is no diff output in <code>git show</code> (because the changes were caused by other commits).
This is different in the case of a merge commit that resolves a conflict:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show</strong>
commit 6e6c55810c884356402c078f30e45a997047058e
Merge: f894659 256329f
Author: Beatrice &lt;beatrice@gitbu.ch&gt;
Date:   Mon Feb 28 05:59:36 2011 +0100

    Merge branch 'B'

    * B:
      honor max_output_lines config option

    Conflicts:
        output.c

diff --cc output.c
index a2bd8ed,f4c8bec..e39e39d
--- a/output.c
+++ b/output.c
@@@ -1,7 -1,9 +1,10 @@@
  int i;
 <strong>+</strong>int tw = 72;

<strong>-</strong> for(i = 0; i < nr_of_lines(); i++)
<strong>+</strong> for(i = 0; i < nr_of_lines(); i++) {
<strong>+</strong>     if(i > config_get("max_output_lines"))
<strong>+</strong>         break;
 <strong>-</strong>    output_line(i);
 <strong>+</strong>    output_wrapped_line(i, tw);
<strong>+</strong> }

  print_stats();</pre>
</div>
</div>
<div class="paragraph">
<p>This <em>combined</em> diff output differs from the usual unidiff format: There is not only one column with the markers for added (<code>+</code>), removed (<code>-</code>) and context or unchanged (<code>␣</code>), but two.
So Git compares the result with <em>both</em> ancestors.
The lines changed in the second column are exactly the same as Axel&#8217;s commit; the (semi-bold) changes in the first column are Beatrice&#8217;s commit including conflict resolution.</p>
</div>
<div class="paragraph">
<p>The default way, as seen above, is the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open conflicting file</p>
</li>
<li>
<p>Resolve conflict, remove markers</p>
</li>
<li>
<p>Mark file as &#8220;resolved&#8221; via <code>git add</code></p>
</li>
<li>
<p>Repeat steps one to three for all files where conflicts occurred</p>
</li>
<li>
<p>Check in conflict solutions via <code>git commit</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you don&#8217;t know how to resolve the conflict on an <em>ad hoc</em> basis (for example, if you want to hire the original developer to produce a conflict-free version of the code), you can use <code>git merge --abort</code> to abort the merge process&#8201;&#8212;&#8201;that is, to restore your working tree to the state it was in before you initiated the merge.
This command also aborts a merge that you have already partially resolved.
Attention: All changes that have not been checked in will be lost.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To get an overview of which commits caused changes to your file relevant to the merge conflict, you can use the command</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git log --merge -p -- &lt;file&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Git then lists the diffs of commits that have made changes to <code>&lt;file&gt;</code> since the merge base.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you are in a merge conflict, a file with conflicts is stored in three <em>stages</em>: Stage one contains the version of the file in the merge base (that is, the common original version of the file), stage two contains the version from the <code>HEAD</code> (that is, the version from the branch <em>into</em> which you are merging).
Finally, stage three contains the file in the version of the branch you are merging into (this has the symbolic reference <code>MERGE_HEAD</code>).
The working tree contains the combination of these three stages with conflict markers.
However, you can display these versions with <code>git show :&lt;n&gt;:&lt;file&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show :1:output.c</strong>
$ <strong>git show :2:output.c</strong>
$ <strong>git show :3:output.c</strong></pre>
</div>
</div>
<div class="paragraph">
<p>With a program specially developed for 3-way merges, however, it is much easier for you to keep an overview.
The program looks at the three stages of a file, visualizes them accordingly and offers you options to move changes back and forth.</p>
</div>
<div class="sect3">
<h4 id="sec.mergetool"><a class="anchor" href="#sec.mergetool"></a>3.4.1. Help with Merging: Mergetool</h4>
<div class="paragraph">
<p>In the case of non-trivial merge conflicts, a merge tool is recommended that visualizes the three stages of a file accordingly, thereby facilitating the resolution of the conflict.</p>
</div>
<div class="paragraph">
<p>Common IDEs and editors such as Vim and Emacs offer such a mode.
There are also external tools such as <em>KDiff3</em>&#8288;<sup class="footnote">[<a id="_footnoteref_41" class="footnote" href="#_footnotedef_41" title="View footnote.">41</a>]</sup> and <em>Meld</em>.&#8288;<sup class="footnote">[<a id="_footnoteref_42" class="footnote" href="#_footnotedef_42" title="View footnote.">42</a>]</sup>
The latter visualizes particularly well how a file has changed between commits.</p>
</div>
<div id="fig.meld" class="imageblock">
<div class="content">
<img src="images/meld-example.png" alt="meld example" width="100%">
</div>
<div class="title">Figure 19. The example merge conflict, visualized in the merge tool &#8220;Meld&#8221;</div>
</div>
<div class="paragraph">
<p>You launch such a merge tool via <code>git mergetool</code>.
Git will go through all the files that contain conflicts and display each one (when you press enter) in a merge tool.
By default this is Vimdiff.&#8288;<sup class="footnote">[<a id="_footnoteref_43" class="footnote" href="#_footnotedef_43" title="View footnote.">43</a>]</sup></p>
</div>
<div class="paragraph">
<p>Such a program will usually display the three versions of a file&#8201;&#8212;&#8201;<em>our</em> page, <em>their</em> page, and the file merged as far as possible, including conflict markers&#8201;&#8212;&#8201;in three columns side by side, the latter sensibly in the middle.
It is always essential that you make the change (conflict resolution) in the middle file, i.e. in the working copy.
The other files are temporary and are deleted again when the merge tool is finished.</p>
</div>
<div class="paragraph">
<p>In principle, you can use any other tool.
The <code>mergetool</code> script simply stores the three stages of the file with the corresponding file name and starts the diff tool on these three files.
If it quits again, Git checks to see if there are any conflict markers left in the file&#8201;&#8212;&#8201;if not, Git will assume that the conflict was resolved successfully and automatically add the file to the index using <code>git add</code>.
Finally, when you have finished processing all the files, you only need to make one commit call to seal the conflict resolution.</p>
</div>
<div class="paragraph">
<p>The <code>merge.tool</code> option determines which tool Git starts on the file.
The following commands are already preconfigured, meaning that Git already knows in which order the program expects the arguments and which additional options need to be specified:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>araxis bc3 codecompare deltawalker diffmerge diffuse
ecmerge emerge gvimdiff gvimdiff2 gvimdiff3 kdiff3
meld opendiff p4merge tkdiff tortoisemerge
vimdiff vimdiff2 vimdiff3 xxdiff</pre>
</div>
</div>
<div class="paragraph">
<p>To use your own merge tool, you must set <code>merge.tool</code> to a suitable name, for example <code>mymerge</code>, and then at least specify the <code>mergetool.mymerge.cmd</code> option.
The shell evaluates the expression stored in it, and the variables <code>BASE</code>, <code>LOCAL</code>, <code>REMOTE</code>, and <code>MERGED</code>, which are contained in the file with the conflict markers, are set to the corresponding temporary files.
You can further configure the properties of your merge command, see the <code>git-config(1)</code> man page in the <code>mergetool</code> configuration section.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you temporarily (not permanently) decide to use another merge program, specify it with the <code>-t &lt;tool&gt;</code> option.
So to try Meld, during a merge conflict, simply type <code>git mergetool -t meld</code>&#8201;&#8212;&#8201;of course Meld must be installed for this to work.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec.rerere"><a class="anchor" href="#sec.rerere"></a>3.4.2. rerere: Reuse Recorded Resolution</h4>
<div class="paragraph">
<p>Git has a relatively unknown (and poorly documented), but very helpful feature: Rerere, short for <em>Reuse Recorded Resolution</em>.
You need to set the <code>rerere.enabled</code> option to <code>true</code> to have the command called automatically (note the <code>d</code> at the end of <code>enabled</code>).</p>
</div>
<div class="paragraph">
<p>The idea behind Rerere is simple but effective: Whenever a merge conflict occurs, Rerere automatically records a <em>pre-image</em>, an image of the conflict file including markers.
In the case of the example above, it would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git merge B</strong>
Auto-merging output.c
CONFLICT (content): Merge conflict in output.c
<strong>Recorded preimage for 'output.c'</strong>
Automatic merge failed; fix conflicts and then commit the result.</pre>
</div>
</div>
<div class="paragraph">
<p>If the conflict is resolved as above and the solution is checked in, Rerere saves the conflict resolution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>vim output.c</strong>
$ <strong>git add output.c</strong>
$ <strong>git commit</strong>
<strong>Recorded resolution for 'output.c'.</strong>
[master 681acc2] Merge branch 'B'</pre>
</div>
</div>
<div class="paragraph">
<p>So far Rerere has not really helped.
But now we can delete the merge commit completely (and are back to the situation before the merge).
Then we execute the merge again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git reset --hard HEAD^</strong>
HEAD is now at f894659 wrap output at 72 chars
$ <strong>git merge B</strong>
Auto-merging output.c
CONFLICT (content): Merge conflict in output.c
<strong>Resolved 'output.c' using previous resolution.</strong>
Automatic merge failed; fix conflicts and then commit the result.</pre>
</div>
</div>
<div class="paragraph">
<p>Rerere notices that the conflict is known and that a solution has already been found.&#8288;<sup class="footnote">[<a id="_footnoteref_44" class="footnote" href="#_footnotedef_44" title="View footnote.">44</a>]</sup>
So Rerere calculates a 3-way-merge between the saved pre-image, the saved solution and the version of the file in the working tree.
This way Rerere can resolve not only the same conflicts, but also <em>similar</em> ones (if in the meantime further lines outside the conflict area have been changed).</p>
</div>
<div class="paragraph">
<p>The result is <em>not</em> directly added to the index.
The solution is simply copied to the file.
You can then use <code>git diff</code> to check whether the solution looks useful, run tests if necessary, etc.
If everything looks good, you can use the automatic solution via <code>git add</code> as usual.</p>
</div>
<div class="sect4">
<h5 id="sec.rerere-explained"><a class="anchor" href="#sec.rerere-explained"></a>3.4.2.1. Why Rerere Makes Sense</h5>
<div class="paragraph">
<p>One might object: Who voluntarily takes the risk of deleting an already (possibly costly) resolved merge conflict in order to want to repeat it at some point?</p>
</div>
<div class="paragraph">
<p>However, the procedure is desirable: First of all, it <em>doesn&#8217;t</em> make sense to simply periodically and out of habit merge the mainline&#8201;&#8212;&#8201;i.e. the main development thread, e.g. <code>master</code>&#8201;&#8212;&#8201;into the topic branch (we will come back to this later).
But if you have a long-lived topic branch and want to test it occasionally to see if it is compatible with the mainline, you don&#8217;t want to resolve the conflicts by hand every time&#8201;&#8212;&#8201;once resolved, Rerere will resolve conflicts automatically.
This way you can successively develop your feature, knowing that it is in conflict with the mainline.
But at the time of the integration of the feature the conflicts are all automatically resolvable (because you have occasionally saved conflict solutions with Rerere).</p>
</div>
<div class="paragraph">
<p>In addition, Rerere is also called automatically in conflict cases that arise in a rebase process (see <a href="#sec.rebase">Section 4.1, &#8220;Move commits - Rebase&#8221;</a>).
Again, once conflicts have been resolved, they can be automatically resolved again.
Once you have merged a branch into the mainline for test purposes and resolved a conflict, this solution is automatically applied when you rebuild this branch on the mainline via rebase.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.rerere-usage"><a class="anchor" href="#sec.rerere-usage"></a>3.4.2.2. Using Rerere</h5>
<div class="paragraph">
<p>In order for the Rere functionality to be used, you must set the <code>rerere.enabled</code> option to <code>true</code>, as mentioned above.
Rerere will then be called automatically when a merge conflict occurs (to capture the pre-image, possibly to resolve the conflict) and when a conflict resolution is checked in (to save the resolution).</p>
</div>
<div class="paragraph">
<p>Rerere stores information such as pre-image and resolution in <code>.git/rr-cache/</code>, uniquely identified by a SHA-1 sum.
You almost never need to call the <code>git rerere</code> subcommand, as it is already handled by <code>merge</code> and <code>commit</code>.
You can also use <code>git rerere gc</code> to delete very old solutions.</p>
</div>
<div class="paragraph">
<p>What happens if a wrong conflict resolution was checked in?
Then you should delete the conflict resolution, otherwise Rerere will reapply the solution when you repeat the conflicted merge.
To do this, there is the command <code>git rerere forget &lt;file&gt;</code>&#8201;&#8212;&#8201;directly after Rerere has checked in a wrong solution, you can delete the wrong solution in this way and restore the original state of the file (i.e. with conflict markers).
If you only want to do the latter, a <code>git checkout -m &lt;file&gt;</code> will also help.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.avoid-conflicts"><a class="anchor" href="#sec.avoid-conflicts"></a>3.4.3. Avoiding Conflicts</h4>
<div class="paragraph">
<p>Decentralized version control systems generally manage merges much better than central ones.
This is mainly due to the fact that it is common practice in decentralized systems to check in many small changes <em>locally</em> first.
This avoids &#8220;monster commits&#8221;, which offer much more potential for conflict.
This finer granular development history and the fact that merges are usually data in the version history (as opposed to simply copying the lines of code) mean that decentralized systems do not have to look at the mere contents of files when merging.</p>
</div>
<div class="paragraph">
<p>Prevention is the best way to minimize merge conflicts.
Make small commits!
Combine your changes so that the resulting commit makes sense as a unit.
Always build Topic Branches on the latest release.
Merge from topic branches into &#8220;collection branches&#8221; or directly into <code>master</code>, not the other way around.&#8288;<sup class="footnote">[<a id="_footnoteref_45" class="footnote" href="#_footnotedef_45" title="View footnote.">45</a>]</sup>
Using Rerere prevents conflicts that have already been resolved from constantly reoccurring.</p>
</div>
<div class="paragraph">
<p>Obviously, good communication among developers is also important for prevention: If several developers implement different and mutually influencing changes to the same function, this will certainly lead to conflicts sooner or later.</p>
</div>
<div class="paragraph">
<p>Another factor that unfortunately often leads to unnecessary(!) conflicts is autogenerated content.
Suppose you write the documentation of a software in <em>AsciiDoc</em>&#8288;<sup class="footnote">[<a id="_footnoteref_46" class="footnote" href="#_footnotedef_46" title="View footnote.">46</a>]</sup> or work on a LaTeX project with several contributors: Never add the compiled man pages or the compiled DVI/PS/PDF to the repository!
In the autogenerated formats, small changes to the plaintext (i.e. in the Ascii or LaTeX version) can cause large (and unpredictable) changes to the compiled formats that Git will not resolve adequately.
Instead, it makes sense to provide appropriate Makefile targets or scripts to generate the files, and possibly keep the compiled version on a separate branch.&#8288;<sup class="footnote">[<a id="_footnoteref_47" class="footnote" href="#_footnotedef_47" title="View footnote.">47</a>]</sup></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.cherry-pick"><a class="anchor" href="#sec.cherry-pick"></a>3.5. Taking over Individual Commits: Cherry Pick</h3>
<div class="paragraph">
<p>It will happen that you don&#8217;t want to integrate an entire branch directly, but rather parts, i.e. individual commits, first.
The <code>cherry-pick</code> (&#8220;pick the good cherries&#8221;) git command is responsible for this.</p>
</div>
<div class="paragraph">
<p>The command expects one or more commits to be copied to the current branch.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git cherry-pick d0c915d</strong>
$ <strong>git cherry-pick topic~5 topic~1</strong>
$ <strong>git cherry-pick topic~5..topic~1</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The middle command copies two explicitly specified commits; the last command, on the other hand, copies all commits belonging to the specified commit range.</p>
</div>
<div class="paragraph">
<p>Unlike a merge, however, only the changes are integrated, not the commit itself.
To do this, it would have to reference its predecessor, so that the predecessor would also have to be integrated, and so on, which is equivalent to a merge.
So when you take over commits with <code>cherry-pick</code>, <em>new</em> commits are created with a new commit ID.
Git <em>can&#8217;t</em> know that these commits are actually the same.</p>
</div>
<div class="paragraph">
<p>So if you are merging two branches that you have cherry-picked changes between, conflicts can occur.&#8288;<sup class="footnote">[<a id="_footnoteref_48" class="footnote" href="#_footnotedef_48" title="View footnote.">48</a>]</sup>
These are usually trivial to resolve, and the strategy options <code>ours</code> and <code>theirs</code> might be helpful (see <a href="#sec.recursive-options">Section 3.3.4, &#8220;Options for the Recursive Strategy&#8221;</a>).
The rebase command, on the other hand, recognizes such commit duplications,&#8288;<sup class="footnote">[<a id="_footnoteref_49" class="footnote" href="#_footnotedef_49" title="View footnote.">49</a>]</sup> and omits the duplicated commits.
This allows you to take some commits &#8220;from the middle&#8221; and then rebuild the branch the commits came from.</p>
</div>
<div class="paragraph">
<p>The <code>cherry-pick</code> command also understands these merge strategy options itself: If you want to copy a commit to the current branch, and if you want to make sure the new commit is right in case of conflict, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git cherry-pick -Xtheirs &lt;commit&gt;</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>-n or</code> <code>--no-commit</code> option tells Git to commit the changes from a commit to the index, but not to make a commit yet.
This allows you to &#8220;aggregate&#8221; several small commits into the index first, and then package them as <em>one</em> commit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git cherry-pick -n 785aa39 512f3e9 4e4a063</strong>
Finished one cherry-pick.
Finished one cherry-pick.
Finished one cherry-pick.
$ <strong>git commit -m "Diverse kleine Änderungen"</strong></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec.visualization"><a class="anchor" href="#sec.visualization"></a>3.6. Visualizing Repositories</h3>
<div class="paragraph">
<p>When you have created and merged some branches, you will have noticed that the following is the case: it&#8217;s easy to lose track.</p>
</div>
<div class="paragraph">
<p>The arrangement of commits and their relationships to each other is called the <em>topology</em> of a repository.
In the following, we will introduce the graphical program <code>gitk</code>, among other things, to examine these topologies.</p>
</div>
<div class="paragraph">
<p>For small repositories, first call <code>gitk --all</code>, which displays the entire repository as a graph.
Clicking on the individual commits displays the meta-information as well as the generated patch.</p>
</div>
<div class="sect3">
<h4 id="rev-list"><a class="anchor" href="#rev-list"></a>3.6.1. Revision Parameters</h4>
<div class="paragraph">
<p>Since the listing of multiple commits is hard to keep track of, we examine a small sample repository with several branches merged together:</p>
</div>
<div id="fig.rev-list-graph" class="imageblock">
<div class="content">
<img src="images/revision-list-commit-graph-gitk.png" alt="revision list commit graph gitk" width="90%">
</div>
<div class="title">Figure 20. The graph of commits as displayed in <code>gitk</code></div>
</div>
<div class="paragraph">
<p>We recognize four branches (A-D) and one tag <code>release</code>.
We can also display this tree on the console with the appropriate command line options using the <code>log</code> command (branch and tag names are printed in semi-bold for better distinction):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log --decorate --pretty=oneline --abbrev-commit --graph --all</strong>
* c937566 (<strong>HEAD</strong>, <strong>D</strong>) commit on branch D
| *   b0b30ef (<strong>release</strong>, <strong>A</strong>) Merge branch 'C' into A
| |\
| | * 807db47 (<strong>C</strong>) commit on branch C
| | * 996a53b commit on branch C
| |/
|/|
| * 83f6bf3 commit on branch A
| *   5b2c291 Merge branch 'B' into A
| |\
| | * 2417cf7 (<strong>B</strong>) commit on branch B
| |/
|/|
| * 0bf1433 commit on branch A
|/
* 4783886 initial commit</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The output of the <code>log</code> command is equivalent to the view in Gitk.
However, <code>git log</code> is much faster than Gitk and does not require another program window.</p>
</div>
<div class="paragraph">
<p>So for a quick overview, it&#8217;s much more convenient to set up an alias that automatically adds the many long options.
The authors use the alias <code>tree</code> for this, which you can define as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global alias.tree \'log --decorate \</strong>
   <strong>--pretty=oneline --abbrev-commit --graph'</strong></pre>
</div>
</div>
<div class="paragraph">
<p>By using <code>git tree --all</code> you get an ASCII version of the graph of the git repository.
In the following, we use this alias to represent the topology.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now we change the above command: instead of the <code>--all</code> option, which puts all commits in the tree, we now specify <code>B</code> (the name of the branch)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tree B</strong>
* 2417cf7 (<strong>B</strong>) commit on branch B
* 4783886 initial commit</pre>
</div>
</div>
<div class="paragraph">
<p>We receive all commits that are accessible from B.
A commit only knows its predecessor(s) (several if branches are merged).
&#8220;All commits reachable from B&#8221; thus refers to the list of commits from B onwards, up to a commit that has no predecessor (called a <em>root commit</em>).</p>
</div>
<div class="paragraph">
<p>Instead of one, the command can also accept multiple references.
So to get the same output as with the <code>--all</code> option, you must specify references A, B, and D.
C can be omitted because the commit is already &#8220;collected&#8221; on the way from A to the root commit.</p>
</div>
<div class="paragraph">
<p>Of course, you can also specify an SHA-1 sum directly instead of symbolic references:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tree 5b2c291</strong>
*   5b2c291 Merge branch 'B' into A
|\
| * 2417cf7 (<strong>B</strong>) commit on branch B
* | 0bf1433 commit on branch A
|/
* 4783886 initial commit</pre>
</div>
</div>
<div class="paragraph">
<p>If a reference is preceded by a caret (<code>^</code>), this negates the meaning.&#8288;<sup class="footnote">[<a id="_footnoteref_50" class="footnote" href="#_footnotedef_50" title="View footnote.">50</a>]</sup>
So the notation <code>^A</code> means: <em>not</em> the commits that are accessible from A.
However, this switch only excludes these commits, but not the others.
So the above log command with the argument <code>^A</code> will not output anything, because Git only knows which commits should <em>not</em> be displayed.
So again, we add <code>--all</code> to list all commits, minus those that are accessible from A:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tree --all ^A</strong>
* c937566 (<strong>HEAD</strong>, <strong>D</strong>) commit on branch D</pre>
</div>
</div>
<div class="paragraph">
<p>An alternative notation is available with <code>--not</code>: Instead of <code>^A</code> you can also write <code>--not A</code>.</p>
</div>
<div class="paragraph">
<p>Such commands are especially useful for examining the <em>difference</em> between two branches: Which commits are in branch D that are not in A?
The command returns the answer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tree D ^A</strong>
* c937566 (<strong>HEAD</strong>, <strong>D</strong>) commit on branch D</pre>
</div>
</div>
<div class="paragraph">
<p>Because this question is often asked, there is another, more intuitive notation for it: <code>A..D</code> is equivalent to <code>D ^A</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tree A..D</strong>
* c937566 (<strong>HEAD</strong>, <strong>D</strong>) commit on branch D</pre>
</div>
</div>
<div class="paragraph">
<p>Of course the order is important here: &#8220;D without A&#8221; is a different set of commits than &#8220;A without D&#8221;!
(Compare also the complete graph.)</p>
</div>
<div class="paragraph">
<p>In our example there is a tag <code>release</code>.
To check which commits from branch D (which could stand for &#8220;Development&#8221;) are not yet included in the current release, simply specify <code>release..D</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The syntax <code>A..B</code> can be remembered as the idiom &#8220;from A to B&#8221;.
However, this &#8220;difference&#8221; is not symmetrical, i.e. <code>A..B</code> are usually not the same commits as <code>B..A</code>.</p>
</div>
<div class="paragraph">
<p>Alternatively, Git provides the <em>symmetrical difference</em> <code>A..B</code>.
It is equivalent to the argument <code>A B --not $(git merge-base A B)</code>, so it includes all the commits that can be reached from A <em>or</em> B, but not both.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="rev-list-explained"><a class="anchor" href="#rev-list-explained"></a>3.6.1.1. Reference vs. List of References</h5>
<div class="paragraph">
<p>In the example, A always refers to all commits that are accessible from A.
But actually a branch is just a reference to a <em>single</em> commit.
So why does <code>log</code> always list all commits reachable from A, while the git command <code>show</code> with the argument A only shows this one commit?</p>
</div>
<div class="paragraph">
<p>The difference is what the commands expect as an argument: <code>show</code> expects an <em>object</em>, that is, a reference to a <em>single</em> object, which is then displayed.&#8288;<sup class="footnote">[<a id="_footnoteref_51" class="footnote" href="#_footnotedef_51" title="View footnote.">51</a>]</sup>
Many other commands expect one (or more) commits instead, and these commands convert the arguments into a list of commits (traversing the list until the root commit).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.gitk"><a class="anchor" href="#sec.gitk"></a>3.6.2. Gitk</h4>
<div class="paragraph">
<p>Gitk is a graphical program implemented in Tcl, which is usually packaged by distributors along with the actual Git commands&#8201;&#8212;&#8201;so you can be sure to find it on almost any system.</p>
</div>
<div class="paragraph">
<p>It represents individual commits or the entire repository in a three-part view: at the top is the tree structure with two additional columns for author and date, below is a list of changes in unified diff format, and a list of files to restrict the changes displayed.</p>
</div>
<div class="paragraph">
<p>The graph view is intuitive: Different colors help to distinguish the different version strings.
Commits are always blue dots, with two exceptions: The <code>HEAD</code> is highlighted in yellow, and a commit that is not a root commit, but whose predecessor is not displayed, is shown in white.</p>
</div>
<div class="paragraph">
<p>Branches with an arrowhead indicate that further commits have been made on the branch.
However, Gitk hides the branch due to the time distance between commits.
A click on the arrowhead will take you to the continuation of the branch.</p>
</div>
<div class="paragraph">
<p>Branches appear as green labels, the currently checked out branch additionally bold.
Tags are shown as yellow arrows.</p>
</div>
<div class="paragraph">
<p>You can delete or check out a branch with a right click on it.
Right-clicking on commits opens a menu in which you can perform actions on the selected commit.
The only thing that might be easier to do with Gitk than from the command line is <em>cherry picking</em>, i.e. transferring individual commits to another branch (see also <a href="#sec.cherry-pick">Section 3.5, &#8220;Taking over Individual Commits: Cherry Pick&#8221;</a>).</p>
</div>
<div id="fig.gitk" class="imageblock">
<div class="content">
<img src="images/gitk.png" alt="gitk" width="90%">
</div>
<div class="title">Figure 21. Complex topology in Gitk</div>
</div>
<div class="paragraph">
<p>Gitk accepts essentially the same options as <code>git log</code>.
Some examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>gitk --since=yesterday -- doc/</strong>
$ <strong>gitk e13404a..48effd3</strong>
$ <strong>gitk --all -n 100</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The first command shows all commits since yesterday that have made changes to a file under the <code>doc/</code> directory.
The second command limits the commits to a specific range, while the third command shows the 100 most recent commits from all branches.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Experience shows that beginners are often confused because <code>gitk</code> by default only shows the current branch.
This is probably because <code>gitk</code> is often called to get an overview of all branches.
Therefore the following shell alias is useful: <code>alias gik='gitk --all'</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Many users leave <code>gitk</code> open during work.
Then it&#8217;s important to update the display from time to time so that more recent commits appear.
With <kbd>F5</kbd> (<em>Update</em>) you load all new commits and refresh the display of the references.
Sometimes, however, if you delete a branch, for example, this is not enough.
Although the branch is no longer displayed, there may still be unreachable commits in the GUI as artifacts.
The key combination <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>F5</kbd></span> (<em>Reload</em>) completely reloads the repository, which solves the problem.</p>
</div>
<div class="paragraph">
<p>As an alternative to <code>gitk</code>, you can use the GTK-based <code>gitg</code> or Qt-based <code>qgit</code> on UNIX systems; on an OS X system, for example, you can use <em>GitX</em>; for Windows, you can use <em>GitExtensions</em>.
Some IDEs now also have corresponding visualizations (e.g. the <em>Eclipse</em> plugin <em>EGit</em>).
Furthermore, you can use full-fledged Git clients like <em>Atlassian SourceTree</em> (OS X, Windows; free of charge), <em>Tower</em> (OS X; commercial) as well as <em>SmartGit</em> (Linux, OS X and Windows; free for non-commercial use).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.reflog"><a class="anchor" href="#sec.reflog"></a>3.7. Reflog</h3>
<div class="paragraph">
<p>The <em>Reference Log</em> (<em>Reflog</em>) are log files that Git creates for each branch and <code>HEAD</code>.
They store when a reference was moved from where to where.
This happens especially with the <code>checkout</code>, <code>reset</code>, <code>merge</code> and <code>rebase</code> commands.</p>
</div>
<div class="paragraph">
<p>These log files are stored under <code>.git/logs/</code> and are named after the reference.
The reflog for the <code>master</code> branch can be found under <code>.git/logs/refs/heads/master</code>.
There is also the command <code>git reflog show &lt;reference&gt;</code> to list the reflog:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git reflog show master</strong>
48effd3 master@{0}: HEAD^: updating HEAD
ef51665 master@{1}: rebase -i (finish): refs/heads/master onto 69b9e27
231d0a3 master@{2}: merge @{u}: Fast-forward
...</pre>
</div>
</div>
<div class="paragraph">
<p>The Reflog command is rarely used directly and is just an alias for <code>git log -g --oneline</code>.
In fact, the <code>-g</code> option causes the command not to show the predecessors in the commit graph, but to process the commits in the order in which they were reflogged.</p>
</div>
<div class="paragraph">
<p>You can easily try this: Create a test commit, then delete it again with <code>git reset --hard HEAD^</code>.
The command <code>git log -g</code> will now first show the <code>HEAD</code>, then the deleted commit, and then the <code>HEAD</code> again.</p>
</div>
<div class="paragraph">
<p>The reflog thus also references commits that are otherwise no longer referenced, i.e. are &#8220;lost&#8221; (see <a href="#sec.branch-management">Section 3.1.2, &#8220;Managing Branches&#8221;</a>).
The reflog might help you if you have deleted a branch that you would have needed after all.
Although a <code>git branch -D</code> also deletes the branch&#8217;s reflog.
However, you had to check out the branch to commit to it, so use <code>git log -g HEAD</code> to find the last time you checked out the branch you were looking for.
Then create a branch that points to this (seemingly lost) commit ID, and your lost commits should be back.&#8288;<sup class="footnote">[<a id="_footnoteref_52" class="footnote" href="#_footnotedef_52" title="View footnote.">52</a>]</sup></p>
</div>
<div class="paragraph">
<p>Commands that expect one or more references can also implicitly use Reflog.
In addition to the syntax already found in the output of <code>git log -g</code> (e.g. <code>HEAD@{1}</code> for the previous position of the HEAD), Git also understands <code>&lt;ref&gt;@{&lt;when&gt;}</code>.
Git interprets the time <code>&lt;when&gt;</code> as an absolute or relative date and then consults the reflog of the corresponding reference to find out what the next log entry in time is.
This is then referenced.</p>
</div>
<div class="paragraph">
<p>Two examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log 'master@{two weeks ago}..'</strong>
$ <strong>git show '@{1st of April, 2011}'</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The first command lists all commits between <code>HEAD</code> and the commit the <code>master</code> branch pointed to two weeks ago (note the suffix <code>..</code> which means a commit range up to <code>HEAD</code>).
This doesn&#8217;t necessarily have to be a commit that is two weeks old: if you test moved the branch to the very first commit in the repository two weeks ago using <code>git reset --hard &lt;initial-commit&gt;</code>, then that very commit will be referenced.&#8288;<sup class="footnote">[<a id="_footnoteref_53" class="footnote" href="#_footnotedef_53" title="View footnote.">53</a>]</sup></p>
</div>
<div class="paragraph">
<p>The second line shows the commit to which the currently checked out branch (due to missing explicit reference before the <code>@</code>) pointed on April 1, 2011.
In both commands, the argument with a Reflog attachment must be enclosed in quotation marks to make sure Git gets the argument completely.</p>
</div>
<div class="paragraph">
<p>Note that the reflog is <em>only</em> available locally and therefore does not belong to the repository.
If you send a commit ID or tag name to another developer, it references the same commit, but a <code>master@{yesterday}</code> can reference <em>different</em> commits depending on the developer.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you don&#8217;t specify a branch and time, Git will assume <code>HEAD</code>.
This allows you to use <code>@</code> as the short form for <code>HEAD</code> in commands.
Furthermore, many commands understand the argument <code>-</code> as <code>@{-1}</code>, which is &#8220;last position of <code>HEAD</code>&#8221;:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout feature</strong>   # vorher auf "master"
$ <strong>git commit ...</strong>         # Änderungen, Commits machen
$ <strong>git checkout -</strong>         # zurück auf "master"
$ <strong>git merge -</strong>            # Merge von "feature"</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch.advanced"><a class="anchor" href="#ch.advanced"></a>4. Advanced Concepts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following chapter covers selected advanced concepts.
The focus is on the Rebase command with its many applications.
We find out who changed a line in the source code (<em>Blame</em>) and when, and how to tell Git to ignore files and directories.
We&#8217;ll also look at how to stash changes to the working tree and annotate commits (<em>Notes</em>).
Finally, we show you how to quickly and automatically find commits that introduce a bug (<em>Bisect</em>).</p>
</div>
<div class="sect2">
<h3 id="sec.rebase"><a class="anchor" href="#sec.rebase"></a>4.1. Move commits - Rebase</h3>
<div class="paragraph">
<p>In the section on Git&#8217;s internals, we mentioned earlier that you can move and modify commits in a Git repository (graphically speaking) at will.
In practice, this is made possible primarily by the git command <code>rebase</code>.
This command is very powerful and important, but sometimes a bit more demanding to use.</p>
</div>
<div class="paragraph">
<p><em>Rebase</em> is an artificial word which means &#8220;to put something on a new basis&#8221;.
What it means is that a group of commits is moved around within the commit graph, building commit after commit based on another node.
The following graphics illustrate how this works:</p>
</div>
<div id="fig.rebase-before" class="imageblock text-center">
<div class="content">
<img src="images/rebase-before.svg" alt="rebase before" width="90%">
</div>
<div class="title">Figure 22. Before the rebase</div>
</div>
<div id="fig.rebase-after" class="imageblock text-center">
<div class="content">
<img src="images/rebase-after.svg" alt="rebase after" width="90%">
</div>
<div class="title">Figure 23. &#8230;&#8203;and after that</div>
</div>
<div class="paragraph">
<p>In its simplest form the command is <code>git rebase &lt;reference&gt;</code> (in the above diagram: <code>git rebase master</code>).
This means that Git first marks all commits <code>&lt;reference&gt;..HEAD</code>, i.e. the commits that can be reached from <code>HEAD</code> (the current branch) minus the commits that can be reached from <code>&lt;reference&gt;</code> - in other words, everything that is in the current branch but not in <code>&lt;reference&gt;</code>.
In the diagram, these are E and F.</p>
</div>
<div class="paragraph">
<p>The list of these commits is stored temporarily.
Git then checks out the commit <code>&lt;reference&gt;</code> and copies the individual cached commits in the original order as new commits to the branch.</p>
</div>
<div class="paragraph">
<p>There are a few points to consider:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Because the first node of the topic branch (E) now has a new predecessor (D), its metadata and thus its SHA-1 sum changes (it becomes E_).
The second commit (F) then also has a different predecessor (E_ instead of E), its SHA-1 sum changes (it becomes F_) and so on - this is also called the <em>ripple effect</em>.
Overall, <em>all</em> copied commits will have new SHA-1 sums - so they&#8217;re the same (in terms of changes), but not identical.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Such an action, just like a merge operation, can result in conflicting changes.
Git can partially resolve them automatically, but aborts with an error message if the conflicts are not trivial.
The rebase process can then either be &#8220;repaired&#8221; and continued, or aborted (see below).</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>If no other reference points to node F, it will be lost, because reference HEAD (and the corresponding branch, if applicable) will be <em>shifted</em> to node F_ in case of a successful rebase.
So if F has no more reference (and no predecessors referencing F), Git can no longer find the node, and the tree &#8220;disappears&#8221;.
If you&#8217;re not sure whether you need the original tree again, you can simply reference it with the <code>tag</code> command, for example.
In that case, the commits will be preserved even after a rebase (but then in duplicate at different places in the commit graph).</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="sec.rebase-bsp"><a class="anchor" href="#sec.rebase-bsp"></a>4.1.1. An example</h4>
<div class="paragraph">
<p>Consider the following situation:
The <code>sqlite-support</code> branch branches off from the &#8220;fixed a bug&#8230;&#8203;&#8221; commit.
But the <code>master</code> branch has already moved on, and a new 1.4.2 release has been made.</p>
</div>
<div id="fig.screenshot-rebase-before" class="imageblock">
<div class="content">
<img src="images/screenshot-rebase-vorher.png" alt="screenshot rebase vorher" width="90%">
</div>
<div class="title">Figure 24. Before the rebase</div>
</div>
<div class="paragraph">
<p>Now <code>sqlite-support</code> is checked out and rebuilt to <code>master</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout sqlite-support</strong>
$ <strong>git rebase master</strong>
First, rewinding head to replay your work on top of it...
Applying: include sqlite header files, prototypes
Applying: generalize queries
Applying: modify Makefile to support sqlite</pre>
</div>
</div>
<div class="paragraph">
<p>Rebase applies the three changes introduced by commits from the <code>sqlite-support</code> branch to the <code>master</code> branch.
After that, the repository looks like this in Gitk:</p>
</div>
<div id="fig.screenshot-rebase-after" class="imageblock">
<div class="content">
<img src="images/screenshot-rebase-nachher.png" alt="screenshot rebase nachher" width="90%">
</div>
<div class="title">Figure 25. After rebase</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.rebase-extended"><a class="anchor" href="#sec.rebase-extended"></a>4.1.2. Extended syntax and conflicts</h4>
<div class="paragraph">
<p>Normally <code>git rebase</code> will always build the branch you are currently working on on a new one.
However, there is a shortcut:
If you want to base <code>topic</code> on <code>master</code>, but you are on a completely different branch, you can do this via</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git rebase master topic</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Git does the following internally:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout topic</strong>
$ <strong>git rebase master</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Please note the (unfortunately not very intuitive) order:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git rebase &lt;on which&gt; &lt;what&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>A rebase can lead to conflicts.
The process then stops with the following error message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git rebase master</strong>
...
CONFLICT (content): Merge conflict in &lt;datei&gt;
Failed to merge in the changes.
Patch failed at ...
The copy of the patch that failed is found in:
   .../.git/rebase-apply/patch

When you have resolved this problem, run "git rebase --continue".
If you prefer to skip this patch, run "git rebase --skip" instead.
To check out the original branch and stop rebasing, run "git rebase --abort".</pre>
</div>
</div>
<div class="paragraph">
<p>You proceed as with a regular merge conflict (see <a href="#sec.merge-conflicts">Section 3.4, &#8220;Resolving Merge Conflicts&#8221;</a>) - <code>git mergetool</code> is very helpful here.
Then simply add the changed file via <code>git add</code> and let the process continue via <code>git rebase --continue</code>.&#8288;<sup class="footnote">[<a id="_footnoteref_54" class="footnote" href="#_footnotedef_54" title="View footnote.">54</a>]</sup></p>
</div>
<div class="paragraph">
<p>Alternatively, the problematic commit can be skipped using the <code>git rebase --skip</code> command.
The commit is then lost unless it is referenced in another branch somewhere else!
So you should only perform this action if you are certain that the commit is obsolete.</p>
</div>
<div class="paragraph">
<p>If none of this helps (e.g. if you can&#8217;t solve the conflict at that point, or if you realize that you are rebuilding the wrong tree), pull the emergency brake: <code>git rebase --abort</code>.
This will discard all changes to the repository (including successfully copied commits), so that the state afterwards is exactly the same as it was when the rebase process was started.
The command also helps if at some point you forget to finish a rebase process, and other commands complain that they can&#8217;t do their job because a rebase is in progress.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.rebase-sense"><a class="anchor" href="#sec.rebase-sense"></a>4.1.3. Why rebase makes sense</h4>
<div class="paragraph">
<p>Rebase is primarily useful for keeping the commit history of a project simple and easy to understand.
For example, a developer might be working on a feature, but then have something else to do for a few weeks.
Meanwhile, however, development on the project has progressed, there&#8217;s been a new release, etc.
Only now does the developer get to finish a feature.
(Even if you want to send patches via email, rebase helps to avoid conflicts, see <a href="#sec.patch-queue">Section 5.9, &#8220;Patches via E-mail&#8221;</a>.)</p>
</div>
<div class="paragraph">
<p>For the version history it is now much more logical if his feature was not &#8220;dragged along&#8221; unfinished for a long period of time alongside the actual development, but if the development branches off from the last stable release.</p>
</div>
<div class="paragraph">
<p>Rebase is good for exactly this change in history:
The developer can now simply enter the command <code>git rebase v1.4.2</code> on the branch where he developed the feature, to rebuild his feature branch on the commit with the release tag <code>v1.4.2</code>.
This makes it much easier to see what differences the feature really brings to the software.</p>
</div>
<div class="paragraph">
<p>It also happens to every developer in the heat of the moment that commits end up in the wrong branch.
There is a bug that happens to be there, which is quickly fixed by a commit; but then a test must be written directly to avoid this bug in the future (another commit), and this must be noted in the documentation.
After the actual work is done, you can use Rebase to &#8220;transplant&#8221; those commits to another location in the commit graph.</p>
</div>
<div class="paragraph">
<p>Rebase can also be useful if a branch requires a feature that has only recently been incorporated into the software.
A <em>merge</em> of the <code>master</code> branch does not make sense semantically, because then these and other changes are inseparably merged with the feature branch.
Instead, you rebase the branch on a new commit that already contains the required feature, and then use that in further development.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.rebase-vs-merge"><a class="anchor" href="#sec.rebase-vs-merge"></a>4.1.4. When rebase is <em>not</em> useful - rebase vs. merge</h4>
<div class="paragraph">
<p>The concept of rebase is initially a little difficult to understand.
But once you have understood what is possible with it, the question arises:
What is the point of a simple merge if you can edit everything with rebase?</p>
</div>
<div class="paragraph">
<p>When git-rebase is not used, or hardly used at all, a project history often develops that becomes relatively unmanageable, because merges have to be performed constantly and for a few commits at a time.</p>
</div>
<div class="paragraph">
<p>If, on the other hand, too much rebase is used, there is a danger that the entire project will be senselessly linearized:
The flexible branching of Git is used for development, but the branches are then integrated into the publishing branch one after the other (!) like a zip fastener via rebase.
This presents us with two main problems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Logically related commits are no longer recognizable as such.
Since all commits are linear, the development of multiple features is inextricably intertwined.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>The integration of a branch can no longer be easily undone, because identifying those commits that once belonged to a feature branch is only possible manually.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is how you can make the most of Git&#8217;s flexible branching.
The conclusion is that rebase should be used neither too much nor too little.
Both make the project history (in different ways) confusing.</p>
</div>
<div class="paragraph">
<p>In general, you are doing well with the following rules of thumb:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A feature is integrated by <em>merge</em> when it is finished.
It is best to avoid creating a <em>fast forward merge</em> so that the merge commit is preserved as the time of integration.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>While you are developing, you should use rebase frequently (especially interactive rebase, see below).</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Logically separate units should be developed on separate branches - logically related ones possibly on several, which are then merged by rebase (if that makes sense).
The merging of logically separate units is then done by merge.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="sec.rebase-warning"><a class="anchor" href="#sec.rebase-warning"></a>4.1.5. A word of warning</h4>
<div class="paragraph">
<p>As mentioned earlier, a rebase inevitably changes the SHA-1 sums of all commits that are &#8220;rebuilt&#8221;.
If these changes have not yet been published, that is, if a developer has them in a private repository, that&#8217;s not too bad either.</p>
</div>
<div class="paragraph">
<p>But if a branch (e.g. &#160;`master`) is published&#8288;<sup class="footnote">[<a id="_footnoteref_55" class="footnote" href="#_footnotedef_55" title="View footnote.">55</a>]</sup> and later rewritten via rebase, this has unpleasant consequences for all involved:
All branches based on <code>master</code> will now reference the old copy of the <code>master</code> branch that has been rewritten.
So each branch must be rebased to the new <code>master</code> (which in turn changes all commit IDs).
This effect continues, and can be very time-consuming to fix (depending on when such a rebase happens, and how many developers are involved in the project), especially if you&#8217;re new to git.</p>
</div>
<div class="paragraph">
<p>Therefore you should always remember the following rule:</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only edit unpublished commits with the rebase command!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Exceptions are conventions like personal branches or <code>pu</code>.
The latter is an abbreviation for <em>Proposed Updates</em> and is usually a branch where new, experimental features are tested for compatibility.
No one builds their own work on this branch, so it can be rewritten without problems and prior notice.</p>
</div>
<div class="paragraph">
<p>Another possibility is offered by private branches, i.e. those that start with <code>&lt;user&gt;/</code> for example.
If you make an agreement that developers will do their own development on these branches, but always base their features on &#8220;official&#8221; branches, then the developers may rewrite their branches as they wish.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.rebase-cp"><a class="anchor" href="#sec.rebase-cp"></a>4.1.6. Avoid code duplication</h4>
<div class="paragraph">
<p>If a feature is being developed over a long period of time, and parts of the feature are already flowing into a mainstream release (e.g. via <code>cherry-pick</code>), the rebase command will detect these commits and omit them when copying or rebuilding the commits, because the change is already contained in the branch.</p>
</div>
<div class="paragraph">
<p>For example, after a rebase, the new branch consists only of the commits that have not yet been incorporated into the base branch.
This way, commits do not appear twice in the version history of a project.
If the branch had simply been merged, the same commits with different SHA-1 sums would sometimes be present in different places in the commit graph.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.rebase-ps"><a class="anchor" href="#sec.rebase-ps"></a>4.1.7. Manage patch stacks</h4>
<div class="paragraph">
<p>There are situations where there is a vanilla version (&#8220;simplest version&#8221;) of a piece of software and also a certain number of patches applied to it before the vanilla version is shipped.
For example, your company builds software, but before each delivery to the customer, some adjustments have to be made (depending on the customer).
Or you have open source software in use, but have adapted it a bit to your needs - every time a new, official version of the software is released, you have to reapply your changes and then rebuild the software.&#8288;<sup class="footnote">[<a id="_footnoteref_56" class="footnote" href="#_footnotedef_56" title="View footnote.">56</a>]</sup></p>
</div>
<div class="paragraph">
<p>To manage patch stacks, there are some programs that build on top of Git, but give you the convenience of not having to work directly with the rebase command.
For example, <em>TopGit</em>&#8288;<sup class="footnote">[<a id="_footnoteref_57" class="footnote" href="#_footnotedef_57" title="View footnote.">57</a>]</sup> allows You can define dependencies between branches - if something changes in a branch and other branches depend on it, TopGit will rebuild them on demand.
An alternative to TopGit is <em>Stacked Git</em>&#8288;<sup class="footnote">[<a id="_footnoteref_58" class="footnote" href="#_footnotedef_58" title="View footnote.">58</a>]</sup>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.rebase-onto"><a class="anchor" href="#sec.rebase-onto"></a>4.1.8. Restrict rebase with --onto</h4>
<div class="paragraph">
<p>Now, you may have wondered:
<code>git rebase &lt;reference&gt;</code> always copies <em>all</em> commits that are between <code>reference&gt;</code> and <code>HEAD</code>.
But what if you only want to implement part of a branch, to &#8220;transplant&#8221; it, so to speak?
Consider the following situation:</p>
</div>
<div id="fig.rebase-onto-before" class="imageblock text-center">
<div class="content">
<img src="images/rebase-onto-before.svg" alt="rebase onto before" width="90%">
</div>
<div class="title">Figure 26. Before the <code>rebase --onto</code></div>
</div>
<div class="paragraph">
<p>You were developing a feature on the branch <code>topic</code> when you noticed a bug; you created a branch <code>bugfix</code> and found another bug.
Semantically speaking, your branch <code>bugfix</code> has nothing to do with the <code>topic</code> branch. Therefore, it makes sense to branch off from the <code>master</code> branch.</p>
</div>
<div class="paragraph">
<p>But if you now rebuild the branch <code>bugfix</code> using <code>git rebase master</code>, the following happens:
All nodes that are in <code>bugfix</code> but not in <code>master</code> are copied to the <code>master</code> branch in order - that is, nodes D, E, F, and G.
However, D and E are not part of the bugfix at all.</p>
</div>
<div class="paragraph">
<p>This is where the <code>--onto</code> option comes into play:
It allows you to specify a start and end point for the list of commits to be copied.
The general syntax is</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git rebase --onto &lt;on which&gt; &lt;start&gt; &lt;end&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, we only want to build the commits F and G (or also: the commits from <code>topic</code> to <code>bugfix</code>) from the top of <code>master</code>.
Therefore the command is</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git rebase --onto master topic bugfix</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The result looks as expected:</p>
</div>
<div id="fig.rebase-onto-after" class="imageblock text-center">
<div class="content">
<img src="images/rebase-onto-after.svg" alt="rebase onto after" width="90%">
</div>
<div class="title">Figure 27. After the <code>rebase --onto</code></div>
</div>
</div>
<div class="sect3">
<h4 id="sec.rebase-onto-ci-amend"><a class="anchor" href="#sec.rebase-onto-ci-amend"></a>4.1.9. Improving a commit</h4>
<div class="paragraph">
<p>You have learned about the <code>commit --amend</code> command in <a href="#sec.basics">Section 2.1, &#8220;Git Commands&#8221;</a>, which you can use to improve a commit.
However, it only refers to the current (last) commit.
With <code>rebase --onto</code> you can also adjust commits that are further back in the past.</p>
</div>
<div class="paragraph">
<p>First, find the commit you want to edit and create a branch to it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout -b fix-master 21d8691</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Then you make your changes, add changed files with <code>git add</code>, and then correct the commit with <code>git commit --amend --no-edit</code> (the <code>--no-edit</code> option takes meta-information like the description of the old commit and does not offer it again for editing).</p>
</div>
<div class="paragraph">
<p>Now apply all the commits from the <code>master</code> branch from above to your corrected commit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git rebase --onto fix-master 21d8691 master</strong></pre>
</div>
</div>
<div class="paragraph">
<p>This will copy all commits from <code>21d8691</code> (exclusive!) to <code>master</code> (inclusive!).
The faulty commit <code>21d8691</code> is no longer referenced, and therefore no longer appears.
The <code>fix-master</code> branch is now obsolete and can be deleted.</p>
</div>
<div class="paragraph">
<p>An equivalent way to edit a commit is with the <code>edit</code> action in the interactive rebase (see <a href="#sec.rebase-i-edit">Section 4.2.2, &#8220;Edit commits arbitrarily&#8221;</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.rebase-options"><a class="anchor" href="#sec.rebase-options"></a>4.1.10. Fine adjustment of rebase</h4>
<div class="paragraph">
<p>There are situations where you may need to adjust the default <code>git rebase</code> behavior.
First, this is the case when you use <code>rebase</code> to edit a branch that contains merges.
rebase may try to mimic these instead of linearizing the commits.
The <code>-p' or `--preserve-merges</code> option is responsible for this. &#8288;<sup class="footnote">[<a id="_footnoteref_59" class="footnote" href="#_footnotedef_59" title="View footnote.">59</a>]</sup></p>
</div>
<div class="paragraph">
<p>With the <code>-m</code> or <code>--merge</code> option, you can tell <code>git rebase</code> to use merge strategies (see also <a href="#sec.merge-strategies">Section 3.3.3, &#8220;Merging Strategies&#8221;</a>).
When using these strategies, keep in mind that rebase internally commits commit by commit to the new branch via <code>cherry-pick</code>; therefore the roles of <code>ours</code> and <code>theirs</code> are reversed:
<code>theirs</code> refers to the branch you are building on a new base!</p>
</div>
<div class="paragraph">
<p>An interesting use case is therefore the strategy option <code>theirs</code> for the merge strategy <code>recursive</code>:
If conflicts occur, priority is given to changes from the commit being copied.
So such a scenario is useful if you know that there are conflicting changes, but are certain that the changes from the branch you are building are <code>more correct</code> than those from the tree you are building on.
If you rebuild <code>topic</code> to <code>master</code>, such a call would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout topic</strong>
$ <strong>git rebase -m -Xtheirs master</strong></pre>
</div>
</div>
<div class="paragraph">
<p>In cases where the <code>recursive</code> (default) strategy gives preference to changes from commits from <code>topic', you will find a corresponding note `Auto-merging &lt;commit description&gt;</code>.</p>
</div>
<div class="paragraph">
<p>A small, very useful option that rebase passes directly to <code>git apply</code> is <code>--whitespace=fix</code>.
It causes Git to automatically correct whitespace errors (such as trailing spaces).
If you have merge conflicts due to whitespace (for example, due to changed indentation), you can also use the strategy options presented in <a href="#sec.recursive-options">Section 3.3.4, &#8220;Options for the Recursive Strategy&#8221;</a> to have solutions generated automatically (for example, by specifying <code>-Xignore-space-change</code>).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.rebase-i"><a class="anchor" href="#sec.rebase-i"></a>4.2. Rewriting the story - interactive rebase</h3>
<div class="paragraph">
<p>Rebase knows an interactive mode; it is technically implemented in the same way as the normal mode, but the typical use case is quite different, because the interactive rebase allows to rewrite the story, i.e. to edit commits at will (and not just move them).</p>
</div>
<div class="paragraph">
<p>In the interactive rebase you can</p>
</div>
<div class="ulist">
<ul>
<li>
<p>change the order of commits</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>delete commits</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>merge commits</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>split a commit into several ones</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>adjust the description of commits</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>edit commits in any other way you can think of</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You activate the mode with the option <code>i</code> or <code>interactive</code>.
Basically, the rebase process will run exactly as before, but you will get a list of commits that rebase will rewrite before the command starts.
This could look like this, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre><strong>pick e6ec2b6</strong> Fix expected values of setup tests on Windows
<strong>pick 95b104c</strong> t/README: hint about using $(pwd) rather than $PWD in tests
<strong>pick 91c031d</strong> tests: cosmetic improvements to the repo-setup test
<strong>pick 786dabe</strong> tests: compress the setup tests
<strong>pick 4868b2e</strong> Subject: setup: officially support --work-tree without
   --git-dir</pre>
</div>
</div>
<div class="paragraph">
<p>Below this list is a help text that describes what you can do with the listed commits.
Essentially, there are six possible actions for each commit.
You simply write the action at the beginning of the line, before the SHA-1 sum, instead of the standard <code>pick</code> action.
The following are the actions-you can also abbreviate each one by its initial letter, e.g., <code>s</code> for <code>squash</code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>pick</code></dt>
<dd>
<p>&#8220;Use commit&#8221; (default).
Corresponds to the handling of commits in the non-interactive rebase.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>-</code></dt>
<dd>
<p>If you delete a line, the commit is not used (will be lost).</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>reword</code></dt>
<dd>
<p>Adjust the commit description.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>squash</code></dt>
<dd>
<p>merge commit with the previous one; editor is opened to merge the descriptions</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>fixup</code></dt>
<dd>
<p>Like <code>squash</code>, but throws away the description of the commit.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>edit</code></dt>
<dd>
<p>Free editing. You can perform arbitrary actions.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>exec</code></dt>
<dd>
<p>The rest of the line is executed as a command on the shell.
If the command does not end successfully (i.e. with a return value of 0), the rebase stops.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The <code>pick</code> action is the simplest&#8201;&#8212;&#8201;it simply says that you want to use the commit, rebase should take that commit as it is.
The opposite of <code>pick</code> is simply deleting an entire line.
The commit is then lost (like <code>git rebase --skip</code>).</p>
</div>
<div class="paragraph">
<p>If you switch the order of the lines, Git will apply the commits in the newly defined order.
In the beginning, the lines are in the order in which they will be applied later&#8201;&#8212;&#8201;that is, the exact opposite of the order in the tree view!
Note that commits often build on top of each other; therefore, swapping commits will often cause conflicts if the commits make changes on the same files and in the same places.</p>
</div>
<div class="paragraph">
<p>The <code>reword</code> command is handy if you have typos in a commit message and want to correct them (or haven&#8217;t written a detailed one yet and want to do so now).
The rebase process is stopped at the process marked <code>reword</code>, and Git starts an editor that already displays the commit message.
Once you exit the editor (don&#8217;t forget to save!), Git will enter the new description and let the rebase process continue.</p>
</div>
<div class="sect3">
<h4 id="sec.rebase-i-squash"><a class="anchor" href="#sec.rebase-i-squash"></a>4.2.1. Correct small errors: bug squashing</h4>
<div class="paragraph">
<p>The <code>squash</code> and <code>fixup</code> commands allow two or more commits to be merged together.</p>
</div>
<div class="paragraph">
<p>Nobody always writes error-free code immediately.
Often there is a big commit in which you have implemented a new feature; shortly after that, small bugs are found.
What to do? A detailed description of why you forgot to add or remove a line out of carelessness?
Not really useful, and especially annoying for other developers who want to review your code later.
It would be nice to maintain the illusion that the commit was bug-free the first time&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>For every bug you find, make a small commit with a more or less meaningful description.
This could look like this, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log --oneline master..feature</strong>
b5ffeb7 fix feature 1
34c4453 fix feature 2
ac445c6 fix feature 1
ae65efd implement feature 2
cf30f4d implement feature 1</pre>
</div>
</div>
<div class="paragraph">
<p>When some such commits have accumulated, start an interactive rebase process over the last commits.
Simply estimate how many commits you want to work on, and then edit the last five using <code>git rebase -i HEAD~5</code>, for example.</p>
</div>
<div class="paragraph">
<p>In the editor the commits now appear in reverse order compared to the output of <code>git log</code>.
Now arrange the small bugfix commits so that they are <em>below</em> the commit you are fixing.
Then mark the fix commits with <code>squash</code> (or <code>s</code>), like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>pick cf30f4d implement feature 1
<strong>s</strong> ac445c6 fix feature 1
<strong>s</strong> b5ffeb7 fix feature 1
pick ae65efd implement feature 2
<strong>s</strong> 34c4453 fix feature 2</pre>
</div>
</div>
<div class="paragraph">
<p>Save the file and close the editor; the rebase process starts.
Because you selected <code>squash</code>, rebase stops after commits are merged.
The editor will display the commit messages of the merged commits, which you now summarize appropriately.
If you use the keyword <code>fixup</code>, or <code>f</code> for short, instead of <code>squash</code>, the commit message of the commits marked in this way will be thrown away&#8212;&#8203;probably more convenient for this way of working.</p>
</div>
<div class="paragraph">
<p>After the rebase the version history looks much tidier:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log --oneline master..feature</strong>
97fe253 implement feature 2
6329a8a implement feature 1</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It often happens that you want to "`lock" a small change into the last commit you made.
Here the following alias is useful, which is similar to the <code>fixup</code> action:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global alias.fixup "commit --amend --no-edit"</strong></pre>
</div>
</div>
<div class="paragraph">
<p>As mentioned above, the <code>--no-edit</code> option inherits one-to-one the meta-information of the old commit, especially the commit message.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you start the commit message with <code>fixup!</code> or <code>squash!</code> followed by the beginning of the description of the commit you want to fix, you execute the command</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git rebase -i --autosquash master</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The commits marked with <code>fixup!</code> or <code>squash!</code> as above are automatically moved to the correct position and given the action <code>squash</code> or <code>fixup</code>.
This allows you to exit the editor directly, and the commits are merged.
If you frequently work with this option, you can also make this behavior the default for rebase calls by setting a configuration option:
To do this, set the <code>rebase.autosquash</code> setting to <code>true</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.rebase-i-edit"><a class="anchor" href="#sec.rebase-i-edit"></a>4.2.2. Edit commits arbitrarily</h4>
<div class="paragraph">
<p>If you mark a commit with <code>edit</code>, it can be edited as you wish.
rebase will go through the commits sequentially, as in the other cases.
For the commits marked <code>edit</code>, rebase stops and <code>HEAD</code> is set to the corresponding commit.
You can then modify the commit as if it were the most recent in the branch.
Afterwards, you let rebase continue running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>vim ...</strong>
// # Korrekturen vornehmen
# Making corrections
$ <strong>git add ...</strong>
$ <strong>git commit --amend</strong>
$ <strong>git rebase --continue</strong></pre>
</div>
</div>
<div class="sect4">
<h5 id="sec.rebase-split-cmmits"><a class="anchor" href="#sec.rebase-split-cmmits"></a>4.2.2.1. Split commits</h5>
<div class="paragraph">
<p>Every programmer knows this:
Checking in every change in a disciplined and meticulous way is exhausting and often interrupts the workflow.
In practice, this leads to commits that are large and confusing.
But this way, the version history is available to other developers - and to yourself! - and yourself, the changes should be split into as small logical units as possible.</p>
</div>
<div class="paragraph">
<p>By the way, it is not only helpful for developers to proceed this way.
Also the automated debugging using <code>git bisect</code> works better and more accurate the smaller and more useful the commits are (see `<a href="#sec.bisect">Section 4.8, &#8220;Find regressions - git bisect&#8221;</a>).</p>
</div>
<div class="paragraph">
<p>With a little experience, you can split a commit very quickly.
If you frequently produce large commits, the following step should become routine.</p>
</div>
<div class="paragraph">
<p>First you start the rebase process and mark the commit you want to split with <code>edit</code>.
rebase stops there, <code>HEAD</code> points to that commit.</p>
</div>
<div class="paragraph">
<p>You then reset <code>HEAD</code> a commit, but without discarding the changes from <code>HEAD</code> (the commit to be split).
This is done with the <code>reset</code> command (see also <a href="#sec.reset">Section 3.2.3, &#8220;Reset and the Index&#8221;</a>; note that if you still need the commit description, you should copy it first):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git reset HEAD^</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The changes caused by the commit being split are still present in the files, but the index and repository reflect the state of the previous commit.
So you have moved the changes from the commit to be split to the <em>unstaged</em> state (you can verify this by looking at <code>git diff</code> before and after the <code>reset</code> call).</p>
</div>
<div class="paragraph">
<p>Now you can add some lines, create a commit, add more lines, and finally create a third commit for the remaining lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git add -p</strong>
$ <strong>git commit -m "Erster Teil"</strong>
$ <strong>git add -p</strong>
$ <strong>git commit -m "Zweiter Teil"</strong>
$ <strong>git add -u</strong>
$ <strong>git commit -m "Dritter (und letzter) Teil";</strong></pre>
</div>
</div>
<div class="paragraph">
<p>What happens?
You have reset the <code>HEAD</code> by using the reset command.
With each call to <code>git commit</code> you create a new commit, based on the respective <code>HEAD</code>.
Instead of the one big commit (which you threw away with the <code>reset</code> call) you have now put three smaller commits in its place.</p>
</div>
<div class="paragraph">
<p>Now let rebase continue (<code>git rebase --continue</code>) and build the remaining commits from the top of <code>HEAD</code> (which is now the latest of your three commits).</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.blame"><a class="anchor" href="#sec.blame"></a>4.3. Who made these changes? - git blame</h3>
<div class="paragraph">
<p>Like other version control systems, Git has a <code>blame</code> or <code>annotate</code> command that puts the date and author of the last change on all lines in a file.
This allows you to quickly find out, for example, who is responsible for a line of code that causes a problem, or since when the problem has existed.</p>
</div>
<div class="paragraph">
<p>The command <code>annotate</code> is only intended for people who are changing to other formats and has the same functionality as the command <code>blame</code>, but a slightly different output format.
So you should always use <code>blame</code> if in doubt.</p>
</div>
<div class="paragraph">
<p>Useful options are <code>-M</code> to display code shifts, and <code>-C</code> to display code copies.
You can then use the file name in the output to see from which file code may have been copied or moved.
If no file name is displayed, Git couldn&#8217;t find any code moves or copies.
If you use these options, it&#8217;s usually a good idea to suppress the author and date with <code>-s</code> so that the display still fits the screen.</p>
</div>
<div class="paragraph">
<p>From the following output you can see, for example, that the function <code>end_url_with_slash</code> originally came from the file <code>http.c</code>.
The option <code>-L&lt;m&gt;,&lt;n&gt;</code> limits the output to the corresponding lines.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git blame -C -s -L123,135 url.c</strong>
638794cd url.c  123) char *url_decode_parameter_value(const char
 **query)
638794cd url.c  124) {
ce83eda1 url.c  125)    struct strbuf out = STRBUF_INIT;
730220de url.c  126)    return url_decode_internal(query, "&amp;", &amp;out,
 1);
638794cd url.c  127) }
d7e92806 http.c 128)
eb9d47cf http.c 129) void end_url_with_slash(struct strbuf *buf, const
 char *url)
5ace994f http.c 130) {
5ace994f http.c 131)    strbuf_addstr(buf, url);
5ace994f http.c 132)    if (buf-&gt;len &amp;&amp; buf-&gt;buf[buf-&gt;len - 1] != _/_)
5ace994f http.c 133)            strbuf_addstr(buf, "/");
5ace994f http.c 134) }
3793a309 url.c  135)</pre>
</div>
</div>
<div class="sect3">
<h4 id="sec.blame-gui"><a class="anchor" href="#sec.blame-gui"></a>4.3.1. Blame graphically</h4>
<div class="paragraph">
<p>A convenient alternative to <code>git blame</code> on the console is the graphical tool <code>git gui blame</code> (you may need to install the <code>git-gui</code> package for this).</p>
</div>
<div id="fig.git-gui-blame" class="imageblock">
<div class="content">
<img src="images/git-gui-blame.png" alt="git gui blame" width="100%">
</div>
<div class="title">Figure 28. A piece of code, which was moved from another file</div>
</div>
<div class="paragraph">
<p>If you examine a file via <code>git gui blame &lt;file&gt;</code>, the different blocks that originate from different commits are displayed with a grey background.
On the left you see the abbreviated commit ID and the initials of the author.</p>
</div>
<div class="paragraph">
<p>Only when you hover your mouse over such a block does a small popup window appear with information about the commit that changed the lines, possibly with a message stating from which file and which commit this block of code was moved or copied.</p>
</div>
<div class="paragraph">
<p>In code review, people are often interested in how a file actually looked like before a certain change was made.
For this purpose, the graphical blame tool offers the following possibility to go back in the version history:
Right-click on the commit ID of a code block and select <em>Blame Parent Commit</em> from the context menu - now the predecessor of this change is displayed.
You can go back several steps this way.
Use the green arrow in the upper left corner to jump back into the future again.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.ignore"><a class="anchor" href="#sec.ignore"></a>4.4. Ignore files</h3>
<div class="paragraph">
<p>In almost every project there are files that you do not want to version.
Be it the binary output of the compiler, the autogenerated documentation in HTML format or the backup files generated by your editor.
Git offers several levels of ignoring files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>user-specific setting</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>repository-specific setting</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>repository-specific setting, which will be checked in with</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Which option you choose depends entirely on your application.
The user-specific settings should contain files and patterns that are relevant to the user, for example backup files that your editor creates.
Such patterns are usually stored in a file in the <code>$HOME</code> directory.
With the option <code>core.excludesfile</code> you specify which file this should be, e.g. in the case of <code>~/.gitignore</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global core.excludesfile ~/.gitignore</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Certain files and patterns are bound to a project and are valid for each participant, e.g. compiler output and autogenerated HTML documentation.
You store these settings in the file <code>.gitignore</code>, which you check in as normal and thus deliver to all developers.</p>
</div>
<div class="paragraph">
<p>Finally, the <code>.git/info/exclude</code> file can be used for repository-specific settings that should not be delivered with a clone, i.e. settings that are both project and user specific.</p>
</div>
<div class="sect3">
<h4 id="sec.pattern"><a class="anchor" href="#sec.pattern"></a>4.4.1. Syntax for pattern</h4>
<div class="paragraph">
<p>The syntax for patterns is based on the shell syntax:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Blank lines have no effect and can be used for structuring and separating.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Lines starting with a <code>#</code> are considered comments and have no effect.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Expressions beginning with <code>!</code> are evaluated as negation.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Expressions ending with a <code>/</code> are evaluated as directory.
The expression <code>man/</code> covers the directory <code>man</code>, but not the file or symlink with the same name.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Expressions that do not contain a <code>/</code> will be evaluated as shell glob for the current and all subdirectories.
The expression <code>*.zip</code> in the topmost <code>.gitignore</code>, for example, covers all zip files in the project&#8217;s directory structure.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>The expression <code>*</code> covers zero or more files and directories.
Both <code>t/data/set1/store.txt</code> and <code>t/README.txt</code> are covered by the pattern <code>t/*/*.txt</code>.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Otherwise the pattern is evaluated as a shell globe, more precisely as a shell globe evaluated by the function <code>fnmatch(3)</code> with the flag <code>FNM_PATHNAME</code>.
This means that the pattern <code>doc/*html</code> captures <code>doc/index.html</code>, but not <code>doc/api/singleton.html</code>.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Expressions beginning with a <code>/</code> are bound to the path.
For example, the expression <code>/*.sh</code> includes <code>upload.sh</code> but not <code>scripts/check-for-error.sh</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example:&#8288;<sup class="footnote">[<a id="_footnoteref_60" class="footnote" href="#_footnotedef_60" title="View footnote.">60</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cat ~/.gitignore</strong>
# vim swap files
.*.sw[nop]

# python bytecode
*.pyc

# documents
*.dvi
*.pdf

# miscellaneous
*.*~
*.out</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.retroactive-ignore"><a class="anchor" href="#sec.retroactive-ignore"></a>4.4.2. Ignore or version later</h4>
<div class="paragraph">
<p>Files that are already versioned are not automatically ignored.
To ignore such a file anyway, explicitly tell Git to &#8220;forget&#8221; the file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git rm documentation.pdf</strong></pre>
</div>
</div>
<div class="paragraph">
<p>To delete the file with the next commit, but still keep it in the working tree:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git rm --cached documentation.pdf</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Files that are already ignored will not appear in the output of <code>git status</code>.
Also, <code>git add</code> refuses to accept the file; the <code>--force</code> and <code>-f</code> options force Git to consider the file after all:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git add documentation.pdf</strong>
The following paths are ignored by one of your .gitignore files:
documentation.pdf
Use -f if you really want to add them.
fatal: no files added
$ <strong>git add -f documentation.pdf</strong></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.git-clean"><a class="anchor" href="#sec.git-clean"></a>4.4.3. Delete ignored and unknown files</h4>
<div class="paragraph">
<p>The <code>git clean</code> command deletes ignored as well as unknown (so-called <em>untracked</em>) files.
Since files may be irretrievably lost, the command has the <code>--dry-run</code> (or <code>-n</code>) option; it tells you what would be deleted.
As a further precaution, the command refuses to delete anything unless you explicitly pass the <code>--force</code> or <code>-f</code>.&#8288;<sup class="footnote">[<a id="_footnoteref_61" class="footnote" href="#_footnotedef_61" title="View footnote.">61</a>]</sup> option</p>
</div>
<div class="paragraph">
<p>By default, <code>git clean</code> only deletes the unknown files, with <code>-X</code> it only removes the ignored files, and with <code>-x</code> it removes both unknown and ignored files.
With the option <code>-d</code> it additionally deletes directories that come into question.
So to delete unknown as well as ignored files and directories, enter</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clean -dfx</strong></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.stash"><a class="anchor" href="#sec.stash"></a>4.5. Outsource changes - git stash</h3>
<div class="paragraph">
<p>The stash is a mechanism used to temporarily store changes in the working tree that have not yet been saved.
A classic use case: your boss asks you to fix a critical bug as soon as possible, but you have just started to implement a new feature.
With the <code>git stash</code> command, you can temporarily <code>clean out</code> the unfinished lines without creating a commit, and thus address the bug with a clean working tree.
The stash also provides a workaround if you cannot change the branch because this would result in losing changes (see also <a href="#sec.branch-management">Section 3.1.2, &#8220;Managing Branches&#8221;</a>).</p>
</div>
<div class="sect3">
<h4 id="sec.stash-benutzung"><a class="anchor" href="#sec.stash-benutzung"></a>4.5.1. Basic usage</h4>
<div class="paragraph">
<p>With <code>git stash</code> you save the current state of working tree and index, if they differ from <code>HEAD</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git stash</strong>
Saved working directory and index state WIP on master: b529e34 new spec
 how the script should behave
HEAD is now at b529e34 new spec how the script should behave</pre>
</div>
</div>
<div class="paragraph">
<p>With the <code>--keep-index</code> option the index remains intact.
This means that all changes that are already in the index remain in the working tree and in the index and are additionally stored in the stash.</p>
</div>
<div class="paragraph">
<p>The changes to the working tree and index are "put aside", and Git does not create a commit on the current branch.
To restore the saved state again, ``apply the saved patch to the current working tree and delete the stash at the same time, use</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git stash pop</strong>
...
Dropped refs/stash@{0} (d4cc94c37e92390e5fabf184a3b5b7ebd5c3943a)</pre>
</div>
</div>
<div class="paragraph">
<p>Between saving and restoring the repository you can change the repository as you like, e.g. change the branch, make commits, etc.
The stash is always applied to the current working tree.</p>
</div>
<div class="paragraph">
<p>The command <code>git stash pop</code> is an abbreviation for the two commands <code>git stash apply</code> and <code>git stash drop</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git stash apply</strong>
...
$ <strong>git stash drop</strong>
Dropped refs/stash@{0} (d4cc94c37e92390e5fabf184a3b5b7ebd5c3943a)</pre>
</div>
</div>
<div class="paragraph">
<p>Both <code>pop</code> and <code>apply</code> maintain the changes in the working tree, the index state is not restored again.
The <code>--index</code> option also restores the stored state of the index.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>--patch</code> (or short <code>-p</code>) option starts an interactive mode, i.e. you can select individual hunks to add to the stash just like with <code>git add -p</code> and <code>git reset -p</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git stash -p</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The configuration setting <code>interactive.singlekey</code> (see <a href="#sec.add-p">Section 2.1.2, &#8220;Creating Commits Step by Step&#8221;</a>) also applies here.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec.stash-conflicts"><a class="anchor" href="#sec.stash-conflicts"></a>4.5.2. Solve conflicts</h4>
<div class="paragraph">
<p>Conflicts can occur if you apply a stash to a commit other than the one on which it was created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git stash pop</strong>
Auto-merging hello.pl
CONFLICT (content): Merge conflict in hello.pl</pre>
</div>
</div>
<div class="paragraph">
<p>In this case, use the usual recipes to solve the conflict, see <a href="#sec.merge-conflicts">Section 3.4, &#8220;Resolving Merge Conflicts&#8221;</a>.
It is important, however, that the conflict markers are labeled <code>Updated Upstream</code> (the version in the current working tree) and <code>Stashed Changes</code> (changes in the stash):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;&lt;&lt;&lt;&lt;&lt;&lt; Updated upstream
# E-Mail: valentin.haenel@gmx.de
========
# E-Mail: valentin@gitbu.ch
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Stashed changes</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you have tried to apply a stash with <code>git stash pop</code> and a conflict has occurred, the stash will <em>not</em> be deleted automatically.
You must explicitly delete it (after resolving the conflict) with <code>git stash drop</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec.stash-fail"><a class="anchor" href="#sec.stash-fail"></a>4.5.3. If you can not apply the stash&#8230;&#8203;</h4>
<div class="paragraph">
<p>The stash is applied to the current working tree by default, provided it is clean - if not, Git aborts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git stash pop</strong>
Cannot apply to a dirty working tree, please stage your changes</pre>
</div>
</div>
<div class="paragraph">
<p>While Git suggests that you add the changes to the index, how you should proceed depends on your goal.
If you want to have the changes in the stash in addition to those in the working tree, here&#8217;s a good idea:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git add -u</strong>
$ <strong>git stash pop</strong>
$ <strong>git reset HEAD</strong></pre>
</div>
</div>
<div class="paragraph">
<p>For explanation:
First, the unsaved changes to the working tree are added to the index; then the changes are extracted from the stash and applied to the working tree, and finally the index is reset.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can create an additional stash and apply the changes you want to have to a clean working tree:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git stash</strong>
$ <strong>git stash apply stash@{1}</strong>
$ <strong>git stash drop stash@{1}</strong></pre>
</div>
</div>
<div class="paragraph">
<p>For this recipe you use several stashes.
First you store the changes in the working tree into a new stash, then you get the changes you actually want from the previous stash and delete it after the application.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.stash-message"><a class="anchor" href="#sec.stash-message"></a>4.5.4. Adjust message</h4>
<div class="paragraph">
<p>By default, Git sets the following message for a stash</p>
</div>
<div class="listingblock">
<div class="content">
<pre>WIP: on &lt;branch&gt;: &lt;sha1&gt; &lt;commit-msg&gt;</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>&lt;branch&gt;</code></dt>
<dd>
<p>the current branch</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>&lt;sha1&gt;</code></dt>
<dd>
<p>the commit ID of the <code>HEAD</code></p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>&lt;commit-msg&gt;</code></dt>
<dd>
<p>the commit message of the <code>HEAD</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>In most cases this is sufficient to identify a stash. If you plan to keep your stashes longer (possible, but not really recommended), or if you want to do more than one, we recommend that you add a better note to them:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git stash save "unfertiges feature"</strong>
Saved working directory and index state On master: unfertiges feature
HEAD is now at b529e34 new spec how the script should behave</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.multi-stash"><a class="anchor" href="#sec.multi-stash"></a>4.5.5. View stashes</h4>
<div class="paragraph">
<p>Git manages all stashes as a stack, i.e. more recent states are on top and are processed first.
The stashes are named with a reflog syntax (see also <a href="#sec.reflog">Section 3.7, &#8220;Reflog&#8221;</a>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    stash@{0}
    stash@{1}
    stash@{2}
    ...</pre>
</div>
</div>
<div class="paragraph">
<p>If you create a new stash, it will be called <code>stash@{0}</code> and the number of the others will be incremented:
<code>stash@{0}</code> becomes <code>stash@{1}</code>, <code>stash@{1}</code> becomes <code>stash@{2}</code> and so on.</p>
</div>
<div class="paragraph">
<p>If you do not specify an explicit stash, the commands <code>apply</code>, <code>drop</code> and <code>show</code> refer to the most recent, i.e. <code>stash@{0}</code>.</p>
</div>
<div class="paragraph">
<p>To view individual stashes, use <code>git stash show</code>.
By default, this command prints a balance of the added and removed lines (like <code>git diff --stat</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git stash show</strong>
git-stats.sh |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>git stash show</code> command also accepts general diff options that affect the format, e.g. &#160;`-p` to output a patch in diff format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git stash show -p stash@{0}</strong>
diff --git a/git-stats.sh b/git-stats.sh
index 62f92fe..1235fd3 100755
--- a/git-stats.sh
\+++ b/git-stats.sh
@@ -1,6 +1,6 @@
 #!/bin/bash
-START=18.07.2010
-END=25.07.2010
+START=18.07.2000
+END=25.07.2020
  echo "Number of commits per author:"</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>git stash list</code> command prints a list of currently created stashes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git stash list</strong>
stash@{0}: WIP on master: eae23b6 add number of merge commits to output
stash@{1}: WIP on master: b1ee2cf start and end date in one place only</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.stash-delete"><a class="anchor" href="#sec.stash-delete"></a>4.5.6. Delete stashes</h4>
<div class="paragraph">
<p>Individual stashes can be deleted with the command <code>git stash drop</code>, all with <code>git stash clear</code>.
If you delete a stash by mistake, you won&#8217;t find it again via the usual reflog mechanisms!
However, the following command prints the former stashes:&#8288;<sup class="footnote">[<a id="_footnoteref_62" class="footnote" href="#_footnotedef_62" title="View footnote.">62</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git fsck --unreachable | grep commit | cut -d" "  -f3 | \</strong>
  <strong>xargs git log --merges --no-walk --grep=WIP</strong></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In case of emergency, note that you will find the command at the very end of the <code>git-stash(1)</code> man page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is also important that the entries shown in this way only exist as unreachable objects in the object database and are therefore subject to the normal maintenance mechanisms&#8201;&#8212;&#8201;they are therefore deleted after some time and are not kept permanently.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.stash-implementation"><a class="anchor" href="#sec.stash-implementation"></a>4.5.7. How is the stash implemented?</h4>
<div class="paragraph">
<p>Git creates two commit objects for each stash, one for working tree changes and one for index changes.
Both have the current <code>HEAD</code> as their ancestor, the working tree object has the index object as its ancestor.
This makes a stash in Gitk appear as a triangle, which is a bit confusing at first:</p>
</div>
<div id="fig.gitk-stash" class="imageblock">
<div class="content">
<img src="images/stash-screenshot.png" alt="stash screenshot" width="90%">
</div>
<div class="title">Figure 29. A stash in Gitk</div>
</div>
<div class="paragraph">
<p>With the alias <code>git tree</code> (see <a href="#rev-list">Section 3.6.1, &#8220;Revision Parameters&#8221;</a>) this looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>*   f1fda63 (refs/stash) WIP on master: e2c67eb Kommentar fehlte
|\
| * 4faee09 index on master: e2c67eb Kommentar fehlte
|/
* e2c67eb (HEAD, master) Kommentar fehlte
* 8e2f5f9 Test Datei
* 308aea1 README Datei
* b0400b0 Erste Version</pre>
</div>
</div>
<div class="paragraph">
<p>Since the stash objects are not referenced by a branch, the working tree object is kept alive with a special reference, <code>refs/stash</code>.
However, this only applies to the latest stash.
Older stashes are only referenced in the Reflog (see ` <a href="#sec.reflog">Section 3.7, &#8220;Reflog&#8221;</a>) and therefore do not appear in Gitk.
In contrast to normal reflog entries, stored stashes do not expire and are therefore not deleted by the normal maintenance mechanisms.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.notes"><a class="anchor" href="#sec.notes"></a>4.6. Annotate commits - git notes</h3>
<div class="paragraph">
<p>In general, it is not easy to modify or extend commits once they have been published.
Sometimes, however, you wish you could &#8220;attach&#8221; information to commits afterwards, without the commit changing.
This could be ticket numbers, information about whether the software compiled, who tested it, and so on.</p>
</div>
<div class="paragraph">
<p>Git offers a way to attach notes to a commit using the <code>git notes</code> command.
The notes are an uncoupled <code>branch</code> of commits, referenced by <code>refs/notes/commits</code>, on which the development of the notes is stored.
On this branch, the notes for a commit are stored in a file whose filename corresponds to the SHA-1 sum of the commit it describes.</p>
</div>
<div class="paragraph">
<p>But you can disregard these internals&#8201;&#8212;&#8201;in practice, you can manage the notes completely with <code>git notes</code>.
The only important thing is to know:
You can only save one note per commit &#8288;<sup class="footnote">[<a id="_footnoteref_63" class="footnote" href="#_footnotedef_63" title="View footnote.">63</a>]</sup>.
But you can edit or extend the notes afterwards.</p>
</div>
<div class="paragraph">
<p>To add a new note:
<code>git notes add &lt;commit&gt;</code>.
If you omit <code>&lt;commit&gt;</code>, <code>HEAD</code> will be used.
Similar to <code>git commit</code> an editor opens where you write the note.
Alternatively, you can specify it directly with <code>-m "&lt;note&gt;"</code>.</p>
</div>
<div class="paragraph">
<p>By default, the note is always displayed below the commit message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show 8e8a7c1f</strong>
commit 8e8a7c1f4ca66aa024acde03a58c2b67fa901f88
Author: Julius Plenz &lt;julius@plenz.com&gt;
Date:   Sun May 22 15:48:46 2011 +0200

    Schleife optimieren

Notes:
    Dies verursacht Bug #2319 und wird mit v2.1.3-7-g6dfa88a korrigiert</pre>
</div>
</div>
<div class="paragraph">
<p>With the <code>--no-notes</code> option you can explicitly tell commands like <code>log</code> or <code>show</code> not to display notes.</p>
</div>
<div class="paragraph">
<p>The command <code>git notes add</code> will end with an error if a note already exists for the given commit.
Use the <code>git notes append</code> command instead to append more lines to the note, or directly <code>git notes edit</code> to edit the note as desired.</p>
</div>
<div class="paragraph">
<p>By default the notes are not uploaded or downloaded, you have to do this explicitly with the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git push &lt;remote&gt; refs/notes/commits</strong>
$ <strong>git fetch &lt;remote&gt; refs/notes/commits:refs/notes/commits</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The notes concept is not very well developed in Git.
In particular, it is problematic when multiple developers create commit notes in parallel, and then need to merge them.
For more information, see the <code>git-notes(1)</code> man page.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to use notes, this is usually only useful in connection with ticket, bug tracking or continuous integration systems:
These could automatically create notes and thus possibly store helpful additional information in the repository.</p>
</div>
<div class="paragraph">
<p>To automatically download the notes at each <code>git fetch</code>, add a refspec of the following form to the file <code>git/config</code> (see also <a href="#sec.git-fetch">Section 5.3.1, &#8220;git fetch&#8221;</a>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  fetch = +refs/notes/*:refs/notes/*</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec.multi-root"><a class="anchor" href="#sec.multi-root"></a>4.7. Multiple root commits</h3>
<div class="paragraph">
<p>When a repository is initialized, the first commit, called the <em>root commit</em>, is created.
This commit is usually the only commit in the entire repository that has no predecessor.</p>
</div>
<div class="paragraph">
<p>However, it is also possible to have multiple root commits in one repository.
This can be useful in the following cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You want to merge two independent projects that were previously developed in separate repositories (see also subtree-merges in <a href="#sec.subtrees">Section 5.11.2, &#8220;Subtrees&#8221;</a>).</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>` You want to manage a fully decoupled branch where you keep a todo list, compiled binaries or autogenerated documentation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In case you want to merge two repositories, this command is usually sufficient:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git fetch -n &lt;anderes-repo&gt; master:&lt;anderer-master&gt;</strong>
warning: no common commits
...
>From &lt;anderes-repo&gt;
 * [new branch]      master     -&gt; &lt;anderer-master&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>master</code> branch of the other repository is copied to the local repository as <code>&lt;other-master&gt;</code>, including all commits until Git finds a merge base or root commit.
The warning "<code>no common commits</code> already indicates that the two version histories do not have a common commit.
The repository now has two root commits.</p>
</div>
<div class="paragraph">
<p>Note that a merge between two branches that do not share commits will fail since a file exists on both sides and is not equal.
This may be remedied by subtree-merges, see <a href="#sec.subtrees">Section 5.11.2, &#8220;Subtrees&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>You can also, instead of importing another repository, create a completely detached branch, ``a second root commit.
The following two commands are sufficient for this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout --orphan &lt;newroot&gt;</strong>
$ <strong>git rm --cached -rf .</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The first one sets the <code>HEAD</code> to the (not yet existing) branch <code>&lt;newroot&gt;</code>.
The <code>rm</code> command deletes all Git-managed files from the index, but leaves them intact in the working tree.
So now you have an index that doesn&#8217;t contain anything and a branch that doesn&#8217;t have a commit yet.</p>
</div>
<div class="paragraph">
<p>You can now use the <code>git add</code> command to add files to the new root commit and then create it with <code>git commit</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec.bisect"><a class="anchor" href="#sec.bisect"></a>4.8. Find regressions - git bisect</h3>
<div class="paragraph">
<p>In software development, a regression refers to the point in time from which a certain feature of a program no longer functions.
This can be after an update of libraries, after the introduction of new features that cause side effects etc.</p>
</div>
<div class="paragraph">
<p>To find such regressions is sometimes difficult.
If you are using an extensive test suite, you are relatively well protected from including trivially detectable regressions (e.g. by running a <code>make test</code> before each commit).</p>
</div>
<div class="paragraph">
<p>If the regression is reproducible ("with the arguments &lt;x&gt; the program crashes", "the configuration setting &lt;y&gt; causes a memory access error"), then you can use Git to automate the search for the commit that causes this regression.</p>
</div>
<div class="paragraph">
<p>Git provides the command <code>bisect</code> for this purpose, whose algorithm is based on the "divide and conquer" principle (<code>divide and conquer_) works:
First you define a point in time (i.e. a commit) when the regression had not yet occurred (called `good</code>), then a point in time when it occurs (called <code>bad</code>, leave it out, Git assumes <code>HEAD</code>).
The <code>bisect</code> command is based on the idealized assumption that the regression was initiated by <em>a</em> commit&#8201;&#8212;&#8201;that is, there is a commit <em>before</em> that everything was fine, and <em>after</em> that the error occurs.&#8288;<sup class="footnote">[<a id="_footnoteref_64" class="footnote" href="#_footnotedef_64" title="View footnote.">64</a>]</sup></p>
</div>
<div class="paragraph">
<p>Now Git chooses a commit from the middle between <code>good</code> and <code>bad</code> and checks it out. You must then check whether the regression is still present.
If yes, Git will set <code>bad</code> to this commit, if no, <code>good</code> will be set to this commit.
This removes about half of the commits to examine.
Git repeats the step until only one commit remains.</p>
</div>
<div class="paragraph">
<p>So the number of steps <code>bisect</code> takes is logarithmic to the number of commits you examine:
For <em>n</em> commits, you need about log<sub>2</sub>(<em>n</em>) steps.
For 32 commits, that&#8217;s a maximum of five steps, but for 1024 commits, that&#8217;s a maximum of 10 steps, because ``you can eliminate 512 commits in the first step.</p>
</div>
<div class="sect3">
<h4 id="sec.bisect-usage"><a class="anchor" href="#sec.bisect-usage"></a>4.8.1. Usage</h4>
<div class="paragraph">
<p>You start a <code>bisect</code> session with the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git bisect start</strong>
$ <strong>git bisect bad &lt;funktioniert-nicht&gt;</strong>
$ <strong>git bisect good &lt;funktioniert&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Once you&#8217;ve defined the two points, Git checks out a commit in the middle, so you&#8217;re now in <em>detached-head</em> mode (see <a href="#sec.detached-head">Section 3.2.1, &#8220;Detached HEAD&#8221;</a>).
After you have checked whether the regression is still present, you can mark it with <code>git bisect good</code> or <code>git bisect bad</code>.
Git will automatically check out the next commit.</p>
</div>
<div class="paragraph">
<p>You may not be able to test the checked out commit, for example, because the program does not compile correctly.
In this case, you can use git <code>git bisect skip</code> to have another commit nearby selected and proceed with it as usual.
You can cancel the debugging at any time with <code>git bisect reset</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.bisect-run"><a class="anchor" href="#sec.bisect-run"></a>4.8.2. Automation</h4>
<div class="paragraph">
<p>Ideally, you can test automatically whether the error occurs&#8201;&#8212;&#8201;with a test that must run successfully if the regression does not occur.</p>
</div>
<div class="paragraph">
<p>You can then define the points <code>good</code> and <code>bad</code> as above.
Afterwards you enter <code>git bisect run &lt;path/to/test&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Based on the return value, <code>bisect</code> decides whether the checked commit is <code>good</code> (if the script ends successfully, i.e. with return value 0) or <code>bad</code> (values 1&#8212;&#8203;127).
A special case is the return value 125, which causes a <code>git bisect skip</code>.
So if you have a program that needs to be compiled, the first thing you should do is to add a command like <code>make || exit 125</code>, so that the commit is skipped if the program does not compile properly.</p>
</div>
<div class="paragraph">
<p>Bisect can then automatically identify the problematic commit.
This looks like this, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git bisect run ./t.sh</strong>
Bisecting: 9 revisions left to test after this (roughly 3 steps) ...
Bisecting: 4 revisions left to test after this (roughly 2 steps) ...
Bisecting: 2 revisions left to test after this (roughly 1 step) ...
Bisecting: 0 revisions left to test after this (roughly 0 steps) ...
d29758fffc080d0d0a8ee9e5266fdf75fcb98076 is the first bad commit</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>With small commits and meaningful descriptions you can save yourself a lot of work by using the <code>bisect</code> command when searching for obscure bugs.</p>
</div>
<div class="paragraph">
<p>So take special care not to create commits that leave the software in a <code>broken</code> state (does not compile, etc.), which a later commit will fix.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch.distributed-git"><a class="anchor" href="#ch.distributed-git"></a>5. Distributed Git</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Git is a <em>distributed</em> version control system.
To understand this feature, a brief digression into the world of centralized version management is necessary: As the name suggests, in a <em>central</em> version control system, such as RCS, CVS, and Subversion, the development history is stored centrally on a repository server, and all developers synchronize their work with <em>this</em> one repository.
Developers who want to change something download a current version to their computer (<em>checkout</em>), maintain their modifications, and then send them back to the server (<em>commit</em>).</p>
</div>
<div class="sect2">
<h3 id="sec.distributed-systems"><a class="anchor" href="#sec.distributed-systems"></a>5.1. How Does Distributed Version Control Work?</h3>
<div class="paragraph">
<p>One of the major disadvantages of the centralized approach is that a connection to the server is required for most of the work steps.
For example, if you want to view history or make a commit, you need a network connection to the server.
Unfortunately, this is not always guaranteed, maybe the server is down or you are working on your laptop without a (W)LAN connection.</p>
</div>
<div class="paragraph">
<p>For distributed systems this is regulated differently: Basically, each developer has his or her own local copy of the repository, so the question arises of how developers share changes.</p>
</div>
<div class="paragraph">
<p>One approach is to provide a single &#8220;master repository&#8221; that all developers use to synchronize their local repositories.
The developers connect to this repository from time to time, uploading their own commits (<em>push</em>) and downloading those of their colleagues (<em>fetch</em> or <em>pull</em>).
This very centralized approach is often used in practice.
For an illustration, see <a href="#fig.central-workflow">Figure 30, &#8220;Central workflow with distributed version management&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>However, there are two noteworthy alternatives in the Git environment that we will introduce in this chapter: the <em>Integration Manager</em> workflow, which uses multiple public repositories (<a href="#sec.multi-remote">Section 5.6, &#8220;Distributed Workflow with Multiple Remotes&#8221;</a>), and patch exchange by e-mail (<a href="#sec.patch-queue">Section 5.9, &#8220;Patches via E-mail&#8221;</a>).</p>
</div>
<div id="fig.central-workflow" class="imageblock text-center">
<div class="content">
<img src="images/central-workflow.svg" alt="central workflow" width="70%">
</div>
<div class="title">Figure 30. Central workflow with distributed version management</div>
</div>
<div class="paragraph">
<p>Unlike central systems, Git&#8217;s commit and checkout processes are local.
Other day-to-day tasks, such as reviewing history or switching to a branch, are also done locally.
Only the uploading and downloading of commits are non-local operations.
This has two important advantages over centralized version management: No network is needed, and everything is faster.
How often you synchronize your repository depends, among other things, on the size and development speed of the project.
If you&#8217;re working with a colleague on the internals of your software, you&#8217;ll probably need to synchronize more often than if you&#8217;re working with a feature that doesn&#8217;t have a major impact on the rest of the code base.
It may well be that one synchronization per day is sufficient.
So you can work productively even without a permanent network connection.</p>
</div>
<div class="paragraph">
<p>This chapter is about how to exchange changes between your local repository and a <em>remote repository</em> (aka <em>remote</em>), what to consider when working with multiple remotes, and how to email patches so that they can be easily applied by the recipient.</p>
</div>
<div class="paragraph">
<p>The most important commands at a glance:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>git remote</code> </dt>
<dd>
<p>General configuration of remotes: add, remove, rename, etc.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>git clone</code> </dt>
<dd>
<p>Download complete copy.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>git pull</code> and <code>git fetch</code> </dt>
<dd>
<p>Download commits and references from a remote.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>git push</code> </dt>
<dd>
<p>Upload commits and references to a remote.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="sec.clone"><a class="anchor" href="#sec.clone"></a>5.2. Cloning Repositories</h3>
<div class="paragraph">
<p>You have already seen the first command related to remote repositories: <code>git clone</code>.
Here we illustrate the cloning process with our &#8220;git cheat sheet&#8221;:&#8288;<sup class="footnote">[<a id="_footnoteref_65" class="footnote" href="#_footnotedef_65" title="View footnote.">65</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone git://github.com/esc/git-cheatsheet-de.git</strong>
Initialized empty Git repository in /tmp/test/git-cheatsheet-de/.git/
remote: Counting objects: 77, done.
remote: Compressing objects: 100% (77/77), done.
remote: Total 77 (delta 45), reused 0 (delta 0)
Receiving objects: 100% (77/77), 132.44 KiB, done.
Resolving deltas: 100% (45/45), done.</pre>
</div>
</div>
<div class="paragraph">
<p>Git will issue various status messages when this call is made.
The most important ones are: the notification of which directory the new repository will be cloned to (<code>Initialized empty Git repository in /tmp/test/git-cheatsheet-de/.git/</code>), and the confirmation that all objects have been successfully received ((<code>Receiving objects: 100% (77/77), 132.44 KiB, done.</code>)
If the cloning process is successful, the <code>master</code> branch is checked out,&#8288;<sup class="footnote">[<a id="_footnoteref_66" class="footnote" href="#_footnotedef_66" title="View footnote.">66</a>]</sup> and the working tree including repository is located in the directory <code>git-cheatsheet-en</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd git-cheatsheet-de</strong>
$ <strong>ls</strong>
cheatsheet.pdf  cheatsheet.tex  Makefile  README
$ <strong>ls -d .&#42;</strong>
.git/</pre>
</div>
</div>
<div class="paragraph">
<p>To create the clone in a different directory, simply pass it as an argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone git://github.com/esc/git-cheatsheet-de.git cheatsheet</strong>
Initialized empty Git repository in /tmp/test/cheatsheet/.git/
$ <strong>ls</strong>
cheatsheet/</pre>
</div>
</div>
<div class="paragraph">
<p>Furthermore, the source repository, i.e. the origin of the clone, is configured as a remote repository named <code>origin</code>.
The git remote command displays the setting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git remote</strong>
origin</pre>
</div>
</div>
<div class="paragraph">
<p>The setting is stored in the configuration file <code>.git/config</code> with the entry <code>remote</code>, in this case only for <code>origin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[remote "origin"]
    fetch = +refs/heads/*:refs/remotes/origin/*
    url = git://github.com/esc/git-cheatsheet-de.git</pre>
</div>
</div>
<div class="paragraph">
<p>You will see two settings in the section: <code>fetch</code> and <code>url</code>.
The first, called the <em>refspec</em>, specifies which changes are to be downloaded when synchronizing with the remote repository, and the second specifies the URL used to do this.</p>
</div>
<div class="paragraph">
<p><code>git remote</code> is also used to manage remote repositories.
For example, you can add more remote repositories using <code>git remote add</code>, adapt the URL for the remote repository using <code>git remote set-url</code>, and so on, but more on this later.</p>
</div>
<div class="paragraph">
<p>The name <code>origin</code> is just a convention; with <code>git remote rename</code> you can change the name of the source repository to suit your needs, for example, from <code>origin</code> to <code>github</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git remote rename origin github</strong>
$ <strong>git remote</strong>
github</pre>
</div>
</div>
<div class="paragraph">
<p>With the option <code>--origin</code> or <code>-o</code> you set the name immediately when cloning:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone -o github git://github.com/esc/git-cheatsheet-de.git</strong></pre>
</div>
</div>
<div class="sect3">
<h4 id="sec.repository-url"><a class="anchor" href="#sec.repository-url"></a>5.2.1. Repository URLs</h4>
<div class="paragraph">
<p>Git supports several protocols for accessing a remote repository, the most common three being Git protocol, SSH, and HTTP(S).
Designed specifically for Git, the Git protocol favors data transfer by always transferring the smallest possible amount of data.
It doesn&#8217;t support authentication, so it&#8217;s often transmitted over an SSH connection.
This ensures both efficient (Git protocol) and secure (SSH) transmission.
HTTP(S) is used when a firewall is configured very restrictively and the allowed ports are drastically restricted.&#8288;<sup class="footnote">[<a id="_footnoteref_67" class="footnote" href="#_footnotedef_67" title="View footnote.">67</a>]</sup></p>
</div>
<div class="paragraph">
<p>In general, a valid URL contains the transfer protocol, the address of the server and the path to the repository:&#8288;<sup class="footnote">[<a id="_footnoteref_68" class="footnote" href="#_footnotedef_68" title="View footnote.">68</a>]</sup></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ssh://[user@]gitbu.ch[:port]/pfad/zum/repo.git/</code></p>
</li>
<li>
<p><code>git://gitbu.ch[:port]/pfad/zum/repo.git/</code></p>
</li>
<li>
<p><code>http[s]://gitbu.ch[:port]/pfad/zum/repo.git/</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the SSH protocol the short form still exists:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>[user@]gitbu.ch:pfad/zum/repo.git/</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is also possible to clone repositories locally using the following syntax:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/pfad/zum/repo.git/</code></p>
</li>
<li>
<p><code>file:///pfad/zum/repo.git/</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want to know what URLs are configured for a remote repository, use git remote&#8217;s <code>--verbose</code> or <code>-v</code> option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git remote -v</strong>
origin  git://github.com/esc/git-cheatsheet-de.git (fetch)
origin  git://github.com/esc/git-cheatsheet-de.git (push)</pre>
</div>
</div>
<div class="paragraph">
<p>You can see that there are two URLs for the remote repository origin, but they are set to the same value by default.
The first URL (<code>fetch</code>) specifies from where and with which protocol changes are downloaded.
The second URL (<code>push</code>) specifies where changes are uploaded to and with which protocol.
Different URLs are particularly interesting if you download or upload with different protocols.
A common example is to download with the git protocol (<code>git://</code>) and upload with the SSH protocol (<code>ssh://</code>).
It is then downloaded without authentication and encryption, which provides a speed advantage, but uploaded with authentication and encryption, which ensures that only you or other authorized people can upload.
You can use the <code>git remote set-url</code> command to customize the URLs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git remote set-url --add \</strong>
  <strong>--push origin pass:quotes[git@github.com]:esc/git-cheatsheet-de.git</strong>
$ <strong>git remote -v</strong>
origin  git://github.com/esc/git-cheatsheet-de.git (fetch)
origin  git@github.com:esc/git-cheatsheet-de.git (push)</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to customize the URL of a repository, it is often faster to do this directly in the <code>.git/config</code> configuration file.
Git provides the <code>git config -e</code> command for this: it opens this file in your editor.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec.remote-tracking-branches"><a class="anchor" href="#sec.remote-tracking-branches"></a>5.2.2. Remote-Tracking-Branches</h4>
<div class="paragraph">
<p>The current status of the remote repository is stored locally.
Git uses the mechanism of <em>remote tracking branches</em>, special branches&#8201;&#8212;&#8201;local references&#8201;&#8212;&#8201;that reflect the state of the remote branches.
They &#8220;track&#8221; the remote branches and are advanced or set by Git when synchronizing with the remote, if the branches in the remote have changed.
In terms of the commit graph, remote tracking branches are markers within the graph that point to the same commits as the branches in the remote repository.
You can&#8217;t modify remote tracking branches like normal branches; Git manages them automatically, so it updates them.
When you clone a repository, Git initializes a remote tracking branch for each remote branch.</p>
</div>
<div id="fig.clone" class="imageblock text-center">
<div class="content">
<img src="images/clone.svg" alt="clone" width="100%">
</div>
<div class="title">Figure 31. Generated Remote Tracking Branches</div>
</div>
<div class="paragraph">
<p><a href="#fig.clone">Figure 31, &#8220;Generated Remote Tracking Branches&#8221;</a> shows an example.
The <code>origin</code> remote repository has three branches: <code>pu</code>, <code>maint</code>, and <code>master</code>.
Git creates a <em>remote tracking branch</em> in the cloned repository for each of these <em>remote branches</em>.
It also creates a local branch <code>master</code> in the clone that corresponds to the remote branch <code>master</code>.
This is checked out and is the branch you should work in if you plan to upload commits to the <code>master</code> (but see <a href="#sec.git-fetch">Section 5.3.1, &#8220;git fetch&#8221;</a>).</p>
</div>
<div class="paragraph">
<p>In the git fetch example, there is only one branch on the remote side, master.
That&#8217;s why Git creates only one remote tracking branch in the clone, <code>origin/master</code>.
The <code>git branch -r</code> command shows all remote tracking branches:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git branch -r</strong>
  origin/HEAD -&gt; origin/master
  origin/master</pre>
</div>
</div>
<div class="paragraph">
<p>The special entry <code>origin/HEAD &#8594; origin/master</code> states that in the remote repository the <code>HEAD</code> points to the branch <code>master</code>.
This is important for cloning, because this branch is checked out after cloning.
The list of remote tracking branches is a bit sparse in this example, you can see more entries in a clone of the Git-via-Git repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git branch -r</strong>
  origin/HEAD -&gt; origin/master
  origin/html
  origin/maint
  origin/man
  origin/master
  origin/next
  origin/pu
  origin/todo</pre>
</div>
</div>
<div class="paragraph">
<p>All branches can be displayed with <code>git branch -a</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git branch -a</strong>
* master
  remotes/origin/HEAD -&gt; origin/master
  remotes/origin/master</pre>
</div>
</div>
<div class="paragraph">
<p>In this case, Git uses the prefix <code>remotes/</code> to clearly distinguish remote tracking branches from normal ones.
If you have enabled color output, the different branches will also be color-coded: the checked-out branch green, remote tracking branches red.</p>
</div>
<div class="paragraph">
<p>Remote Tracking Branches are also references only and are therefore stored under <code>.git/refs</code> like all references.
However, since they are special references that are also linked to a remote repository, they end up under <code>.git/refs/remotes/&lt;remote-name&gt;</code> (see <a href="#sec.branch-refs">Section 3.1.1, &#8220;HEAD and Other Symbolic References&#8221;</a>).
In Gitk, the remote tracking branches are displayed with the prefix <code>remotes/&lt;remote-name&gt;/</code>, which is also colored dark yellow (<a href="#fig.remote-tracking-gitk">Figure 32, &#8220;Branch <code>next</code> and the corresponding remote tracking branch in Gitk&#8221;</a>).</p>
</div>
<div id="fig.remote-tracking-gitk" class="imageblock">
<div class="content">
<img src="images/remote-tracking-gitk.png" alt="remote tracking gitk" width="90%">
</div>
<div class="title">Figure 32. Branch <code>next</code> and the corresponding remote tracking branch in Gitk</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.downloading-commits"><a class="anchor" href="#sec.downloading-commits"></a>5.3. Downloading Commits</h3>
<div class="paragraph">
<p>Now what does it mean when you synchronize two repositories, such as a clone with the source?
Synchronization in this context means two things: first, downloading commits and references, and second, uploading.
As far as the commit graph is concerned, the local graph needs to be synchronized with the one on the remote side, so that both have the same structure.
In this section, we first discuss how to download commits and references from a remote.
There are two commands for this: <code>git fetch</code> and <code>git pull</code>.
We&#8217;ll first introduce both commands, and in <a href="#sec.fetch-vs-pull">Section 5.3.3, &#8220;git fetch vs. git pull&#8221;</a> we&#8217;ll describe which command is preferable under which circumstances.</p>
</div>
<div class="sect3">
<h4 id="sec.git-fetch"><a class="anchor" href="#sec.git-fetch"></a>5.3.1. git fetch</h4>
<div class="paragraph">
<p>As soon as new commits are created by other developers in a remote, you want to download them to your local repository.
In the simplest case, you just want to find out which commits you don&#8217;t have locally, download them, and update the remote tracking branches so that they reflect the current status in the remote.</p>
</div>
<div class="paragraph">
<p>Use the <code>git fetch</code> command to do this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git fetch origin</strong>
...
From github.com:esc/git-cheatsheet-de
   79170e8..003e3c7  master     -&gt; origin/master</pre>
</div>
</div>
<div class="paragraph">
<p>Git acknowledges the call with a message that <code>origin/master</code> has been set from commit <code>79170e8</code> to commit <code>003e3c7</code>.
The notation <code>master &#8594; origin/master</code> indicates that the branch <code>master</code> from the remote was used to update the remote tracking branch <code>origin/master</code>.
In other words: Branches from the remote on the left and remote tracking branches on the right.</p>
</div>
<div class="paragraph">
<p>See <a href="#fig.fetch">Figure 33, &#8220;Remote Tracking Branches are updated&#8221;</a> for the effect this has on the commit graph: On the left side is the initial state of the remote origin and next to it that of the clone.
Both the remote and the clone have new commits since the last synchronization (C and D).
The remote tracking branch <code>origin/master</code> in the clone points to commit B; this is the last state of the remote known to the clone.
By calling <code>git fetch origin</code>, Git updates the remote tracking branch in the clone to reflect the current status of the <code>master</code> (pointing to commit C) in the remote.
To do this, Git downloads the missing commit C and then sets the remote tracking branch on it.</p>
</div>
<div id="fig.fetch" class="imageblock">
<div class="content">
<img src="images/fetch.svg" alt="fetch" width="90%">
</div>
<div class="title">Figure 33. Remote Tracking Branches are updated</div>
</div>
<div class="sect4">
<h5 id="sec.refspec"><a class="anchor" href="#sec.refspec"></a>5.3.1.1. Refspec</h5>
<div class="paragraph">
<p>The <em>refspec</em> (<em>reference specification</em>) ensures that the remote tracking branches are set.
This is a description of the references to be retrieved from the remote.
An example was given above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[remote "origin"]
    fetch = +refs/heads/*:refs/remotes/origin/*
    url = git://github.com/esc/git-cheatsheet-de.git</pre>
</div>
</div>
<div class="paragraph">
<p>In the entry <code>fetch</code> the refspec for the remote is stored.
It has the form: <code>&lt;remote-refs&gt;:&lt;local-refs&gt;</code> with an optional plus (+).
The example is configured so that all branches, i.e. all references stored in the remote under <code>refs/heads</code>, end up locally under <code>refs/remotes/origin</code>.&#8288;<sup class="footnote">[<a id="_footnoteref_69" class="footnote" href="#_footnotedef_69" title="View footnote.">69</a>]</sup>
Thus, for example, the branch <code>master</code> from the remote <code>origin</code> (<code>refs/heads/master</code>) is stored locally as <code>refs/remotes/origin/master</code>.</p>
</div>
<div class="paragraph">
<p>Normally the remote tracking branches are &#8220;fast-forwarded&#8221;, similar to a fast-forward merge.
The remote tracking branch is therefore only updated if the target commit is a descendant of the current reference.
This may not be possible, for example, after a rebase.
In this case, Git will refuse to update the remote tracking branch.
However, the plus overrides this behavior, and the remote tracking branch is still updated.
If this happens, Git will indicate this with the addition <code>(forced update)</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> + f5225b8..0efec48 pu         -&gt; origin/pu  (forced update)</pre>
</div>
</div>
<div class="paragraph">
<p>This setting is useful in practice and is therefore set by default.
Furthermore, as a user you do not need to worry about setting the refspec, because if you use the command <code>git clone</code> or <code>git remote add</code>, Git automatically creates the corresponding default entry for you.
Sometimes you may want to restrict the refspec explicitly.
For example, if you use namespaces for all developers and you are only interested in the <code>master</code> branch and the branches of the other developers in your team (Beatrice and Carlos), it might look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[remote "firma"]
    url = axel@example.com:produkt.git
    fetch = +refs/heads/master:refs/remotes/origin/master
    fetch = +refs/heads/beatrice/*:refs/remotes/origin/beatrice/*
    fetch = +refs/heads/carlos/*:refs/remotes/origin/carlos/*</pre>
</div>
</div>
<div class="paragraph">
<p>With regard to the commit graph, Git only downloads those commits that are necessary to get references in the commit graph.
This makes sense, because commits that are not &#8220;secured&#8221; by a reference are considered unreachable, and will eventually be deleted (see also <a href="#sec.branch-management">Section 3.1.2, &#8220;Managing Branches&#8221;</a>).
In the last example, Git therefore does not need to download commits that are referenced by the branches that are not in the refspec.
In terms of distribution, Git does not necessarily need to synchronize the entire commit graph, the &#8220;relevant&#8221; parts are sufficient.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can specify the refspec on the command line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git fetch origin +refs/heads/master:refs/remotes/origin/master</strong></pre>
</div>
</div>
<div class="paragraph">
<p>If there is a refspec that has no reference on the right side of the colon, there is no target to store.
In this case, Git places the reference in the <code>.git/FETCH_HEAD</code> file instead, and you can use the special term <code>FETCH_HEAD</code> for a merge:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git fetch origin master</strong>
From github.com:esc/git-cheatsheet-de
 * branch            master     -&gt; FETCH_HEAD
$ <strong>cat .git/FETCH_HEAD</strong>
003e3c70ce7310f6d6836748f45284383480d40e
    branch 'master' of github.com:esc/git-cheatsheet-de
$ <strong>git merge FETCH_HEAD</strong></pre>
</div>
</div>
<div class="paragraph">
<p>This feature can be useful if you are interested in a single remote branch that you have not configured a remote tracking branch for and do not want to do so.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.prune"><a class="anchor" href="#sec.prune"></a>5.3.1.2. Deleting Expired Remote Tracking Branches</h5>
<div class="paragraph">
<p>If a Remote Branch is deleted (as described in <a href="#sec.push-delete">Section 5.4.1, &#8220;Deleting Remote References&#8221;</a>), the corresponding Remote Tracking Branch is referred to as <em>stale</em> (&#8220;expired&#8221;).
Since such branches usually have no further use, delete them (<em>prune</em>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git remote prune origin</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Delete directly during download:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git fetch --prune</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Since this is often the desired behavior, Git offers the <code>fetch.prune</code> option.
If you set it to <code>true</code>, git fetch will behave as if you had called it with the <code>--prune</code> option.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.local-working-branches"><a class="anchor" href="#sec.local-working-branches"></a>5.3.1.3. Working with Local Branches</h5>
<div class="paragraph">
<p>So far we have only discussed how to track the change in a remote.
If you make changes yourself that are based on one of the branches in the remote, you must first create a local branch where you are allowed to make commits:&#8288;<sup class="footnote">[<a id="_footnoteref_70" class="footnote" href="#_footnotedef_70" title="View footnote.">70</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout -b next origin/next</strong>
Branch next set up to track remote branch next from origin.
Switched to a new branch <em>next</em></pre>
</div>
</div>
<div class="paragraph">
<p>If no local branch named <code>next</code> exists yet, the following abbreviation also works:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout next</strong>
Branch next set up to track remote branch next from origin.
Switched to a new branch <em>next</em></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>set up to track</code> message indicates that Git is configuring the branch <code>next</code> from the remote <code>origin</code> as the <em>upstream branch</em> for the local branch <code>next</code>.
This is a kind of &#8220;shortcut&#8221; that benefits other Git commands.
For more details, see <a href="#sec.pull">Section 5.3.2, &#8220;git pull&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>You can work in the local branch as usual.
Note, however, that you only ever commit <em>locally</em>.
To publish your work, i.e. upload it to a remote branch, you still need the <code>git push</code> command (<a href="#sec.uploading-commits">Section 5.4, &#8220;Uploading Commits: git push&#8221;</a>).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.pull"><a class="anchor" href="#sec.pull"></a>5.3.2. git pull</h4>
<div class="paragraph">
<p>Suppose you want to transfer commits from the remote repository to your local branch.
To do this, first run a <code>git fetch</code> to fetch new commits, and then merge the change from the corresponding remote tracking branch:&#8288;<sup class="footnote">[<a id="_footnoteref_71" class="footnote" href="#_footnotedef_71" title="View footnote.">71</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git merge origin/master</strong>
Updating 79170e8..003e3c7
Fast-forward
 cheatsheet.pdf |  Bin 89792 -&gt; 95619 bytes
 cheatsheet.tex |   19 +++++++++++++++++---
 2 files changed, 16 insertions(+), 3 deletions(-)</pre>
</div>
</div>
<div class="paragraph">
<p>For this use case, Git provides the <code>git pull</code> command to speed up your workflow.
It is a combination of <code>git fetch</code> and <code>git merge</code> or <code>git rebase</code>.</p>
</div>
<div class="paragraph">
<p>Downloading new commits from <code>origin</code> and merging all commits referenced by the <code>master</code> there into the current branch can be done with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git pull origin master</strong>
...
From github.com:esc/git-cheatsheet-de
   79170e8..003e3c7  master     -&gt; origin/master
Updating 79170e8..003e3c7
Fast-forward
 cheatsheet.pdf |  Bin 89792 -> 95619 bytes
 cheatsheet.tex |   19 ++++++++++++++++---
 2 files changed, 16 insertions(+), 3 deletions(-)</pre>
</div>
</div>
<div class="paragraph">
<p>In <a href="#fig.pull">Figure 34, &#8220;What happens with a pull&#8221;</a> we illustrate the process.
On the left, you see the remote repository <code>origin</code> and next to it the current status of the local repository.
The repository was cloned when it only contained commits A and B, so the remote tracking branch points <code>origin/master</code> to B.
In the meantime, both the remote (<code>C</code>) and local (<code>D</code>) repositories have been added.</p>
</div>
<div class="paragraph">
<p>On the right side is the state after <code>git pull origin master</code>.
Commit C has been added to the local repository.
The <code>fetch</code> call contained in the <code>pull</code> has updated the remote tracking branch, i.e. it points to the same commit as the <code>master</code> in <code>origin</code> and thus reflects the state there.
In addition, the <code>merge</code> call contained in the <code>pull</code> has integrated the <code>master</code> from <code>origin</code> into the local <code>master</code>, as you can see from the merge commit M and the current position of the local <code>master</code>.</p>
</div>
<div id="fig.pull" class="imageblock">
<div class="content">
<img src="images/pull.svg" alt="pull" width="90%">
</div>
<div class="title">Figure 34. What happens with a pull</div>
</div>
<div class="paragraph">
<p>Alternatively, the <code>--rebase</code> option instructs the <code>pull</code> command to rebase the local branch to the remote tracking branch after <code>fetch</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git pull --rebase  origin master</strong></pre>
</div>
</div>
<div class="paragraph">
<p>In <a href="#fig.pull-rebase">Figure 35, &#8220;What happens during a pull with rebase&#8221;</a> you can see what happens if you perform a rebase instead of the default merge.</p>
</div>
<div id="fig.pull-rebase" class="imageblock">
<div class="content">
<img src="images/pull-rebase.svg" alt="pull rebase" width="90%">
</div>
<div class="title">Figure 35. What happens during a pull with rebase</div>
</div>
<div class="paragraph">
<p>The initial situation is the same as in <a href="#fig.pull">Figure 34, &#8220;What happens with a pull&#8221;</a>.
The <code>fetch</code> contained in the <code>pull</code> moves the remote tracking branch <code>origin/master</code> to commit C.
However, <code>rebase</code> does not create a merge commit; instead, a call to <code>rebase</code> gives the commit D a new base, and the local <code>master</code> is set to the new commit D'.
(Rebase is described in detail in <a href="#sec.rebase">Section 4.1, &#8220;Move commits - Rebase&#8221;</a>).</p>
</div>
<div class="sect4">
<h5 id="sec.upstream"><a class="anchor" href="#sec.upstream"></a>5.3.2.1. Upstream Branches</h5>
<div class="paragraph">
<p>Often <code>git fetch</code>, <code>git pull</code> and <code>git push</code> are executed without arguments.
Git uses the configuration of the upstream branches to decide what to do, among other things.
From the repository&#8217;s config:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[branch "master"]
    remote = origin
    merge = refs/heads/master</pre>
</div>
</div>
<div class="paragraph">
<p>The entry states that the local branch <code>master</code> is linked to the remote branch <code>master</code> in the <code>origin</code> repository.</p>
</div>
<div class="paragraph">
<p>The <code>remote</code> entry instructs <code>git fetch</code> and <code>git pull</code>, from which remote commits are downloaded.
The <code>merge</code> entry tells <code>git pull</code> to merge the new commits from the remote branch <code>master</code> to the local <code>master</code>.
This allows both commands to be used without arguments, which is very common in practice.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git fetch</strong>
...
From github.com:esc/git-cheatsheet-de
   79170e8..003e3c7  master     -&gt; origin/master
$ <strong>git pull</strong>
...
From github.com:esc/git-cheatsheet-de
   79170e8..003e3c7  master     -&gt; origin/master
Updating 79170e8..003e3c7
Fast-forward
 cheatsheet.pdf |  Bin 89792 -> 95619 bytes
 cheatsheet.tex |   19 ++++++++++++++++---
 2 files changed, 16 insertions(+), 3 deletions(-)</pre>
</div>
</div>
<div class="paragraph">
<p>If no upstream branch is configured, it tries <code>git fetch</code> with <code>origin</code> and otherwise aborts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git fetch</strong>
fatal: No remote repository specified.  Please, specify either a URL or
a remote name from which new revisions should be fetched.</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you want changes from an upstream branch on <code>git pull</code> to be applied by rebase instead of merge by default, set the value of the <code>branch.&lt;name&gt;.rebase</code> setting to <code>true</code>, for example</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config branch.master.rebase true</strong></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.fetch-vs-pull"><a class="anchor" href="#sec.fetch-vs-pull"></a>5.3.3. git fetch vs. git pull</h4>
<div class="paragraph">
<p>Git beginners often ask themselves whether they should use <code>fetch</code> or <code>pull</code>.
The answer depends on how you develop: How big is the project?
How many remotes are there?
How heavily are branches used?</p>
</div>
<div class="sect4">
<h5 id="sec.push-pull"><a class="anchor" href="#sec.push-pull"></a>5.3.3.1. Distributed Git for Beginners</h5>
<div class="paragraph">
<p>Especially for beginners, it makes sense that all participants work on the same branch (usually <code>master</code>), synchronize with the same repository (central workflow) and use only <code>git pull</code> for downloading and <code>git push</code> for uploading.
This eliminates the need to deal with more complex aspects such as object model, branching and distribution; and participants can contribute improvements with just a few commands.</p>
</div>
<div class="paragraph">
<p>This results in the following workflow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Repository Klonen
$ <strong>git clone &lt;URL&gt;</strong>
# Arbeiten und lokale Commits machen
$ <strong>git add ...</strong>
$ <strong>git commit</strong>
# Veränderungen von Anderen herunterladen
$ <strong>git pull</strong>
# Eigene Veränderungen hochladen
$ <strong>git push</strong>
# Weiter arbeiten, und Synchronisation bei Bedarf wiederholen
$ <strong>git commit</strong></pre>
</div>
</div>
<div class="paragraph">
<p>This approach has advantages and disadvantages.
The advantage is certainly that only a basic understanding of Git is necessary to follow the workflow successfully.
The automatic configuration of upstream branches ensures that <code>git push</code> and <code>git pull</code> do the &#8220;right thing&#8221; without argument.
In addition, this workflow is similar to what Subversion users are used to.</p>
</div>
<div class="paragraph">
<p>However, there are also drawbacks, mainly related to implicit merging.
Suppose the team consists of two people, Beatrice and Carlos.
Both have made local commits, and Beatrice has already uploaded hers.
Carlos now runs <code>git pull</code> and receives the message <code>Merge made by recursive</code>.
If you keep the commit graph in mind, it&#8217;s logical: the local branch and the <code>master</code> of the remote have <em>diverged</em>, so they have been merged back together.
However, Carlos doesn&#8217;t understand the message, since he was working on a different part of the code than his colleague, and in his opinion no merge was necessary.
One problem is that term <em>merge</em> stores the association that many people used to have with centralized version control that changes would be merged into the same file.
With Git, however, a merge is always to be understood as the merging of commits into a commit graph.
This may mean merging changes to the same file, but it does not require it.</p>
</div>
<div class="paragraph">
<p>Besides confusing users, this workflow creates &#8220;nonsensical&#8221; commits in the history.
Ideally, merge commits should be meaningful entries in the repository history.
An outsider can immediately see that a development branch has been included.
However, this workflow inevitably involves the local <code>master</code> and its remote counterpart diverging and being merged back together.
The resulting merge commits make no sense&#8201;&#8212;&#8201;they are actually only a side effect of the workflow and reduce the readability of the history.
Although the <code>--rebase</code> option for <code>git pull</code> offers a remedy, the man page explicitly advises against using this option unless you have already internalized the principle of rebase.
Once you understand this, you&#8217;re also familiar with how the commit graph is created and how to manipulate it&#8201;&#8212;&#8201;it&#8217;s worthwhile for you to go straight for feature-driven development with branches as a workflow.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.fetch-push"><a class="anchor" href="#sec.fetch-push"></a>5.3.3.2. Distributed Git for Advanced Users</h5>
<div class="paragraph">
<p>Once you understand the object model and the commit graph, we recommend that you use a workflow that essentially consists of <code>git fetch</code>, manual merges, and many branches.
The following are some recipes as a suggestion.</p>
</div>
<div class="paragraph">
<p>If you are using <code>master</code> as your integration branch, you will need to move your local U forward after calling <code>git fetch</code>.
To be precise, you need to advance all local branches that have a remote equivalent.
Git provides the syntax <code>@{upstream}</code> and <code>@{u}</code>, which corresponds to the remote tracking branch configured for the current branch.
This can be very helpful.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Veränderungen von Anderen herunterladen
$ <strong>git remote update</strong>
...
   79170e8..003e3c7  master     -&gt; origin/master

# Den Status der Remote-Tracking-Branches abfragen
$ <strong>git branch -vv</strong>
* master 79170e8 [origin/master: behind 1] Lizenz hinzugefügt

# Veränderungen einsehen
$ <strong>git log -p ..@{u}</strong>

# Heruntergeladene Änderungen übernehmen
$ <strong>git merge @{u}</strong>
Updating 79170e8..003e3c7
Fast-forward
...

# ... oder eigene Änderungen darauf neu aufbauen
$ <strong>git rebase @{u}</strong>

# Änderungen dann hochladen
$ <strong>git push</strong></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you frequently synchronize local branches with your remote tracking branch, we recommend the following alias:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global alias.fft "merge --ff-only @{u}"</strong></pre>
</div>
</div>
<div class="paragraph">
<p>This allows you to easily move forward a branch with <code>git fft</code> (<em>Fast Forward Tracking</em>).
The <code>--ff-only</code> option prevents accidental merge commits from occurring where none should.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this context, <a href="#ch.workflows">Chapter 6, <em>Workflows</em></a> is also helpful, where it is described how to work clearly with many Topic Branches.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.uploading-commits"><a class="anchor" href="#sec.uploading-commits"></a>5.4. Uploading Commits: git push</h3>
<div class="paragraph">
<p>The counterpart to <code>fetch</code> and <code>pull</code> is the command <code>git push</code>.
This is used to upload git objects and references to a remote&#8201;&#8212;&#8201;e.g. the local <code>master</code> to the branch <code>master</code> in the remote <code>origin</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git push origin master:master</strong></pre>
</div>
</div>
<div class="paragraph">
<p>As with <code>git fetch</code>, you specify the references for uploading with a refspec.
However, the refspec has the opposite form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;local-refs&gt;:&lt;remote-refs&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This time the local references are on the left side of the colon, and the remote references on the right.</p>
</div>
<div class="paragraph">
<p>If you omit the colon and the remote reference, the local name will also be used on the remote side, and will be created by Git if it doesn&#8217;t exist:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git push origin master</strong>
Counting objects: 73, done.
Compressing objects: 100% (33/33), done.
Writing objects: 100% (73/73), 116.22 KiB, done.
Total 73 (delta 42), reused 68 (delta 40)
Unpacking objects: 100% (73/73), done.
To git@github.com:esc/git-cheatsheet-de.git
 * [new branch]      master -&gt; master</pre>
</div>
</div>
<div class="paragraph">
<p><a href="#fig.push">Figure 36, &#8220;Upload references and commits&#8221;</a> shows the process behind <code>git push</code>.
The initial situation is shown on the left (it is the result of a <code>pull</code> call).
Git uploads the missing commits D and M to the remote <code>origin</code>.
At the same time, the remote branch master is advanced to the commit M, so that it matches the local branch <code>master</code>.
In addition, the remote tracking branch <code>origin/master</code> is advanced so that it reflects the current status in the remote.</p>
</div>
<div id="fig.push" class="imageblock">
<div class="content">
<img src="images/push.svg" alt="push" width="100%">
</div>
<div class="title">Figure 36. Upload references and commits</div>
</div>
<div class="paragraph">
<p>Like <code>fetch</code>, Git refuses to update references where the target commit is not a descendant of the current commit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git push origin master</strong>
...
 ! [rejected]        master -&gt; master (non-fast-forward)
error: failed to push some refs to 'git@github.com:esc/git-cheatsheet-de.git'
To prevent you from losing history, non-fast-forward updates were
rejected
Merge the remote changes before pushing again.  See the 'Note about
fast-forwards' section of 'git push --help' for details.</pre>
</div>
</div>
<div class="paragraph">
<p>You can override this behavior either by prefixing it with a plus (<code>+</code>) in the refspec or by using the <code>--force</code> or short <code>-f</code> option:&#8288;<sup class="footnote">[<a id="_footnoteref_72" class="footnote" href="#_footnotedef_72" title="View footnote.">72</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git push origin --force master</strong>
$ <strong>git push origin +master</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Look out!
Commits may be lost on the remote side&#8201;&#8212;&#8201;for example, if you have moved a branch using <code>git reset --hard</code> and commits are no longer referenced.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll also get the error message if you have modified commits that have already been published via <code>git push</code> using <code>git rebase</code> or <code>git commit --amend</code>.
So here&#8217;s the explicit warning again: avoid modifying commits that you have already published!
The modified SHA-1 sums will cause duplication if others have already downloaded the original commits.</p>
</div>
<div class="sect3">
<h4 id="sec.push-delete"><a class="anchor" href="#sec.push-delete"></a>5.4.1. Deleting Remote References</h4>
<div class="paragraph">
<p>There are two ways to delete references in the remote: The older one (before Git version 1.7.0) is to omit the local reference in the refspec&#8201;&#8212;&#8201;this statement means you want to upload &#8220;nothing&#8221;.
So you replace an existing reference with the empty one.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git push origin :bugfix</strong></pre>
</div>
</div>
<div class="paragraph">
<p>However, newer git versions usually use the <code>git push</code> command with the <code>--delete</code> option, which is syntactically much clearer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git push origin --delete bugfix</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Note that in other clones, the remote tracking branch <code>origin/bugfix</code>, if present, does <em>not</em> automatically disappear!
See the section on <em>pruning</em> above (<a href="#sec.downloading-commits">Section 5.3, &#8220;Downloading Commits&#8221;</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.push-default"><a class="anchor" href="#sec.push-default"></a>5.4.2. Pushing without Arguments: push.default</h4>
<div class="paragraph">
<p>In everyday life you often run <code>git push</code> without specifying remote and refspec.
In this case, Git uses the configuration entries (upstream branch and <code>push.default</code>) to decide which references are sent where.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git push</strong>
...
To git@github.com:esc/git-cheatsheet-de.git
   79170e8..003e3c7  master -&gt; master</pre>
</div>
</div>
<div class="paragraph">
<p>By default, Git proceeds like this:&#8288;<sup class="footnote">[<a id="_footnoteref_73" class="footnote" href="#_footnotedef_73" title="View footnote.">73</a>]</sup> If you don&#8217;t specify a remote, Git will look for the upstream configuration of the current branch.
If the name of the branch on the remote side matches the name of the local branch, the corresponding reference is uploaded (this is to protect you from uploading, for example, your branch <code>devel</code> to <code>master</code> if the upstream configuration is incorrect).
If no upstream branch is configured, Git aborts with an error message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git push</strong>
fatal: The current branch master has no upstream branch.
To push the current branch and set the remote as upstream, use

    git push --set-upstream origin master</pre>
</div>
</div>
<div class="paragraph">
<p>If you use <code>git push &lt;remote&gt;</code> to specify a remote but no branch, Git will attempt to upload the current branch to the remote under the same name.</p>
</div>
<div class="paragraph">
<p>The strategy described here is also known as <code>simple</code>.
For most use cases, it does what the user expects and protects against avoidable errors.
However, you can set the <code>push.default</code> option responsible for this to one of the following values if required:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>nothing</code> 
</td>
<td class="hdlist2">
<p>Do not upload anything.
This is useful if you always want to explicitly specify which branch you want to upload to where.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>upstream</code> 
</td>
<td class="hdlist2">
<p>If the current branch has an upstream branch, push there.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>current</code> 
</td>
<td class="hdlist2">
<p>Push the current branch into a remote branch of the same name.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>matching</code> 
</td>
<td class="hdlist2">
<p>Uploads all locally existing references for which a reference of the same name already exists in the corresponding remote.
Attention: You are potentially uploading several branches at the same time!</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec.upstream-config"><a class="anchor" href="#sec.upstream-config"></a>5.4.3. Configuring the Upstream Branch</h4>
<div class="paragraph">
<p>In some cases, Git will automatically configure upstream branches (for example, after a <code>git clone</code>).
However, you need to do this explicitly, especially for new branches that you are uploading for the first time.
You can do this either afterwards using the <code>--set-upstream-to</code> option or, in short, <code>-u</code> of <code>git branch</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git push origin new-feature</strong>
$ <strong>git branch -u origin/new-feature</strong>
Branch new-feature set up to track remote branch new-feature from origin.</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, and if you think about it, you can also have <code>git push</code> write the configuration when you call <code>git push</code> with the <code>-u</code> option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git push -u origin new-feature</strong></pre>
</div>
</div>
<div class="paragraph">
<p>To view the upstream configuration of your branches, call <code>git branch -vv</code>.
The output shows the upstream partner of a branch (if any) in square brackets.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.remotes-check"><a class="anchor" href="#sec.remotes-check"></a>5.5. Examining Remotes</h3>
<div class="paragraph">
<p>In this section, we introduce techniques for viewing a remote and comparing your local repository to it.</p>
</div>
<div class="sect3">
<h4 id="sec.remotes-show"><a class="anchor" href="#sec.remotes-show"></a>5.5.1. Overview of a Remote</h4>
<div class="paragraph">
<p>The <code>git remote show</code> command gives a concise summary of the remote, including the branches available there, whether they are tracked locally (tracking status) and which local branches are configured for specific tasks.</p>
</div>
<div class="paragraph">
<p>The command must request the current status from the remote, i.e. the command fails if the remote is not available, e.g. due to a missing network connection.
The option <code>-n</code> prevents the query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git remote show origin</strong>
* remote origin
  Fetch URL: git://git.kernel.org/pub/scm/git/git.git
  Push  URL: git://git.kernel.org/pub/scm/git/git.git
  HEAD branch: master
  Remote branches:
    html   tracked
    maint  tracked
    man    tracked
    master tracked
    next   tracked
    pu     tracked
    todo   tracked
  Local branches configured for 'git pull':
    master merges with remote master
    pu     merges with remote pu
  Local refs configured for 'git push':
    master pushes to master (local out of date)
    pu     pushes to pu     (up to date)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.remote-branch-vv"><a class="anchor" href="#sec.remote-branch-vv"></a>5.5.2. Comparison with the Upstream</h4>
<div class="paragraph">
<p>If you have configured an upstream branch, when you change the branch (<code>git checkout</code>) and query the status (<code>git status</code>), you will receive a notification about the status of the branch compared to the upstream, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout master</strong>
Your branch is behind 'origin/master' by 73 commits, and can be
fast-forwarded.</pre>
</div>
</div>
<div class="paragraph">
<p>Here there are four different possibilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The branches point to the same commit.
Git doesn&#8217;t show any special message.
This state is also called <em>up-to-date</em>.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>The local branch has commits that are not yet available upstream:</p>
<div class="paragraph">
<p><code>Your branch is ahead of 'origin/master' by 16 commits.</code></p>
</div>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>The remote tracking branch has commits that are not yet available in the local branch:</p>
<div class="paragraph">
<p><code>Your branch is behind 'origin/master' by 73 commits, and can be fast-forwarded.</code></p>
</div>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Both the second and third conditions apply, a state called <em>diverged</em> in Git jargon:</p>
<div class="paragraph">
<p><code>Your branch and 'origin/master' have diverged, and have 16 and 73 different commit(s) each, respectively.</code></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>With the <code>-v</code> (compare only) or <code>-vv</code> (compare and upstream name) option, <code>git branch</code> displays the appropriate information for local branches:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git branch -vv</strong>
* master      0a464e9 [origin/master: ahead 1] docs: fix grammar in
git-tags.txt
  feature     cd3065f Merge branch 'kc/gitweb-pathinfo-w-anchor'
  next        be8b495 [origin/next] Merge branch master into next
  pu          0c0c536 [origin/pu: behind 3] Merge branch
'jk/maint-merge-rename-create' into pu</pre>
</div>
</div>
<div class="paragraph">
<p>The command prints the SHA-1 prefix for all branches and the commit message of the current commit.
If an upstream is configured for the branch, Git returns both the name and a comparison to the upstream.
In the example, you see four different branches.
<code>master</code> has an additional commit that has not yet been uploaded to the remote, and is therefore <em>ahead</em>.
The branch <code>feature</code>, on the other hand, has no upstream branch configured, so it currently exists only locally.
The branch <code>next</code> is <em>up-to-date</em> with the corresponding remote tracking branch.
The Branch <code>pu</code>, on the other hand, &#8220;lags&#8221; behind its upstream and is therefore displayed as <code>behind</code>.
The only state missing here is <em>diverged</em>&#8201;&#8212;&#8201;then both <em>ahead</em> and <em>behind</em> are shown including the number of &#8220;missing&#8221; commits.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.multi-remote"><a class="anchor" href="#sec.multi-remote"></a>5.6. Distributed Workflow with Multiple Remotes</h3>
<div class="paragraph">
<p>Git supports working with multiple remotes.
A popular workflow that takes advantage of this feature is the <em>Integration Manager Workflow</em>.
There is no &#8220;central&#8221; repository in the true sense of the word, that is, one that all active developers have write access to.
Instead, there is only a quasi-official repository called <em>blessed</em>.
It is accessible, for example, via the respective project domain and allows only the most important maintainers (or even only one) write access.</p>
</div>
<div class="paragraph">
<p>Everyone who wants to contribute to the project clones the blessed repository and starts working.
As soon as he has fixed bugs or implemented a new feature, he makes his improvements available via a publicly accessible repository, a so-called <em>developer public</em>.
He then sends a <em>pull request</em> to one of the maintainers of the official repository (or to the mailing list), requesting that certain code from his public repository be transferred to the official repository.
You can see the infrastructure for this process in <a href="#fig.developer-public-workflow">Figure 37, &#8220;Integration Manager Workflow&#8221;</a>.
Although it is theoretically possible to give interested parties direct access to your development machine, this almost never happens in practice.</p>
</div>
<div id="fig.developer-public-workflow" class="imageblock text-center">
<div class="content">
<img src="images/integration-manager-workflow.svg" alt="integration manager workflow" width="70%">
</div>
<div class="title">Figure 37. Integration Manager Workflow</div>
</div>
<div class="paragraph">
<p>One of the maintainers who have access to the master repository then checks if the code works, if it meets the quality requirements, etc.
Any errors or ambiguities are reported to the author of the code, who then corrects them in his repository.
Only when the maintainer is satisfied does he commit the changes to the master repository, so that the code is delivered in one of the following releases.
Maintainers who integrate new code are often referred to as <em>Integration Managers</em>, which gives the workflow its name.
Such maintainers often have several remotes configured, one for each contributor.</p>
</div>
<div class="paragraph">
<p>One of the great advantages of this workflow is that, in addition to the maintainers, interested users, such as colleagues or friends of the developer, also have access to the public developer repositories.
They don&#8217;t have to wait until the code has found its way into the official repository, but can try out the improvements immediately after deployment.
The hosting platform Github in particular relies heavily on this workflow.
The web interface used there offers a lot of features to support this workflow, e.g. a visualization that shows all available clones of a project and the commits contained in them, as well as the possibility to perform merges directly in the web interface.
For a detailed description of this service, see <a href="#ch.github">Chapter 11, <em>GitHub</em></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec.managing-remotes"><a class="anchor" href="#sec.managing-remotes"></a>5.7. Managing Remotes</h3>
<div class="paragraph">
<p>With <code>git remote</code> you can manage additional remotes.
For example, to add a new remote from another developer, use the command <code>git remote add</code>.
Most of the time you&#8217;ll want to initialize the remote tracking branches afterwards, which you can do with <code>git fetch</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git remote add example git://example.com/example.git</strong>
$ <strong>git fetch example</strong>
...</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To do both steps in one call, use the <code>-f</code> option, for <em>fetch</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git remote add -f example git://example.com/example.git</strong></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you no longer need the remote, you can remove it from your local configuration using <code>git remote rm</code>.
This will also delete all remote tracking branches for that remote:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git remote rm example</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Remotes do not necessarily have to be configured via <code>git remote add</code>.
You can simply use the URL on the command line,&#8288;<sup class="footnote">[<a id="_footnoteref_74" class="footnote" href="#_footnotedef_74" title="View footnote.">74</a>]</sup> for example to download the objects and references for a bugfix:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git fetch git://example.com/example.git bugfix:bugfix</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Of course this also works with <code>pull</code> and <code>push</code>.</p>
</div>
<div class="paragraph">
<p>If you work with several remotes, the command <code>git remote update --prune</code> is a good choice.
This will <code>fetch</code> all remotes, and the <code>--prune</code> option will delete all expired remote tracking branches.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The following alias has proved to be very useful for us, as it combines many work steps that are often performed one after the other in practice:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global alias.ru "remote update --prune"</strong></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec.pull-request"><a class="anchor" href="#sec.pull-request"></a>5.7.1. Pull-Request</h4>
<div class="paragraph">
<p>To generate a pull request automatically, there is the git command <code>request-pull</code>.
The syntax is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git request-pull &lt;start&gt; &lt;URL&gt; [&lt;end&gt;]</pre>
</div>
</div>
<div class="paragraph">
<p>As <code>&lt;URL&gt;</code> you specify your public repository (either as the actual URL or as a configured remote repository), and as <code>&lt;start&gt;</code> you select the reference on which the feature is built (in many cases the branch <code>master</code>, which should match the master branch of the official repository).
Optionally, you can specify an <code>&lt;end&gt;</code>; if you omit this, Git will use <code>HEAD</code>.</p>
</div>
<div class="paragraph">
<p>The output is by default STDOUT, and includes the repository&#8217;s URL and branch name, a short description of all commits by author, and a diff state, i.e., a balance of added and deleted lines by file.
This output can easily be forwarded to an e-mail program.
If you add the <code>-p</code> option, a patch with all changes is appended below the text.</p>
</div>
<div class="paragraph">
<p>For example, to ask someone to download the two latest commits from a repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git request-pull HEAD~2 origin</strong>
The following changes since commit d2640ac6a1a552781[...]c48e08e695d53:

  README verbessert (2010-11-20 21:27:20 +0100)

are available in the git repository at:
  git@github.com:esc/git-cheatsheet-de.git master

Valentin Haenel (2):
      Lizenz hinzugefügt
      URL hinzugefügt und Metadaten neu formatiert

 cheatsheet.pdf |  Bin 89513 -> 95619 bytes
 cheatsheet.tex |   18 ++++++++++++++++--
 2 files changed, 16 insertions(), 2 deletions(-)</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.remote-tags"><a class="anchor" href="#sec.remote-tags"></a>5.8. Exchanging Tags</h3>
<div class="paragraph">
<p>Tags are also exchanged with the remote commands <code>fetch</code> or <code>pull</code> and <code>push</code>.
In contrast to branches, which change, tags are &#8220;static&#8221;.
For this reason, remote tags are not referenced locally again, so there is no equivalent to the remote tracking branches for the tags.
Tags that you get from your remote repositories are stored by Git as <code>.git/refs/tags/</code> or <code>.git/packed-refs</code>, as usual.</p>
</div>
<div class="sect3">
<h4 id="sec.tags-download"><a class="anchor" href="#sec.tags-download"></a>5.8.1. Downloading Tags</h4>
<div class="paragraph">
<p>In principle, Git automatically downloads new tags when you call <code>git fetch</code> or <code>git pull</code>.
That is, if you download a commit that has a tag pointing to it, that tag will be included.
However, if you use a refspec to exclude individual branches, then commits in those branches will not be downloaded, and thus no tags that may point to those commits will be downloaded.
Conclusion: Git only downloads relevant tags.
With the options <code>--no-tags</code> (no tags) and <code>--tags</code> or <code>-t</code> (all tags) you can adjust the default behavior.
Note, however, that <code>--tags</code> not only downloads the tags, but necessarily the commits to which they point.</p>
</div>
<div class="paragraph">
<p>Git notifies you when new tags arrive:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git fetch</strong>
[fetch output]
From git://git.kernel.org/pub/scm/git/git
 * [new tag]         v1.7.4.2   -&gt; v1.7.4.2</pre>
</div>
</div>
<div class="paragraph">
<p>If you want to know what tags are present on the remote side, use <code>git ls-remote</code> with the <code>--tags</code> option.
For example, you can get all release candidates of git version <code>1.7.1</code> with the following call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git ls-remote origin --tags v1.7.1-rc*</strong>
bdf533f9b47dc58ac452a4cc92c81dc0b2f5304f    refs/tags/v1.7.1-rc0
537f6c7fb40257776a513128043112ea43b5cdb8    refs/tags/v1.7.1-rc0^{}
d34cb027c31d8a80c5dbbf74272ecd07001952e6    refs/tags/v1.7.1-rc1
b9aa901856cee7ad16737343f6a372bb37871258    refs/tags/v1.7.1-rc1^{}
03c5bd5315930d8d88d0c6b521e998041a13bb26    refs/tags/v1.7.1-rc2
5469e2dab133a197dc2ca2fa47eb9e846ac19b66    refs/tags/v1.7.1-rc2^{}</pre>
</div>
</div>
<div class="paragraph">
<p>Git outputs the SHA-1 sums of the tags and their contents.&#8288;<sup class="footnote">[<a id="_footnoteref_75" class="footnote" href="#_footnotedef_75" title="View footnote.">75</a>]</sup></p>
</div>
</div>
<div class="sect3">
<h4 id="sec.uploading-tags"><a class="anchor" href="#sec.uploading-tags"></a>5.8.2. Uploading Tags</h4>
<div class="paragraph">
<p>Git does not automatically upload tags.
You need to pass them explicitly to <code>git push</code>, similar to the branches, e.g. to upload the tag <code>v0.1</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git push origin v0.1</strong></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to upload all tags at once, use the <code>--tags</code> option.
But be careful: Avoid this option if you use Annotated Tags to mark versions and Lightweight Tags to mark something locally, as described in <a href="#sec.tags">Section 3.1.3, &#8220;Tags&#8201;&#8212;&#8201;Marking Important Versions&#8221;</a>, because with this option you would upload <em>all</em> tags, as already mentioned.</p>
</div>
<div class="paragraph">
<p>Attention: Once you have uploaded a tag, you should never change it!
The reason: Let&#8217;s say Axel changes a tag, like <code>v0.7</code>, that he has already released.
First it pointed to the <code>5b6eef</code> commit, and now to <code>bab18e</code>.
Beatrice had already downloaded the first version pointing to <code>5b6eef</code>, but Carlos had not yet.
The next time Beatrice calls <code>git pull</code>, Git won&#8217;t download the new version from the <code>v0.7</code> tag; the assumption is that tags don&#8217;t change, so Git doesn&#8217;t check the validity of the tag!
When Carlos now runs <code>git pull</code>, he also gets the <code>v0.7</code> tag, but it now points to <code>bab18e</code>.
Finally, two versions of the tag&#8201;&#8212;&#8201;each pointing to different commits --- are in circulation.
Not a very helpful situation.
It gets really confusing when both Carlos and Beatrice use the same public repository, and upload all tags by default.&#8288;<sup class="footnote">[<a id="_footnoteref_76" class="footnote" href="#_footnotedef_76" title="View footnote.">76</a>]</sup>
The tag &#8220;jumps&#8221; back and forth between two commits in the public repository, so to speak; which version you get with a clone depends on who pushed last.</p>
</div>
<div class="paragraph">
<p>If you do get this mishap, you have two options:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The sensible alternative: Instead of replacing the tag, create a new one and upload it as well.
Name the new tag according to the project conventions.
If the old tag is <code>v0.7</code>, name the new one something like <code>v0.7.1</code>.</p>
</li>
<li>
<p>If you really want to replace the tag: Admit publicly (mailing list, wiki, blog) that you made a mistake.
Let all developers and users know that a tag has changed and ask them to check the tag with you.
The size of the project and your willingness to take risks will determine whether this solution is feasible.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.patch-queue"><a class="anchor" href="#sec.patch-queue"></a>5.9. Patches via E-mail</h3>
<div class="paragraph">
<p>An alternative to setting up a public repository is to automatically send patches via email.
The format of the email is chosen so that maintainers can have Git automatically apply patches received via email.
Especially for small bug fixes and sporadic collaboration, this is usually less time-consuming and faster.
There are many projects that rely on this type of exchange, most notably the Git project itself.</p>
</div>
<div class="paragraph">
<p>The majority of patches for Git are contributed via the mailing list.
There they go through a stringent review process, which usually leads to corrections and improvements.
The patches are improved by the author and sent back to the list until a consensus is reached.
Meanwhile, the maintainer regularly stores the patches in a branch in his repository, and makes them available for testing via the <code>pu</code> branch.
If the patch series is considered finished by the participants on the list, the branch moves on to the different integration branches <code>pu</code> and <code>next</code>, where the changes are tested for compatibility and stability.
If everything is in order, the branch finally ends up in the <code>master</code> and from there forms part of the next release.</p>
</div>
<div class="paragraph">
<p>The approach <em>patches via e-mail</em> is realized by the following git commands:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>git format-patch</code> 
</td>
<td class="hdlist2">
<p>Format commits for sending as patches.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>git send-email</code> 
</td>
<td class="hdlist2">
<p>Send patches.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>git am</code> 
</td>
<td class="hdlist2">
<p>Add patches from a mailbox to the current branch (<em>a</em>pply from <em>m</em>ailbox).</p>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec.exporting-patches"><a class="anchor" href="#sec.exporting-patches"></a>5.9.1. Exporting Patches</h4>
<div class="paragraph">
<p>The <code>git format-patch</code> command exports one or more commits as patches in Unix mailbox format and prints one file per commit.
The file names consist of a sequential numbering and the commit message, and end in <code>.patch</code>.&#8288;<sup class="footnote">[<a id="_footnoteref_77" class="footnote" href="#_footnotedef_77" title="View footnote.">77</a>]</sup>
As an argument, the command expects either a single commit or a range such as <code>A..B</code>.
If you specify a single commit, Git will evaluate this as the selection from the commit to the <code>HEAD</code>.</p>
</div>
<div id="fig.gitk-screen-format-patch" class="imageblock">
<div class="content">
<img src="images/gitk-screen-format-patch.png" alt="gitk screen format patch" width="90%">
</div>
<div class="title">Figure 38. Formatting three commits to 'master' as patches</div>
</div>
<div class="paragraph">
<p><a href="#fig.gitk-screen-format-patch">Figure 38, &#8220;Formatting three commits to 'master' as patches&#8221;</a> shows the initial situation.
We want to export the three commits in the <code>fix-git-svn-docs</code> branch, that is, all commits from <code>master</code>, as patches:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git format-patch master</strong>
0001-git-svn.txt-fix-usage-of-add-author-from.patch
0002-git-svn.txt-move-option-descriptions.patch
0003-git-svn.txt-small-typeface-improvements.patch</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To export only the <code>HEAD</code>, use option <code>-1</code>, and <code>format-patch</code> will create a patch for the first commit only:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git format-patch -1</strong>
0001-git-svn.txt-small-typeface-improvements.patch</pre>
</div>
</div>
<div class="paragraph">
<p>This also works for any SHA-1 sums:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git format-patch -1 9126ce7</strong>
0001-git-svn.txt-fix-usage-of-add-author-from.patch</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The generated files contain, among other things, the header fields <code>From</code>, <code>Date</code> and <code>Subject</code>, which are used for sending as e-mail.
These fields are completed using the information available in the commit&#8201;&#8212;&#8201;author, date, and commit message.
The files also contain a diff-stat summary and the changes themselves as a patch in unified diff format.
The <code>[PATCH m/n]</code> suffix&#8288;<sup class="footnote">[<a id="_footnoteref_78" class="footnote" href="#_footnotedef_78" title="View footnote.">78</a>]</sup> in the subject line is used later by Git to apply the patches in the correct order.</p>
</div>
<div class="paragraph">
<p>A corresponding excerpt follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cat 0003-git-svn.txt-small-typeface-improvements.patch</strong>
From 6cf93e4dae1e5146242338b1b9297e6d2d8a08f4 Mon Sep 17 00:00:00 2001
From: Valentin Haenel <valentin.haenel@gmx.de>
Date: Fri, 22 Apr 2011 18:18:55 0200
Subject: [PATCH 3/3] git-svn.txt: small typeface improvements

Signed-off-by: Valentin Haenel <valentin.haenel@gmx.de>
Acked-by: Eric Wong <normalperson@yhbt.net>
---
 Documentation/git-svn.txt |    8 ++++----
 1 files changed, 4 insertions(), 4 deletions(-)

diff --git a/Documentation/git-svn.txt b/Documentation/git-svn.txt
...</pre>
</div>
</div>
<div class="paragraph">
<p>If you plan to send a series of patches, it is recommended that you use the <code>--cover-letter</code> option to create a kind of &#8220;cover page&#8221; in which you describe the series.
By default the file is called <code>0000-cover-letter.patch</code>.
Apart from the default headers, such a file looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Subject: [PATCH 0/3] *** SUBJECT HERE ***

*** BLURB HERE ***

Valentin Haenel (3):
  git-svn.txt: fix usage of --add-author-from
  git-svn.txt: move option descriptions
  git-svn.txt: small typeface improvements

 Documentation/git-svn.txt |   22 +++++++++++-----------
 1 files changed, 11 insertions(+), 11 deletions(-)</pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, the <code>Subject:</code> still has the prefix <code>[PATCH 0/3]</code>; this way, all recipients can immediately see that it is a cover page.
The file also contains the output of <code>git shortlog</code> and <code>git diff --stat</code>.
Replace <code><strong>* SUBJECT HERE </strong><strong></code> with a subject and <code><strong></strong> BLURB HERE </strong>*</code> with a summary of the patch series.
Send the file together with the patch files.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Frequently, mailing lists to which patches are sent are used to criticize the patches in terms of content and syntax and to ask the author for improvement.
Once the author has made the improvements, he sends the corrected series back to the list as a <em>reroll</em>.
Depending on the size of the patch series and the requirements of the project, a patch series may go through several rerolls until it is accepted.</p>
</div>
<div class="paragraph">
<p>When you send a patch series to a mailing list: Keep the commits on a separate branch, and incorporate the fixes in new commits (for missing functionality) or with interactive rebase (to adjust existing commits).
Then use the <code>git format-patch</code> command with the <code>--reroll-count=&lt;n&gt;</code> option (or <code>-v &lt;n&gt;</code> for short): this will create patches with <code>[PATCH v2]</code> as the subject line, making it clear that this is the first reroll in the series.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec.sending-patches"><a class="anchor" href="#sec.sending-patches"></a>5.9.2. Sending Patches</h4>
<div class="paragraph">
<p>Send the generated files with <code>git send-email</code> (or an email client of your choice).
The command expects as its only mandatory argument either one or more patch files, a directory full of patches, or a selection of commits (in which case Git also calls <code>git format-patch</code> internally):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git send-email 000*</strong>
0000-cover-letter.patch
0001-git-svn.txt-fix-usage-of-add-author-from.patch
0002-git-svn.txt-move-option-descriptions.patch
0003-git-svn.txt-small-typeface-improvements.patch
Who should the emails appear to be from? [Valentin Haenel
&lt;valentin.haenel@gmx.de&gt;]

$ <strong>git send-email master</strong>
/tmp/HMSotqIfnB/0001-git-svn.txt-fix-usage-of-add-author-from.patch
/tmp/HMSotqIfnB/0002-git-svn.txt-move-option-descriptions.patch
/tmp/HMSotqIfnB/0003-git-svn.txt-small-typeface-improvements.patch
Who should the emails appear to be from? [Valentin Haenel
&lt;valentin.haenel@gmx.de&gt;]</pre>
</div>
</div>
<div class="paragraph">
<p>The command <code>git send-email</code> sets the fields <code>Message-Id</code> and <code>In-Reply-To</code>.
This makes all e-mails after the first one look like replies to them and thus most mail programs will display them as a continuous <em>thread</em>:&#8288;<sup class="footnote">[<a id="_footnoteref_79" class="footnote" href="#_footnotedef_79" title="View footnote.">79</a>]</sup></p>
</div>
<div id="fig.mail-thread" class="imageblock">
<div class="content">
<img src="images/mail-thread.png" alt="mail thread" width="100%">
</div>
<div class="title">Figure 39. Patch series as mail thread</div>
</div>
<div class="paragraph">
<p>You can customize the command with options such as <code>--to</code>, <code>--from</code> and` --cc` (see the <code>git-send-email(1)</code> man page).
However, if not specified, the essential information is queried interactively&#8201;&#8212;&#8201;most important is an address to which the patches should be sent.&#8288;<sup class="footnote">[<a id="_footnoteref_80" class="footnote" href="#_footnotedef_80" title="View footnote.">80</a>]</sup></p>
</div>
<div class="paragraph">
<p>Before the emails are actually sent, you will see the header again; you should check if everything is as you want it, and then answer  the question` Send this email? ([y]es|[n]o|[q]uit|[a]ll):` answer with <code>y</code> for &#8220;yes&#8221;.
To get familiar with the command, you can first send all emails only to yourself or use the <code>--dry-run</code> option.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As an alternative to <code>git send-email</code>, you can post the contents of the files to one of the many online <em>pastebin</em> services, for example <em>dpaste</em>&#8288;<sup class="footnote">[<a id="_footnoteref_81" class="footnote" href="#_footnotedef_81" title="View footnote.">81</a>]</sup> or <em>gist.github</em>&#8288;<sup class="footnote">[<a id="_footnoteref_82" class="footnote" href="#_footnotedef_82" title="View footnote.">82</a>]</sup>, and send the reference to it via IRC or Jabber.
For pastebin, the recipient downloads the content into a file and submits it via <code>git am</code> (see below).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you want to use your preferred <em>Mail User Agent</em> (MUA) (e.g. Thunderbird, Kmail or others) to send patches, there may be a few things to consider.
Some MUAs are notorious for mutilating patches so that Git won&#8217;t recognize them as such.&#8288;<sup class="footnote">[<a id="_footnoteref_83" class="footnote" href="#_footnotedef_83" title="View footnote.">83</a>]</sup></p>
</div>
</div>
<div class="sect3">
<h4 id="sec.applying-patches"><a class="anchor" href="#sec.applying-patches"></a>5.9.3. Applying Patches</h4>
<div class="paragraph">
<p>Patch emails exported with <code>git format-patch</code> are translated back into commits by the git command <code>git am</code> (<em>apply from mailbox</em>).
A new commit is created from each email, and its meta-information (author, commit message, etc.) is generated from the email header lines (<code>From</code>, <code>Date</code>).
As mentioned earlier, Git uses the number in the subject to determine the order in which the commits should be entered.
To complete the example from earlier: If the emails are in the Maildir directory <code>patches</code>, then that&#8217;s enough:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git am patches</strong>
Applying: git-svn.txt: fix usage of --add-author-from
Applying: git-svn.txt: move option descriptions
Applying: git-svn.txt: small typeface improvements</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The command understands <em>Maildir</em> and <em>mbox</em> formats as well as files that contain the output of <code>git format-patch</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git \</strong>
  <strong>am 0001-git-svn.txt-fix-usage-of-add-author-from.patch</strong>
Applying: git-svn.txt: fix usage of --add-author-from</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you apply patches from others using <code>git am</code>, the values of <em>Author</em>/<em>AuthorDate</em> and <em>Committer</em>/<em>CommitDate</em> are different.
This means that both the author of the commit and the person who commits it are honored.
In particular, the attributes are retained; it remains traceable who wrote which lines of code.
With Gitk, the author and committer values are displayed by default; on the command line, set the <code>--format=fuller</code> option, which is accepted by <code>git log</code> and <code>git show</code>, among others:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show --format=fuller  12d3065</strong>
commit 12d30657d411979af3ab9ca7139b5290340e4abb
Author:     Valentin Haenel &lt;valentin.haenel@gmx.de&gt;
AuthorDate: Mon Apr 25 23:36:15 2011 +0200
Commit:     Junio C Hamano &lt;gitster@pobox.com&gt;
CommitDate: Tue Apr 26 11:48:34 2011 -0700

    git-svn.txt: fix usage of --add-author-from</pre>
</div>
</div>
<div class="paragraph">
<p>With the <em>Dictator and Lieutenants</em> Workflow (<a href="#sec.dictator">Section 5.10, &#8220;A Distributed, Hierarchical Workflow&#8221;</a>), it can happen that more than two people are involved in a commit.
In this case, it makes sense that everyone who reviews the patch also &#8220;approves&#8221; it, especially the author.
For this purpose, there is a <code>--signoff</code> option (<code>-s</code> for short) for the <code>git commit</code> and <code>git am</code> commands, which appends the committer&#8217;s name and email to the commit message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Signed-off-by: Valentin Haenel &lt;valentin.haenel@gmx.de&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This feature is especially useful for larger projects, which usually have guidelines on how to format commits and how best to send them.&#8288;<sup class="footnote">[<a id="_footnoteref_84" class="footnote" href="#_footnotedef_84" title="View footnote.">84</a>]</sup></p>
</div>
<div class="paragraph">
<p>Conflicts can occur when patches are entered with <code>git am</code>, e.g. if the patches are based on an older version and the lines concerned have already been changed.
In this case, the process is interrupted and you then have several options for how to proceed.
Either resolve the conflict, update the index and continue the process with <code>git am --continue</code>, or skip the patch with <code>git am --skip</code>.
Use <code>git am --abort</code> to abort the process and restore the current status of the branch.</p>
</div>
<div class="paragraph">
<p>Because patches usually contain changes made by others, it can sometimes be difficult to find the right solution to a conflict.
The best strategy for patches that cannot be applied is to ask the author of the patches to rebase them to a well-defined base, such as the current <code>master</code>, and send them again.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>An alternative to <code>git am</code> is the somewhat rudimentary command <code>git apply</code>.
It is used to apply a patch to the working tree or index (with the <code>--index</code> option).
It is similar to the classic Unix command <code>patch</code>.
It is especially useful if you want to edit the patch or metadata before committing, or if someone has sent you the output of <code>git diff</code> instead of <code>git format-patch</code> as a patch.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.dictator"><a class="anchor" href="#sec.dictator"></a>5.10. A Distributed, Hierarchical Workflow</h3>
<div class="paragraph">
<p>The Integration Manager workflow does not scale with the size of the project.
With large growth, at some point the maintainer is overwhelmed by the complexity of the project and the number of incoming patches.
The so-called <em>Dictator and Lieutenants</em> workflow, which is used extensively in the development of the Linux kernel, provides a remedy.
In this case, the software is usually divided into different subsystems, and contributions are examined by the <em>lieutenants</em> (also <em>subsystem maintainers</em>) and then forwarded to the <em>Benevolent Dictator</em>.
The Benevolent Dictator uploads the changes to the <em>blessed</em> repository, which in turn is synchronized with all other participants.</p>
</div>
<div id="fig.dictator" class="imageblock">
<div class="content">
<img src="images/patches-via-email.svg" alt="patches via email" width="90%">
</div>
<div class="title">Figure 40. Workflow: <em>Dictator and Lieutenants</em></div>
</div>
<div class="paragraph">
<p>The workflow is based on trust: The dictator trusts his lieutenants and usually takes over their forwarded modifications without control.
The advantage is that the dictator is exonerated, but still retains a veto right, which led to the title Benevolent Dictator.</p>
</div>
<div class="paragraph">
<p>For historical reasons, the official repository is often only the public repository of the current main maintainer or the original author.
It is important to note that this repository exists only because of social conventions.
Should another developer one day better advance the project, his public repository may become the new Blessed Repository.
From a technical point of view, there is no reason not to do so.</p>
</div>
<div class="paragraph">
<p>The projects that use this workflow in practice prefer to exchange patches by mail.
However, the nature of the exchange is secondary, and subsystem maintainers may just as well receive pull requests from developers they know; or they may mix public repositories and patches sent by email at will.
Git&#8217;s flexibility&#8201;&#8212;&#8201;especially the variety of different methods for exchanging changes&#8201;&#8212;&#8201;supports every conceivable workflow in the spirit of free, open development.
Certainly a feature that has contributed greatly to Git&#8217;s popularity.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec.subprojects"><a class="anchor" href="#sec.subprojects"></a>5.11. Managing Subprojects</h3>
<div class="paragraph">
<p>For larger software projects, it is sometimes necessary to outsource certain parts of a program into separate projects.
This is the case in the following situations, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your software depends on a specific version of a library that you want to ship with the source code.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Your initially small project grows so large over time that you want to move functionality to a library that you want to manage as a separate project.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Independent parts of your software are managed by other development groups.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With Git, you can use it in two different ways: You can manage the modules as <em>Git submodules</em> or as <em>subtrees</em>&#8201;&#8212;&#8201;in either case, you manage source code in a subdirectory of your project.</p>
</div>
<div class="paragraph">
<p>As submodules, you manage an isolated repository that has nothing to do with your parent repository.
If you work with subtrees instead, the project history of the subdirectory becomes inseparable from the parent project.
Both have advantages and disadvantages.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll look at both techniques by way of example, creating a fictional project that requires <code>libgit2</code>.
The library provides, similar to <code>libgit.a</code>, an API to examine and modify Git repositories.&#8288;<sup class="footnote">[<a id="_footnoteref_85" class="footnote" href="#_footnotedef_85" title="View footnote.">85</a>]</sup>
The library, written in C, can extend its functions to Lua, Ruby, Python, PHP and JavaScript, among others.</p>
</div>
<div class="sect3">
<h4 id="sec.submodules"><a class="anchor" href="#sec.submodules"></a>5.11.1. Submodules</h4>
<div class="paragraph">
<p>Submodules are managed by Git as subdirectories that have a special entry in the <code>.gitmodules</code> file.
The command <code>git submodule</code> is responsible for handling them.</p>
</div>
<div class="paragraph">
<p>First we need to import the library.
This is done with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git submodule add git://github.com/libgit2/libgit2.git libgit2</strong>
Cloning into libgit2...
remote: Counting objects: 4296, done.
remote: Compressing objects: 100% (1632/1632), done.
remote: Total 4296 (delta 3214), reused 3530 (delta 2603)
Receiving objects: 100% (4296/4296), 1.92 MiB | 788 KiB/s, done.
Resolving deltas: 100% (3214/3214), done.</pre>
</div>
</div>
<div class="paragraph">
<p>From the output of <code>git status</code> we can now see that there is a new directory <code>libgit2</code> and that the file <code>.gitmodules</code> with the following content has been created</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[submodule "libgit2"]
  path = libgit2
  url = git://github.com/libgit2/libgit2.git</pre>
</div>
</div>
<div class="paragraph">
<p>This file has already been added to the index, prepared for committing.
The <code>libgit2</code> directory, on the other hand, does not appear in the output of <code>git diff --staged</code> as usual:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git diff --staged -- libgit2</strong>
diff --git a/libgit2 b/libgit2
new file mode 160000
index 0000000..b64e11d
--- /dev/null
+++ b/libgit2
@@ -0,0 +1 @@
+Subproject commit 7c80c19e1dffb4421f91913bc79b9cb7596634a4</pre>
</div>
</div>
<div class="paragraph">
<p>Instead of listing all the files in the directory, Git saves a &#8220;special&#8221; file (recognizable by the unusual file mode <code>160000</code>) that simply records the commit the module is currently on.</p>
</div>
<div class="paragraph">
<p>We import these changes, and from now on we can compile <code>libgit2</code> in its subdirectory and then link against it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git commit -m "libgit2-submodule importiert"</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The parent project and <code>libgit2</code> are now merged in the working tree, but their version history is and remains separate.
In the Git repository of <code>libgit2</code> you can behave exactly the same way as in a &#8220;real&#8221; repository.
For example, you can look at the output of <code>git log</code> in the parent project and after a <code>cd libgit2</code> in the submodule.</p>
</div>
<div class="sect4">
<h5 id="sec.submodule-mod"><a class="anchor" href="#sec.submodule-mod"></a>5.11.1.1. Changes in Submodules</h5>
<div class="paragraph">
<p>Now <code>libgit2</code> has selected the branch development as default branch (i.e. the <code>HEAD</code> on the server side).
It may not be the best idea to more or less wire this development branch to your repository.</p>
</div>
<div class="paragraph">
<p>So we change to the <code>libgit2</code> directory and check out the latest tag, <code>v0.10.0</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd libgit2</strong>
$ <strong>git checkout v0.10.0</strong>
# Nachricht über "detached HEAD state"
$ <strong>cd ..</strong>
$ <strong>git diff</strong>
diff --git a/libgit2 b/libgit2
index 7c80c19..7064938 160000
--- a/libgit2
+++ b/libgit2
@@ -1 +1 @@
-Subproject commit 7c80c19e1dffb4421f91913bc79b9cb7596634a4
+Subproject commit 7064938bd5e7ef47bfd79a685a62c1e2649e2ce7</pre>
</div>
</div>
<div class="paragraph">
<p>So the parent Git repository sees a change of <code>HEAD</code>, which was done by the <code>git checkout v0.10.0</code> command in <code>libgit2/</code>, as a change to the pseudo-file <code>libgit2</code>, which now points to the corresponding new commit.</p>
</div>
<div class="paragraph">
<p>Now we can add this change to the index and save it as a commit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git add libgit2</strong>
$ <strong>git commit -m "Libgit2-Version auf v0.10.0 setzen"</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Attention: Never add <em>files</em> from <code>libgit2</code> or the <em>directory</em> <code>libgit2/</code> (ends with slash)&#8201;&#8212;&#8201;this breaks the modular concept of Git, you will suddenly manage files from the submodules in the parent project.</p>
</div>
<div class="paragraph">
<p>Similarly, you can use <code>submodule update</code> (or <code>git remote update</code> in the <code>libgit2/</code> directory) to download new commits and record a library update in the parent repository accordingly.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.submodule-userview"><a class="anchor" href="#sec.submodule-userview"></a>5.11.1.2. From a User Perspective</h5>
<div class="paragraph">
<p>So what does it all look like from the perspective of a user cloning the project for the first time?
First, it&#8217;s obvious that the submodule(s) are <em>not</em> hard-coded into the repository and are not shipped with it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone /dev/shm/super clone-super</strong>
$ <strong>cd clone-super</strong>
$ <strong>ls</strong>
bar.c  foo.c  libgit2/
$ <strong>ls -l libgit2</strong>
total 0</pre>
</div>
</div>
<div class="paragraph">
<p>The directory <code>libgit2/</code> is empty.
So everything Git knows about the submodules is in the <code>.gitmodules</code> file.
You need to initialize this module first and then download the module&#8217;s repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git submodule init</strong>
Submodule 'libgit2' (git://github.com/libgit2/libgit2.git)
registered for path 'libgit2'
$ <strong>git submodule update</strong>
...
Submodule path 'libgit2': checked out '7064938bd5e7ef47bfd79a685a62c1e2649e2ce7'</pre>
</div>
</div>
<div class="paragraph">
<p>So we see that <code>libgit2</code> is automatically set to the <code>v0.10.0</code> version  defined in our repository.
But in principle the user can now also change to the directory, check out the branch <code>development</code> and compile the project against this version.
Submodules get the flexibility of the sub-repository&#8201;&#8212;&#8201;so the entry on which state the module is on is only a &#8220;recommendation&#8221;.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.subtrees"><a class="anchor" href="#sec.subtrees"></a>5.11.2. Subtrees</h4>
<div class="paragraph">
<p>Unlike submodules, which maintain their character as a standalone Git repository, when you work with Subtrees, you directly merge the history of two projects.
A comparison of the two approaches follows.</p>
</div>
<div class="paragraph">
<p>Essentially, this technique is based on so-called subtree-merges, which were briefly discussed in <a href="#sec.merge-strategies">Section 3.3.3, &#8220;Merging Strategies&#8221;</a> about merge strategies.
In our example, a subtree-merge is done by merging regular commits from the <code>libgit2</code> repository under the <code>libgit2/</code> <em>tree</em> (directory)&#8201;&#8212;&#8201;a top-level file in the library repository thus becomes a top-level file in the <code>libgit2/</code> tree, which in turn is part of the repository.</p>
</div>
<div class="paragraph">
<p>Git has a command to manage subtree-merges.&#8288;<sup class="footnote">[<a id="_footnoteref_86" class="footnote" href="#_footnotedef_86" title="View footnote.">86</a>]</sup>
You must always explicitly specify which subdirectory you are referring to by using <code>-P &lt;prefix&gt;</code>.
To import the <code>libgit2</code> in version 0.8.0, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git subtree add -P libgit2 \</strong>
  <strong>git://github.com/libgit2/libgit2.git v0.8.0</strong>
git fetch git://github.com/libgit2/libgit2.git v0.8.0
From git://github.com/libgit2/libgit2
 * tag               v0.8.0     -&gt; FETCH_HEAD
Added dir 'libgit2'</pre>
</div>
</div>
<div class="paragraph">
<p>The command automatically downloads all required commits and creates a merge commit that creates all the files of <code>libgit2</code> under the directory <code>libgit2/</code>.
The merge commit now links the previous version history to that of <code>libgit2</code> (by referencing an original commit and then referencing other commits).</p>
</div>
<div class="paragraph">
<p>The result of this procedure is that your repository now contains all relevant commits from <code>libgit2</code>.
Your repository now has two root commits (see also multi-root repositories in <a href="#sec.multi-root">Section 4.7, &#8220;Multiple root commits&#8221;</a>).</p>
</div>
<div class="paragraph">
<p>The files are now stored inseparably linked to the project.
A <code>git clone</code> of this repository would also transfer all files under libgit2.&#8288;<sup class="footnote">[<a id="_footnoteref_87" class="footnote" href="#_footnotedef_87" title="View footnote.">87</a>]</sup></p>
</div>
<div class="paragraph">
<p>Now what happens when you want to &#8220;upgrade&#8221; to <code>v0.10.0</code>?
Use the <code>pull</code> command from <code>git subtree</code> for this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git subtree -P libgit2 \</strong>
  <strong>pull git://github.com/libgit2/libgit2.git v0.10.0</strong>
From git://github.com/libgit2/libgit2
 * tag               v0.10.0    -&gt; FETCH_HEAD
Merge made by the 'recursive' strategy.
...</pre>
</div>
</div>
<div class="paragraph">
<p>Note: Since the original <code>libgit2</code> commits are present, these commits also seem to change top-level files (e.g., <code>COPYING</code> when you use <code>git log --name-status</code> to examine the version history).
In fact, these changes are actually made in <code>libgit2</code>, which is the responsibility of the merge commit, which aligns the trees accordingly.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you&#8217;re not interested in the version history of a subproject, but want to anchor a particular state in the repository, you can use the <code>--squash</code> option.
The <code>git subtree add</code>/<code>pull</code> commands then do not merge the corresponding commits, but only create a <em>single</em> commit that contains all changes.
Note: Do not use this option unless you have also imported the project using <code>--squash</code>; this will cause merge conflicts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="sec.split-off-subtree"><a class="anchor" href="#sec.split-off-subtree"></a>5.11.2.1. Splitting off a Subdirectory</h5>
<div class="paragraph">
<p>At some point, you may be faced with the task of managing a subdirectory of your project as a separate repository.
However, you may still want to integrate the changes into the original project.</p>
</div>
<div class="paragraph">
<p>For example, the documentation stored under <code>doc/</code> will be managed in a separate repository from now on.
Occasionally, that is, every few weeks, you want to transfer the latest developments to the master repository.</p>
</div>
<div class="paragraph">
<p>The <code>git sub-tree</code> command provides a separate sub-command <code>split</code> for this purpose, which you can use to automate this step.
It creates a version history containing all changes to a directory, and issues the latest commit&#8201;&#8212;&#8201;which you can then upload to an (empty) remote.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git subtree split -P doc --rejoin</strong>
Merge made by the 'ours' strategy.
563c68aa14375f887d104d63bf817f1357482576
$ <strong>git push &lt;neues-doku-repo&gt; 563c68aa14375:refs/heads/master</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--rejoin</code> option causes the version history split off in this way to be directly reintegrated into the current project via <code>git subtree merge</code>.
From now on you can integrate the new commits via <code>git subtree pull</code>.
If you want to use the <code>--squash</code> option instead, omit <code>--rejoin</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.submodule-vs-subtree"><a class="anchor" href="#sec.submodule-vs-subtree"></a>5.11.3. Submodules vs. Subtrees</h4>
<div class="paragraph">
<p>The question &#8220;Submodules or Subtrees?&#8221; cannot be answered in general, but only on a case by case basis.
The decisive criterion should be the affiliation of the subproject to the superordinate one: If you include third-party software, it is probably more likely to be submodules, your own with limited commits and a direct relationship to the main project rather than a subtree.</p>
</div>
<div class="paragraph">
<p>For example, when you install CGit (see <a href="#sec.cgit">Section 7.5, &#8220;CGit&#8201;&#8212;&#8201;CGI for Git&#8221;</a>), you must initialize and update a submodule to compile <code>libgit.a</code>.
So CGit needs the source code of Git, but doesn&#8217;t want to merge the development history with that of Git (the comparatively few CGit commits would be lost in this!).
You can, however, compile CGit against another version of Git if you wish&#8201;&#8212;&#8201;the flexibility of the sub-repository is preserved.</p>
</div>
<div class="paragraph">
<p>The graphical repository browser Gitk, on the other hand, is managed as a subtree.
It is developed in <code>git://ozlabs.org/~paulus/gitk</code>, but is included in the main Git repository with the subtree-merge strategy under <code>gitk-git/</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch.workflows"><a class="anchor" href="#ch.workflows"></a>6. Workflows</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In software development, <em>workflows</em> are usually used to describe strategies that define workflows in a team (e.g. 'agile software development').
We can generally limit ourselves to literature references here.&#8288;<sup class="footnote">[<a id="_footnoteref_88" class="footnote" href="#_footnotedef_88" title="View footnote.">88</a>]</sup></p>
</div>
<div class="paragraph">
<p>In Git, you can see &#8220;workflows&#8221; from two different perspectives:
Workflows (command sequences) that affect individual users, and project-related workflows (e.g., release management).
Both aspects are discussed below.</p>
</div>
<div class="sect2">
<h3 id="sec.workflows-user"><a class="anchor" href="#sec.workflows-user"></a>6.1. User</h3>
<div class="paragraph">
<p>Below you will find a list of general development strategies (in no particular order):</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Make commits as small and independent as possible</em></dt>
<dd>
<p>Divide your work into small, logical steps and make a commit for each step.
The commits should be independent of future commits and should pass all tests (if any).
This makes it easier for your colleagues or maintainers to keep track of what you have done.
It also increases the efficiency of commands that examine the story, such as <code>git bisect</code> and <code>git blame</code>.
Don&#8217;t be afraid to make commits that are too small.
It&#8217;s easier in hindsight to combine several small commits with <code>git rebase --interactive</code> than to split one big one into several small ones.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Develop in topic branches</em></dt>
<dd>
<p>Branching is easy, fast and intuitive in Git.
Subsequent merging works without problems, even repeatedly.
Take advantage of Git&#8217;s flexibility:
Don&#8217;t develop directly in <code>master</code>, but develop each feature in its own branch, called the <em>Topic Branch</em>.</p>
<div class="paragraph">
<p>This has several advantages:
you can develop features independently;
you get a well-defined point in time for integration (merge);
you can rebase the development to be &#8220;streamlined&#8221; and clear before you publish it;
you make it easier for other developers to test a new feature in isolation.</p>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Use Namespaces</em></dt>
<dd>
<p>You can create different classes of branches by using <code>/</code> characters in the branch name.
In a central repository you can create your own namespace using your initials (e.g. <code>jp/refactor-base64</code>) or store your features under <code>experimental/</code> or <code>pu/</code> (see below) depending on stability.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Rebase early, Rebase often</em></dt>
<dd>
<p>If you frequently work with Rebase on Topic Branches, you will create a much more readable version history.
This is convenient for you and other developers and helps to split the actual programming process into logical units.</p>
<div class="paragraph">
<p>Merge small commits when they belong together.
If necessary, take the time to split up large commits again in a sensible way (see <a href="#sec.rebase-i-edit">Section 4.2.2, &#8220;Edit commits arbitrarily&#8221;</a>).</p>
</div>
<div class="paragraph">
<p>However, only use Rebase for your own commits:
do not modify already published commits or other developers' commits.</p>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Make a conscious distinction between FF and regular merges</em></dt>
<dd>
<p>Integrate changes from upstream always via fast-forward (you simply fast forward the local copy of the branches).
In contrast, integrate new features through regular merges.
The aliases presented in <a href="#sec.merge-ff">Section 3.3.2, &#8220;Fast Forward Merges: Fast Forwarding One Branch&#8221;</a> are also helpful for differentiation.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Note the merge direction</em></dt>
<dd>
<p>The command git merge pulls one or more branches into the current one.
So always pay attention to the direction in which you perform a merge:
Integrate topic branches into the mainline (the branch on which you are preparing the stable release), not the other way around.&#8288;<sup class="footnote">[<a id="_footnoteref_89" class="footnote" href="#_footnotedef_89" title="View footnote.">89</a>]</sup>
This way you can isolate the history of a feature from the mainline even after the fact (git log topic lists only the relevant commits).</p>
<div class="paragraph">
<p>Criss-cross merges (crossed merges) should be avoided if possible:
They occur when you integrate a branch A into a branch B and an older version of B into A.</p>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Test the compatibility of features via Throw-Away Integration</em></dt>
<dd>
<p>Create a new (disposable) branch and merge the features whose compatibility you want to test.
Run the test suite or test the interaction of the new components in another way.
You can then delete the branch and continue developing the features separately.
Such <em>Throw-Away</em> branches are usually not published.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Certain work steps appear again and again.
Here are a few general solution strategies:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Fix a small bug</em></dt>
<dd>
<p>If you notice a small bug that you want to fix quickly, you can do this in two ways:
stash existing changes (see <a href="#sec.stash">Section 4.5, &#8220;Outsource changes - git stash&#8221;</a>), check out the corresponding branch, fix the bug, change the branch again, and apply the stash.</p>
<div class="paragraph">
<p>The other possibility is to fix the bug on the branch you are currently working on and to subsequently transfer the corresponding commit(s) via Cherry Pick or Rebase-Onto (see <a href="#sec.cherry-pick">Section 3.5, &#8220;Taking over Individual Commits: Cherry Pick&#8221;</a>) to the designated bugfix or topic branch.</p>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Correcting a Commit</em></dt>
<dd>
<p>With <code>git commit --amend</code> you can customize the last commit.
The <code>--no-edit</code> option causes the description to be retained and not offered again for editing.</p>
<div class="paragraph">
<p>To fix deeper commits, either use interactive rebase and the <code>edit</code> keyword (see <a href="#sec.rebase-i-edit">Section 4.2.2, &#8220;Edit commits arbitrarily&#8221;</a>), or create a small commit for each fix, then arrange them accordingly in the interactive rebase, and apply the <code>fixup</code> action to them to correct the original commit.</p>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Which branches are not yet in <code>master</code>?</em></dt>
<dd>
<p>Use <code>git branch -vv --no-merged</code> to find out which branches are not yet included in the current branch.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Merge multiple changes from different sources</em></dt>
<dd>
<p>Use the index to combine several changes, e.g. changes that complement each other but are in different branches or as patches.
The commands <code>git apply</code>, <code>git cherry-pick --no-commit</code> and <code>git merge --squash</code> apply the corresponding changes only to the working tree or index without creating a commit.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="sec.branching-model"><a class="anchor" href="#sec.branching-model"></a>6.2. A Branching Model</h3>
<div class="paragraph">
<p>The following section introduces a branching model based on the model described in the <code>gitworkflows(7)</code> man page.
The branching model determines which branch performs which functions, when and how commits are taken from a branch, which commits are to be tagged as releases, etc.
It is flexible, scales well, and can be extended as needed (see below).</p>
</div>
<div class="paragraph">
<p>In its basic form the model consists of four branches:
<code>maint</code>, <code>master</code>, <code>next</code>, and <code>pu</code> (<em>Proposed Updates</em>).
The <code>master</code> branch is used to prepare the next release and to collect trivial changes.
<code>pu</code> branches are used for feature development (topic branches).
In the <code>next</code> branch halfway stable new features are collected, tested for compatibility, stability and correctness and improved if necessary.
Critical bug fixes for previous versions are collected in the <code>main</code> branch and published as maintenance releases.</p>
</div>
<div class="paragraph">
<p>In principle, commits are always integrated into another branch by a merge (in <a href="#fig.branch-model">Figure 41, &#8220;Branch model according to <code>gitworkflows (7)</code>&#8221;</a> indicated by arrows).
Unlike cherry picking, commits are not duplicated, and you can easily see whether a branch already contains a particular commit or not.</p>
</div>
<div class="paragraph">
<p>The following diagram is a schematic representation of the ten-point workflow, which is explained in detail below.</p>
</div>
<div id="fig.branch-model" class="imageblock text-center">
<div class="content">
<img src="images/branch-model.svg" alt="branch model" width="70%">
</div>
<div class="title">Figure 41. Branch model according to <code>gitworkflows (7)</code></div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>New Topic Branches arise from well-defined points, e.g. tagged releases, on the <code>master</code>.</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout -b pu/cmdline-refactor v0.1</strong></pre>
</div>
</div>
</li>
<li>
<p>Sufficiently stable features are taken from their respective <code>pu</code> branch to <code>next</code> (<em>feature graduation</em>).</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout next</strong>
$ <strong>git merge pu/cmdline-refactor</strong></pre>
</div>
</div>
</li>
<li>
<p>Release preparation:
If enough new features have accumulated in <code>next</code> (feature driven development), <code>next</code> is merged to <code>master</code> and if necessary a release candidate tag (RC tag) is created (suffix <code>-rc&lt;n&gt;</code>).</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout master</strong>
$ <strong>git merge next</strong>
$ <strong>git tag -a v0.2-rc1</strong></pre>
</div>
</div>
</li>
<li>
<p>From now on, only so-called <em>release critical bugs</em> (RC bugs) are corrected directly in the <code>master</code>.
These are &#8220;show-stoppers&#8221;, i.e. bugs that significantly limit the functionality of the software or make new features unusable.
If necessary, you can undo merges of problematic branches (see <a href="#sec.revert">Section 3.2.2, &#8220;Rolling Back Commits&#8221;</a>).</p>
<div class="paragraph">
<p>What happens to <code>next</code> during the release phase depends on the size of the project.
If all developers are busy fixing the RC bugs, a development stop for <code>next</code> is a good idea.
For larger projects, where development for the next release but one is already being pushed forward during the release phase, <code>next</code> can continue to serve as an integration branch for new features.</p>
</div>
</li>
<li>
<p>Once all RC bugs have been eliminated, the <code>master</code> is tagged as a release and, if necessary, published as a source code archive, distribution package, etc.
Furthermore, <code>master</code> is merged to <code>next</code> to transfer all fixes for RC bugs.
If no further commits have been made to <code>next</code> in the meantime, this is a fast forward merge.
Now new topic branches can be opened again, based on the new release.</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tag -a v0.2</strong>
$ <strong>git checkout next</strong>
$ <strong>git merge master</strong></pre>
</div>
</div>
</li>
<li>
<p>Feature Branches that didn&#8217;t make it into the release can now either be merged into the <code>next</code> Branch, or, if they are not yet finished, they can be rebuilt to a new, well-defined base.</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout pu/numeric-integration</strong>
$ <strong>git rebase next</strong></pre>
</div>
</div>
</li>
<li>
<p>In order to separate feature development from bug fixes and <em>maintenance</em>, bug fixes that affect a previous version are made in the branch <code>maint</code>.
This maintenance branch, like the feature branches, branches off from <code>master</code> at well-defined points.</p>
</li>
<li>
<p>If enough bug fixes have accumulated or if a critical bug has been fixed, e.g. a security bug, the current commit is tagged as maintenance release on the <code>main</code> branch and can be published via the usual channels.</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout maint</strong>
$ <strong>git tag -a v0.1.1</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Sometimes it happens that bug fixes made on <code>master</code> are also needed in <code>maint</code>.
In this case it is okay to transfer them there using <code>git cherry-pick</code>.
But this should be the exception rather than the rule.</p>
</div>
</li>
<li>
<p>To ensure that bug fixes are available in the future, the <code>maint</code> branch is merged to <code>master</code> after a maintenance release.</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout master</strong>
$ <strong>git merge maint</strong></pre>
</div>
</div>
<div class="paragraph">
<p>If the bug fixes are very urgent, they can be transferred to the appropriate branch (<code>next</code> or <code>pu/*</code>) using <code>git cherry-pick</code>.
As with <code>git cherry-pick</code> to <code>maint</code>, this should only happen rarely.</p>
</div>
</li>
<li>
<p>When a new release is released, the <code>maint</code> branch is fast-forwarded to the state of <code>master</code>, so <code>maint</code> now contains all commits that make up the new release.
If no fast-forward is possible here, this is an indication that there are still bug fixes in <code>maint</code> that are not in <code>master</code> (see point 9).</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout maint</strong>
$ <strong>git merge --ff-only master</strong></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can extend the branching model as you wish.
One approach that is often encountered is the use of <em>namespaces</em> (see <a href="#sec.branches">Section 3.1, &#8220;References: Branches and Tags&#8221;</a>) in addition to the <code>pu/*</code> branches.
This has the advantage that each developer uses his own namespace, which is delimited by convention.
Another very popular extension is to have a separate <code>maint</code> branch for each previous version.
This makes it possible to maintain any number of older versions.
For this purpose, before merging from <code>maint</code> to <code>master</code>, a corresponding branch for the version is created in point 9.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git branch maint-v0.1.2</strong></pre>
</div>
</div>
<div class="paragraph">
<p>But keep in mind that these additional maintenance branches mean an increased maintenance effort, because every new bug fix has to be checked.
If it is also relevant for an older version, it must be added to the maintenance branch for that version using <code>git cherry-pick</code>.
In addition, a new maintenance version may have to be tagged and published.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec.releases-management"><a class="anchor" href="#sec.releases-management"></a>6.3. Release Management</h3>
<div class="paragraph">
<p>As soon as a project has more than one or two developers, it usually makes sense to assign a developer to manage the releases.
This <em>Integration Manager</em> decides after consultation with the others (e.g. via the mailing list) which branches are integrated and when new releases are made.</p>
</div>
<div class="paragraph">
<p>Each project has its own requirements for the release process.
Below are some general tips on how to monitor development and partially automate the release process.&#8288;<sup class="footnote">[<a id="_footnoteref_90" class="footnote" href="#_footnotedef_90" title="View footnote.">90</a>]</sup></p>
</div>
<div class="sect3">
<h4 id="sec.release-check-branches"><a class="anchor" href="#sec.release-check-branches"></a>6.3.1. Exploring tasks</h4>
<div class="paragraph">
<p>The maintainer of a software must have a good overview of the features that are actively being developed and will soon be integrated.
In most development models, commits <em>graduate</em> from one branch to the next&#8201;&#8212;&#8201;in the model presented above, first from the <code>pu</code> branches to <code>next</code> and then to <code>master</code>.</p>
</div>
<div class="paragraph">
<p>First of all, you should always clean up your local branches in order not to lose the overview.
The command <code>git branch --merged master</code>, which lists all branches that are already fully integrated into <code>master</code> (or another branch), is especially helpful here.
You can usually delete these.</p>
</div>
<div class="paragraph">
<p>To get a rough overview of the tasks that need to be done, it is recommended to use <code>git show-branch</code>.
Without any further arguments, it lists all local branches, each with an exclamation mark (<code>!</code>) in its own color.
The current branch gets a star (<code>*</code>).
Below the output all commits are shown and for each branch in the respective column a plus (<code>+</code>) or a star (<code>*</code>) if the commit is part of the branch.
A minus (<code>-</code>) indicates merge commits.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show-branch</strong>
! [for-hjemli] initialize buf2 properly
 * [master] Merge branch _stable_
  ! [z-custom] silently discard "error opening directory" messages
---
+   [for-hjemli] initialize buf2 properly
--  [master] Merge branch _stable_
+*  [master\^2] Add advice about scan-path in cgitrc.5.txt
+*  [master^2\^] fix two encoding bugs
+*  [master\^] make enable-log-linecount independent of -filecount
+*  [master\~2] new_filter: correctly initialise ... for a new filter
+*  [master\~3] source_filter: fix a memory leak
  + [z-custom] silently discard "error opening directory" messages
  + [z-custom^] Highlight odd rows
  + [z-custom\~2] print upstream modification time
  + [z-custom\~3] make latin1 default charset
&#43;*&#43; [master~4] CGIT 0.9</pre>
</div>
</div>
<div class="paragraph">
<p>Only so many commits are shown until a common merge base of all commits is found (in the example: <code>master~4</code>).
If you don&#8217;t want to examine all branches at once, but only the branches under <code>pu/</code>, for example, then explicitly specify this as argument.
<code>--topics &lt;branch&gt;</code> defines <code>&lt;branch&gt;</code> as integration branch, whose commits are not explicitly shown.</p>
</div>
<div class="paragraph">
<p>So the following command shows you all commits of all <code>pu</code> branches and their relation to <code>master</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git show-branch --topics master "pu/&#42;"</strong></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is worth documenting the commands you use for release management (so that others can continue your tasks if necessary).
You should also abbreviate common steps by using aliases.</p>
</div>
<div class="paragraph">
<p>You could convert the above command into an alias <code>todo</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global alias.todo \</strong>
  <strong>"!git rev-parse --symbolic --branches | \</strong>
  <strong>xargs git show-branch --topics master"</strong></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>However, the <code>git show-branch</code> command only recognizes <em>identical</em>, i.e. identical commits.
If you use <code>git cherry-pick</code> to copy a commit to another branch, the changes are almost the same, but <code>git show-branch</code> would not detect this because the SHA-1 sum of the commit changes.</p>
</div>
<div class="paragraph">
<p>The <code>git cherry</code> tool is responsible for these cases.
It uses the small tool <code>git-patch-id</code> internally, which reduces a commit to its changes.
It ignores whitespace changes and the contextual position of the hunks (line numbers).
So the tool returns the same ID for patches that essentially commit the same change.</p>
</div>
<div class="paragraph">
<p>Usually, <code>git cherry</code> is used when the question arises:
Which commits have already been transferred to the integration branch?
The command <code>git cherry -v &lt;upstream&gt; &lt;topic&gt;</code> is used for this:
It lists all commits from <code>&lt;topic&gt;</code>, and puts a minus (<code>-</code>) in front of them if they are already in <code>&lt;upstream&gt;</code>, otherwise a plus (<code>+</code>).
This looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git cherry --abbrev=7 -v master z-custom</strong>
+ ae8538e guess default branch from HEAD
- 6f70c3d fix two encoding bugs
- 42a6061 Add advice about scan-path in cgitrc.5.txt
+ cd3cf53 make latin1 default charset
+ 95f7179 Highlight odd rows
+ bbaabe9 silently discard "error opening directory" messages</pre>
</div>
</div>
<div class="paragraph">
<p>Two of the patches were already applied after <code>master</code>.
<code>git cherry</code> recognizes this, although the commit IDs have changed.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.release-create"><a class="anchor" href="#sec.release-create"></a>6.3.2. Create Release</h4>
<div class="paragraph">
<p>Git provides the following two useful tools to help you prepare for a release:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>git shortlog</code></dt>
<dd>
<p>Summarizes the output of <code>git log</code>.</p>
</dd>
<dt class="hdlist1"><code>git archive</code></dt>
<dd>
<p>Automatically creates a source code archive.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A good release includes a so-called <em>changelog</em>, i.e. a summary of the most important changes including thanks to people who have contributed help.
This is where <code>git shortlog</code> comes in.
It shows the respective authors, how many commits each one has made, and the commit messages of each commit.
This makes it easy to see who did what.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git shortlog HEAD~3..</strong>
Georges Khaznadar (1):
      bugfix: 3294518

Kai Dietrich (6):
      delete grammar tests in master
      updated changelog and makefile
      in-code version number updated
      version number in README
      version number in distutils setup.py
      Merge branch _prepare-release-0.9.3_

Valentin Haenel (3):
      test: add trivial test for color transform
      test: expose bug with ID 3294518
      Merge branch _fix-3294518_</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--numbered</code> or <code>-n</code> option sorts the output by the number of commits instead of alphabetically.
With <code>--summary</code> or <code>-s</code> the commit messages are omitted.</p>
</div>
<div class="paragraph">
<p>But if in doubt, don&#8217;t simply write the output of <code>git log</code> or <code>git shortlog</code> to the file CHANGELOG.
Especially with many technical commits, the changelog is not helpful (if you&#8217;re interested in this information, you can always check the repository).
But you can take the output as a basis, delete unimportant changes and combine the rest into meaningful groups.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Often the question arises for the maintainer what has changed since the last release.
This is where <code>git-describe</code> (see <a href="#sec.tags">Section 3.1.3, &#8220;Tags&#8201;&#8212;&#8201;Marking Important Versions&#8221;</a>) comes in handy.
In conjunction with --abbrev=0, it outputs the first accessible tag from the HEAD:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git describe</strong>
wiki2beamer-0.9.2-20-g181f09a
$ <strong>git describe --abbrev=0</strong>
wiki2beamer-0.9.2</pre>
</div>
</div>
<div class="paragraph">
<p>In combination with <code>git shortlog</code> the question can be answered very easily:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git shortlog -sn $(git describe --abbrev=0)..</strong>
    15  Kai Dietrich
     4  Valentin Haenel
     1  Georges Khaznadar</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>git archive</code> command helps to create a source code archive.
The command can handle both tar and zip format.
Additionally, you can set a prefix for the files to be saved with the option <code>--prefix=</code>.
The top level of the repository is then stored below this prefix, usually the name and version number of the software:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git archive --format=zip --prefix=wiki2beamer-0.9.3/ HEAD \</strong>
    <strong>&gt; wiki2beamer-0.9.3.zip</strong>
$ <strong>git archive --format=tar --prefix=wiki2beamer-0.9.3/ HEAD \</strong>
    <strong>| gzip &gt; wiki2beamer-0.9.3.tgz</strong></pre>
</div>
</div>
<div class="paragraph">
<p>As a mandatory argument the command expects a commit (or a tree), which should be packed as an archive.
In the above example the <code>HEAD</code>.
But it could also have been a commit ID, a reference (branch or tag) or directly a tree object.&#8288;<sup class="footnote">[<a id="_footnoteref_91" class="footnote" href="#_footnotedef_91" title="View footnote.">91</a>]</sup></p>
</div>
<div class="paragraph">
<p>Again, you can use <code>git describe</code> after you have tagged a release commit.
If you have a suitable tag scheme <code>&lt;name&gt;-&lt;X.Y.Z&gt;</code> as above, the following command is sufficient:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>version=$(git describe)</strong>
$ <strong>git archive --format=zip --prefix=$version/ HEAD &gt; $version.zip</strong></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s possible that not all of the files you manage in your git repository should also be in the source code archives, such as the project website.
You can also specify paths - so to limit the archive to the <code>src</code> directory and the <code>LICENSE</code> and <code>README</code> files, use</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>version=$(git describe)</strong>
$ <strong>git archive --format=zip --prefix=$version/ HEAD src LICENSE README \</strong>
    <strong>&gt; $version.zip</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Git will store the SHA-1 sum in the archive if you specify a commit as an argument.
In tar format, this is stored as a <em>pax header entry</em>, which Git can read again with the command <code>git get-tar-commit-id</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>zcat wiki2beamer-0.9.3.tgz | git get-tar-commit-id</strong>
181f09a469546b4ebdc6f565ac31b3f07a19cecb</pre>
</div>
</div>
<div class="paragraph">
<p>In zip files, Git simply saves the SHA-1 sum in the comment field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>unzip -l wiki2beamer-0.9.3.zip | head -5</strong>
Archive:  wiki2beamer-0.9.3.zip
181f09a469546b4ebdc6f565ac31b3f07a19cecb
  Length      Date    Time    Name
---------  ---------- -----   ----
        0  05-06-2011 20:45   wiki2beamer-0.9.3/</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>One problem you should keep in mind is that for example <code>.gitignore</code> files are automatically packed.
But since they have no meaning outside a git repository, it is worth excluding them with the git attribute (see <a href="#sec.attributes">Section 8.1, &#8220;Git attributes - treat files separately&#8221;</a>) <code>export-ignore</code>.
This is done with an entry <code>.gitignore export-ignore</code> in <code>.git/info/attributes</code>.</p>
</div>
<div class="paragraph">
<p>You can also perform automatic keyword substitutions before packing the archive (see <a href="#sec.smudge-clean-keywords">Section 8.1.2, &#8220;Keywords in files&#8221;</a>).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch.server"><a class="anchor" href="#ch.server"></a>7. Git Servers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following is about hosting Git repositories and <em>Gitolite</em>, which allows you to flexibly manage repository access rights via SSH public keys.
It also explains how to install and configure the two web interfaces <em>Gitweb</em> and <em>CGit</em>, alternatively for Apache or Lighttpd.</p>
</div>
<div class="sect2">
<h3 id="sec.server"><a class="anchor" href="#sec.server"></a>7.1. Hosting a Git Server</h3>
<div class="paragraph">
<p>First some basics: How do repositories on a server differ from those of a normal user?
And how does Git exchange the changes?</p>
</div>
<div class="sect3">
<h4 id="sec.git-protocol"><a class="anchor" href="#sec.git-protocol"></a>7.1.1. The Git Protocol</h4>
<div class="paragraph">
<p>Git is designed for decentralized repository management; the smallest unit for exchanging changes between repositories is commits.
However, since there are sometimes thousands of commits between two versions of a piece of software, and a single commit-by-commit transfer would generate a lot of overhead, commits are grouped together into so-called <em>packfiles</em> before being transferred.
These packfiles are a simple but effective format.&#8288;<sup class="footnote">[<a id="_footnoteref_92" class="footnote" href="#_footnotedef_92" title="View footnote.">92</a>]</sup>
They are also used to store (older) commits on the hard disk in a space-saving way (<code>git gc</code> or <code>git repack</code>, see <a href="#sec.gc">Section B.1, &#8220;Cleaning up&#8221;</a>).</p>
</div>
<div class="paragraph">
<p>These packfiles are usually transmitted via the Git protocol, which runs on port 9418/TCP by default.
The Git protocol is deliberately kept very simple in design and offers only a few functions that are directly related to the structure of Git: What data to send or receive, and a way for the sender and receiver sides to agree on the smallest possible amount of data that needs to be transmitted to synchronize both sides.</p>
</div>
<div class="paragraph">
<p>Therefore, the Git protocol does <em>not</em> include any authentication option.
Instead, Git uses an already existing, secure and simple authentication structure: SSH, the <code>'Secure Shell'</code>.</p>
</div>
<div class="paragraph">
<p>So while the Git protocol can be used unencrypted and in raw form for anonymous <em>read-only</em> access, writing or uploading via Git protocol only works via SSH.</p>
</div>
<div class="paragraph">
<p>Git also supports transport via HTTP(S), FTP(S), and Rsync.
Although Rsync is now considered <em>deprecated</em>, and should not be used anymore, there are some use cases for HTTP(S): In particularly restrictive environments with very restrictive firewall rules, you may be able to access a repository via HTTP(S) (i.e. only on port 80 or 443) for both read and write operations.
Platforms like GitHub (see <a href="#ch.github">Chapter 11, <em>GitHub</em></a>) therefore offer HTTPS as default transport method.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.git-pack-same-machine"><a class="anchor" href="#sec.git-pack-same-machine"></a>7.1.2. Repositories on the Same Computer</h4>
<div class="paragraph">
<p>Wollen Sie Änderungen an Repositories auf dem gleichen Rechner synchronisieren, muss dies nicht über Umwege erfolgen: Git kommuniziert direkt über Unix-Pipes mit der Gegenseite, handelt eine gemeinsame Basis aus und synchronisiert die Daten.
(Dafür ist es natürlich nötig, dass der Nutzer, der das Git-Kommando aufruft, zumindest Leseberechtigung auf die Packfiles des anderen Repositorys hat.)</p>
</div>
<div class="paragraph">
<p>If you want to synchronize changes to repositories on the same computer, this does not have to be done via detours: Git communicates directly with the other side via Unix pipes, negotiates a common basis and synchronizes the data.
(Of course, this requires that the user invoking the Git command has at least read permission to the other repository&#8217;s pack files).</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.bare-repos"><a class="anchor" href="#sec.bare-repos"></a>7.1.3. Bare Repositories: Repositories Without Working Tree</h4>
<div class="paragraph">
<p>So far, you&#8217;ve probably worked mostly with Git repositories, which were working tree and repository in one: The repository-internal data is stored in the <code>.git</code> subdirectory, all other files belong to the working tree, i.e. you can edit them while Git observes and stores the changes to these files (<em>tracking</em>).</p>
</div>
<div class="paragraph">
<p>A so-called <em>bare repository</em>, i.e. a &#8220;mere&#8221; repository, has no assigned working tree.
It contains only the files and directories that are stored in a &#8220;regular&#8221; repository under <code>.git</code>.</p>
</div>
<div class="paragraph">
<p>You create such a bare repository with <code>git init --bare</code>.
Take a look at the difference between the two options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd /tmp/ &amp;&amp; mkdir init-test &amp;&amp; cd init-test</strong>
$ <strong>git init</strong>
Initialized empty Git repository in /tmp/init-test/.git/
$ <strong>ls -AF</strong>
.git/

$ <strong>mkdir ../init-test-bare &amp;&amp; cd ../init-test-bare</strong>
$ <strong>git init --bare</strong>
Initialized empty Git repository in /tmp/init-test-bare/
$ <strong>ls -AF</strong>
branches/  config  description  HEAD  hooks/  info/  objects/  refs/</pre>
</div>
</div>
<div class="paragraph">
<p>To create a backup of one of your normal repositories, you can create a new bare repository (e.g. on a USB stick) and upload all your references (and thus all your commits):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git init --bare /mnt/usb/repo-backup/</strong>
$ <strong>git push --all /mnt/usb/repo-backup/</strong></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.permissions"><a class="anchor" href="#sec.permissions"></a>7.1.4. Repository Access Permissions</h4>
<div class="paragraph">
<p>With <code>git init</code> the files are usually created with read and write permission according to the <code>umask</code> setting.
This is also a convenient choice for the end user.
However, if you want to set up a repository on a server, you can use the <code>--shared</code> option to specify who (at the filesystem level) can access the repository.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>umask</code> 
</td>
<td class="hdlist2">
<p>Default, if <code>--shared</code> is not specified; uses the currently set <code>umask</code>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>group</code> 
</td>
<td class="hdlist2">
<p>Default, if only <code>--shared</code> is specified.
Assigns write permissions to all group members.
Especially directories are also set to <code>g+sx</code> mode, allowing all group members to create new files (i.e. upload commits).
Note that if the <code>umask</code> sets read permission for all users (<code>a+r</code>), this permission will still be granted.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>all</code> 
</td>
<td class="hdlist2">
<p>Same as <code>group</code>, except that read permissions are explicitly granted for all, regardless of the <code>umask</code>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>0&lt;nnn&gt;</code> 
</td>
<td class="hdlist2">
<p>Set the <code>umask</code> explicitly to <code>&lt;nnn&gt;</code>.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you initialize a repository with <code>--shared</code>, the <code>receive.denyNonFastForwards</code> option is automatically set.
It prevents uploading commits that cannot be integrated via Fast-Forwards (even if the user explicitly wants to via <code>git push -f</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.git-shell"><a class="anchor" href="#sec.git-shell"></a>7.1.5. Access via SSH: The Git Shell</h4>
<div class="paragraph">
<p>Usually, write access to Git repositories located on another computer can only be granted via SSH.
However, it is generally undesirable to grant a user who will have access to a repository the same user rights to the whole system.</p>
</div>
<div class="paragraph">
<p>Git works around this problem with the included <code>git-shell</code> program.
It works like a shell, but only allows you to run four Git commands that are responsible for uploading and downloading pack files.
Interactive use or execution of other commands is denied by the shell unless you explicitly enable the &#8220;Interactive Mode&#8221; of the shell&#8201;&#8212;&#8201;see the <code>git-shell(1)</code> man page for details.</p>
</div>
<div class="paragraph">
<p>If you create a new user and assign the git shell to him, e.g., using <code>chsh &lt;user&gt;</code>, he cannot log in via SSH, but he can upload commits to all git repositories to which he has write permission.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.ssh-pubkey"><a class="anchor" href="#sec.ssh-pubkey"></a>7.1.6. Access via SSH: Public Keys</h4>
<div class="paragraph">
<p>It&#8217;s a major advantage that Git uses SSH as an encrypted and authenticated transport channel, because most users already have a key pair (public/private) with which they log in on other computers.</p>
</div>
<div class="paragraph">
<p>So instead of tediously assigning (and then sending out) passwords to accounts, a system administrator can limit access to Git repositories to users who authenticate against SSH public keys.
This saves time for the user (by eliminating the need to re-enter a password), but also saves the administrator from having to worry about password changes (which would not be easily possible using the Git shell).</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.two-users"><a class="anchor" href="#sec.two-users"></a>7.1.7. Example: Two Users Want to Collaborate</h4>
<div class="paragraph">
<p>In the following we will show you how to set up two users on your system, <code>max</code> and <code>moritz</code>, and let them work on the same repository.</p>
</div>
<div class="paragraph">
<p>First, we have to set up a repository that the two users will want to access later.
Assuming that other repositories might follow later, we will create a Unix group <code>git</code> (generally for Git users) and a directory <code>/var/repositories</code> with read permission for members of the <code>git</code> group, as well as a <code>git-example</code> group and its corresponding directory, writeable only for members of <code>git-example</code>, in which the repository will later be located:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>groupadd git</strong>
$ <strong>groupadd git-beispiel</strong>
$ <strong>mkdir -m 0750 /var/repositories</strong>
$ <strong>mkdir -m 0770 /var/repositories/git-beispiel</strong>
$ <strong>chown root:git /var/repositories</strong>
$ <strong>chown root:git-beispiel /var/repositories/git-beispiel</strong></pre>
</div>
</div>
<div class="paragraph">
<p>We also create a repository in the last created directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git init --bare --shared /var/repositories/git-beispiel</strong>
$ <strong>chown -R nobody:git /var/repositories/git-beispiel</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Als nächstes erstellen wir die beiden Nutzer.
Beachten Sie, dass bei diesem Aufruf <em>kein</em> Homeverzeichnis für die Nutzer unter <code>/home/</code> erstellt wird.
Außerdem werden beide der Gruppe <code>git</code> und <code>git-beispiel</code> hinzugefügt:</p>
</div>
<div class="paragraph">
<p>Next we create the two users.
Note that this call will <em>not</em> create a home directory for the users under <code>/home/</code>.
Also, both are added to the <code>git</code> and <code>git-example</code> groups:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>adduser --no-create-home --shell /usr/bin/git-shell max</strong>
$ <strong>adduser --no-create-home --shell /usr/bin/git-shell moritz</strong>
$ <strong>adduser max git</strong>
$ <strong>adduser max git-beispiel</strong>
$ <strong>adduser moritz git</strong>
$ <strong>adduser moritz git-beispiel</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Next, we have to assign a password to each user via <code>passwd</code> so that they can log in via SSH.
Afterwards, the new users can now work together on a project.
You add the remote as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git remote add origin max@server:/var/repositories/git-example</strong></pre>
</div>
</div>
<div class="paragraph">
<p>All other users who want to contribute to this project must belong to the <code>git-example</code> group.
So this approach is essentially based on the use of Unix groups and Unix users.
However, a server admin usually wants to offer not only Git, but various services.
And to control the user administration entirely via Unix groups is rather inflexible.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.gitolite"><a class="anchor" href="#sec.gitolite"></a>7.2. Gitolite: Simple Git Hosting</h3>
<div class="paragraph">
<p>The aforementioned described way of managing users has some major disadvantages.
Namely:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A full Unix account must be created for each user.
This means a lot of additional work for the administrator and possibly also opens security holes.</p>
</li>
<li>
<p>For each project a separate Unix group must be created.</p>
</li>
<li>
<p>For each user created, the access permissions must be adjusted manually (or via a script).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The program <em>Gitolite</em> provides a remedy.&#8288;<sup class="footnote">[<a id="_footnoteref_93" class="footnote" href="#_footnotedef_93" title="View footnote.">93</a>]</sup></p>
</div>
<div class="paragraph">
<p>Gitolite originated from the <em>Gitosis</em> project, which is now considered obsolete.
The idea: Only only Unix user (e.g. <code>git</code>) is created on the server.
Internally, Gitolite then manages a list of users with associated SSH keys.
But these users do not have a &#8220;real&#8221; user account on the system.</p>
</div>
<div class="paragraph">
<p>Users log <em>just</em> into the <code>git</code> account with their public SSH keys.
This has three major advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No password needs to be assigned or changed.</p>
</li>
<li>
<p>Users can store multiple SSH keys (for different computers they work on).</p>
</li>
<li>
<p>Using the SSH key a user logs in with, Gitolite can <em>uniquely</em>&#8288;<sup class="footnote">[<a id="_footnoteref_94" class="footnote" href="#_footnotedef_94" title="View footnote.">94</a>]</sup> derive the internal username and thus the permissions on the repositories managed by Gitolite.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="sec.installing-gitolite"><a class="anchor" href="#sec.installing-gitolite"></a>7.2.1. Installing Gitolite</h4>
<div class="paragraph">
<p>The installation of Gitolite is simple.
All you need to do is have your public key ready to register as an administrator.
You don&#8217;t need root privileges unless you need to create the <code>git</code> user first,&#8288;<sup class="footnote">[<a id="_footnoteref_95" class="footnote" href="#_footnotedef_95" title="View footnote.">95</a>]</sup> so skip the next step if you have already created such a user.</p>
</div>
<div class="paragraph">
<p>First, create a user on the computer that will act as the git server (henceforth <code>&lt;server&gt;</code>).
Usually, this user is called <code>git</code>, but you may also call it something else (e.g. <code>gitolite</code>).
You can specify <code>/home/git</code> as your home directory or, as in this example, something like <code>/var/git</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server# <strong>adduser --home /var/git git</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Now switch to the <code>git</code> user.
Gitolite needs the <code>.ssh/</code> and <code>bin/</code> directories, so we need to create them:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server$ <strong>mkdir -m 0700 ~/.ssh ~/bin</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Now clone the Gitolite repository and install a symlink to <code>bin</code> (this is already the whole installation):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server$ <strong>git clone git://github.com/sitaramc/gitolite</strong>
server$ <strong>gitolite/install -ln</strong></pre>
</div>
</div>
<div class="paragraph">
<p>You can now configure Gitolite and enter your public key with which you want to manage the Gitolite configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server$ <strong>bin/gitolite setup -pk &lt;ihr-key&gt;.pub</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Check that Gitolite works on the computer where you normally work (and where you have stored the corresponding private key):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>client$ <strong>ssh -T git@&lt;server&gt;</strong>
...
 R W    gitolite-admin</pre>
</div>
</div>
<div class="paragraph">
<p>You should verify that your key gives you read and write permission to the gitolite-admin repository.
Now clone it onto your computer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>client$ <strong>git clone git@&lt;server&gt;:gitolite-admin</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The repository contains the entire configuration for Gitolite.
You check in your changes there and upload them via <code>git push</code>: the server automatically updates the settings.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.gitolite-config"><a class="anchor" href="#sec.gitolite-config"></a>7.2.2. Configuring Gitolite</h4>
<div class="paragraph">
<p>The Gitolite admin directory contains two subdirectories, <code>conf</code> and <code>keydir</code>.
To introduce a new user to Gitolite, you need to put their SSH key under <code>keydir/&lt;user&gt;.pub</code>.
If the user has multiple keys, you can store them in separate files of the format <code>&lt;user&gt;@&lt;description&gt;.pub</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>client$ <strong>cat &gt; keydir/feh@laptop1.pub</strong>
ssh-dss AAAAB3NzaC1kc3M ... dTw== feh@mali
^D
client$ <strong>cat &gt; keydir/feh@laptop2.pub</strong>
ssh-dss AAAAB3NzaC1kc3M ... 5LA== feh@deepthought
^D</pre>
</div>
</div>
<div class="paragraph">
<p>Don&#8217;t forget to check in the new keys with <code>git add keydir</code> followed by <code>git commit</code>.
To make them known to the gitolite installation, you also need to upload the commits using <code>git push</code>.</p>
</div>
<div class="paragraph">
<p>Then you can assign permissions to this username in the <code>conf/gitolite.conf</code> configuration file.</p>
</div>
<div class="paragraph">
<p>You can save yourself a lot of administrative work and typing by using <em>macros</em>.
You can combine groups (of users or repositories), e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@test_entwickler = max markus felix
@test_repos      = test1 test2 test3</pre>
</div>
</div>
<div class="paragraph">
<p>These macros are also evaluated recursively.
When defining them, it does not have to be clear whether they are users or repositories; the macros are only evaluated at runtime.
This allows you to create groups from other groups:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@proj = @developer @tester @admins</pre>
</div>
</div>
<div class="paragraph">
<p>There is a special group <code>@all</code> which, depending on the context, contains all users or all repositories.</p>
</div>
<div class="paragraph">
<p>You can configure one (or more) repositories as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>repo @test_repos
    RW+ = @test_entwickler</pre>
</div>
</div>
<div class="paragraph">
<p><code>R</code> and <code>W</code> stand for read or write access.
The plus means that forced uploading is also allowed (<em>non-fast-forward</em>, i.e. also deleting commits).</p>
</div>
<div class="paragraph">
<p>For a repository, of course, several such lines can be entered.
In a small project there could be maintainers, other developers and testers.
Then the access rights could be regulated as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@maintainers = ... # Hauptentwickler/Chefs
@developers  = ... # Weitere Entwickler
@testers     = ...

repo Projekt
    RW+ = @maintainers
    RW  = @developers
    R   = @testers</pre>
</div>
</div>
<div class="paragraph">
<p>Thus, the testers have read-only access, while the developers are allowed to upload new commits, but only if they can be integrated via <em>fast-forward</em>.
The main maintainers are allowed &#8220;everything&#8221;.</p>
</div>
<div class="paragraph">
<p>These lines are processed sequentially.
If the line applies to a user, Gitolite authorizes the user and grants him the appropriate rights.
If no line matches the user, the user is rejected and is not allowed to change anything in the repository.</p>
</div>
<div class="paragraph">
<p>A user can view all his permissions by simply logging into the Git server via SSH.
Immediately after installation, this is how it looks like to the administrator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>ssh -q git@&lt;server&gt;</strong>
hello feh, this is git@mjanja running gitolite3 v3.6.1-6-gdc8b590 on git 2.1.0

 R W     gitolite-admin
 R W     testing</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.gitweb-name"><a class="anchor" href="#sec.gitweb-name"></a>7.2.3. Ownership and Description</h4>
<div class="paragraph">
<p>If you want to install a web-based tool to browse the Git repositories later, you should also name a person in charge and describe the project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>repo &lt;repo-name&gt;
  # Zugriffsrechte
  config gitweb.owner = "Julius Plenz"
  config gitweb.description = "Ein Test-Repository"</pre>
</div>
</div>
<div class="paragraph">
<p>For this to work, you must first enable Gitolite to set these config settings: This is done on the server where Gitolite is installed, in the file <code>.gitolite.rc</code>: Enter the value <code>gitweb\..*</code> under the <code>GIT_CONFIG_KEYS</code> key.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.file-access"><a class="anchor" href="#sec.file-access"></a>7.2.4. Access Rights on File or Branch Level</h4>
<div class="paragraph">
<p>Especially in corporate environments, access rights often have to be differentiated even more finely than a mere &#8220;has access&#8221; and &#8220;must not access&#8221;.
For this purpose, Gitolite offers access restriction on directory- and file- as well as tag- and branch-level.</p>
</div>
<div class="paragraph">
<p>We will first look at a case that occurs frequently: developers should be able to develop on development branches at will, but only a small group of maintainers should be able to edit &#8220;important&#8221; branches such as <code>master</code>.</p>
</div>
<div class="paragraph">
<p>This could be implemented in a similar way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@maintainers = ...
@developers  = ...

repo Projekt
    RW+ dev/    = @developers
    RW+         = @maintainers
    R           = @developers</pre>
</div>
</div>
<div class="paragraph">
<p>Here a &#8220;development namespace&#8221; is created: The group of developers can work with branches below <code>dev/</code>, e.g. create <code>dev/feature</code> or delete it.
However, the developers can only read the <code>master</code> branch, not change it&#8201;&#8212;&#8201;this is reserved for the maintainers.</p>
</div>
<div class="paragraph">
<p>The part between the <em>flags</em> (<code>RW+</code>) and the equal sign is a so-called <em>Perl-Compatible Regular Expression</em> (PCRE).
If it does not start with <code>refs/</code>, the expression refers to all references below <code>refs/heads/</code>, i.e. branches.
In the above example, any references below <code>refs/heads/dev/</code> can be modified&#8201;&#8212;&#8201;but not the <code>dev</code> branch itself, nor <code>anything-dev</code>!</p>
</div>
<div class="paragraph">
<p>But if such an expression starts explicitly with <code>refs/</code>, you can manage any references.
In the following way you can set up that all maintainers are allowed to create <em>Release Candidate</em> tags,&#8288;<sup class="footnote">[<a id="_footnoteref_96" class="footnote" href="#_footnotedef_96" title="View footnote.">96</a>]</sup> but only <em>one</em> maintainer is really allowed to create the versioning tag (or any other):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>repo Projekt
    RW+ refs/tags/v.*-rc[0-9]+$     = @maintainers
    RW+ refs/tags/                  = &lt;projektleiter&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>If one of the maintainers still wants to upload a tag like <code>v1.0</code>, the following happens:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>remote: W refs/tags/v1.0 &lt;repository&gt; &lt;user&gt; DENIED by fallthru
remote: error: hook declined to update refs/tags/v1.0
To &lt;user&gt;:&lt;repository&gt;
 ! [remote rejected] v1.0 -&gt; v1.0 (hook declined)</pre>
</div>
</div>
<div class="paragraph">
<p>As mentioned above, here the rules are applied one after the other.
Since the tag <code>v1.0</code> does not match the regular expression above, only the bottom line comes into question, but the username does not match.
No line is left (<code>fallthru</code>), so the action is not allowed.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.personal-namespaces"><a class="anchor" href="#sec.personal-namespaces"></a>7.2.5. Personal Namespaces</h4>
<div class="paragraph">
<p>The concept of personal namespaces is somewhat more flexible.
This gives each developer his own hierarchy of branches that he can manage.</p>
</div>
<div class="paragraph">
<p>There is a special keyword for this, <code>USER</code>, which is replaced by the user name currently accessing the branch.
This makes the following possible:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>repo Projekt
    RW+ p/USER/  = @developers
    R            = @developers @maintainers</pre>
</div>
</div>
<div class="paragraph">
<p>Nun können alle Developer unterhalb von <code>p/&lt;user&gt;/</code> beliebig ihre Branches verwalten.
Die untere Direktive sorgt dafür, dass alle diese Branches auch lesen können.
Nun kann <code>max</code> z.B. <code>p/max/bugfixes</code> erstellen, aber <code>moritz</code> kann nur lesend darauf zugreifen.</p>
</div>
<div class="paragraph">
<p>Now all developers under <code>p/&lt;user&gt;/</code> can manage their branches as they like.
The lower directive makes sure that all developers can read these branches.
Now <code>max</code> can e.g. create <code>p/max/bugfixes</code>, but <code>moritz</code> can only read them.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.file-level-acl"><a class="anchor" href="#sec.file-level-acl"></a>7.2.6. File-Level Access Control</h4>
<div class="paragraph">
<p>Gitolite also allows file- and directory-level access restrictions.
The virtual reference <code>VREF/NAME</code> is responsible for this.
For example, you can allow the documentation team only (writing&#8288;<sup class="footnote">[<a id="_footnoteref_97" class="footnote" href="#_footnotedef_97" title="View footnote.">97</a>]</sup>) access to <code>doc/</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@doc = ...  # Dokumentations-Team

repo Projekt
    RW VREF/NAME/doc/   = @doc
    -  VREF/NAME/       = @doc</pre>
</div>
</div>
<div class="paragraph">
<p>However, the following pitfalls must be taken into account: Once the keyword <code>VREF/NAME</code> appears once, the file-based rules are applied to <em>all</em> users.
If none of them apply, access is allowed&#8201;&#8212;&#8201;so the second rule is important, which prohibits access for <code>@doc</code> unless the commit only modifies files under <code>doc/</code> (see also <a href="#sec.gl-deny">Section 7.2.7, &#8220;Explicitly Prohibiting Actions&#8221;</a> below).</p>
</div>
<div class="paragraph">
<p>Access control checks at the commit level which files are modified; if a commit contains changes to a file that the user is not allowed to edit, the entire <code>push</code> process is aborted.
In particular, no actions can be performed that involve commits from other developers that modify files outside the allowed range.</p>
</div>
<div class="paragraph">
<p>Specifically, in relation to the above example, this means that <code>@doc</code> members generally <em>cannot create new branches</em>.
Creating a new branch would mean creating a new reference to an initial commit and then <em>fast-forwarding</em> all commits from top to root, i.e., the entire project history.
However, there are certainly commits in it that modify files outside of <code>doc/</code>, and so the action is prohibited.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.gl-deny"><a class="anchor" href="#sec.gl-deny"></a>7.2.7. Explicitly Prohibiting Actions</h4>
<div class="paragraph">
<p>Previously, a user was only rejected if he failed all rules (<code>fallthru</code>), i.e. if no rights were assigned to him.
But the <code>-</code> flag (instead of <code>RW</code>) can be used to explicitly restrict access.
Again, the rules are passed through from top to bottom.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>repo Projekt
    -   VREF/NAME/Makefile   = @developers</pre>
</div>
</div>
<div class="paragraph">
<p>This directive prohibits members of <code>@developers</code> from making commits that modify the <code>Makefile</code>.&#8288;<sup class="footnote">[<a id="_footnoteref_98" class="footnote" href="#_footnotedef_98" title="View footnote.">98</a>]</sup></p>
</div>
<div class="paragraph">
<p>By convention, you should never upload forced updates to the <code>master</code> or <code>maint</code> branches (see also <a href="#sec.branches">Section 3.1, &#8220;References: Branches and Tags&#8221;</a>).
You can now force this policy with Gitolite:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>repo Projekt
    RW  master maint    = @developers
    -   master maint    = @developers
    RW+                 = @developers</pre>
</div>
</div>
<div class="paragraph">
<p>If a branch that is <em>not</em> called <code>master</code> or <code>maint</code> is uploaded, only the third rule is applied and arbitrary access (including non <em>fast-forward</em> updates) is allowed.
Commits that can be integrated to <code>master</code> or <code>maint</code> via <em>fast-forward</em> are allowed by the first rule.
Note the missing plus sign, though: A forced update is not covered by the first rule, but by the second one, which explicitly prohibits everything (that has not been allowed before).</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.enforcing-policies"><a class="anchor" href="#sec.enforcing-policies"></a>7.2.8. Should Policies Be Enforced?</h4>
<div class="paragraph">
<p>With the means presented here and others, which you can take from the documentation, &#8288;<sup class="footnote">[<a id="_footnoteref_99" class="footnote" href="#_footnotedef_99" title="View footnote.">99</a>]</sup> you are able to force policies very flexibly.
However, it may not be useful to control everything down to the smallest detail.
As mentioned above, especially a control on file name level is problematic.
Then, if hours of work go into a commit, but it can&#8217;t be uploaded because one of those restrictions prohibits it, the frustration is great (and fixing that commit is not trivial, either; see <em>rebase</em>, <a href="#sec.rebase">Section 4.1, &#8220;Move commits - Rebase&#8221;</a>).</p>
</div>
<div class="paragraph">
<p>At the branch level, it makes sense to give only a limited group of developers access to &#8220;important&#8221; branches (such as <code>master</code>).
Of course, strict control over who can do what comes at the expense of flexibility, and it&#8217;s this flexibility that makes branching in Git so practical.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.git-daemon"><a class="anchor" href="#sec.git-daemon"></a>7.3. Git Daemon: Anonymous Read-Only Access</h3>
<div class="paragraph">
<p>The Git daemon allows unencrypted, anonymous, read-only access to Git repositories via the Git protocol.
It comes with Git and usually runs on TCP port 9418 (and can thus be started without root privileges).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The transmission is not encrypted.
However, the cryptographic integrity that Git constantly checks excludes the possibility of attackers manipulating the data stream and smuggling in malicious code.&#8288;<sup class="footnote">[<a id="_footnoteref_100" class="footnote" href="#_footnotedef_100" title="View footnote.">100</a>]</sup></p>
</li>
<li>
<p>This way is ideal for making source code available to a large number of people quickly and easily.
Only the minimum of necessary information is downloaded (only the required commits are negotiated and then transferred packed).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to export one or more repositories, simply execute <code>git daemon &lt;path&gt;</code>, where <code>&lt;path&gt;</code> is the path where your repositories are located.
You can also specify multiple paths.
If you have already set up Gitolite as above, <code>/var/git/repositories</code> is a useful path.</p>
</div>
<div class="paragraph">
<p>For testing, you can run a Git daemon on a single repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>touch .git/git-daemon-export-ok</strong>
$ <strong>git daemon --verbose /home/feh/testrepo</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Then clone (preferably into a temporary directory) this very repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone git://localhost/home/feh/testrepo</strong>
Initialized empty Git repository in /tmp/tmp.kXtkwxKgkc/testrepo/.git/
remote: Counting objects: 130, done.
remote: Compressing objects: 100% (102/102), done.
Receiving objects: 100% (130/130), 239.71 KiB, done.
Resolving deltas: 100% (54/54), done.
remote: Total 130 (delta 54), reused 0 (delta 0)</pre>
</div>
</div>
<div class="paragraph">
<p>However, the Git daemon will only export a repository if a <code>git-daemon-export-ok</code> file is created in the <code>.git</code> directory (as done above; in the case of <em>bare repositories</em>, of course, this must be done in the directory itself).
This is done for security reasons: For example, <code>/var/git/repositories</code> may contain many (even private) repositories, but only those that really need to be exported without access control will receive this file.</p>
</div>
<div class="paragraph">
<p>However, the daemon accepts the <code>--export-all</code> option, which removes this restriction and exports all repositories in all subdirectories.</p>
</div>
<div class="paragraph">
<p>Another important setting is the <em>Base Path</em>, which is the path where the actual Git repositories are located.
Start the Git daemon as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git daemon --base-path=/var/git/repositories /var/git/repositories</strong></pre>
</div>
</div>
<div class="paragraph">
<p>wird jeder Anfrage nach einem Git-Repository der <em>Base Path</em> vorangestellt.
Nun können Nutzer ein Repository mit der Adresse <code>git://&lt;server&gt;/&lt;projekt&gt;.git</code> klonen, anstatt das umständliche <code>git://&lt;server&gt;/var/git/repositories/&lt;projekt&gt;.git</code> zu verwenden.</p>
</div>
<div class="paragraph">
<p>every request for a git repository is preceded by the <em>base path</em>.
Now users can clone a repository with the address <code>git://&lt;server&gt;/&lt;project&gt;.git</code> instead of using the cumbersome <code>git://&lt;server&gt;/var/git/repositories/&lt;project&gt;.git</code>.</p>
</div>
<div class="sect3">
<h4 id="sec.git-daemon-inetd"><a class="anchor" href="#sec.git-daemon-inetd"></a>7.3.1. Git-Daemon and Inetd</h4>
<div class="paragraph">
<p>As a rule, the Git daemon is supposed to constantly deliver a large number of repositories.
To do this, it runs constantly in the background or is restarted for each request.
The latter task is typically performed by <em>Inetd</em> from OpenBSD.
To make this work, you just need to add the following (one!) line to <code>/etc/inetd.conf</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git     stream  tcp     nowait  &lt;user&gt;   /usr/bin/git git daemon
  --inetd --base-path=/var/git/repositories /var/git/repositories</pre>
</div>
</div>
<div class="paragraph">
<p><code>&lt;user&gt;</code> must be a user who has read access to the repositories.
This can be <code>root</code>, because the Inetd normally runs with root privileges, but should be <code>git</code> or a similarly unprivileged account.</p>
</div>
<div class="paragraph">
<p>The configuration for the <code>xinetd</code> is similar, but more self-explanatory.
It is stored e.g. under <code>/etc/xinet.d/git-daemon</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>service git
{
    disable         = no
    type            = UNLISTED
    port            = 9418
    socket_type     = stream
    wait            = no
    user            = &lt;user&gt;
    server          = /usr/bin/git
    server_args     = daemon --inetd --base-path=... ...
    log_on_failure  += USERID
}</pre>
</div>
</div>
<div class="paragraph">
<p>Do not forget to restart the respective daemon via <code>/etc/init.d/[x]inetd restart</code>.&#8288;<sup class="footnote">[<a id="_footnoteref_101" class="footnote" href="#_footnotedef_101" title="View footnote.">101</a>]</sup></p>
</div>
</div>
<div class="sect3">
<h4 id="sec.git-daemon-sv"><a class="anchor" href="#sec.git-daemon-sv"></a>7.3.2. The Debian Way: Git Daemon SV</h4>
<div class="paragraph">
<p>Debian offers the <code>git-daemon-run</code> package which contains configuration files for <code>sv</code>.&#8288;<sup class="footnote">[<a id="_footnoteref_102" class="footnote" href="#_footnotedef_102" title="View footnote.">102</a>]</sup>
The package essentially creates a <code>gitlog</code> user and two executable shell scripts, <code>/etc/sv/git-daemon/run</code> and <code>/etc/sv/git-daemon/log/run</code>.
Modify the former to run the Git daemon in the directory where your repositories are located:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/sh
exec 2&gt;&amp;1
echo _git-daemon starting._
exec git-daemon --verbose --listen=203.0.113.1 --user=git --group=git \
  --reuseaddr --base-path=/var/git/repositories /var/git/repositories</pre>
</div>
</div>
<div class="paragraph">
<p>If you start the Git daemon from a shell script this way (or similarly via SysV-Init), the script will be executed with root privileges.
The following options are therefore useful:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>--user=&lt;user&gt;</code> 
</td>
<td class="hdlist2">
<p>The user which the daemon runs as (e.g. <code>git</code>).
Must have read access to the repositories.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>-&#8288;-&#8288;group&#8288;=&#8288;&lt;group&gt;</code> 
</td>
<td class="hdlist2">
<p>The group which the daemon runs as.
It makes sense to use the user group (<code>git</code>) or <code>nobody</code>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>--reuseaddr</code> 
</td>
<td class="hdlist2">
<p>Prevents the daemon restart from going wrong because there are still open connections waiting for a timeout.
This option uses the bind address even if there are still connections.
You should always specify this option if an instance is running continuously.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you are using SysV-Init, which means that services are usually started via symlinks in <code>/etc/rc2.d/</code> to scripts in <code>/etc/init.d/</code>, you will also need to create the following symlinks to automatically start the git daemon when the system boots</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>ln -s /usr/bin/sv /etc/init.d/git-daemon</strong>
# <strong>ln -s ../init.d/git-daemon /etc/rc2.d/S92git-daemon</strong>
# <strong>ln -s ../init.d/git-daemon /etc/rc0.d/K10git-daemon</strong>
# <strong>ln -s ../init.d/git-daemon /etc/rc6.d/K10git-daemon</strong></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.git-daemon-production"><a class="anchor" href="#sec.git-daemon-production"></a>7.3.3. The Git Daemon on Production Systems</h4>
<div class="paragraph">
<p>On a production system that is more than just a Git server, you may encounter the following situations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There are several network cards or virtual interfaces.</p>
</li>
<li>
<p>The service should run on a different port.</p>
</li>
<li>
<p>Different IPs should deliver different repositories.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Git daemon provides options to respond to such situations.
They are summarized below.
For more detailed explanations, please consult the <code>git-daemon</code> man page.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--max-connections=&lt;n&gt;</code> </dt>
<dd>
<p>By default, the Git daemon only allows 32 simultaneous connections.
With this option you can increase the number.
A value of 0 allows any number of connections.&#8288;<sup class="footnote">[<a id="_footnoteref_103" class="footnote" href="#_footnotedef_103" title="View footnote.">103</a>]</sup></p>
</dd>
<dt class="hdlist1"><code>--syslog</code> </dt>
<dd>
<p>Uses the syslog mechanism instead of standard error to log error messages.</p>
</dd>
<dt class="hdlist1"><code>--port=&lt;n&gt;</code> </dt>
<dd>
<p>Uses a port other than 9418.</p>
</dd>
<dt class="hdlist1"><code>--listen=&lt;host/ip&gt;</code> </dt>
<dd>
<p>Determines which interface the Git daemon should bind to.
By default the daemon is accessible on all interfaces, so it binds to <code>0.0.0.0</code>.
A setting of <code>127.0.0.1</code>, for example, only allows connections from the local machine.</p>
</dd>
<dt class="hdlist1"><code>--interpolated-path=&lt;template&gt;</code> </dt>
<dd>
<p>If a Git daemon shall offer different repositories depending on the interface-address, this is controlled by the <code>&lt;template&gt;</code>: <code>%IP</code> is replaced by the IP address of the interface, where the connection comes in, and <code>%D</code> by the given path.
With a template of <code>/repos/%IP%D</code>, a <code>git clone git://localhost/testrepo</code> will display the following message in the log files: <code>interpolated dir '/repos/127.0.0.1/testrepo'</code> (because the connection is established via the loopback interface).
For each interface on which the Git daemon runs, there must be a subdirectory in <code>/repos/</code> with the interface&#8217;s corresponding IP address in which exportable repositories are located.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec.gitolite-export"><a class="anchor" href="#sec.gitolite-export"></a>7.3.4. Specifying Exportable Repositories on Gitolite</h4>
<div class="paragraph">
<p>Gitolite knows a special username, <code>daemon</code>.
For all repositories where this user has read permission, the file <code>git-daemon-export-ok</code> is automatically created.
So you can use Gitolite to directly specify which repositories to export:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>repo Projekt
    R = daemon</pre>
</div>
</div>
<div class="paragraph">
<p>Note that this setting has no effect if you start the Git daemon with the <code>--export-all</code> option.
Also, you cannot give this permission to all repositories via <code>repo @all</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.gitweb"><a class="anchor" href="#sec.gitweb"></a>7.4. Gitweb: The Integrated Web Frontend</h3>
<div class="paragraph">
<p>Git comes with an integrated, browser-based frontend called <em>Gitweb</em>.
The frontend allows you to search the entire version history of a project: Each commit can be viewed with full details, differences between commits, files or branches, as well as all log messages.
In addition, each snapshot can be downloaded individually as a tar archive (this is especially handy for Git newbies).</p>
</div>
<div class="paragraph">
<p>To get an overview of the functionality, you can use the command <code>git instaweb</code> to set up a temporary web server with Gitweb without further configuration.</p>
</div>
<div class="paragraph">
<p>Git does not come with its own web server.
You can use the <code>--httpd=&lt;webserver&gt;</code> option to specify which web server Git should use to deliver the page.
If you just want to try out Gitweb, we recommend using the <code>webrick</code> web server&#8201;&#8212;&#8201;this is a small web server that automatically ships with the Ruby scripting language.</p>
</div>
<div class="paragraph">
<p>As soon as you execute the following command, the web server will be started and the page will be displayed in the browser (which browser is used can be specified with the <code>--browser</code> option).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git instaweb --httpd=webrick</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the command must be started at the top level of a Git directory.
If necessary, stop the web server with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git instaweb --stop</strong></pre>
</div>
</div>
<div class="sect3">
<h4 id="sec.gitweb-installation"><a class="anchor" href="#sec.gitweb-installation"></a>7.4.1. Installing Gitweb Globally</h4>
<div class="paragraph">
<p>Many distributions already include Gitweb as a separate package or directly in the Git package.
Under Debian, the corresponding package is called <code>gitweb</code>.
If you are not sure if Gitweb is available on your system, you should check under <code>/usr/share/gitweb</code> and install it if necessary.</p>
</div>
<div class="paragraph">
<p>Gitweb only requires a large Perl script plus a configuration file and optionally a logo, CSS stylesheet, and favicon.
The configuration file is usually located in <code>/etc/gitweb.conf</code>, but can also be named differently.
It is important that each time the Perl script is called, the environment variable <code>GITWEB_CONFIG</code> is used to specify where this file is located.</p>
</div>
<div class="paragraph">
<p>Usually you should already have such a file.
The following list shows the most important configuration options.</p>
</div>
<div class="paragraph">
<p>Attention: The file must be written in valid Perl.
In particular, do not forget the concluding semicolon when assigning variables!</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>$projectroot</code> </dt>
<dd>
<p>The directory where your Git repositories are located.</p>
</dd>
<dt class="hdlist1"><code>$export_ok</code> </dt>
<dd>
<p>File name that determines whether a repository should be visible in Gitweb.
You should set this variable to <code>"git-daemon-export-ok"</code> so that only those repositories that are also delivered by the Git daemon are displayed.</p>
</dd>
<dt class="hdlist1"><code>@git_base_url_list</code> </dt>
<dd>
<p>Array of URLs that can be used to clone the project.
These URLs appear in the project overview and are very helpful to give people quick access to the source code after they have gotten a brief overview.
It&#8217;s best to specify the URL where your Git daemon can be reached, e.g. <code>('git://git.example.com')</code>.</p>
</dd>
<dt class="hdlist1"><code>$projects_list</code> </dt>
<dd>
<p>Assignment of projects and their owners.
This project list can be automatically generated by Gitolite; see the sample configuration file below.</p>
</dd>
<dt class="hdlist1"><code>$home_text</code> </dt>
<dd>
<p>Absolute path to a file containing, for example, a company or project-specific text module.
This is displayed above the list of repositories.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If you installed Gitolite as mentioned above, and your repositories are located under <code>/var/git/repositories</code>, the following Gitweb configuration should be sufficient:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$projects_list = "/var/git/projects.list";
$projectroot = "/var/git/repositories";
$export_ok = "git-daemon-export-ok";
@git_base_url_list = (_git://example.com_);</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.gitweb-apache"><a class="anchor" href="#sec.gitweb-apache"></a>7.4.2. Gitweb and Apache</h4>
<div class="paragraph">
<p>Assuming that you have installed the CGI script under <code>/usr/lib/cgi-bin</code> and the image and CSS files under <code>/usr/share/gitweb</code> (as the Debian <code>gitweb</code> package does), configure Apache as follows:</p>
</div>
<div class="paragraph">
<p>Create <code>/etc/apache2/sites-available/git.example.com</code> with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;VirtualHost *:80&gt;
  ServerName    git.example.com
  ServerAdmin   admins@example.com

  SetEnv GITWEB_CONFIG /etc/gitweb.conf

  Alias /gitweb.css         /usr/share/gitweb/gitweb.css
  Alias /git-logo.png       /usr/share/gitweb/git-logo.png
  Alias /git-favicon.png    /usr/share/gitweb/git-favicon.png
  Alias /                   /usr/lib/cgi-bin/gitweb.cgi

  Options +ExecCGI
&lt;/VirtualHost&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Then you need to activate the virtual host and let Apache reload the configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># <strong>a2ensite git.example.com</strong>
# <strong>/etc/init.d/apache2 reload</strong></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.gitweb-Lighttpd"><a class="anchor" href="#sec.gitweb-Lighttpd"></a>7.4.3. Gitweb and Lighttpd</h4>
<div class="paragraph">
<p>Depending on how you implement virtual hosts in Lighttpd, the configuration might look different.
Three things are important: That you make aliases for the globally installed Gitweb files, set the environment variable <code>GITWEB_CONFIG</code> and that CGI scripts are executed.
To do this you need to load the modules <code>mod_alias</code>, <code>mod_setenv</code> and <code>mod_cgi</code> (if you haven&#8217;t already done so).</p>
</div>
<div class="paragraph">
<p>The configuration then looks like this:&#8288;<sup class="footnote">[<a id="_footnoteref_104" class="footnote" href="#_footnotedef_104" title="View footnote.">104</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$HTTP["host"] =~ "^git\.example\.com(:\d+)?$" {
    setenv.add-environment = ( "GITWEB_CONFIG" =&gt; "/etc/gitweb.conf" )
    alias.url = (
        "/gitweb.css"       =&gt; "/usr/share/gitweb/gitweb.css",
        "/git-logo.png"     =&gt; "/usr/share/gitweb/git-logo.png",
        "/git-favicon.png"  =&gt; "/usr/share/gitweb/git-favicon.png",
        "/"                 =&gt; "/usr/lib/cgi-bin/gitweb.cgi",
    )
    $HTTP["url"] =~ "^/$" {
        cgi.assign = ( ".cgi" =&gt; "" )
    }
}</pre>
</div>
</div>
<div id="fig.gitweb-overview" class="imageblock">
<div class="content">
<img src="images/gitweb-overview.png" alt="gitweb overview" width="90%">
</div>
<div class="title">Figure 42. Gitweb&#8217;s Summary page</div>
</div>
<div id="fig.gitweb-commitdiff" class="imageblock">
<div class="content">
<img src="images/gitweb-commitdiff.png" alt="gitweb commitdiff" width="90%">
</div>
<div class="title">Figure 43. Viewing a commit in Gitweb</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.cgit"><a class="anchor" href="#sec.cgit"></a>7.5. CGit&#8201;&#8212;&#8201;CGI for Git</h3>
<div class="paragraph">
<p>CGit (&#8220;CGI for Git&#8221;) is an alternative web frontend.
Unlike Gitweb, which is written entirely in Perl, CGit is written in C and uses caching where possible.
This renders it much faster than Gitweb.</p>
</div>
<div class="paragraph">
<p>To install CGit, you need to download the sources first.
You will need the latest version of Git to access routines from the Git source code.
To do this, you need to initialize the already configured submodule and download the code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone git://git.zx2c4.com/cgit</strong>
...
$ <strong>cd cgit</strong>
$ <strong>git submodule init</strong>
Submodule 'git' (git://git.kernel.org/pub/scm/git/git.git) registered
for path 'git'
$ <strong>git submodule update</strong>
&lt;Git-Sourcen werden heruntergeladen.&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>By default CGit installs the CGI file in a somewhat obscure directory <code>/var/www/htdocs/cgit</code>.
To choose more sensible alternatives, create a file <code>cgit.conf</code> in the CGit directory, which is automatically included in the <code>Makefile</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>CGIT_SCRIPT_PATH=/usr/lib/cgi-bin
CGIT_DATA_PATH=/usr/share/cgit</pre>
</div>
</div>
<div class="paragraph">
<p>Now the program can be compiled and installed via <code>make install</code>.
However, it is recommended to use <code>checkinstall</code>&#8288;<sup class="footnote">[<a id="_footnoteref_105" class="footnote" href="#_footnotedef_105" title="View footnote.">105</a>]</sup> so that you can easily get rid of the package if necessary.</p>
</div>
<div id="fig.cgit-overview" class="imageblock">
<div class="content">
<img src="images/cgit-overview.png" alt="cgit overview" width="90%">
</div>
<div class="title">Figure 44. Overview page of CGit</div>
</div>
<div class="sect3">
<h4 id="sec.cgit-integration"><a class="anchor" href="#sec.cgit-integration"></a>7.5.1. CGit, Apache and Lighttpd</h4>
<div class="paragraph">
<p>The integration in Apache and Lighttpd is similar.
However, since CGit uses &#8220;nicer&#8221; URLs (like <code><a href="http://git.example.com/dwm/tree/dwm.c" class="bare">http://git.example.com/dwm/tree/dwm.c</a></code> for the <code>dwm.c</code> file from the <code>dwm</code> repository), a little effort is required to rewrite the URLs.</p>
</div>
<div class="paragraph">
<p>The following configurations run CGit on <code>git.example.com</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;VirtualHost *:80&gt;
  ServerName git.example.com

  AcceptPathInfo On
  Options +ExecCGI

  Alias /cgit.css /usr/share/cgit/cgit.css
  Alias /cgit.png /usr/share/cgit/cgit.png
  AliasMatch ^/(.*) /usr/lib/cgi-bin/cgit.cgi/$1
&lt;/VirtualHost&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>For Lighttpd you have to resort to some tricks.
You must not forget to configure <code>virtual-root=/</code> (see below&#8201;&#8212;&#8201;this setting is not harmful for Apache either).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$HTTP["host"] =~ "^git\.example\.com(:\d+)?$" {
    alias.url = (
        "/cgit.css" =&gt; "/usr/share/cgit/cgit.css",
        "/cgit.png" =&gt; "/usr/share/cgit/cgit.png",
        "/cgit.cgi" =&gt; "/usr/lib/cgi-bin/cgit.cgi",
        "/"         =&gt; "/usr/lib/cgi-bin/cgit.cgi",
    )
    cgi.assign = ( ".cgi" =&gt; "" )
    url.rewrite-once = (
        "^/cgit\.(css|png)" =&gt; "$0", # statische Seiten "durchreichen"
        "^/.+" =&gt; "/cgit.cgi$0"
    )
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.cgit-config"><a class="anchor" href="#sec.cgit-config"></a>7.5.2. Configuration</h4>
<div class="paragraph">
<p>The configuration is controlled by the file <code>/etc/cgitrc</code>.
A list of supported options can be found in the file <code>cgitrc.5.txt</code> in the source directory of CGit (unfortunately the program does not include any other documentation).
The most important ones are listed below:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>clone-prefix</code> </dt>
<dd>
<p>URL where the source code (preferably via Git protocol) can be downloaded (similar to <code>@git_base_url_list</code> from Gitweb).</p>
</dd>
<dt class="hdlist1"><code>enable-index-links</code> </dt>
<dd>
<p>If set to 1, another column appears in the repository listing, with direct links to the tabs &#8220;summary&#8221;, &#8220;log&#8221; and &#8220;tree&#8221;.</p>
</dd>
<dt class="hdlist1"><code>enable-gitweb-owner</code> </dt>
<dd>
<p>If set to 1, the owner is read from the Git repository&#8217;s <code>gitweb.owner</code> configuration.
Gitolite sets this option automatically when you specify a name, see <a href="#sec.gitweb-name">Section 7.2.3, &#8220;Ownership and Description&#8221;</a>.</p>
</dd>
<dt class="hdlist1"><code>enable-log-filecount</code> </dt>
<dd>
<p>Displays a column for each commit, showing the number of changed files.</p>
</dd>
<dt class="hdlist1"><code>enable-log-linecount</code> </dt>
<dd>
<p>Analogous to <code>-filecount</code>, displays a summary of added/removed rows.</p>
</dd>
<dt class="hdlist1"><code>scan-path</code> </dt>
<dd>
<p>Path that CGit should search for Git repositories.
Attention: This option <em>doesn&#8217;t</em> take into account whether the repository has been released by the <code>git-daemon-export-ok</code> file (see also <code>project-list</code>)!
Also note that the repositories added in this way will only inherit the settings that were made up to that point.
It is therefore recommended to list the <code>scan-path</code> line last in the file.</p>
</dd>
<dt class="hdlist1"><code>project-list</code> </dt>
<dd>
<p>List of project files to be included in the <code>scan-path</code>.
Gitolite creates such a file for all public repositories.
See the sample configuration below.</p>
</dd>
<dt class="hdlist1"><code>remove-suffix</code> </dt>
<dd>
<p>If the option is set to 1: the <code>.git</code> suffix is removed from URLs or repository names.</p>
</dd>
<dt class="hdlist1"><code>root-title</code> </dt>
<dd>
<p>Headline that is displayed on the home page, next to the logo.</p>
</dd>
<dt class="hdlist1"><code>root-desc</code> </dt>
<dd>
<p>Lettering that is displayed on the home page, under the headline.</p>
</dd>
<dt class="hdlist1"><code>side-by-side-diffs</code> </dt>
<dd>
<p>If the option is set to 1, diff output will display two files side by side instead of using the unified diff format.</p>
</dd>
<dt class="hdlist1"><code>snapshots</code> </dt>
<dd>
<p>Specifies which snapshot formats are offered.
By default, none are offered.
Possible values are <code>tar</code>, <code>tar.gz</code>, <code>tar.bz2</code> and <code>zip</code>.
Specify the desired formats separated by spaces.</p>
</dd>
<dt class="hdlist1"><code>virtual-root</code> </dt>
<dd>
<p>Specifies which URL CGit should prefix to each link.
If you set CGit to a &#8220;higher&#8221;" layer, e.g. <code><a href="http://git.example.com" class="bare">http://git.example.com</a></code>, this option should be set to <code>/</code> (this is especially necessary if you use Lighttpd).
If you want to run CGit in a subdirectory instead, you should adjust this option accordingly, e.g. to <code>/git</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>With the following configuration, any repository you have allowed Gitweb access to in Gitolite will appear in the listing&#8201;&#8212;&#8201;and the description and author (if specified, see <a href="#sec.gitweb-name">Section 7.2.3, &#8220;Ownership and Description&#8221;</a>) will also be displayed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>virtual-root=/
enable-gitweb-owner=1
remove-suffix=1
project-list=/var/git/projects.list
scan-path=/var/git/repositories</pre>
</div>
</div>
<div id="fig.cgit-commitdiff" class="imageblock">
<div class="content">
<img src="images/cgit-commitdiff.png" alt="cgit commitdiff" width="90%">
</div>
<div class="title">Figure 45. Viewing a commit in CGit</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.cgit-special-config"><a class="anchor" href="#sec.cgit-special-config"></a>7.5.3. Special Configuration of Individual Repositories</h4>
<div class="paragraph">
<p>With the <code>scan-path</code> option explained above, in combination with Gitolite it is usually not necessary to add and configure repositories individually.
However, if you want to do this, or if your repositories are not stored in a central location, you can do this per repository as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>repo.url=foo
repo.path=/pub/git/foo.git
repo.desc=the master foo repository
repo.owner=fooman@example.com</pre>
</div>
</div>
<div class="paragraph">
<p>For more repository-specific configurations, consult the sample configuration file or the explanations of the options in the <code>cgitrc.5.txt</code> file in the source directory of CGit.
You can also group these manually configured repositories under different sections (option <code>section</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.cgit-cache"><a class="anchor" href="#sec.cgit-cache"></a>7.5.4. Exploiting Caching</h4>
<div class="paragraph">
<p>CGit is especially fast compared to Gitweb because it is written in C and also supports caching.
This is especially necessary if you have many repositories and/or many page views in a short time.</p>
</div>
<div class="paragraph">
<p>CGit uses a simple hash mechanism to check if a request is already in the cache and not too old (configurable, see list below).
If such a cache entry is present, it will be delivered instead of re-creating the same page (the HTTP header <code>Last-Modified</code> stays the same, i.e. the browser knows when the page is from).</p>
</div>
<div class="paragraph">
<p>CGit also caches the result of <code>scan-path</code>.
This way CGit doesn&#8217;t have to add all repositories one by one for the overview page each time.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>cache-root</code> 
</td>
<td class="hdlist2">
<p>Path where the cache files are stored; defaults to <code>/var/cache/cgit</code>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>cache-size</code> 
</td>
<td class="hdlist2">
<p>Number of entries (i.e. individual pages) that the cache contains.
The default value is 0, so caching is disabled.
A value of 500 should be enough even for large pages.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>cache&#8288;-&#8288;&lt;type&gt;&#8288;-&#8288;ttl</code> 
</td>
<td class="hdlist2">
<p>Time in minutes for a cache entry to be considered &#8220;current&#8221;.
You can configure the time specifically for individual pages.
Possible <code>&lt;type&gt;</code> values are: <code>scanrc</code> for the result of <code>scan-path</code>, <code>root</code> for the repository listing, <code>repo</code> for the &#8220;home&#8221; page of a repository, and <code>dynamic</code> or <code>static</code> for the &#8220;dynamic&#8221; pages (such as for branch names) or static pages (such as for a commit identified by its SHA-1 sum).
By default, these values are set to five minutes, except for <code>scanrc</code> (15).</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Another important factor that influences how fast the index page builds up is the use of so-called <em>age files</em>.
The <em>Idle</em> column is usually recreated each time CGit goes through the branches of each repository and notes the age.
This is not very fast though.</p>
</div>
<div class="paragraph">
<p>It&#8217;s more practical to use one file per repository, indicating when the last commit was uploaded.
This is best done with hooks (see <a href="#sec.hooks">Section 8.2, &#8220;Hooks&#8221;</a>).
Use this command in the <code>post-update</code> hook:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mkdir -p info/web || exit 1
git for-each-ref \
    --sort=-committerdate \
    --format='%(committerdate:iso8601)' \
    --count=1 'refs/heads/*' \
    &gt; info/web/last-modified</pre>
</div>
</div>
<div class="paragraph">
<p>If you want to use a different path instead of <code>info/web/last-modified</code> (relative to <code>$GIT_DIR</code>), use the CGit configuration key <code>agefile</code> for the specification.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch.automation"><a class="anchor" href="#ch.automation"></a>8. Git Automation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this chapter, we&#8217;ll introduce advanced techniques for automating Git.
In the first section about <em>Git attributes</em>, we&#8217;ll show you how to tell Git to treat certain files separately, for example, to call an external diff command on graphics.</p>
</div>
<div class="paragraph">
<p>We continue with <em>hooks</em>&#8201;&#8212;&#8201;small scripts that are executed when various git commands are called, for example to notify all developers via email when new commits arrive in the repository.</p>
</div>
<div class="paragraph">
<p>Then we&#8217;ll give a basic introduction to scripting with Git and show you useful <em>plumbing commands</em>.</p>
</div>
<div class="paragraph">
<p>Finally, we will introduce the powerful <code>filter-branch</code> command, which you can use to rewrite the project history on a large scale, for example to remove a file with a password from <em>all</em> commits.</p>
</div>
<div class="sect2">
<h3 id="sec.attributes"><a class="anchor" href="#sec.attributes"></a>8.1. Git attributes - treat files separately</h3>
<div class="paragraph">
<p><em>Git attributes</em> allow you to assign specific properties to individual files or a group of files so that Git treats them with special care; examples would be forcing the end of lines or marking certain files as binary.</p>
</div>
<div class="paragraph">
<p>You can write the attributes either in the file <code>.gitattributes</code> or <code>.git/info/attributes</code>.
The latter is for a repository and is not managed by Git.
A <code>.gitattributes</code> file is usually checked in, so all developers use these attributes.
You can also store additional attribute definitions in subdirectories.</p>
</div>
<div class="paragraph">
<p>One line in this file has the format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;pattern&gt; &lt;attrib1&gt; &lt;attrib2&gt; ...</pre>
</div>
</div>
<div class="paragraph">
<p>An example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>*.eps   binary
*.tex   -text
*.c     filter=indent</pre>
</div>
</div>
<div class="paragraph">
<p>Usually attributes can be set (e.g.&#160;`binary`), canceled (<code>-text</code>) or set to a value (<code>filter=indent</code>).
The man page <code>gitattributes(5)</code> describes in detail how Git interprets the attributes.</p>
</div>
<div class="paragraph">
<p>A project that is developed in parallel on Windows and Unix machines suffers from the fact that the developers use different conventions for line endings.
This is due to the operating system:
Windows systems use a carriage return followed by a line feed (CRLF), while unixoid systems use only a line feed (LF).</p>
</div>
<div class="paragraph">
<p>By means of suitable git attributes you can determine an adequate policy&#8201;&#8212;&#8201;in this case the attributes <code>text</code> or <code>eol</code> are responsible.
The attribute <code>text</code> causes the line ends to be "normalized".
Whether a developer&#8217;s editor uses CRLF or just LF, Git will only store the version with LF in the blob.
If you set the attribute to <code>auto</code>, Git will only perform this normalization if the file also looks like text.</p>
</div>
<div class="paragraph">
<p>The <code>eol</code> attribute, on the other hand, determines what happens during a checkout.
Regardless of the user&#8217;s <code>core.eol</code> setting, you can specify e.g. CRLF for some files (because the format requires it).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>*.txt   text
*.csv   eol=crlf</pre>
</div>
</div>
<div class="paragraph">
<p>With these attributes, <code>.txt</code> files are always saved internally with LF and checked out as CRLF if required (platform- or user-dependent).
CSV files on the other hand are checked out with CRLF on all platforms.
(Internally, Git will save all these blobs with simple LF extensions).</p>
</div>
<div class="sect3">
<h4 id="sec.smudge-clean"><a class="anchor" href="#sec.smudge-clean"></a>8.1.1. Filter: Smudge and Clean</h4>
<div class="paragraph">
<p>Git offers a <em>filter</em> to "smudge" files after a checkout and to "clean" files again before a git add.</p>
</div>
<div class="paragraph">
<p>The filters do not get any arguments, but only the content of the blob on standard in.
The output of the program is used as new blob.</p>
</div>
<div class="paragraph">
<p>For each filter you have to define a Smudge and a Clean command.
If one of the definitions is missing or if the filter is <code>cat</code>, the blob is taken over unchanged.</p>
</div>
<div class="paragraph">
<p>Which filter is used for which type of files is defined by the git attribute <code>filter</code>.
For example, to automatically indent C files correctly before a commit, you can use the following filter definitions (instead of <code>&lt;indent&gt;</code>, any other name is possible):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config filter.&lt;indent&gt;.clean indent</strong>
$ <strong>git config filter.&lt;indent&gt;.smudge cat</strong>
$ <strong>echo &#39;&#42;.c filter=&lt;indent&gt;&#39; &gt; .git/info/attributes</strong></pre>
</div>
</div>
<div class="paragraph">
<p>To "clean up" a C file, Git now automatically calls the <code>indent</code> program that should be installed on standard systems.&#8288;<sup class="footnote">[<a id="_footnoteref_106" class="footnote" href="#_footnotedef_106" title="View footnote.">106</a>]</sup></p>
</div>
</div>
<div class="sect3">
<h4 id="sec.smudge-clean-keywords"><a class="anchor" href="#sec.smudge-clean-keywords"></a>8.1.2. Keywords in files</h4>
<div class="paragraph">
<p>So in principle the well-known keyword expansions can be realized, so that e.g. <code>$Version$</code> becomes <code>$Version: v1.5.4-rc2$</code>.</p>
</div>
<div class="paragraph">
<p>You define the filters in your configuration and then equip corresponding files with this git attribute.
This works like this, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config filter.version.smudge \~/bin/git-version.smudge</strong>
$ <strong>git config filter.version.clean ~/bin/git-version.clean</strong>
$ <strong>echo &#39;&#42; filter=version&#39; &gt; .git/info/attributes</strong></pre>
</div>
</div>
<div class="paragraph">
<p>A filter that replaces or cleans up the <code>$Version$</code> keyword could be implemented as a Perl one-liner; first the Smudge filter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/sh
version=`git describe --tags`
exec perl -pe _s/$Version(:\s[^$]+)?$/$Version: _"$version"_$/g_</pre>
</div>
</div>
<div class="paragraph">
<p>And the Clean-Filter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/usr/bin/perl -p
s/$Version: [^$]+$/$Version$/g</pre>
</div>
</div>
<div class="paragraph">
<p>It is important that repeated application of such a filter does not make uncontrolled changes in the file.
A double call to Smudge should be fixed by a single call to Clean.</p>
</div>
<div class="sect4">
<h5 id="sec.smudge-clean-dontuse"><a class="anchor" href="#sec.smudge-clean-dontuse"></a>8.1.2.1. Restrictions</h5>
<div class="paragraph">
<p>The concept of filters in Git is intentionally kept simple and will not be expanded in future versions.
The filters receive <em>no</em> information about the context in which Git is currently located:
Is a checkout happening?
A merge?
A diff?
They only get the blob content.
So the filters should only perform <em>context-independent</em> manipulations.</p>
</div>
<div class="paragraph">
<p>At the time Smudge is called, the <code>HEAD</code> may not yet be up to date (the above filter would write an incorrect version number to the file during a <code>git checkout</code>, because it is called <em>before</em> the <code>HEAD</code> is moved).
So the filters are not very suitable for keyword expansion.</p>
</div>
<div class="paragraph">
<p>This may annoy users who have become accustomed to this feature in other version control systems.
However, there are no good arguments for such an expansion <em>within</em> a version control system.
The internal mechanisms Git uses to check if files have been modified are paralyzed (since they always have to go through the clean filter).
Also, because of the structure of Git repositories, you can "track" a blob through the commits or trees, so you can always tell if a file belongs to a commit by its contents if necessary.</p>
</div>
<div class="paragraph">
<p>So keyword expansion is only useful <em>outside</em> of Git.
This is not the responsibility of Git, but a <code>Makefile</code> target or script.
For example, a <code>make dist</code> can replace all occurrences of <code>VERSION</code> with the output of <code>git describe --tags</code>.
Git will display the files as "changed".
Once the files are distributed (e.g. as a tarball), you can clean up with <code>git reset --hard</code>.</p>
</div>
<div class="paragraph">
<p>Alternatively, the <code>export-subst</code> attribute ensures that an expansion of the form <code>$Format:&lt;Pretty&gt;$</code> is performed.
Where <code>&lt;Pretty&gt;</code> must be a format that is valid for <code>git log --pretty=format:&lt;Pretty&gt;</code>, e.g.&#160;`%h` for the shortened commit hash sum.
Git will only expand these attributes if the file is packaged via <code>git archive</code> (see <a href="#sec.release-create">Section 6.3.2, &#8220;Create Release&#8221;</a>).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.external-diff"><a class="anchor" href="#sec.external-diff"></a>8.1.3. Own diff programs</h4>
<div class="paragraph">
<p>Git&#8217;s internal diff mechanism is very well suited for all types of plaintext.
But it fails with binaries - Git just tells you whether they differ or not.
However, if you have a project where you need to manage binary data, such as PDFs, OpenOffice documents, or images, it&#8217;s a good idea to define a special program that creates meaningful diffs for these files.</p>
</div>
<div class="paragraph">
<p>For example, there are <code>antiword</code> and <code>pdftotext</code> to convert Word documents and PDFs to plaintext.
There are analogous scripts for OpenOffice formats.
For images you can use commands from the ImageMagick suite (see also the example below).
If you manage statistical data, you can plot the changed recordsets side by side.
Depending on the nature of the data, there are usually adequate ways to visualize changes.</p>
</div>
<div class="paragraph">
<p>Such conversion processes are, of course, lossy:
You cannot use this diff output, for example to make meaningful changes to the files in a merge conflict.
But to get a quick overview of who changed what, such techniques are sufficient.</p>
</div>
<div class="sect4">
<h5 id="sec.external-diff-parameters"><a class="anchor" href="#sec.external-diff-parameters"></a>8.1.3.1. API for external diff programs</h5>
<div class="paragraph">
<p>Git provides a simple API for custom diff filters.
A diff filter is always passed the following seven arguments:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>path (name of the file in the Git repository)</p>
</li>
<li>
<p>old version of the file</p>
</li>
<li>
<p>old SHA-1 ID of the blob</p>
</li>
<li>
<p>old Unix rights</p>
</li>
<li>
<p>new version of the file</p>
</li>
<li>
<p>new SHA-1 ID of the blob</p>
</li>
<li>
<p>new Unix rights</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The arguments 2 and 5 may be temporary files, which will be deleted as soon as the diff program quits again, so you don&#8217;t have to care about cleaning up.</p>
</div>
<div class="paragraph">
<p>If one of the two files does not exist (newly added or deleted), then <code>/dev/null</code> is passed as file name.
The corresponding blob is then <code>00000</code>&#8230;&#8203;, even if a file does not yet exist as a fixed object in the object database (i.e. only in the working tree or index).
The Diff command must be able to handle these cases accordingly.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.diff-config"><a class="anchor" href="#sec.diff-config"></a>8.1.3.2. Configure External Diffs</h5>
<div class="paragraph">
<p>There are two ways to call an external diff program.
The first method is temporary:
just set the environment variable <code>GIT_EXTERNAL_DIFF</code> to the path to your program before calling <code>git diff</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>GIT_EXTERNAL_DIFF=&lt;/pfad/zum/diff-kommando&gt; git diff HEAD^</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The other option is persistent, but requires some configuration.
First you define your own diff command <code>&lt;name&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config diff.&lt;name&gt;.command &lt;/pfad/zum/diff-kommando&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The command needs to be able to handle the above mentioned seven arguments.
Now you have to use the git-attribute <code>diff</code> to define, which diff-program is called.
To do this, write e.g. the following lines in the <code>.gitattributes</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>*.jpg diff=imgdiff
*.pdf diff=pdfdiff</pre>
</div>
</div>
<div class="paragraph">
<p>When you check the file in, other users must also have set corresponding commands for <code>imgdiff</code> or <code>pdfdiff</code>, otherwise they will see the regular output.
If you want to set this for one repository only, write this information to <code>.git/info/attributes</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.diff-immages"><a class="anchor" href="#sec.diff-immages"></a>8.1.3.3. Compare pictures</h5>
<div class="paragraph">
<p>A common use case are pictures:
What has changed between two versions of an image?
To visualize this is not always easy.
The tool <code>compare</code> from the ImageMagick suite marks the places that have changed for images of the same size.
You can also animate the two images one after the other and recognize by the "flickering" where the image has changed.</p>
</div>
<div class="paragraph">
<p>Instead, we want a program that compares the two images.
Between the two images a kind of "difference" is displayed:
All areas where changes have occurred are copied from the <em>new</em> image onto a white background.
So the diff shows which areas have been added.</p>
</div>
<div class="paragraph">
<p>Therefore we save the following script under <code>$HOME/bin/imgdiff</code>:&#8288;<sup class="footnote">[<a id="_footnoteref_107" class="footnote" href="#_footnotedef_107" title="View footnote.">107</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/sh

OLD="$2"
NEW="$5"

# "xc:none" ist "Nichts", entspricht einem fehlenden Bild
[ "$OLD" = "/dev/null" ] &amp;&amp; OLD="xc:none"
[ "$NEW" = "/dev/null" ] &amp;&amp; NEW="xc:none"

exec convert "$OLD" "$NEW" -alpha off \
    \( -clone 0-1 -compose difference -composite -threshold 0 \) \
    \( -clone 1-2 -compose copy_opacity -composite \
       -compose over -background white -flatten \) \
    -delete 2 -swap 1,2 +append \
    -background white -flatten x:</pre>
</div>
</div>
<div class="paragraph">
<p>Finally, we need to configure the diff command and make sure it is used by an entry in the <code>.git/info/attributes</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config diff.imgdiff.command ~/bin/imgdiff</strong>
$ <strong>echo &#34;&#42;.gif diff=imgdiff&#34; &gt; .git/info/attributes</strong></pre>
</div>
</div>
<div class="paragraph">
<p>As an example we use the original versions of the Tux.&#8288;<sup class="footnote">[<a id="_footnoteref_108" class="footnote" href="#_footnotedef_108" title="View footnote.">108</a>]</sup>
First we insert the black and white Tux:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>wget http://www.isc.tamu.edu/~lewing/linux/sit3-bw-tran.1.gif \</strong>
  <strong>-Otux.gif</strong>
$ <strong>git add tux.gif &amp;&amp; git commit -m &#34;tux hinzugefügt&#34;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>It will be replaced by a colored version in the next commit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ wget http://www.isc.tamu.edu/~lewing/linux/sit3-bw<strong>o</strong>-tran.1.gif \ 
  -Otux.gif
$ <strong>git diff</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The output of the <code>git diff</code> command is a window with the following content:
On the left the old version, on the right the new version, and in the middle a mask of those parts of the new image that are different from the old.</p>
</div>
<div id="fig.tux-diff" class="imageblock">
<div class="content">
<img src="images/tux-diff.png" alt="tux diff" width="90%">
</div>
<div class="title">Figure 46. The output of <code>git diff</code> with the custom diff program <code>imgdiff</code></div>
</div>
<div class="paragraph">
<p>The example with the Tux incl. manual can also be found in a repository at:
<a href="https://github.com/gitbuch/tux-diff-demo" class="bare">https://github.com/gitbuch/tux-diff-demo</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.hooks"><a class="anchor" href="#sec.hooks"></a>8.2. Hooks</h3>
<div class="paragraph">
<p>Hooks provide a mechanism to "hook" into important Git commands and perform your own actions.
Therefore, hooks are usually small shell scripts to perform automated tasks, such as sending emails as soon as new commits are uploaded, or checking for whitespace errors before a commit and issuing a warning if necessary.</p>
</div>
<div class="paragraph">
<p>For hooks to be executed by Git, they must be located in the <code>hooks/</code> directory in the Git directory, i.e. under <code>.git/hooks/</code> or under <code>hooks/</code> at the top level for bare repositories.
They must also be executable.</p>
</div>
<div class="paragraph">
<p>Git automatically installs sample hooks on a <code>git init</code>, but these have the extension <code>&lt;hook&gt;.sample</code> and are therefore not executed without user intervention (renaming of files).</p>
</div>
<div class="paragraph">
<p>You can activate a supplied hook e.g. like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>mv .git/hooks/commit-msg.sample .git/hooks/commit-msg</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Hooks come in two classes: those that are executed locally (checking commit messages or patches, performing actions after a merge or checkout, etc.), and those that are executed server-side when you publish changes via <code>git push</code>.&#8288;<sup class="footnote">[<a id="_footnoteref_109" class="footnote" href="#_footnotedef_109" title="View footnote.">109</a>]</sup></p>
</div>
<div class="paragraph">
<p>Hooks whose name begins with <code>pre-</code> can often be used to decide whether or not to perform an action.
If a <code>pre</code>-hook does not end successfully (i.e. with a non-zero exit status), the action is aborted.
Technical documentation on how this works can be found in the <code>githooks(5)</code> man page.</p>
</div>
<div class="sect3">
<h4 id="sec.hooks-commit"><a class="anchor" href="#sec.hooks-commit"></a>8.2.1. Commits</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>pre-commit</code></dt>
<dd>
<p>Is called before the commit message is queried.
If the hook terminates with a non-zero value, the commit process is aborted.
The hook installed by default checks whether a newly added file has non-ASCII characters in the file name and whether there are whitespace errors in the modified files.
With the <code>-n</code> or <code>--no-verify</code> option, <code>git commit</code> skips this hook.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>prepare-commit-msg</code></dt>
<dd>
<p>Will be executed right before the message is displayed in an editor.
Gets up to three parameters, the first of which is the file where the commit message is stored so that it can be edited.
For example, the hook can add lines automatically.
A non-zero exit status cancels the commit process.
However, this hook cannot be skipped and therefore should not duplicate or replace the functionality of <code>pre-commit</code>.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>commit-msg</code></dt>
<dd>
<p>Will be executed after the commit message is entered.
The only argument is the file where the message is stored, so that it can be modified (normalization).
This hook can be skipped by <code>-n</code> or <code>--no-verify</code>; if it does not terminate successfully, the commit process is aborted.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>post-commit</code></dt>
<dd>
<p>Called after a commit has been created.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These hooks act only locally and are used to enforce certain policies regarding commits or commit messages.
The <code>pre-commit</code> hook is especially useful for this.
For example, some editors do not adequately indicate when there are spaces at the end of the line, or spaces contain spaces.
Again, this is annoying when other developers have to clean up whitespace in addition to regular changes.
This is where Git helps with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git diff --cached --check</strong>
hooks.tex:82: trailing whitespace.
<strong>+</strong> auch noch Whitespace aufräumen müssen._</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--check</code> option lets <code>git diff</code> check for such whitespace errors and will only exit successfully if the changes are error-free.
If you write this command in your <code>pre-commit</code> hook, you will always be warned if you want to check in whitespace errors.
If you are quite sure, you can simply suspend the hook temporarily with <code>git commit -n</code>.</p>
</div>
<div class="paragraph">
<p>Similarly, you can also store the "Check Syntax" command for a script language of your choice in this hook.
For example, the following block for Perl scripts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git diff --diff-filter=MA --cached --name-only |
while read file; do
    if [ -f $file ] &amp;&amp; [ $(head -n 1 $file) = "#!/usr/bin/perl" ]; then
        perl -c $file || exit 1
    fi
done
true</pre>
</div>
</div>
<div class="paragraph">
<p>The names of all files modified in the index (diff filter <code>modified</code> and <code>added</code>, see also <a href="#sec.scripting-find-changes">Section 8.3.4, &#8220;Find changes&#8221;</a>) are passed to a subshell that checks per file whether the first line is a Perl script.
If so, the file is checked with <code>perl -c</code>.
If there is a syntax error in the file, the command will issue an appropriate error message, and <code>exit 1</code> will terminate the hook, so Git will abort the commit process before an editor is opened to enter the commit message.</p>
</div>
<div class="paragraph">
<p>The closing <code>true</code> is needed e.g. if a non-perl file was edited:
Then the if construct fails, the shell returns the return value of the last command, and although there is nothing to complain about, Git will not execute the commit.
With the line <code>true</code> the hook was successful if all passes of the <code>while</code> loop were successful.</p>
</div>
<div class="paragraph">
<p>The hook can of course be simplified by assuming that all Perl files are present as <code>&lt;name&gt;.pl</code>.
Then the following code is sufficient:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git ls-files -z -- _*.pl_ | xargs -z -n 1 perl -c</pre>
</div>
</div>
<div class="paragraph">
<p>Since you might want to check only the files managed by Git, a <code>git ls-files</code> is better than a simple <code>ls</code>, because that would also list untracked files ending in <code>.pl</code>.</p>
</div>
<div class="paragraph">
<p>Besides checking the syntax, you can of course also use Lint style programs that check the source code for "unsightly" or non portable constructs.</p>
</div>
<div class="paragraph">
<p>Such hooks are extremely useful to avoid accidentally checking in faulty code.
If warnings are inappropriate, you can always skip the hook <code>pre-commit</code> by using the <code>-n</code> option when committing.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.hooks-server"><a class="anchor" href="#sec.hooks-server"></a>8.2.2. Server side</h4>
<div class="paragraph">
<p>The following hooks are called on the receiver side of <code>git receive-pack</code> after the user enters <code>git push</code> in the local repository.</p>
</div>
<div class="paragraph">
<p>For a push operation, <code>git send-pack</code> creates <em>one</em> packfile on the local side (see also <a href="#sec.od">Section 2.2.3, &#8220;The Object Database&#8221;</a>), which is received by <code>git receive-pack</code> on the recipient side.
Such a packfile contains the new values of one or more references as well as the commits required by the recipient repository to completely map the version history.
The two sides negotiate which commits these are in advance (similar to a merge base).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>pre-receive</code></dt>
<dd>
<p>The hook is called once and receives a list of changed references on standard input (see below for format).
If the hook does not complete successfully, <code>git receive-pack</code> refuses to accept it (the whole push operation fails).</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>update</code></dt>
<dd>
<p>Is called once <em>per changed reference</em> and gets three arguments: the old state of the reference, the proposed new one and the name of the reference.
If the hook does not end successfully, the update of the single reference is denied (in contrast to <code>pre-receive</code>, where only a whole packfile can be agreed or not).</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>post-receive</code></dt>
<dd>
<p>Similar to <code>pre-receive</code>, but is called only <em>after</em> the references have been changed (so it has no influence on whether the packfile is accepted or not).</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>post-update</code></dt>
<dd>
<p>After all references are changed, this hook is executed once and gets the names of all changed references as arguments.
But the hook is not told, on which state the references were before or are now.
(You can use <code>post-receive</code> for this.)
A typical use case is a call to <code>git update-server-info</code>, which is necessary if you want to provide a repository via HTTP.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="sec.hooks-receive-format"><a class="anchor" href="#sec.hooks-receive-format"></a>8.2.2.1. The format of the receive hooks</h5>
<div class="paragraph">
<p>The <code>pre-receive</code> and <code>post-receive</code> hooks get an equivalent input to standard input.
The format is the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;alte-sha1&gt; &lt;neue-sha1&gt; &lt;name-der-referenz&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This can look like this, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>0000000...0000000 ca0e8cf...12b14dc refs/heads/newbranch
ca0e8cf...12b14dc 0000000...0000000 refs/heads/oldbranch
6618257...93afb8d 62dec1c...ac5373b refs/heads/master</pre>
</div>
</div>
<div class="paragraph">
<p>A SHA-1 sum of all zeros means "not present".
So the first line describes a reference that was not present before, while the second line means the deletion of a reference.
The third line represents a regular update.</p>
</div>
<div class="paragraph">
<p>You can easily read the references with the following loop:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>while read old new ref; do
  # ...
done</pre>
</div>
</div>
<div class="paragraph">
<p>In <code>old</code> and <code>new</code> then the SHA-1 sums are stored, while <code>ref</code> contains the name of the reference.
A <code>git log $old..$new</code> would list all new commits.
The default output is forwarded to <code>git send-pack</code> on the page where <code>git push</code> was entered.
So you can forward any error messages or reports directly to the user.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.hooks-email"><a class="anchor" href="#sec.hooks-email"></a>8.2.2.2. Sending e-mails</h5>
<div class="paragraph">
<p>A practical use of the <code>post-receive</code> hook is to send out emails as soon as new commits are available in the repository.
You can program this yourself, of course, but there is a ready-made script that comes with Git.
You can find it in the Git source directory under <code>contrib/hooks/post-receive-email</code>, and some distributions, such as Debian, also install it along with Git to <code>/usr/share/doc/git/contrib/hooks/post-receive-email</code>.</p>
</div>
<div class="paragraph">
<p>Once you have copied the hook into the <code>hooks/</code> subdirectory of your bare repository and made it executable, you can adjust the configuration accordingly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>less config</strong>
...
[hooks]
  mailinglist = "Autor Eins &lt;autor1@example.com&gt;, autor2@example.com"
  envelopesender = "git@example.com"
  emailprefix = "[project] "</pre>
</div>
</div>
<div class="paragraph">
<p>This means that for each push operation per reference, a mail is sent with a summary of the new commits.
The mail goes to all recipients defined in <code>hooks.mailinglist</code> and comes from <code>hooks.envelopesender</code>.
The subject line is prefixed with the <code>hooks.emailprefix</code>, so that the mail can be sorted away more easily.
More options are documented in the comments of the hooks.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.hooks-update"><a class="anchor" href="#sec.hooks-update"></a>8.2.2.3. The update hook</h5>
<div class="paragraph">
<p>The <code>update</code> hook is called for each reference individually.
It is therefore particularly well suited to implement a kind of "access control" to certain branches.</p>
</div>
<div class="paragraph">
<p>In fact, the <code>update</code> hook is used by Gitolite (see <a href="#sec.gitolite">Section 7.2, &#8220;Gitolite: Simple Git Hosting&#8221;</a>) to decide whether a branch may be modified or not.
Gitolite implements the hook as a Perl script that checks whether the appropriate permission is present and terminates with a zero or non-zero return value accordingly.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.hooks-deploy"><a class="anchor" href="#sec.hooks-deploy"></a>8.2.2.4. Deployment via hooks</h5>
<div class="paragraph">
<p>Git is a version control system and knows nothing about deployment processes.
However, you can use the update hook to implement a simple deployment procedure - e.g. for web applications.</p>
</div>
<div class="paragraph">
<p>The following <code>update</code> hook will, if the <code>master</code> branch has changed, replicate the changes to <code>/var/www/www.example.com</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[ "$3" = "refs/heads/master" ] || exit 0
env GIT_WORK_TREE=/var/www/www.example.com git checkout -f</pre>
</div>
</div>
<div class="paragraph">
<p>So as soon as you upload new commits via <code>git push</code> to the server&#8217;s master branch, this hook will automatically update the web presence.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.hooks-am"><a class="anchor" href="#sec.hooks-am"></a>8.2.3. Apply patches</h4>
<div class="paragraph">
<p>The following hooks are each called by <code>git am</code> when one or more patches are applied.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>applypatch-msg</code></dt>
<dd>
<p>Is called before a Patch is applied.
The hook receives as its only parameter the file where the commit message of the patch is stored.
The hook can change the message if necessary.
A non-zero exit status causes <code>git am</code> not to accept the patch.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>pre-applypatch</code></dt>
<dd>
<p>Called after a patch has been applied, but before the change is committed.
A non-zero exit status causes <code>git am</code> not to accept the patch.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>post-applypatch</code></dt>
<dd>
<p>Is called after a patch has been applied.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The hooks installed by default execute the corresponding commit hooks <code>commit-msg</code> and <code>pre-commit</code>, if enabled.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.hooks-misc"><a class="anchor" href="#sec.hooks-misc"></a>8.2.4. Other Hooks</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>pre-rebase</code></dt>
<dd>
<p>Is executed before a rebase process starts.
Gets as arguments the references that are also passed to the rebase command (e.g. for the <code>git rebase master topic</code> command, the hook gets the arguments <code>master</code> and <code>topic</code>).
Based on the exit status <code>git rebase</code> decides whether the rebase process is executed or not.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>pre-push</code></dt>
<dd>
<p>Is executed before a push operation starts.
Receives on standard input lines of the form <code>&lt;locale-ref&gt;</code>&#x2423;`&lt;locale-sha1&gt;`&#x2423;`&lt;remote-ref&gt;`&#x2423;`&lt;remote-sha1&gt;`.
If the hook does not terminate successfully, the push process is aborted.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>post-rewrite</code></dt>
<dd>
<p>Is called by commands that rewrite commits (currently only <code>git commit --amend</code> and <code>git rebase</code>).
Receives a list in the format <code>&lt;old-sha1&gt;</code>&#x2423;`&lt;new-sha1&gt;` on standard input.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>post-checkout</code></dt>
<dd>
<p>Is called after a checkout.
The first two parameters are the old and new reference to which <code>HEAD</code> points.
The third parameter is a flag that indicates whether a branch has been changed (<code>1</code>) or individual files have been checked out (<code>0</code>).</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>post-merge</code></dt>
<dd>
<p>Will be executed if a merge was successfully completed.
The hook gets a <code>1</code> as argument if the merge was a so called squash-merge, i.e. a merge that did not create a commit but only processed the files in the working tree.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>pre-auto-gc</code></dt>
<dd>
<p>Is called before <code>git gc --auto</code> is executed.
Prevents execution of the automatic garbage collection if the return value is not zero.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>You can use the <code>post-checkout</code> and <code>post-commit</code> hooks to teach Git "real" file permissions.
This is because a blob object does not accurately reflect the contents of a file and its access rights.
Instead, Git only knows "executable" or "non-executable".&#8288;<sup class="footnote">[<a id="_footnoteref_110" class="footnote" href="#_footnotedef_110" title="View footnote.">110</a>]</sup></p>
</div>
<div class="paragraph">
<p>The script stored in the git source directory under <code>contrib/hooks/setgitperms.perl</code> provides a ready-made solution that you can integrate into the above hooks.
The script stores the real access rights in a <code>.gitmeta</code> file.
If you do the read-in (option <code>-r</code>) in the <code>pre-commit</code> hook and give the hooks <code>post-checkout</code> and <code>post-merge</code> the command to write permissions (option <code>-w</code>), the permissions of your files should now be persistent.
See the comments in the file for the exact commands.</p>
</div>
<div class="paragraph">
<p>The access rights are of course only stable between checkouts - unless you check in the <code>.gitmeta</code> file and force the use of the hooks, clones of this repository will of course only get the "basic" access rights.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.scripting"><a class="anchor" href="#sec.scripting"></a>8.3. Writing your own Git commands</h3>
<div class="paragraph">
<p>Git follows the Unix philosophy of "one tool, one job" with its division into subcommands.
It also divides the subcommands into two categories: <em>Porcelain</em> and <em>Plumbing</em>.</p>
</div>
<div class="paragraph">
<p>Porcelain refers to the "good porcelain" that is taken out of the cupboard for the end user: a tidy user interface and human-readable output.
Plumbing commands, on the other hand, are mainly used for "plumbing work" in scripts and have a machine-readable output (usually line by line with unique separators).</p>
</div>
<div class="paragraph">
<p>In fact, a substantial part of the Porcelain commands is implemented as shell script.
They use the various plumbing commands internally, but present a comprehensible interface to the outside.
The commands <code>rebase</code>, <code>am</code>, <code>bisect</code> and <code>stash</code> are just a few examples.</p>
</div>
<div class="paragraph">
<p>It is therefore useful and easy to write your own shell scripts to automate frequently occurring tasks in your workflow.
These could be scripts that control the release process of the software, create automatic changelogs or other operations tailored to the project.</p>
</div>
<div class="paragraph">
<p>Writing your own git command is very easy:
You just have to place an executable file in a directory of your <code>$PATH</code> (e.g. in <code>~/bin</code>) whose name starts with <code>git-</code>.
If you type <code>git &lt;command&gt;</code> and <code>&lt;command&gt;</code> is neither an alias nor a known command, Git will simply try to run <code>git-&lt;command&gt;</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Even if you can write scripts in any language you like, we recommend using shell scripts:
Not only are they easier to understand for outsiders, but above all, the typical operations used to combine Git commands - calling programs, redirecting output - are "intuitively" possible with the shell and do not require any complicated constructs, such as <code>qx()</code> in Perl or <code>os.popen()</code> in Python.</p>
</div>
<div class="paragraph">
<p>When writing shell scripts, please pay attention to POSIX compatibility!&#8288;<sup class="footnote">[<a id="_footnoteref_111" class="footnote" href="#_footnotedef_111" title="View footnote.">111</a>]</sup>
This includes in particular not using "bashisms" like <code>[[ &#8230;&#8203; ]]</code> (the POSIX equivalent is <code>[ &#8230;&#8203; ]</code>).
If your script does not run without problems with Dash&#8288;<sup class="footnote">[<a id="_footnoteref_112" class="footnote" href="#_footnotedef_112" title="View footnote.">112</a>]</sup>, you should explicitly specify the shell used in the shebang line, e.g. via <code>&#35;!/bin/bash</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All scripts presented in the following section can also be found online, in the script collection for this book.&#8288;<sup class="footnote">[<a id="_footnoteref_113" class="footnote" href="#_footnotedef_113" title="View footnote.">113</a>]</sup></p>
</div>
<div class="sect3">
<h4 id="sec.scripting-init"><a class="anchor" href="#sec.scripting-init"></a>8.3.1. Initialization</h4>
<div class="paragraph">
<p>Typically, you want to ensure that your script is executed in a repository.
For necessary initialization tasks, Git offers the <code>git-sh-setup</code>.
You should include this shell script directly after the shebang line using <code>.</code> (known as <code>source</code> in interactive shells):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/sh

. $(git --exec-path)/git-sh-setup</pre>
</div>
</div>
<div class="paragraph">
<p>Unless Git can detect a repository, <code>git-sh-setup</code> will abort.
Also, the script will abort if it is not running at the top level in a repository.
Your script will not be executed and an error message will be displayed.
You can work around this behavior by setting the <code>NONGIT_OK</code> or <code>SUBDIRECTORY_OK</code> variable before the call.</p>
</div>
<div class="paragraph">
<p>Beside this initialization mechanism there are some functions available, which do frequently occurring tasks.
Below is an overview of the most important ones:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>cd_to_toplevel</code></dt>
<dd>
<p>Switches to the top level of the Git repository.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>say</code></dt>
<dd>
<p>Outputs the arguments, unless <code>GIT_QUIET</code> is set.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>git_editor</code></dt>
<dd>
<p>Opens the editor set for Git on the specified files.
It&#8217;s better to use this function than "blind"&#160;`$EDITOR`.
Git also uses this as a fallback.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>git_pager</code></dt>
<dd>
<p>Opens the pager defined for Git.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>require_work_tree</code></dt>
<dd>
<p>The function terminates with an error message if there is no working tree to the repository&#8201;&#8212;&#8201;this is the case with bare repositories.
So you should call this function for security reasons if you want to access files from the working tree.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="sec.scripting-pos"><a class="anchor" href="#sec.scripting-pos"></a>8.3.2. Position in the repository</h4>
<div class="paragraph">
<p>In scripts you will often need the information from which directory the script was called.
The Git command <code>rev-parse</code> offers some options for this.
The following script, stored under <code>~/bin/git-whereami</code>, illustrates how to "find your way" within a repository.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/sh

SUBDIRECTORY_OK=Yes
. $(git --exec-path)/git-sh-setup

gitdir="$(git rev-parse --git-dir)"
absolute="$(git rev-parse --show-toplevel)"
relative="$(git rev-parse --show-cdup)"
prefix="$(git rev-parse --show-prefix)"

echo "gitdir    absolute    relative    prefix"
echo "$gitdir   $absolute   $relative   $prefix"</pre>
</div>
</div>
<div class="paragraph">
<p>The output looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git whereami</strong>
gitdir          absolute    relative    prefix
.git            /tmp/repo
$ <strong>cd very/deep</strong>
$ <strong>git whereami</strong>
gitdir          absolute    relative    prefix
/tmp/repo/.git  /tmp/repo   ../../      very/deep/</pre>
</div>
</div>
<div class="paragraph">
<p>Especially important is the prefix you get via <code>--show-prefix</code>.
If your command accepts filenames and you want to find the blobs they correspond to in the object database, you must put this prefix in front of the filename.
If you are in the <code>very/deep</code> directory and give the script the file name <code>README</code>, it will find the corresponding blob in the current tree via <code>very/deep/README</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.scripting-rev-list"><a class="anchor" href="#sec.scripting-rev-list"></a>8.3.3. List references: rev-list</h4>
<div class="paragraph">
<p>The core of the plumbing commands is <code>git rev-list</code> (<em>revision list</em>).
Its basic function is to resolve one or more references to the SHA-1 sum(s) to which they correspond.</p>
</div>
<div class="paragraph">
<p>With a <code>git log &lt;ref1&gt;..&lt;ref2&gt;</code> you display the commit messages from <code>&lt;ref1&gt;</code> (exclusive) to <code>&lt;ref2&gt;</code> (inclusive).
The <code>git rev-list</code> command resolves this reference to the individual commits that are affected and prints it out line by line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git rev-list master..topic</strong>
f4a6a973e38f9fac4b421181402be229786dbee9
bb8d8c12a4c9e769576f8ddeacb6eb4eedfa3751
c7c331668f544ac53de01bc2d5f5024dda7af283</pre>
</div>
</div>
<div class="paragraph">
<p>So a script that operates on one or more commits can simply pass information to <code>rev-list</code>, as other Git commands understand it.
Your script can even handle complicated expressions.</p>
</div>
<div class="paragraph">
<p>You can use the command, for example, to check whether fast forward from one branch to another is possible.
Fast forward from <code>&lt;ref1&gt;</code> to <code>&lt;ref2&gt;</code> is possible if Git can reach the commit marked by <code>&lt;ref1&gt;</code> in the commit graph of <code>&lt;ref2&gt;</code>.
In other words, there is no commit reachable from <code>&lt;ref1&gt;</code> that can&#8217;t also be reached from <code>&lt;ref2&gt;</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/sh

SUBDIRECTORY_OK=Yes
. $(git --exec-path)/git-sh-setup

[ $# -eq 2 ] || { echo "usage: $(basename $0) &lt;ref1&gt; &lt;ref2&gt;"; exit 1; }

for i in $1 $2
do
    if ! git rev-parse --verify $i &gt;| /dev/null 2&gt;&amp;1 ; then
        echo "Ref:_$i_ does not exist!" &amp;&amp; exit 1
    fi
done

one_two=$(git rev-list $1..$2)
two_one=$(git rev-list $2..$1)

[ $(git rev-parse $1) = $(git rev-parse $2) ] \
&amp;&amp; echo "$1 and $2 point to the same commit!" &amp;&amp; exit 2

[ -n "$one_two" ] &amp;&amp; [ -z "$two_one" ] \
&amp;&amp; echo "FF from $1 to $2 possible!" &amp;&amp; exit 0
[ -n "$two_one" ] &amp;&amp; [ -z "$one_two" ] \
&amp;&amp; echo "FF from $2 to $1 possible!" &amp;&amp; exit 0

echo "FF not possible! $1 and $2 are diverged!" &amp;&amp; exit 3</pre>
</div>
</div>
<div class="paragraph">
<p>The calls to <code>rev-parse</code> in the For loop check that the arguments are references that Git can resolve to a commit (or other database object) - if this fails, the script aborts with an error message.</p>
</div>
<div class="paragraph">
<p>The output of the script could look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git check-ff topic master</strong>
FF von master nach topic möglich!</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For simple scripts, which expect only a limited number of options and arguments, a simple evaluation of these, as in the above script, is completely sufficient.
However, if you are planning a more complex project, the so-called <code>getopt mode</code> of <code>git rev-parse</code> is recommended.
This mode allows syntax analysis of command line options and offers a similar functionality as the C-library <code>getopt</code>.
For details see the <code>git-rev-parse(1)</code> man page, section "Parseopt".</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec.scripting-find-changes"><a class="anchor" href="#sec.scripting-find-changes"></a>8.3.4. Find changes</h4>
<div class="paragraph">
<p><code>git diff</code> and <code>git log</code> tell you to display information about the files that a commit has changed, using the <code>--name-status</code> option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log -1 --name-status 8c8674fc9</strong>
commit 8c8674fc954d8c4bc46f303a141f510ecf264fcd
...
M       git-pull.sh
M       t/t5520-pull.sh</pre>
</div>
</div>
<div class="paragraph">
<p>Each name is preceded by one of five flags&#8288;<sup class="footnote">[<a id="_footnoteref_114" class="footnote" href="#_footnotedef_114" title="View footnote.">114</a>]</sup>, which are shown in the list below:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>A</code> (<em>added</em>)</dt>
<dd>
<p>File was added</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>D</code> (<em>deleted</em>)</dt>
<dd>
<p>File was deleted</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>M</code> (<em>modified</em>)</dt>
<dd>
<p>File was changed</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>C</code> (<em>copied</em>)</dt>
<dd>
<p>File was copied</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>R</code> (<em>renamed</em>)</dt>
<dd>
<p>File was renamed</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The flags <code>C</code> and <code>R</code> are followed by a three-digit number indicating the percentage that has remained the same.
So if you duplicate a file, this corresponds to the output <code>C100</code>.
A file that is renamed and slightly modified in the same commit via <code>git mv</code> might show up as <code>R094</code> - a 94% renaming.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log -1 --name-status 0ecace728f</strong>
...
M       Makefile
R094    merge-index.c   builtin-merge-index.c
M       builtin.h
M       git.c</pre>
</div>
</div>
<div class="paragraph">
<p>You can use these flags to search for commits that have changed a specific file using diff filters.
For example, if you want to find out who added a file when, use the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log --pretty=format:&#39;added by %an %ar&#39; --diff-filter=A -- cache.h</strong>
added by Linus Torvalds 6 years ago</pre>
</div>
</div>
<div class="paragraph">
<p>You can specify several flags to a diff filter directly after each other.
The question "Who did most of the work on this file?" can often be answered by whose commits modified this file the most.
This can be found out, for example, by doing the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log --pretty=format:%an --diff-filter=M -- cache.h | \</strong>
  <strong>sort | uniq -c | sort -rn | head -n 5</strong>
    187 Junio C Hamano
    100 Linus Torvalds
     27 Johannes Schindelin
     26 Shawn O. Pearce
     24 Jeff King</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.od-explore"><a class="anchor" href="#sec.od-explore"></a>8.3.5. The object database and rev-parse</h4>
<div class="paragraph">
<p>The Git command <code>rev-parse</code> (<em>revision parse</em>) is an extremely flexible tool whose task is, among other things, to translate expressions describing commits or other objects of the object database into their complete SHA-1 sum.
For example, the command converts abbreviated SHA-1 sums into the unique 40-character variant:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git rev-parse --verify be1ca37e5</strong>
be1ca37e540973bb1bc9b7cf5507f9f8d6bce415</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--verify</code> option is passed to make Git print an appropriate error message if the passed reference is not a valid one.</p>
</div>
<div class="paragraph">
<p>However, the command can also abbreviate a SHA-1 sum with the <code>--short</code> option.
The default is seven characters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git rev-parse --verify --short be1ca37e540973bb1bc9b7cf5507f9f8d6bce415</strong>
be1ca37</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to find out the <em>name</em> of the branch that is currently checked out (as opposed to the commit ID), use <code>git rev-parse --symbolic-full-name HEAD</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>But <code>rev-parse</code> (and thus also all other git-commands, which accept arguments as references) supports even more possibilities to reference objects.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>&lt;sha1&gt;^{&lt;type&gt;}</code></dt>
<dd>
<p>Follows the reference <code>&lt;sha1&gt;</code> and resolves it to an object of type <code>&lt;typ&gt;</code>.
This way you can find the corresponding tree for a commit <code>&lt;commit&gt;</code> by specifying <code>&lt;commit&gt;^{tree}</code>.
If you don&#8217;t specify an explicit type, the reference is resolved until Git finds an object that isn&#8217;t a tag (which is especially handy when you want to find the equivalent of a tag).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Many git commands do not work on a commit, but on the trees that are referenced (e.g. the <code>git diff</code> command, which compares files, i.e. tree entries).
In the man page, these arguments are called <em>tree-ish</em>.
Git expects arbitrary references, which can be resolved to a tree, with which the command then continues to work.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>&lt;tree-ish&gt;:&lt;path&gt;</code></dt>
<dd>
<p>Resolves the path <code>&lt;path&gt;</code> to the corresponding referenced tree or blob (corresponds to a directory or file).
The referenced object is extracted from <code>&lt;tree-ish&gt;</code>, which can be a tag, a commit or a tree.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following example illustrates how this special syntax works:
The first command extracts the SHA-1 ID of the tree referenced by <code>HEAD</code>.
The second command extracts the SHA-1 ID of the blob corresponding to the <code>README</code> file at the top level of the git repository.
The third command then verifies that this really is a blob.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git rev-parse &#39;HEAD^{tree}&#39;</strong>
89f156b00f35fe5c92ac75c9ccf51f043fe65dd9
$ <strong>git rev-parse 89f156b00f:README</strong>
67cfeb2016b24df1cb406c18145efd399f6a1792
$ <strong>git cat-file -t 67cfeb2016b</strong>
blob</pre>
</div>
</div>
<div class="paragraph">
<p>A <code>git show 67cfeb2016b</code> would now show the actual contents of the blob.
By redirecting with <code>&gt;</code> you can extract the blob as a file to the file system.</p>
</div>
<div class="paragraph">
<p>The following script first finds the commit ID of the commit that last modifies a particular file (the file is passed as the first argument, <code>$1</code>).
Then the script extracts the file (with prefix, see above) from the <em>predecessor</em> of the commit (<code>$ref~</code>) that last modified the file, and saves it in a temporary file.</p>
</div>
<div class="paragraph">
<p>Finally, Vim is called in diff mode on the file and then the file is deleted.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/sh

SUBDIRECTORY_OK=Yes
. $(git --exec-path)/git-sh-setup

[ -z "$1" ] &amp;&amp; echo "usage: $(basename $0) &lt;file&gt;" &amp;&amp; exit 1
ref="$(git log --pretty=format:%H --diff-filter=M -1 -- $1)"
git rev-parse --verify $ref &gt;/dev/null || exit 1

prefix="$(git rev-parse --show-prefix)"
temp="$(mktemp .diff.$ref.XXXXXX)"
git show $ref^:$prefix$1 &gt; $temp

vim -f -d $temp $1
rm $temp</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To resolve a lot of references with <code>rev-parse</code>, you should do this in <em>one</em> program call:
<code>rev-parse</code> will print one line for each reference.
With dozens or even hundreds of references, the single call is resource-saving and therefore faster.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sec.for-each-ref"><a class="anchor" href="#sec.for-each-ref"></a>8.3.6. Iterate references: for-each-ref</h4>
<div class="paragraph">
<p>A common task is to iterate references.
Here, Git provides the general-purpose command <code>for-each-ref</code>.
The common syntax is <code>git for-each-ref --format=&lt;format&gt; &lt;pattern&gt;</code>.
You can use the pattern to restrict the references to be iterated, e.g.&#160;`refs/heads` or <code>refs/tags</code>.
With the format expression you specify which properties of the reference should be output.
It consists of different fields <code>%(fieldname)</code>, which are expanded to corresponding values in the output.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>refname</code></dt>
<dd>
<p>Name of the reference, e.g.&#160;`heads/master`.
The addition <code>:short</code> shows the short form, i.e. <code>master</code>.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>objecttype</code></dt>
<dd>
<p>Type of object (<code>blob</code>, <code>tree</code>, <code>commit</code> or <code>tag</code>)</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>objectsize</code></dt>
<dd>
<p>Object size in byte</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>object name</code></dt>
<dd>
<p>Commit ID or SHA-1 sum</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>upstream</code></dt>
<dd>
<p>Remote Tracking Branch of the Upstream Branch</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Here is a simple example how to display all SHA-1 sums of the release candidates of version <code>1.7.1</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git for-each-ref --format=&#39;%(objectname)--%(objecttype)--%(refname:\</strong>
  <strong>short)&#39; refs/tags/v1.7.1-rc&#42;</strong>
bdf533f9b47dc58ac452a4cc92c81dc0b2f5304f--tag--v1.7.1-rc0
d34cb027c31d8a80c5dbbf74272ecd07001952e6--tag--v1.7.1-rc1
03c5bd5315930d8d88d0c6b521e998041a13bb26--tag--v1.7.1-rc2</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the separators "--" are taken over in this way and thus additional characters for formatting are possible.</p>
</div>
<div class="paragraph">
<p>Depending on the object type, other field names are also available, for example, for a tag the <code>tagger</code> field, which contains the tag author, his e-mail and the date.
At the same time the fields <code>taggername</code>, <code>taggeremail</code> and <code>taggerdate</code> are available, each containing only the name, the e-mail and the date.</p>
</div>
<div class="paragraph">
<p>For example, if you want to know for a project who ever created a tag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git for-each-ref --format=&#39;%(taggername)&#39; refs/tags | sort -u</strong>
Junio C Hamano
Linus Torvalds
Pat Thoyts
Shawn O. Pearce</pre>
</div>
</div>
<div class="paragraph">
<p>As a further interface different options are offered for script languages, <code>--shell</code>, <code>--python</code>, <code>--perl</code> and <code>--tcl</code>.
Thus the fields are formatted accordingly as <em>string literals</em> in the respective language, so that they can be evaluated per <code>eval</code> and translated into variables:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git for-each-ref --shell --format=&#39;ref=%(refname)&#39; refs/tags/v1.7.1.&#42;</strong>
ref=_refs/tags/v1.7.1.1_
ref=_refs/tags/v1.7.1.2_
ref=_refs/tags/v1.7.1.3_
ref=_refs/tags/v1.7.1.4_</pre>
</div>
</div>
<div class="paragraph">
<p>This can be used to write the following script, which prints a summary of all branches that have an upstream branch - including SHA-1 sum of the most recent commit, its author, and tracking status.
The output is very similar to <code>git branch -vv</code>, but a bit more readable.
The <code>authorname</code> field contains the name of the commit author, similar to <code>taggername</code>.
The core is the <code>eval "$data"</code> statement, which translates the line-by-line output of <code>for-each-ref</code> into the variables used later.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/sh
SUBDIRECTORY_OK=Yes
. $(git --exec-path)/git-sh-setup

git for-each-ref --shell --format=\
"refname=%(refname:short) "\
"author=%(authorname) "\
"sha1=%(objectname) "\
"upstream=%(upstream:short)" \
refs/heads | while read daten
do
    eval "$daten"
    if [ -n "$upstream" ] ; then
        ahead=$(git rev-list $upstream..$refname | wc -l)
        behind=$(git rev-list $refname..$upstream | wc -l)
        echo $refname
        echo --------------------
        echo     "    Upstream:    "$upstream
        echo     "    Last author: "$author
        echo     "    Commit-ID    "$(git rev-parse --short $sha1)
        echo -n  "    Status:      "
        [ $ahead  -gt 0 ] &amp;&amp; echo -n "ahead:"$ahead" "
        [ $behind -gt 0 ] &amp;&amp; echo -n "behind:"$behind" "
        [ $behind -eq 0 ] &amp;&amp; [ $ahead -eq 0 ] &amp;&amp; echo -n "synchron!"
        echo
    fi
done</pre>
</div>
</div>
<div class="paragraph">
<p>The output will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git tstatus</strong>
maint
--------------------
    Upstream:    origin/maint
    Last author: João Britto
    Commit-ID    4c007ae
    Status:      synchron!
master
--------------------
    Upstream:    origin/master
    Last author: Junio C Hamano
    Commit-ID    4e3aa87
    Status:      synchron!
next
--------------------
    Upstream:    origin/next
    Last author: Junio C Hamano
    Commit-ID    711ff78
    Status:      behind:22
pu
--------------------
    Upstream:    origin/pu
    Last author: Junio C Hamano
    Commit-ID    dba0393
    Status:      ahead:43 behind:126</pre>
</div>
</div>
<div class="paragraph">
<p>The other field names as well as examples can be found in the <code>git-for-each-ref(1)</code> man page.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.git-update-ref"><a class="anchor" href="#sec.git-update-ref"></a>8.3.7. Rewrite references: git update-ref</h4>
<div class="paragraph">
<p>If you use <code>for-each-ref</code>, you usually want to edit references as well - therefore the <code>update-ref</code> command should be mentioned.
With it you can create references and safely convert or delete them.
Basically <code>git update-ref</code> works with two or three arguments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git update-ref &lt;ref&gt; &lt;new-value&gt; [&lt;oldvalue&gt;]</pre>
</div>
</div>
<div class="paragraph">
<p>Here is an example that moves the <code>master</code> to <code>HEAD^</code> if it points to <code>HEAD</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git update-ref refs/heads/master HEAD^ HEAD</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Or to create a new reference <code>topic</code> at <code>ea0ccd3</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git update-ref refs/heads/topic ea0ccd3</strong></pre>
</div>
</div>
<div class="paragraph">
<p>To delete references there is the option <code>-d</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git update-ref -d &lt;ref&gt; [&lt;oldvalue&gt;]</pre>
</div>
</div>
<div class="paragraph">
<p>For example to delete the reference <code>topic</code> again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git update-ref -d topic ea0ccd3</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Of course, you could also manipulate the references with commands like <code>echo &lt;sha&gt; &gt; .git/refs/heads/&lt;ref&gt;</code>, but <code>update-ref</code> brings various safeguards and helps to minimize possible damage.
The addition <code>&lt;oldvalue&gt;</code> is optional, but helps to avoid programming errors.
It also takes care of special cases (symlinks whose target is inside or outside the repository, references pointing to other references, etc.).
An additional advantage is that <code>git update-ref</code> automatically makes entries in the reflog, which makes troubleshooting much easier.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.git-extended-aliases"><a class="anchor" href="#sec.git-extended-aliases"></a>8.3.8. Extended Aliases</h4>
<div class="paragraph">
<p>If you have only one one-liner, it is usually not worthwhile to create your own script.
Git aliases were developed for this use case.
For example, it is possible to call external programs by prefixing them with an exclamation mark, for example to simply call <code>gitk --all</code> with <code>git k</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global alias.k &#39;!gitk --all&#39;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Another example, which deletes all branches already merged and uses a concatenation of commands for this is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>prune-local = !git branch --merged | grep -v ^* | xargs git branch -d</pre>
</div>
</div>
<div class="paragraph">
<p>With certain constructs, you may want to rearrange the arguments passed to the alias or use them within a command chain.
The following trick is suitable for this, where a shell function is built into the alias:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config --global alias.demo &#39;!f(){ echo $2 $1 ; }; f&#39;</strong>
$ <strong>git demo foo bar</strong>
bar foo</pre>
</div>
</div>
<div class="paragraph">
<p>This allows even more complex one-liners to be defined elegantly as aliases.
The following construction filters out for a given file, which authors made how many commits in which the file was changed.
If you send patches to the Git project&#8217;s mailing list, you are asked to send the mail via CC to the main authors of the files you changed.
Use this alias to find out who they are.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>who-signed = "!f(){ git log -- $1 | \
    grep Signed-off-by | sort | uniq --count | \
    sort --human-numeric-sort --reverse |\
    sed _s/Signed-off-by: / /_ | head ; } ; f "</pre>
</div>
</div>
<div class="paragraph">
<p>There are some things to consider here:
An alias is always executed from the toplevel directory of the repository, so the argument must contain the path inside the repository.
The alias is also based on the fact that all people involved have signed off on the commit with a <code>signed-off-by</code> line, because these lines are used to generate the statistics.
Since the alias is spread over several lines, it must be enclosed in quotes, otherwise Git cannot interpret the alias correctly.
The final call to <code>head</code> limits the output to the top ten authors:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git who-signed Documentation/git-svn.txt</strong>
     46      Junio C Hamano &lt;gitster@pobox.com&gt;
     30      Eric Wong &lt;normalperson@yhbt.net&gt;
     27      Junio C Hamano &lt;junkio@cox.net&gt;
      5      Jonathan Nieder &lt;jrnieder@uchicago.edu&gt;
      4      Yann Dirson &lt;ydirson@altern.org&gt;
      4      Shawn O. Pearce &lt;spearce@spearce.org&gt;
      3      Wesley J. Landaker &lt;wjl@icecavern.net&gt;
      3      Valentin Haenel &lt;valentin.haenel@gmx.de&gt;
      3      Ben Jackson &lt;ben@ben.com&gt;
      3      Adam Roben &lt;aroben@apple.com&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Further interesting ideas and suggestions can be found in the Git-Wiki on the page about aliases.&#8288;<sup class="footnote">[<a id="_footnoteref_115" class="footnote" href="#_footnotedef_115" title="View footnote.">115</a>]</sup></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.filter-branch"><a class="anchor" href="#sec.filter-branch"></a>8.4. Rewrite version history</h3>
<div class="paragraph">
<p>The previously introduced <code>git rebase</code> command and its interactive mode allows developers to edit commits at will.
Code that is still in development can be "cleaned up" before it is integrated (e.g. via merge) and thus permanently merged with the software.</p>
</div>
<div class="paragraph">
<p>But what if <em>all</em> commits are to be changed afterwards, or at least a large part of them?
Such requirements arise, for example, when a previously private project is to be published, but sensitive data (keys, certificates, passwords) are included in the commits.</p>
</div>
<div class="paragraph">
<p>Git offers the <code>filter-branch</code> command to automate this task.
Basically, it works like this:
You specify a set of references that Git should rewrite.
You also define commands that are responsible for modifying the commit message, tree contents, commits, etc. Git goes through each commit and applies the appropriate filter to the appropriate part.
The filters are executed per <code>eval</code> in the shell, so they can be complete commands or names of scripts.
The following list describes the filters that Git offers:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--env-filter</code></dt>
<dd>
<p>Can be used to adjust the environment variables under which the commit is rewritten.
Especially the variables <code>GIT_{AUTHOR,COMMITTER}_{NAME,EMAIL,DATE}</code> can be exported with new values if needed.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--tree filter</code></dt>
<dd>
<p>Creates a checkout for each commit to be rewritten, changes to the directory and executes the filter.
Afterwards, new files are automatically added and old ones deleted and all changes are applied.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--index filter</code></dt>
<dd>
<p>Manipulates the index.
Behaves similar to the tree filter, except that Git doesn&#8217;t create a checkout, making the index filter faster.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--msg-filter</code></dt>
<dd>
<p>Receives the commit message on default-in and prints the new message on default-out.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--commit-filter</code></dt>
<dd>
<p>Is called instead of <code>git commit-tree</code> and can thus in principle make several commits from one.
See the man page for details.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--tag-name filter</code></dt>
<dd>
<p>Will be called for all tag names that point to a commit that has been rewritten elsewhere.
If you use <code>cat</code> as filter, the tags will be applied.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>--subdirectory-filter</code></dt>
<dd>
<p>Only view the commits that modify the specified directory.
The rewritten history will contain only this directory, as the topmost directory in the repository.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The general syntax of the command is:
<code>git filter-branch &lt;filter&gt; - &lt;references&gt;</code>.
Here <code>&lt;references&gt;</code> is an argument for <code>rev-parse</code>, so it can be one or more branch names, a syntax of the form <code>&lt;ref1&gt;..&lt;ref2&gt;</code> or simply <code>--all</code> for all references.
Note the double bar <code>--</code>, which separates the arguments for <code>filter-branch</code> from those for <code>rev-parse</code>!</p>
</div>
<div class="paragraph">
<p>As soon as one of the filters does not end with the return value zero on a commit, the whole rewrite process will abort.
So be careful to catch possible error messages or ignore them by appending <code>|| true</code>.</p>
</div>
<div class="paragraph">
<p>The original references are stored under <code>original/</code>, so when you rewrite the <code>master</code> branch, <code>original/refs/heads/master</code> still points to the original, unrewritten commit (and its predecessor, accordingly).
If this backup reference already exists, the <code>filter-branch</code> command will refuse to rewrite the reference unless you specify the <code>-f</code> option for <em>force</em>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You should always do your <code>filter-branch</code> experiments in a fresh clone.
The chance of causing damage by unfortunate typos is not insignificant.
However, if you like the result, you can easily make the new repository the master repository, and also outsource the old one as a backup.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following examples deal with some typical use cases of the <code>filter-branch</code> command.</p>
</div>
<div class="sect3">
<h4 id="sec.fb-censor"><a class="anchor" href="#sec.fb-censor"></a>8.4.1. Remove sensitive information afterwards</h4>
<div class="paragraph">
<p>Ideally, sensitive data such as keys, certificates or passwords are not part of a repository.
Even large binary files or other data junk unnecessarily inflate the size of the repository.</p>
</div>
<div class="paragraph">
<p>Open source software, the use of which is permitted, but the distribution of which is prohibited by license terms ('no distribution'), may of course not appear in a repository that you make available to the public.</p>
</div>
<div class="paragraph">
<p>In all these cases you can rewrite the project history so that nobody can find out that the corresponding data ever appeared in the version history of the project.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are working with git tags, it is always a good idea to pass the <code>--tag-name-filter cat</code> argument as well, so that tags pointing to commits to be rewritten will also point to the new version.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To delete only some files or subdirectories from the entire project history, use a simple index filter.
All you have to do is tell Git to remove the corresponding entries from the index:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git filter-branch --index-filter \</strong>
  <strong>&#39;git rm --cached --ignore-unmatch &lt;file&gt;&#39; \</strong>
  <strong>--prune-empty -- --all</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--cached</code> and <code>--ignore-unmatch</code> arguments tell <code>git rm</code> to remove only the index entry, and not to abort with an error if the corresponding entry does not exist (e.g. because the file was not added until a particular commit). If you want to delete directories, you must also specify <code>-r</code>.</p>
</div>
<div class="paragraph">
<p>The argument <code>--prune-empty</code> makes sure that commits which do <em>not</em> change the tree after applying the filter are omitted.
So if you have added a certificate with a commit, and this commit becomes an "empty" commit by removing the certificate, Git will omit it altogether.</p>
</div>
<div class="paragraph">
<p>Similar to the command above, you can also move files or directories with <code>git mv</code>.
If the operations are a bit more complex, you should consider designing several simple filters and calling them one after the other.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is possible that a file you want to delete had a different name in the past.
To check this, use the command <code>git log --name-status --follow - &lt;file&gt;</code> to detect possible renames.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="sec.fb-censor-string"><a class="anchor" href="#sec.fb-censor-string"></a>8.4.1.1. Remove strings from files</h5>
<div class="paragraph">
<p>If you don&#8217;t want to change whole files, but only certain lines in all commits, a filter at index level is not sufficient.
You must use a tree filter.</p>
</div>
<div class="paragraph">
<p>For each commit, Git will check out the relevant tree, change to the appropriate directory, and then run the filter.
Any changes you make will be applied (without you having to use <code>git add</code> etc.).</p>
</div>
<div class="paragraph">
<p>To erase the password <code>v3rYs3cr1T</code> from all files and commits, the following commands are required:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git filter-branch --tree-filter &#39;git ls-files -z | \</strong>
  <strong>xargs -0 -n 1 sed -i &#34;s/v3rYs3cr1T/PASSWORD/g&#34; \</strong>
  <strong>2&gt;/dev/null || true&#39; -- master</strong>
Rewrite cbddbd3505086b79dc3b6bd92ac9f811c8a6f4d1 (142/142)
Ref _refs/heads/master_ was rewritten</pre>
</div>
</div>
<div class="paragraph">
<p>The command performs an <em>in-place</em> replacement with <code>sed</code> on every file in the repository.
Any error messages are neither issued nor do they cause the <code>filter-branch</code> call to be aborted.</p>
</div>
<div class="paragraph">
<p>After the references have been rewritten, you can use the pickaxe tool (<code>-G&lt;expression&gt;</code>, see <a href="#sec.git-log">Section 2.1.6, &#8220;Examining the Project History&#8221;</a>) to verify that no commit really introduces the string <code>v3rYs3cr1T</code> anymore:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git log -p -G&#34;v3rYs3cr1T&#34;</strong>
# should not produce any output</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Tree filters must check out the appropriate tree for each commit.
This creates a considerable overhead for many commits and many files, so a <code>filter-branch</code> call can take a long time.</p>
</div>
<div class="paragraph">
<p>By specifying <code>-d &lt;path&gt;</code> you can instruct the command to check out the tree to <code>&lt;path&gt;</code> instead of <code>.git-rewrite/</code>.
If you use a <code>tmpfs</code> here (especially <code>/dev/shm</code> or <code>/tmp</code>), the files are only held in memory, which can speed up the command call by several orders of magnitude.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec.fb-developer"><a class="anchor" href="#sec.fb-developer"></a>8.4.1.2. Rename a developer</h5>
<div class="paragraph">
<p>If you want to rename a developer, you can do this by changing the variable <code>GIT_AUTHOR_NAME</code> in an environment filter, if necessary.
For example like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git filter-branch -f --env-filter \</strong>
  <strong>&#39;if [ &#34;$GIT_AUTHOR_NAME&#34; = &#34;Julius Plenz&#34; ];</strong>
  <strong>then export GIT_AUTHOR_NAME=&#34;Julius Foobar&#34;; fi&#39; -- master</strong></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.fb-subdir"><a class="anchor" href="#sec.fb-subdir"></a>8.4.2. Extract subdirectory</h4>
<div class="paragraph">
<p>The Subdirectory filter allows you to rewrite the commits so that a subdirectory of the current repository becomes the new top-level directory.
All other directories and the former top-level directory are dropped.
Commits that have not changed anything in the new subdirectory are also dropped.</p>
</div>
<div class="paragraph">
<p>In this way, you can, for example, extract the version history of a library from a larger project.
The exchange between the outsourced project and the base project can work via submodules or subtree-merges (see <a href="#sec.subprojects">Section 5.11, &#8220;Managing Subprojects&#8221;</a>).</p>
</div>
<div class="paragraph">
<p>To split the directory <code>t/</code> (containing the test suite) from the git source repository, the following command is sufficient:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git filter-branch --subdirectory-filter t -- master</strong>
Rewrite 2071fb015bc673d2514142d7614b56a37b3faaf2 (5252/5252)
Ref _refs/heads/master_ was rewritten</pre>
</div>
</div>
<div class="paragraph">
<p>Attention: This command runs for several minutes.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.fb-grafts"><a class="anchor" href="#sec.fb-grafts"></a>8.4.3. Grafts: Subsequent Merges</h4>
<div class="paragraph">
<p>Git provides a way to simulate merges via so-called <em>Graft Points</em> or <em>Grafts</em> (to graft: plant).
Such grafts are stored line by line in the file <code>.git/info/grafts</code> and have the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>commit [parent1 [parent2 ...]]</pre>
</div>
</div>
<div class="paragraph">
<p>In addition to the information that Git gets from the commit metadata, you can also specify one or more parents for any commits.&#8288;<sup class="footnote">[<a id="_footnoteref_116" class="footnote" href="#_footnotedef_116" title="View footnote.">116</a>]</sup></p>
</div>
<div class="paragraph">
<p>Make sure to still consider the repository as a DAG and not close any circles:
Do not define <code>HEAD</code> as the predecessor of the root commit!
The grafts file is <em>not</em> part of the repository, so a <code>git clone</code> does not copy this information, it just helps Git find a merge base.
However, when <code>filter-branch</code> is called, this graft information is hard-coded into the commits.</p>
</div>
<div class="paragraph">
<p>This is especially useful in two cases:
If you import an old version history from a tool that cannot handle merges correctly (e.g. previous Subversion versions), or if you want to "glue" two version histories together.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s assume the development was switched to Git.
But nobody has taken care of converting the old version history.
So the new repository was started with an initial commit that reflected the state of the project at that time.</p>
</div>
<div class="paragraph">
<p>Meanwhile, you&#8217;ve successfully converted the old version history to Git, and now you want to append it <em>before</em> the initial commit (or instead).
To do this, proceed as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd &lt;neues-repository&gt;</strong>
$ <strong>git fetch &lt;altes-repository&gt; master:old-master</strong>
... Konvertierte Commits importieren ...</pre>
</div>
</div>
<div class="paragraph">
<p>You now have a multi-root repository.
You then need to find the initial commit of the new repository (<code>$old_root</code>) and define the latest commit of the old, converted repository (<code>$old_tip</code>) as its <em>predecessor</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>old_root=`git rev-list --reverse master | head -n 1`</strong>
$ <strong>old_tip=`git rev-parse old-master`</strong>
$ <strong>echo $old_root $old_tip &gt; .git/info/grafts</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Look at the result with Gitk or a similar program.
If you are satisfied, you can make the grafts <em>permanent</em> (all commits starting at <code>$old_tip</code> are rewritten).
To do this, call <code>git filter-branch</code> without specifying any filters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git filter-branch -- $old_tip..</strong>
Rewrite 1591ed7dbb3a683b9bf1d880d7a6ef5d252fc0a0 (1532/1532)
Ref _refs/heads/master_ was rewritten
$ <strong>rm .git/info/grafts</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Of course you also have to delete the remaining backup references (see below).</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.fb-clean"><a class="anchor" href="#sec.fb-clean"></a>8.4.4. Delete old commits</h4>
<div class="paragraph">
<p>After you have removed any sensitive data from all commits, you still need to make sure that these old commits do not reappear.
In the repository you rewrote, this is done in three steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Delete the backup references under <code>original/</code>.</p>
</li>
<li>
<p>You can do this with the following command:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git for-each-ref --format=&#39;%(refname)&#39; -- &#39;refs/original/&#39; | \</strong>
  <strong>xargs -n 1 git update-ref -d</strong></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you have not yet rewritten or deleted old tags or other branches, you must of course do this first.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Delete the Reflog:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git reflog expire --verbose --expire=now --all</strong></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Delete the (<em>orphaned</em>) commits that are no longer accessible.</p>
</li>
<li>
<p>The best way to do this is to use the <code>gc</code> option <code>--prune</code>, which sets the time since when a commit should be unreachable so that it is deleted:</p>
</li>
<li>
<p>Now.</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git gc --prune=now</strong></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>If other developers are working with an outdated version of the repository, they must now "migrate".
It is essential that they do not use their development branches to pull old commits back into the cleaned up repository.</p>
</div>
<div class="paragraph">
<p>The best way to do this is to clone the new repository, fetch important branches from the old repository using <code>git fetch</code>, and rebase directly on the new commits.
You can then dispose of the old commits using <code>git gc --prune=now</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec.git-svn-cvs"><a class="anchor" href="#sec.git-svn-cvs"></a>9. Interacting with Other Version Control Systems</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Git has interfaces to other version control systems, which are important for two basic use cases:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>Bidirectional communication</em> </dt>
<dd>
<p>You want to develop locally in a Git repository, but also transfer the changes to an external repository or import changes from there to Git.</p>
</dd>
<dt class="hdlist1"><em>Migration</em> </dt>
<dd>
<p>You want to import the version history stored in an existing repository of another system into Git.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Git offers the following interfaces&#8201;&#8212;&#8201;all of which allow two-way communication and complete conversion:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Subversion (<code>svn</code>) </dt>
<dd>
<p>The <code>git-svn</code> tool provides all the essential subcommands for dealing with Subversion repositories and is discussed in detail in this chapter.
The program is implemented in Perl and uses the Perl bindings for Git and Subversion.
It is managed together with the Git sources in the <code>git.git</code> repository (stored as <code>git-svn.perl</code>).
Note: The tool is called <code>git-svn</code>, but is called as usual with <code>git svn &lt;command&gt;</code>.
The technical documentation is available in the <code>git-svn(1)</code> man page.</p>
</dd>
<dt class="hdlist1">Concurrent Versioning System (<code>cvs</code>) </dt>
<dd>
<p>The <code>git cvsimport</code> command imports and synchronizes a CVS repository&#8201;&#8212;&#8201;its counterpart is <code>git cvsexportcommit</code>.</p>
</dd>
<dt class="hdlist1">Perforce (<code>p4</code>) </dt>
<dd>
<p>With <code>git p4</code> you address repositories of the proprietary Perforce system.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For the interaction with other VCS there are also a lot of additional tools and scripts that improve, extend and partly replace the mentioned commands.
But also interfaces to other version control systems, such as Mercurial, are offered.
If the commands and recipes described in this chapter are not sufficient, an internet research is worthwhile.
As a first starting point we recommend the Git-Wiki.&#8288;<sup class="footnote">[<a id="_footnoteref_117" class="footnote" href="#_footnotedef_117" title="View footnote.">117</a>]</sup></p>
</div>
<div class="paragraph">
<p>In addition to its immediate communication capabilities with other systems, Git has its own simple plain-text protocol that lets you translate the version history from any system in such a way that Git creates a repository from it.
For a detailed description including an example, see <a href="#sec.fast-import">Section 9.2, &#8220;Custom Importers&#8221;</a> about <em>Fast Import</em>.</p>
</div>
<div class="sect2">
<h3 id="sec.subversion"><a class="anchor" href="#sec.subversion"></a>9.1. Subversion</h3>
<div class="paragraph">
<p>The following is about how to use <code>git-svn</code>.
We&#8217;ll show you how to convert Subversion repositories and how to use it to exchange changes between a Subversion repository and Git.</p>
</div>
<div class="sect3">
<h4 id="sec.git-svn-convert"><a class="anchor" href="#sec.git-svn-convert"></a>9.1.1. Conversion</h4>
<div class="paragraph">
<p>The goal is to transfer the version history from a Subversion repository to a Git repository.
Before you start, you will need to make preparations that may take some time, depending on the size of your project.
However, good preparation helps you to avoid mistakes from the start.</p>
</div>
<div class="sect4">
<h5 id="sec.git-svn-preparation"><a class="anchor" href="#sec.git-svn-preparation"></a>9.1.1.1. Preparation</h5>
<div class="paragraph">
<p>You should have the following information at hand:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Who are the authors? What are their e-mail addresses?</p>
</li>
<li>
<p>How is the repository structured? Are there branches and tags?</p>
</li>
<li>
<p>Should metadata about the Subversion revision be stored in the git commits?</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Later, you will run the command <code>git svn clone</code>.
The answers to the above questions will determine which options and arguments you use to do this.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Our experience has shown that rarely a single conversion attempt is sufficient.
If the Subversion repository is not already local, it&#8217;s definitely worth making a local copy of it&#8201;&#8212;&#8201;so you don&#8217;t have to download the revisions over the network on a second attempt.
You can use <code>rsvndump</code>, for example, to do this.&#8288;<sup class="footnote">[<a id="_footnoteref_118" class="footnote" href="#_footnotedef_118" title="View footnote.">118</a>]</sup></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Subversion uses less extensive author metadata than Git; revisions are simply marked with a Subversion username, and there is no difference between the author and committer of a revision.
In order for <code>git-svn</code> to convert Subversion usernames to the full names with email addresses typical of Git, a so-called <em>authors file</em> is required:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>jplenz  = Julius Plenz &lt;julius@plenz.com&gt;
vhaenel = Valentin Haenel &lt;valentin.haenel@gmx.de&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The file, e.g.&#160;<code>authors.txt</code>, is later passed to <code>git-svn</code> via <code>--authors-file=</code> or <code>-A</code>.</p>
</div>
<div class="paragraph">
<p>The following one-liner determines all Subversion usernames and helps you to create the file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>svn log --xml | grep author | sed 's_^.&#42;&gt;\(.&#42;\)&lt;.&#42;$_\1_&#39; | \</strong>
  <strong>sort --unique</strong></pre>
</div>
</div>
<div class="paragraph">
<p>If you do not specify an authors file when converting (or if an author is missing), <code>git-svn</code> will use the Subversion username as the author.
The e-mail address is composed of the Subversion username and the UUID of the Subversion repository.</p>
</div>
<div class="paragraph">
<p>Find out how the repository is structured in the next step.
The following questions will help:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Does the repository have a so-called <em>trunk</em> (main development thread), branches and tags?</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If so, is the default Subversion layout (<code>trunk/</code>, <code>branches/</code>, <code>tags/</code>) used?</p>
</li>
<li>
<p>If not, in which directories are trunk, branches and tags then?</p>
</li>
</ol>
</div>
</li>
<li>
<p>Are only a single or multiple projects managed in the repository?</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the project follows the Subversion standard layout (<a href="#fig.svn-stdlayout">Figure 47, &#8220;Standard Subversion layout&#8221;</a>), use the argument <code>--stdlayout</code> or <code>-s</code> for short.</p>
</div>
<div id="fig.svn-stdlayout" class="imageblock">
<div class="content">
<img src="images/svn-stdlayout-crop.png" alt="svn stdlayout crop" width="20%">
</div>
<div class="title">Figure 47. Standard Subversion layout</div>
</div>
</div>
<div class="sect4">
<h5 id="sec.git-svn-metadata"><a class="anchor" href="#sec.git-svn-metadata"></a>9.1.1.2. SVN Metadata</h5>
<div class="paragraph">
<p>The <code>--no-metadata</code> argument prevents additional metadata from being included in the commit message.
To what extent this makes sense for your use case is up to you to decide.
From a technical standpoint, metadata is only necessary if you want to continue to interact with the Subversion repository.
However, it may also be helpful to preserve the metadata, for example if you use the Subversion revision number in your bug tracking system.</p>
</div>
<div class="paragraph">
<p>The SVN metadata appears in the last line of each commit message and takes the following form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git-svn-id: &lt;URL&gt;@&lt;Revision&gt; &lt;UUID&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><code>&lt;URL&gt;</code> ist die URL des Subversion-Repositorys, <code>&lt;Revision&gt;</code> die Subversion-Revision und <code>&lt;UUID&gt;</code> (<em>Universally Unique Identifier</em>) eine Art &#8220;Fingerabdruck&#8221; des Subversion-Repositorys.
Zum Beispiel:</p>
</div>
<div class="paragraph">
<p><code>&lt;URL&gt;</code> is the URL of the Subversion repository, <code>&lt;Revision&gt;</code> is the Subversion revision, and <code>&lt;UUID&gt;</code> (<em>Universally Unique Identifier</em>) is a sort of &#8220;fingerprint&#8221; of the Subversion repository.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git-svn-id: file:///demo/trunk@8 2423f1c7-8de6-44f9-ab07-c0d4e8840b78</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec.git-svn-username"><a class="anchor" href="#sec.git-svn-username"></a>9.1.1.3. Specify a Username</h5>
<div class="paragraph">
<p>Wie Sie den Benutzernamen angeben, hängt vom Transport-Protokoll ab.
Für solche, bei denen Subversion die Authentifizierung regelt (z.B. <code>http</code>, <code>https</code> und <code>svn</code>), nutzen Sie die Option <code>--username</code>.
Für andere (<code>svn+ssh</code>) müssen Sie den Benutzernamen als Teil der URL angeben, also beispielsweise <code>svn+ssh://USER@svn.example.com</code>.</p>
</div>
<div class="paragraph">
<p>How you specify the user name depends on the transport protocol.
For those where Subversion handles authentication (e.g. <code>http</code>, <code>https</code>, and <code>svn</code>), use the <code>--username</code> option.
For others (<code>svn+ssh</code>), you must specify the username as part of the URL, for example, <code>svn+ssh://USER@svn.example.com</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.git-svn-convert-command"><a class="anchor" href="#sec.git-svn-convert-command"></a>9.1.1.4. Converting Standard Layouts</h5>
<div class="paragraph">
<p>You can convert an SVN repository in standard layout with the following call (after you have created an Authors file):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git svn clone &lt;http://svn.example.com/&gt; -s -A &lt;authors.txt&gt; \</strong>
    <strong>--no-metadata &lt;projekt-konvertiert&gt;</strong></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec.git-svn-nonstdlayout"><a class="anchor" href="#sec.git-svn-nonstdlayout"></a>9.1.1.5. Non-Standard Layouts</h5>
<div class="paragraph">
<p>If the repository is not laid out according to the Subversion standard layout, adjust the call to <code>git svn</code> accordingly: Instead of <code>--stdlayout</code>, explicitly specify the trunk with <code>--trunk</code> or <code>-T</code>, the branches with <code>--branches</code> or <code>-b</code>, and the tags with <code>--tags</code> or <code>-t</code>&#8201;&#8212;&#8201;if, for example, several projects are managed in one Subversion repository (<a href="#fig.svn-nonstdlayout">Figure 48, &#8220;Non-Standard Layout&#8221;</a>).</p>
</div>
<div id="fig.svn-nonstdlayout" class="imageblock">
<div class="content">
<img src="images/svn-nonstdlayout-crop.png" alt="svn nonstdlayout crop" width="20%">
</div>
<div class="title">Figure 48. Non-Standard Layout</div>
</div>
<div class="paragraph">
<p>To convert <code>project1</code>, the call would be as follows:&#8288;<sup class="footnote">[<a id="_footnoteref_119" class="footnote" href="#_footnotedef_119" title="View footnote.">119</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git svn clone &lt;http://svn.example.com/&gt; -T trunk/projekt1 \</strong>
  <strong>-b branches/projekt1 -t tags/projekt1 \</strong>
  <strong>-A &lt;authors.txt&gt; &lt;projekt1-konvertiert&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>An SVN repository without branches or tags can simply be cloned by using the URL of the project directory and omit <code>--stdlayout</code> entirely:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git svn clone &lt;http://svn.example.com/projekt&gt; -A authors.txt \</strong>
    <strong>--no-metadata &lt;projekt-konvertiert&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>If several independent projects are managed in one repository, we recommend that you create a separate Git repository for each project.
Unlike Subversion, Git is not suitable for managing multiple projects in one repository.
The object model means that the development histories (commit graphs) would become inextricably linked.
How to &#8220;link&#8221; projects from different Git repositories is described in <a href="#sec.subprojects">Section 5.11, &#8220;Managing Subprojects&#8221;</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.git-svn-postprocessing"><a class="anchor" href="#sec.git-svn-postprocessing"></a>9.1.1.6. Postprocessing</h5>
<div class="paragraph">
<p>Once <code>git svn clone</code> has run, you&#8217;ll usually need to do a bit of rework on the repository.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>During conversion, <code>git-svn</code> ignores all Subversion properties except <code>svn:execute</code>.
If the Subversion repository uses the <code>svn:ignore</code> properties to exclude files, you can translate them into one (or recursively for multiple) <code>.gitignore</code> file(s):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git svn create-ignore</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>.gitignore</code> files are only created and added to the index&#8201;&#8212;&#8201;you still have to check them in.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Git creates special git branches under <code>remotes/origin</code> for the Subversion trunk and the Subversion branches and tags.
They are very similar to the remote tracking branches, in that they reflect the state of the Subversion repository-that is, they are <em>Subversion tracking branches</em>, so to speak.
They are mainly used for bidirectional communication and are updated when synchronized with the Subversion repository.
However, if you only want to convert the repository, these branches are of no use anymore and should be rewritten to &#8220;real&#8221; Git repositories (see below).</p>
</div>
<div class="paragraph">
<p>A Subversion tracking branch is created for the trunk and for each Subversion branch,&#8288;<sup class="footnote">[<a id="_footnoteref_120" class="footnote" href="#_footnotedef_120" title="View footnote.">120</a>]</sup> and for each Subversion tag a Subversion tracking branch is also created (<em>no</em> git tag, see below), but under <code>remotes/origin/tags</code>.</p>
</div>
<div class="paragraph">
<p>Assume that the Subversion repository has the following Subversion branches and tags:</p>
</div>
<div id="fig.svn-branches" class="imageblock">
<div class="content">
<img src="images/svn-branches-crop.png" alt="svn branches crop" width="20%">
</div>
<div class="title">Figure 49. Example Subversion branches and tags</div>
</div>
<div class="paragraph">
<p>In this case <code>git svn</code> creates the following git branches:</p>
</div>
<div id="fig.git-converted-branches" class="imageblock">
<div class="content">
<img src="images/git-branches-crop.png" alt="git branches crop" width="35%">
</div>
<div class="title">Figure 50. Converted Git Branches</div>
</div>
<div class="paragraph">
<p>You can adjust the prefix with the option <code>--prefix=</code>.
For example, with the <code>--prefix=svn/</code> statement, all converted references are stored under <code>remotes/svn/</code> instead of <code>remotes/origin</code>.</p>
</div>
<div class="paragraph">
<p>As already mentioned, <code>git-svn</code> <em>does not</em> create git tags for Subversion tags.
This is because from a technical point of view, Subversion tags are hardly different from Subversion branches.
They are also created with <code>git svn copy</code> and&#8201;&#8212;&#8201;unlike git tags&#8201;&#8212;&#8201;can be changed afterwards.
To be able to track such updates, Subversion tags are therefore also displayed as Subversion tracking branches.
Like the Subversion branches, they are of no use (but rather cause confusion) in a converted repository, and should be converted to real Git tags.</p>
</div>
<div class="paragraph">
<p>If you want to keep the Subversion branches and tags, you should translate the Subversion tracking branches into local Git branches or lightweight Git tags.
The following shell script git-convert-refs will help you in the first step:&#8288;<sup class="footnote">[<a id="_footnoteref_121" class="footnote" href="#_footnotedef_121" title="View footnote.">121</a>]</sup></p>
</div>
<div id="code.git-convert-refs" class="listingblock">
<div class="content">
<pre>#!/bin/sh

. $(git --exec-path)/git-sh-setup
svn_prefix='svn/'

convert_ref(){
  echo -n "converting: $1 to: $2 ..."
  git update-ref $2 $1
  git update-ref -d $1
  echo "done"
}

get_refs(){
  git for-each-ref $1 --format='%(refname)'
}

echo 'Converting svn tags'
get_refs refs/remotes/${svn_prefix}tags | while read svn_tag
do
  new_ref=$(echo $svn_tag | sed -e "s|remotes/$svn_prefix||")
  convert_ref $svn_tag $new_ref
done

echo "Converting svn branches"
get_refs refs/remotes/${svn_prefix} | while read svn_branch
do
  new_ref=$(echo $svn_branch | sed -e "s|remotes/$svn_prefix|heads/|")
  convert_ref $svn_branch $new_ref
done</pre>
</div>
</div>
<div class="paragraph">
<p>The script assumes that the repository was converted with the <code>--prefix=svn/</code> option.
The two <code>while</code> loops do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A git tag is created for each Subversion tracking branch that corresponds to a Subversion <em>tag</em> (e.g. <code>refs/remotes/svn/tags/v1.0</code> &#8594; <code>refs/tags/v1.0</code>).</p>
</li>
<li>
<p>For each Subversion tracking branch that corresponds to a Subversion <em>branch</em>, a &#8220;real&#8221; local Git branch is created (e.g. <code>refs/remotes/svn/bugfix</code> &#8594; <code>refs/heads/bugfix</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The script uses the plumbing commands <code>git for-each-ref</code>, which prints references matching the given expression line by line, and <code>git update-ref</code>, which rewrites and deletes references.&#8288;<sup class="footnote">[<a id="_footnoteref_122" class="footnote" href="#_footnotedef_122" title="View footnote.">122</a>]</sup></p>
</div>
<div class="paragraph">
<p>See <a href="#fig.git-convert-refs-before">Figure 51, &#8220;Converted branches and tags before translation&#8221;</a> and <a href="#fig.git-convert-refs-after">Figure 52, &#8220;Converted branches and tags after translation&#8221;</a> to see how the script works.
In the Subversion repository there is a trunk, a branch feature and the <code>v1.0</code> tag.
<code>git-svn</code> creates three branches under <code>remotes/svn</code> during the conversion process, as described above.
The script <code>git-convert-refs</code> finally translates <code>remotes/svn/trunk</code> &#8594; <code>trunk</code>, <code>remotes/svn/feature</code> &#8594; <code>feature</code> and <code>remotes/svn/tags/v1.0</code> becomes a lightweight tag.</p>
</div>
<div id="fig.git-convert-refs-before" class="imageblock">
<div class="content">
<img src="images/git-convert-refs-before.png" alt="git convert refs before" width="90%">
</div>
<div class="title">Figure 51. Converted branches and tags before translation</div>
</div>
<div id="fig.git-convert-refs-after" class="imageblock">
<div class="content">
<img src="images/git-convert-refs-after.png" alt="git convert refs after" width="90%">
</div>
<div class="title">Figure 52. Converted branches and tags after translation</div>
</div>
<div class="paragraph">
<p>After rewriting Subversion branches and tags, you will notice that all Git tags &#8220;sit&#8221; on very short branches (see tag <code>v1.0</code> in <a href="#fig.git-convert-refs-after">Figure 52, &#8220;Converted branches and tags after translation&#8221;</a> and <a href="#fig.git-svn-tag-fix-before">Figure 53, &#8220;Converted Git tags on branches&#8221;</a>).
This is because each Subversion tag is stored with a Subversion commit.
So the conversion behavior of <code>git-svn</code> is correct in principle, because one Git commit is created per Subversion revision&#8201;&#8212;&#8201;but a bit unwieldy for a Git repository: you cannot use <code>git describe --tags</code>, for example.</p>
</div>
<div class="paragraph">
<p>However, unless the Subversion tag has been modified afterwards, the tagged commit references the same tree as its ancestor, so you can move the tags to the ancestors.
The following shell script <code>git-fix-tags</code>&#8288;<sup class="footnote">[<a id="_footnoteref_123" class="footnote" href="#_footnotedef_123" title="View footnote.">123</a>]</sup> will help here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/sh

. $(git --exec-path)/git-sh-setup
get_tree(){ git rev-parse $1^{tree}; }

git for-each-ref refs/tags --format='%(refname)' \
| while read tag
do
    sha1=$(git rev-parse $tag)
    tree=$(get_tree $tag )
    new=$sha1
    while true
    do
        parent=$(git rev-parse $new^)
        git rev-parse $new^2 &gt; /dev/null 2&gt;&amp;1 &amp;&amp; break
        parent_tree=$(get_tree $parent)
        [ "$parent_tree" != "$tree" ] &amp;&amp; break
        new=$parent
    done
    [ "$sha1" = "$new" ] &amp;&amp; break
    echo -n "Found new commit for tag ${tag#refs/tags/}: " \
        $(git rev-parse --short $new)", resetting..."
    git update-ref $tag $new
    echo 'done'
done</pre>
</div>
</div>
<div class="paragraph">
<p>The script examines every tagged commit.
If there is a commit among the ancestors that references the same tree, the tag is renewed.
If the commit or one of its ancestors itself has multiple ancestors (after a merge), the search is aborted.
In <a href="#fig.git-svn-tag-fix-before">Figure 53, &#8220;Converted Git tags on branches&#8221;</a>, you can see two tags that come into consideration: <code>v1.0</code> and <code>v2.0</code>.
The <code>v1.0</code> tag was created from commit <code>C1</code> and does not contain any subsequent changes.
The <code>v2.0</code> tag, on the other hand, was modified again after it was created from Commit <code>C2</code>.</p>
</div>
<div id="fig.git-svn-tag-fix-before" class="imageblock">
<div class="content">
<img src="images/git-svn-tag-fix-before.png" alt="git svn tag fix before" width="90%">
</div>
<div class="title">Figure 53. Converted Git tags on branches</div>
</div>
<div class="paragraph">
<p>In <a href="#fig.git-svn-tag-fix-after">Figure 54, &#8220;Tag <code>v1.0</code> was rewritten&#8221;</a> you can see how tag <code>v1.0</code> was moved from the above script to the ancestor (because the trees are the same).
However, tag <code>v2.0</code> remains in place (because the trees are different due to subsequent changes).</p>
</div>
<div id="fig.git-svn-tag-fix-after" class="imageblock">
<div class="content">
<img src="images/git-svn-tag-fix-after.png" alt="git svn tag fix after" width="90%">
</div>
<div class="title">Figure 54. Tag <code>v1.0</code> was rewritten</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The tool <code>git-svn-abandon</code>&#8288;<sup class="footnote">[<a id="_footnoteref_124" class="footnote" href="#_footnotedef_124" title="View footnote.">124</a>]</sup> takes a similar approach to the two scripts presented, i.e. it converts Subversion tracking branches and moves tags.
Instead of lightweight tags, however, it creates annotated tags and does some additional cleanup work, similar to the ones we&#8217;ll cover next.
Another alternative for moving tags is the script <code>git-move-tags-up</code>.&#8288;<sup class="footnote">[<a id="_footnoteref_125" class="footnote" href="#_footnotedef_125" title="View footnote.">125</a>]</sup></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You should still decide how to handle the trunk reference (<code>trunk</code> or <code>git-svn</code>).
After conversion, it will point to the same commit as <code>master</code>, so you can actually delete it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git branch -d trunk</strong></pre>
</div>
</div>
<div class="paragraph">
<p>There may still be Git branches in the repository after the conversion that have already been merged into <code>master</code>.
Remove them with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout master</strong>
$ <strong>git branch --merged | grep -v '^&#42;' | xargs git branch -d</strong></pre>
</div>
</div>
<div class="paragraph">
<p>You can also dispose of the remaining legacy files that are both in the repository configuration and in <code>.git/</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>rm -r .git/svn</strong>
$ <strong>git config --remove-section svn</strong>
$ <strong>git config --remove-section svn-remote.svn</strong></pre>
</div>
</div>
<div class="paragraph">
<p>You are then ready to upload the converted history to a remote repository to share it with other developers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git remote add &lt;example&gt; &lt;git@git.example.com:projekt1.git&gt;</strong>
$ <strong>git push &lt;example&gt; --mirror</strong></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sec.git-svn-merges"><a class="anchor" href="#sec.git-svn-merges"></a>9.1.1.7. Subversion Merges</h5>
<div class="paragraph">
<p>Subversion merges are detected by <code>git-svn</code> using the <code>svn:mergeinfo</code> properties and translated as git merges&#8201;&#8212;&#8201;although not always.
It depends on which Subversion revisions were merged and how.
If all revisions affecting a branch have been merged (<code>svn merge -r &lt;N:M&gt;</code>), this is represented by a Git merge commit.
However, if only individual revisions have been merged (via <code>svn merge -c &lt;N&gt;</code>), then they are simply committed with <code>git cherry-pick</code> instead.</p>
</div>
<div class="paragraph">
<p>For the following example, we have created a Subversion repository with a branch feature that is merged twice: once as a Subversion merge, which is considered a Git merge commit, and once as a Subversion merge, which is translated as cherry-pick.
The result converted with <code>git-svn</code> is shown below.</p>
</div>
<div id="fig.git-svn-merge-demo" class="imageblock">
<div class="content">
<img src="images/git-svn-merge-demo.png" alt="git svn merge demo" width="90%">
</div>
<div class="title">Figure 55. Converted Subversion repository</div>
</div>
<div class="paragraph">
<p>The commits in the Subversion repository were made in the following order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Standardlayout</p>
</li>
<li>
<p><code>C1</code> on <code>trunk</code></p>
</li>
<li>
<p>Branch <code>feature</code></p>
</li>
<li>
<p><code>C1</code> on <code>feature</code></p>
</li>
<li>
<p><code>C2</code> on <code>feature</code></p>
</li>
<li>
<p><code>C2</code> on <code>trunk</code></p>
</li>
<li>
<p><code>svn merge branches/feature trunk -c 5</code> (commit <code>C2</code> on <code>feature</code>)</p>
</li>
<li>
<p><code>svn merge branches/feature trunk -r 3:5</code> (commit <code>C1</code>&amp;`C2` on <code>feature</code>)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Finally, it should be mentioned that <code>git-svn</code> is by far not the only tool for conversion.
<code>git-svn</code> often suffers from speed problems with very large repositories.
In this context, two tools are mentioned very often that work faster: on the one hand <code>svn2git</code>&#8288;<sup class="footnote">[<a id="_footnoteref_126" class="footnote" href="#_footnotedef_126" title="View footnote.">126</a>]</sup> and also <code>svn-fe</code>&#8288;<sup class="footnote">[<a id="_footnoteref_127" class="footnote" href="#_footnotedef_127" title="View footnote.">127</a>]</sup> (svn-fast-export).
If you encounter problems during the conversion (e.g. if the conversion has been running for several days and there is no end in sight), it is worth taking a look at the alternatives.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.git-svn-conduit"><a class="anchor" href="#sec.git-svn-conduit"></a>9.1.2. Bidirectional Communication</h4>
<div class="paragraph">
<p>The <code>git-svn</code> tool can not only convert a Subversion repository, it is also a better Subversion client.
This means you have all the benefits of Git locally (easy and flexible branching, local commits and history)&#8201;&#8212;&#8201;but you can upload your Git commits from your local Git repository as Subversion commits to a Subversion repository.
Additionally, <code>git-svn</code> allows you to download new commits from other developers in the Subversion repository to your local Git repository.
You should use <code>git-svn</code> if a complete conversion to Git is not feasible, but you&#8217;d like to take advantage of the local benefits of Git.
Note that <code>git-svn</code> is a somewhat limited version of Subversion, and not all features are fully available.
There are some subtleties to consider, especially when uploading.</p>
</div>
<div class="paragraph">
<p>First, a summary of the most important <code>git-svn</code> commands:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>git svn init</code> 
</td>
<td class="hdlist2">
<p>Create a Git repository to track a Subversion repository.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>git svn fetch</code> 
</td>
<td class="hdlist2">
<p>Download new revisions from the Subversion repository.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>git svn clone</code> 
</td>
<td class="hdlist2">
<p>Combination of 'git svn init` and <code>git svn fetch</code>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>git svn dcommit</code> 
</td>
<td class="hdlist2">
<p>Upload Git commits as Subversion revisions to the Subversion repository (<em>diff commit</em>)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>git svn rebase</code> 
</td>
<td class="hdlist2">
<p>Combination of <code>git svn fetch</code> and <code>git rebase</code>, usually executed before a <code>git svn dcommit</code>.</p>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="sec.git-svn-clone"><a class="anchor" href="#sec.git-svn-clone"></a>9.1.2.1. Cloning a Subversion Repository</h5>
<div class="paragraph">
<p>To retrieve the repository, first follow the same procedure as in the Subversion conversion section&#8201;&#8212;&#8201;create an authors file and determine the repository layout.
Then you can use <code>git svn clone</code> to clone the Subversion repository, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git svn clone http://svn.example.com/ -s \</strong>
  <strong>-A &lt;authors.txt&gt; &lt;projekt-git&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The call downloads all Subversion revisions and creates a Git repository from the history under <code>&lt;project-git&gt;</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Cloning an entire Subversion history can be extremely time consuming under certain circumstances.
From a Subversion point of view, a long history is not a problem because the <code>svn checkout</code> command usually only downloads the current revision.
Something similar can be done with <code>git-svn</code>.
To do this, you first have to initialize the local Git repository and then only download the current revision (<code>HEAD</code>) from the trunk or branch.
The advantage here is certainly the speed, the disadvantage is that there is no local history:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git svn init http://svn.example.com/trunk projekt-git</strong>
$ <strong>cd projekt-git</strong>
$ <strong>git svn fetch -r HEAD</strong></pre>
</div>
</div>
<div class="paragraph">
<p>As an alternative to <code>HEAD</code>, you could specify any revision and then use <code>git svn fetch</code> to download the missing revisions up to <code>HEAD</code>, thus cloning only part of the history.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As part of the conversion, we described how to post-process the repository.
Since you want to continue interacting with the Subversion repository in the future, this is not necessary here.
Also, the <code>--no-metadata</code> option must not be used, because otherwise the metadata of the form <code>git-svn-id:</code> will disappear from the commit message, and Git will no longer be able to map the commits and revisions.</p>
</div>
<div class="paragraph">
<p>The call to <code>git-svn</code> creates several entries in the configuration file <code>.git/config</code>.
First, an entry <code>svn-remote.svn</code>, which, similar to a remote entry for a Git repository, contains information about the URL and the Subversion branches and tags to track.
For example, if you cloned a repository with a standard layout, it might look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[svn-remote "svn"]
    url = http://svn.example.com/
    fetch = trunk:refs/remotes/origin/trunk
    branches = branches/*:refs/remotes/origin/*
    tags = tags/*:refs/remotes/origin/tags/*</pre>
</div>
</div>
<div class="paragraph">
<p>In contrast to a regular <code>remote</code> entry this one additionally contains the values <code>branches</code> and <code>tags</code>.
These in turn each contain a refspec describing how Subversion branches and tags are stored locally as Subversion tracking branches.
The <code>fetch</code> entry only handles the Subversion trunk and must not contain any glob expressions.</p>
</div>
<div class="paragraph">
<p>If you do not have any Subversion branches and tags, the corresponding entries are omitted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[svn-remote "svn"]
    url = http://svn.example.com/
    fetch = :refs/remotes/git-svn</pre>
</div>
</div>
<div class="paragraph">
<p>If you clone the repository with the prefix option, for example with <code>--prefix=svn/</code>, <code>git svn</code> will adjust the refspecs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[svn-remote "svn"]
    url = http://svn.example.com/
    fetch = trunk:refs/remotes/svn/trunk
    branches = branches/*:refs/remotes/svn/*
    tags = tags/*:refs/remotes/svn/tags/*</pre>
</div>
</div>
<div class="paragraph">
<p>If you specify an authors file, a separate entry is created for it.
The file will still be needed in the future when you download new commits from the Subversion repository.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[svn]
    authorsfile = /home/valentin/svn-testing/authors.txt</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In the section on conversion we described how to use <code>create-ignore</code> to create <code>.gitignore</code> files.
However, if you want to continue working with the Subversion repository, there is little point in checking in the <code>.gitignore</code> files there.
They have no effect on Subversion and only confuse other developers who continue to work with the native Subversion client (<code>svn</code>).
Instead, there is an option to store the patterns to ignore in the <code>.git/info/excludes</code> file (see <a href="#sec.ignore">Section 4.4, &#8220;Ignore files&#8221;</a>), which is not part of the repository.
The <code>git svn show-ignore</code> command, which searches for and outputs all <code>svn-ignore</code> properties, can help here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git svn show-ignore &gt; .git/info/excludes</strong></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec.git-svn-examine"><a class="anchor" href="#sec.git-svn-examine"></a>9.1.2.2. Examining a Repository</h5>
<div class="paragraph">
<p>In addition, <code>git-svn</code> provides some commands for examining the history and other properties of the repository:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>git&#160;svn&#160;log</code> 
</td>
<td class="hdlist2">
<p>A hybrid of <code>svn log</code> and <code>git log</code>.
The subcommand produces output similar to <code>svn log</code>, but uses the local repository to create it.
Several options of <code>git svn</code> have been recreated, such as <code>-r &lt;N&gt;:&lt;M&gt;</code>.
Unknown options, e.g. <code>-p</code>, are passed directly to <code>git log</code> so that options from both commands can be mixed:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git svn log -r 3:16 -p</strong></pre>
</div>
</div>
<div class="paragraph">
<p>It would now show the revisions 3&#x2013;16, including a patch of the changes.</p>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>git&#160;svn&#160;blame</code> 
</td>
<td class="hdlist2">
<p>Similar to <code>svn blame</code>.
With the <code>--git-format</code> option, the output has the same format as <code>git&#160;blame</code>, but with Subversion revisions instead of the SHA-1 IDs.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>git&#160;svn&#160;find&#8288;-&#8288;rev</code> 
</td>
<td class="hdlist2">
<p>Shows the SHA-1 ID of the Git commit, which is the changeset of a particular Subversion revision.
The revision is passed with the syntax <code>r&lt;N&gt;</code>, where <code>&lt;N&gt;</code> is the revision number:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git svn find-rev r6</strong>
c56506a535f9d41b64850a757a9f6b15480b2c07</pre>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>git&#160;svn&#160;info</code> 
</td>
<td class="hdlist2">
<p>Like <code>svn info</code>.
Returns various information about the Subversion repository.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>git&#160;svn&#160;proplist</code> 
</td>
<td class="hdlist2">
<p>Like <code>svn proplist</code>, prints a list of existing Subversion properties.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>git&#160;svn&#160;propget</code> 
</td>
<td class="hdlist2">
<p>Like <code>svn propget</code>, outputs the value of a single Subversion property.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Unfortunately, currently <code>git-svn</code> can only query Subversion properties, but cannot create, modify or delete them.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.git-svn-exchange"><a class="anchor" href="#sec.git-svn-exchange"></a>9.1.2.3. Exchanging Commits</h5>
<div class="paragraph">
<p>Similar to <code>git fetch</code>, <code>git svn fetch</code> downloads new commits from the Subversion repository.
In the process, <code>git-svn</code> fetches all new Subversion revisions, translates them into Git commits, and finally updates the Subversion tracking branches.
The output is a list of downloaded Subversion revisions, the files changed by the revision, the SHA-1 sum, and the Subversion tracking branch of the resulting Git commit, e.g:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git svn fetch</strong>
        A   COPYING
        M   README
r21 = 8d707316e1854afbc1b728af9f834e6954273425 (refs/remotes/trunk)</pre>
</div>
</div>
<div class="paragraph">
<p>You can work locally in the Git repository as usual, but there is an important restriction when uploading commits to the Subversion repository: While <code>git-svn</code> is capable of rendering Subversion merges to some degree (see above), it can&#8217;t map local Git merges to Subversion merges, so only linear histories should be uploaded via <code>git svn dcommit</code>.</p>
</div>
<div class="paragraph">
<p>To make this linearization easier, there is the command <code>git svn rebase</code>.
It first downloads all new commits from the Subversion repository and then rebuilds the current Git branch to the appropriate Subversion tracking branch via <code>git rebase</code>.</p>
</div>
<div class="paragraph">
<p>Essentially, the workflow consists of the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git add/commit ...</strong>
$ <strong>git svn rebase</strong>
$ <strong>git svn dcommit</strong></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#fig.git-svn-rebase">Figure 56</a> shows what <code>git svn rebase</code> does.
First, new revisions are downloaded from the Subversion repository, in this case <code>C</code>.
Then the <code>remote/origin/trunk</code> tracking branch is &#8220;advanced&#8221; so to speak, and then corresponds to the current status in the Subversion repository.
Finally, the current branch (in this case <code>master</code>) is rebuilt using <code>git rebase</code>.
The commit <code>D'</code> can now be uploaded.</p>
</div>
<div id="fig.git-svn-rebase" class="imageblock">
<div class="content">
<img src="images/svn-rebase.svg" alt="svn rebase" width="90%">
</div>
<div class="title">Figure 56. <code>git svn rebase</code> integrates the newly added Subversion revision as commit <code>C</code>&#8201;&#8212;&#8201;before <code>D</code>, which becomes <code>D'</code>.</div>
</div>
<div class="paragraph">
<p>With <code>git svn dcommit</code>, you upload a Git commit changeset as a revision to the Subversion repository.
As part of the operation, the revision is again committed to the local Git repository as a Git commit, but this time with Subversion metadata in the commit message.
This, of course, changes the SHA-1 sum of the commit, as shown in <a href="#fig.git-svn-dcommit">Figure 57</a> by the different commits <code>D'</code> and <code>D''</code>.</p>
</div>
<div id="fig.git-svn-dcommit" class="imageblock">
<div class="content">
<img src="images/svn-dcommit.svg" alt="svn dcommit" width="90%">
</div>
<div class="title">Figure 57. After a <code>git svn dcommit</code>, the commit <code>D'</code> has a new SHA-1 ID and becomes <code>D''</code> because its commit description has been changed to store meta information.</div>
</div>
<div class="paragraph">
<p>Similar to <code>git push</code>, you may not use <code>git rebase</code> or <code>git commit --amend</code> to modify commits that you have already uploaded with <code>git svn dcommit</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="sec.git-svn-branches-tags"><a class="anchor" href="#sec.git-svn-branches-tags"></a>9.1.2.4. Subversion Branches and Tags</h5>
<div class="paragraph">
<p>The subcommands <code>git svn branch</code> and <code>git svn tag</code> are used to create Subversion branches and tags.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git svn tag -m "Tag Version 2.0" v2.0</strong></pre>
</div>
</div>
<div class="paragraph">
<p>In the Subversion repository, this creates the <code>tags/v2.0</code> directory, the contents of which is a copy of the current <code>HEAD</code>.&#8288;<sup class="footnote">[<a id="_footnoteref_128" class="footnote" href="#_footnotedef_128" title="View footnote.">128</a>]</sup>
In the Git repository, a new Subversion tracking branch (<code>remotes/origin/tags/v2.0</code>) is created for this.
The <code>-m</code> option optionally passes a message.
If not, <code>git-svn</code> sets the message <code>Create tag &lt;tag&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Git version 1.7.4 introduced a feature that allows you to perform Subversion merges.
The feature is available to <code>git svn dcommit</code> via the <code>--mergeinfo</code> option and causes the Subversion property <code>svn:mergeinfo</code> to be set.
The documentation for this option in the <code>git-svn(1)</code> man page is new in version 1.7.4.5 and later.</p>
</div>
<div class="paragraph">
<p>The following is an example of a procedure for creating a branch with <code>git-svn</code>, committing it in it and merging it again later, in the sense of Subversion.</p>
</div>
<div class="paragraph">
<p>First create the Subversion branch&#8201;&#8212;&#8201;the command works basically like <code>git svn tag</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git svn branch &lt;feature&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Then you create a local branch to work with and commit to it.
The branch must be based on the Subversion tracking branch <code>&lt;feature&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout -b &lt;feature&gt; origin/&lt;feature&gt;</strong>
$ <strong>git commit ...</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Then upload the commits to the Subversion repository.
The <code>git svn rebase</code> call is only necessary if another user has made commits to the Subversion <code>feature</code> branch in the meantime.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git svn rebase</strong>
$ <strong>git svn dcommit</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Now you have to transfer the merge information separately.
To do this, proceed as follows: First you merge the branch locally in the Git repository and then upload the resulting merge commit using <code>--mergeinfo</code>.
The syntax for this option is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git svn dcommit --mergeinfo=&lt;branch-name&gt;:&lt;N&gt;-&lt;M&gt;</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>&lt;branch-name&gt;</code> is the Subversion name of the branch, e.g. <code>/branches/&lt;name&gt;</code>, <code>&lt;N&gt;</code> the first Subversion revision that changes the branch, and <code>&lt;M&gt;</code> the last.&#8288;<sup class="footnote">[<a id="_footnoteref_129" class="footnote" href="#_footnotedef_129" title="View footnote.">129</a>]</sup>
Assuming you created the branch with revision 23 and now, after two commits, want to merge the branch again, the command would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git checkout master</strong>
$ <strong>git merge --no-ff &lt;feature&gt;</strong>
$ <strong>git svn dcommit --mergeinfo=/branches/feature:23-25</strong></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.fast-import"><a class="anchor" href="#sec.fast-import"></a>9.2. Custom Importers</h3>
<div class="paragraph">
<p>Git offers an easy and convenient way to turn any version history into a Git repository using the <code>fast-import</code> subcommand.
The fast-import protocol is text-based and very flexible.&#8288;<sup class="footnote">[<a id="_footnoteref_130" class="footnote" href="#_footnotedef_130" title="View footnote.">130</a>]</sup></p>
</div>
<div class="paragraph">
<p>Any kind of data can be used as a basis: be it backups, tarballs, repositories of other version control systems, or, or, or, or&#8230;&#8203;
An import program that you can write in any language must translate the existing history into the so-called Fast Import Protocol and output it to Standard Out.
This output is then processed by <code>git fast-import</code>, which uses it to create a full-featured Git repository.</p>
</div>
<div class="paragraph">
<p>For simple importers who need to import a linear version history, three building blocks are important:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<em>Data&#160;block</em> 
</td>
<td class="hdlist2">
<p>A data block begins with the keyword <code>data</code>, followed by a space, followed by the data length in bytes and a line break.
This is immediately followed by the data, followed by another line break.
The data block does not have to be ended explicitly, since its length is specified in bytes.
It looks like this, for example:</p>
<div class="listingblock">
<div class="content">
<pre>data 4
test</pre>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<em>File</em> 
</td>
<td class="hdlist2">
<p>To pass the contents of a file, use the following format in the simplest case: <code>M &lt;mode&gt; inline &lt;path&gt;</code> followed by a data block on the next line.</p>
<div class="paragraph">
<p>So to import a file <code>README</code> with the content <code>test</code> (without a final newline!) the following construct is necessary:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>M 644 inline README
data 4
test</pre>
</div>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
<em>Commit</em> 
</td>
<td class="hdlist2">
<p>For a commit, you must specify the appropriate metadata (at least the committer and date, and a commit message), followed by the changed files.
This is done in the following format:</p>
<div class="listingblock">
<div class="content">
<pre>commit &lt;branch&gt;
committer &lt;who&gt; &lt;email&gt; &lt;when&gt;
&lt;Data block for commit message&gt;
deleteall</pre>
</div>
</div>
<div class="paragraph">
<p>For <code>&lt;branch&gt;</code> use a corresponding branch on which the commit should be made, e.g. <code>refs/heads/master</code>.
The name of the committer (<code>&lt;who&gt;</code>) is optional, but the email address is not.
The format of <code>&lt;when&gt;</code> must be a Unix timestamp with timezone, e.g. <code>1303329307 +0200</code>.&#8288;<sup class="footnote">[<a id="_footnoteref_131" class="footnote" href="#_footnotedef_131" title="View footnote.">131</a>]</sup>
Analogous to the <code>committer</code> line, you can add an <code>author</code> line.</p>
</div>
<div class="paragraph">
<p>The data block forms the commit message.
The final <code>deleteall</code> tells Git to forget everything about files from previous commits.
So for each commit, you add all the data completely new.&#8288;<sup class="footnote">[<a id="_footnoteref_132" class="footnote" href="#_footnotedef_132" title="View footnote.">132</a>]</sup>
Then follow one or more file definitions.
This could look like this, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>commit refs/heads/master
committer Julius Plenz &lt;julius@plenz.com&gt; 1303329307 +0200
data 23
Import the README File
deleteall
M 644 inline README
data 4
test</pre>
</div>
</div>
<div class="paragraph">
<p>Unless otherwise specified, commits are built upon each other in the order in which they are read (if they are on the same branch).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With these simple components we want to demonstrate how to turn old release tar balls into a Git archive using a small shell script.</p>
</div>
<div class="paragraph">
<p>First we download old releases of the editor <em>Vim</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>wget -q --mirror -nd ftp://ftp.home.vim.org/pub/vim/old/</strong></pre>
</div>
</div>
<div class="paragraph">
<p>For each tarball we now want to create a commit.
For this we proceed as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Read in archives line by line on Standard In and convert them into absolute path names (because the directory will be changed later).</p>
</li>
<li>
<p>For each of these archives, perform the following steps:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>&#8220;version&#8221;, last change, current time and commit message in the appropriate variables.
The time zone is hard coded for simplicity.</p>
</li>
<li>
<p>Create a temporary directory and unpack the archive there.</p>
</li>
<li>
<p>Output the corresponding lines <code>commit</code>, <code>author</code>, <code>committer</code>.
Then the prepared commit message, whose length is counted by <code>wc -c</code> (<em>byte count</em>).
Finally the keyword <code>deleteall</code>.</p>
</li>
<li>
<p>Output a corresponding file block for each file.
The first component of the file name is discarded (e.g. <code>./vim-1.14/</code>).
The length of the following file is again counted using <code>wc -c</code>.</p>
</li>
<li>
<p>Delete the temporary directory.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>All output of the script is set to Standard Out, so it can be easily piped to <code>git fast-import</code>.
The beginning of the output looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>commit refs/heads/master
author Bram Moolenaar &lt;bram@vim.org&gt; 1033077600 +0200
committer Julius Plenz &lt;julius@plenz.com&gt; 1303330792 +0200
data 15
import vim-1.14
deleteall
M 644 inline src/vim.h
data 7494
/* vi:ts=4:sw=4
 *
 * VIM - Vi IMitation
...</pre>
</div>
</div>
<div class="paragraph">
<p>To create a Git repository from this output, let&#8217;s proceed as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ <strong>git init vimgit</strong>
Initialized empty Git repository in /dev/shm/vimgit/.git/
$ <strong>cd vimgit</strong>
$ <strong>ls ../vim/&#42;.tar.gz | &lt;import-tarballs.sh&gt; | git fast-import</strong>
git-fast-import statistics:
---------------------------------------------------------------------
Alloc'd objects:       5000
Total objects:         1350 (      1206 duplicates                  )
      blobs  :         1249 (      1177 duplicates        523 deltas)
      trees  :           87 (        29 duplicates          0 deltas)
      commits:           14 (         0 duplicates          0 deltas)
      tags   :            0 (         0 duplicates          0 deltas)
Total branches:           1 (         1 loads     )
      marks:           1024 (         0 unique    )
      atoms:            354
Memory total:          2294 KiB
       pools:          2098 KiB
     objects:           195 KiB
---------------------------------------------------------------------
pack_report: getpagesize()            =       4096
pack_report: core.packedGitWindowSize =   33554432
pack_report: core.packedGitLimit      =  268435456
pack_report: pack_used_ctr            =          1
pack_report: pack_mmap_calls          =          1
pack_report: pack_open_windows        =          1 /          1
pack_report: pack_mapped              =    7668864 /    7668864
---------------------------------------------------------------------</pre>
</div>
</div>
<div class="paragraph">
<p>The command outputs a lot of statistical data about the import process (and aborts with a corresponding error message if the input is not understood).
A subsequent <code>reset</code> synchronizes index, working tree and repository, and the tar-balls are successfully imported:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git reset --hard</strong>
HEAD is now at ddb8ffe import vim-4.5
$ <strong>git log --oneline</strong>
ddb8ffe import vim-4.5
4151b0c import vim-4.4
dbbdf3d import vim-4.3
6d5aa08 import vim-4.2
bde105d import vim-4.1
332228b import vim-4.0
...</pre>
</div>
</div>
<div class="paragraph">
<p>For reference the complete script:&#8288;<sup class="footnote">[<a id="_footnoteref_133" class="footnote" href="#_footnotedef_133" title="View footnote.">133</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>#!/bin/sh

while read ar; do
    [ -f "$ar" ] || { echo "not a file: $ar" &gt;&amp;2; exit 1; }
    readlink -f "$ar"
done |
while read archive; do
    dir="$(mktemp -d /dev/shm/fi.XXXXXXXX)"
    version="$(basename $archive | sed _s/\.tar\.gz$//_)"
    mod="$(stat -c %Y $archive) +0200"
    now="$(date +%s) +0200"
    msg="import $version"

    cd "$dir" &amp;&amp;
    tar xfz "$archive" &amp;&amp;
    echo "commit refs/heads/master" &amp;&amp;
    echo "author Bram Moolenaar &lt;bram@vim.org&gt; $mod" &amp;&amp;
    echo "committer Julius Plenz &lt;julius@plenz.com&gt; $now" &amp;&amp;
    echo -n "data " &amp;&amp; echo -n "$msg" | wc -c &amp;&amp; echo "$msg" &amp;&amp;
    echo "deleteall" &amp;&amp;
    find . -type f |
    while read f; do
        echo -n "M 644 inline "
        echo "$f" | sed -e _s,^\./[^/]*/,,_
        echo -n "data " &amp;&amp; wc -c &lt; "$f" &amp;&amp; cat "$f"
    done &amp;&amp;
    echo
    rm -fr "$dir"
done</pre>
</div>
</div>
<div class="paragraph">
<p>As soon as the version history is a bit more complicated, the commands <code>mark</code>, <code>from</code> and <code>merge</code> become particularly interesting.
By using <code>mark</code> you can assign an ID to any objects (commits or blobs) in order to access them as &#8220;named objects&#8221; and not always have to specify the data <code>inline</code>.
The commands <code>from</code> and <code>merge</code> define the predecessor(s) of a commit, so that even complicated interdependencies between branches can be displayed.
For more details see the man page.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch.shell-integration"><a class="anchor" href="#ch.shell-integration"></a>10. Shell integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since you usually run Git commands on the shell, you should add functionality to them to interact with Git.
Especially for Git beginners, such interaction between shell and Git is very helpful to keep track of things.</p>
</div>
<div class="paragraph">
<p>There are two areas in which the shell can help you:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Display important information about a repository at the <em>prompt</em>.</p>
</li>
<li>
<p>This way you don&#8217;t have to call <code>git status</code> and consorts too often.</p>
</li>
<li>
<p>A custom <em>completion</em> helps you to enter git commands correctly, even if you don&#8217;t know the exact syntax.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A good prompt should signal the state of the working tree in addition to the current branch.
Are there any changes that are not yet saved?
Are there already changes in the index?</p>
</div>
<div class="paragraph">
<p>A good completion should, for example, when entering <code>git checkout</code> and then pressing the Tab key, only offer branches from the repository for completion.
But if you type <code>git checkout --</code> only files should be completed.
This saves time and protects against typos.
Other completions are also useful, such as the existing remotes for <code>git push</code> and <code>git pull</code>.</p>
</div>
<div class="paragraph">
<p>In this chapter we will introduce basic recipes for two popular shells: the <em>Bash</em> and the <em>Z-Shell</em>.
Instructions for other interactive shells can be found on the Internet.</p>
</div>
<div class="paragraph">
<p>The topic of shell integration is very extensive, so the tutorials presented here are only guidelines and ideas and do not claim to be complete.
To make matters worse, the git community is developing the user interface - i.e. the existing subcommands and their options - very quickly.
So please don&#8217;t be surprised if the completion is &#8220;lagging behind&#8221; and brand new subcommands and options are not (yet) available.</p>
</div>
<div class="sect2">
<h3 id="sec.bash-integration"><a class="anchor" href="#sec.bash-integration"></a>10.1. Git and the Bash</h3>
<div class="paragraph">
<p>Both the functionality for completion and the status commands for the prompt are implemented in a script called <code>git-completion.bash</code>.
It is managed together with the sources for Git.
You can find the file in the <code>contrib/completion</code> directory of the Git project.
Often the completion is already provided by your distribution or the git installer for your operating system.
If you have installed the <code>git</code> package in Debian or Ubuntu, the file should already be in <code>/usr/share/bash-completion/completions/git</code>.
In Gentoo, you install the file via the USE flag <code>bash-completion</code> of <code>dev-vcs/git</code>.
The current maintainer is Shawn O. Pearce.</p>
</div>
<div class="sect3">
<h4 id="sec.bash-completion"><a class="anchor" href="#sec.bash-completion"></a>10.1.1. Completion</h4>
<div class="paragraph">
<p>To activate the completion, load the script with the command <code>source</code> and pass the corresponding file as argument, e.g:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>source ~/Downloads/git-2.1.0/contrib/completion/git-completion.bash</pre>
</div>
</div>
<div class="paragraph">
<p>The completion completes among other things:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Git subcommands</dt>
<dd>
<p>For example, if you type <code>git pu[TAB]</code>, the bash will offer you <code>pull</code> and <code>push</code>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git pu[TAB]</strong>
pull push</pre>
</div>
</div>
<div class="paragraph">
<p>Note: Only the <em>porcelain</em> commands and user aliases are available.
External and <em>plumbing</em> commands are not implemented.
Subcommands that have additional subcommands themselves, e.g.&#160;<code>git remote</code> or <code>git stash</code>, are also completed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git remote [TAB]</strong>
add     prune     rename     rm     set-head     show     update</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Local Branches and Tags</dt>
<dd>
<p>Useful for subcommands, such as <code>checkout</code> and <code>rebase</code>, that expect a local reference:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git branch</strong>
* master
  refactor-cmd-line
  refactor-profiling
$ <strong>git checkout refactor-[TAB]</strong>
refactor-cmd-line    refactor-profiling</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Configured Remotes</dt>
<dd>
<p>Commands like <code>git fetch</code> and <code>git remote</code> are often called with a remote as argument.
Completion helps here too:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git remote show [TAB]</strong>
github        sourceforge</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Remote Branches and Tags</dt>
<dd>
<p>The Completion can also &#8220;check&#8221; on the remote page to see which references are available.
This is done for example with the command <code>git pull</code>, which expects a remote reference or a refspec:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git pull origin v1.7.1[TAB]</strong>
v1.7.1       v1.7.1.2     v1.7.1.4     v1.7.1-rc1
v1.7.1.1     v1.7.1.3     v1.7.1-rc0   v1.7.1-rc2</pre>
</div>
</div>
<div class="paragraph">
<p>Of course this only works if the remote repository is available.
In most cases a network connection and at least read access is required.</p>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Options</dt>
<dd>
<p>Most subcommands have several <em>long options</em> like&#160;<code>--bare</code>.
The completion usually knows these and completes them accordingly:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git diff --color[TAB]</strong>
--color         --color-words</pre>
</div>
</div>
<div class="paragraph">
<p><em>Short options</em>, such as&#160;<code>-a</code>, are not completed.</p>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Files</dt>
<dd>
<p>For Git commands that expect file names.
Good examples are <code>git add</code> and <code>git checkout</code>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git add [TAB]</strong>
.git/     hello.py  README    test/
$ <strong>git checkout -- [TAB]</strong>
.git/     hello.py  README    test/</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Git configuration options</dt>
<dd>
<p>The bash completion for Git also completes configuration options that you set with <code>git config</code>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config user.[TAB]</strong>
user.email        user.name         user.signingkey</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>As usual with bash completion, the input is automatically completed when it is unique.
If only the Branch <code>feature</code> exists, typing <code>git checkout fe[TAB]</code> will cause <code>fe</code> to be completed; the command <code>git checkout feature</code> will then appear on the command line - press Enter to execute the command.
Only when the input is ambiguous does the bash display the possible completions.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.bash-prompt"><a class="anchor" href="#sec.bash-prompt"></a>10.1.2. Prompt</h4>
<div class="paragraph">
<p>Beside the completion there is another script to display information about the git repository in the prompt.
For this you have to load the file <code>contrib/completion/git-prompt.sh</code> (maybe it is also installed by your distribution, e.g. under <code>/usr/lib/git-core/git-sh-prompt</code>).
Then, as in the following example, place a call to the <code>__git_ps1</code> function in the <code>PS1</code> variable.
The function takes a so-called _format string expression_ as argument - i.e. the string <code>%s</code> is replaced by git infos, all other characters are taken over.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>source /usr/lib/git-core/git-sh-prompt
PS1=_\u@\h \w$(__git_ps1 " (%s)") $ _</pre>
</div>
</div>
<div class="paragraph">
<p>The characters are replaced as follows: <code>\u</code> is the username, <code>\h</code> is the hostname, <code>\w</code> is the current working directory and <code>$(__git_ps1 " (%s)")</code> are the git infos, which without additional configuration (see below) consist only of the branch name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche \~ $ <strong>cd git-working/git</strong>
esc@creche ~/git-working/git (master) $</pre>
</div>
</div>
<div class="paragraph">
<p>The format string expression allows you to customize the display of the git info by using additional characters or color codes, e.g. with the following prompt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>PS1=_\u@\h \w$(__git_ps1 " (git)-[%s]") $ _</pre>
</div>
</div>
<div class="paragraph">
<p>This looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche ~/git-working/git (git)-[master] $</pre>
</div>
</div>
<div class="paragraph">
<p>If the current commit is not referenced by a branch (Detached-HEAD), either the tag or the abbreviated SHA-1 sum is displayed, each surrounded by a pair of brackets:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche ~/git-working/git (git)-[(v1.7.1.4)] $
esc@creche ~/git-working/git (git)-[(e760924...)] $</pre>
</div>
</div>
<div class="paragraph">
<p>If you are inside the <code>$GIT_DIR</code> or in a bare repository, this is signaled accordingly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche ~/git-working/git/.git (git)-[GIT_DIR!] $
esc@creche ~/git-working/git.git/.git (git)-[BARE:master] $</pre>
</div>
</div>
<div class="paragraph">
<p>It also indicates when you are in the middle of a merge, rebase or similar state where only certain operations are possible:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche ~/git-working/git (git)-[master|REBASE-i] $</pre>
</div>
</div>
<div class="paragraph">
<p>You can also expand the display to show the status of the Working Trees using different icons.
To do this, you must set the following environment variables to a <em>non-empty</em> value, e.g. to 1.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>GIT_PS1_SHOWDIRTYSTATE</code></dt>
<dd>
<p>For changes that are not yet in the index (<em>unstaged</em>), an asterisk (<code>*</code>) is displayed.
For changes that are already in the index (<em>staged</em>), a plus (<code>+</code>) is displayed.
The display requires the working tree to be read - this may slow down the shell for large repositories (Git has to check every file for modifications).
You can therefore disable this behavior for individual repositories with the Git variable <code>bash.showDirtyState</code>:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config bash.showDirtyState false</strong></pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>GIT_PS1_SHOWSTASHSTATE</code></dt>
<dd>
<p>If you have created one or more stashes, this is indicated by the dollar sign (<code>$</code>) in the prompt.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>GIT_PS1_SHOWUNTRACKEDFILES</code></dt>
<dd>
<p>The existence of (<em>untracked files</em>) is indicated by a percentage sign (<code>%</code>).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>You can activate all this additional information as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GIT_PS1_SHOWDIRTYSTATE=1
GIT_PS1_SHOWSTASHSTATE=1
GIT_PS1_SHOWUNTRACKEDFILES=1</pre>
</div>
</div>
<div class="paragraph">
<p>If everything in the repository matches (i.e. <em>unstaged</em>, <em>staged</em>, <em>stashed</em> and <em>untracked</em>), four additional characters (<code>*</code>, <code>+</code>, <code>$</code> and <code>%</code>) are displayed in the prompt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche ~/git-working/git (git)-[master *+$%] $</pre>
</div>
</div>
<div class="paragraph">
<p>In newer Git versions, the script has a new feature that shows the relationship to the upstream branch (<code>@{upstream}</code>).
Enable this feature by setting <code>GIT_PS1_SHOWUPSTREAM</code> to the value <code>git</code>.&#8288;<sup class="footnote">[<a id="_footnoteref_134" class="footnote" href="#_footnotedef_134" title="View footnote.">134</a>]</sup> The prompt then signals all states described in Section 5.5.2, "Comparison with the Upstream": <em>up-to-date</em> with the equal sign (<code>=</code>); <em>ahead</em> with the greater-than sign (<code>&gt;</code>); <em>behind</em> with the less-than sign (<code>&lt;</code>); <em>diverged</em> with both a greater-than sign and a less-than sign (<code>&gt;&lt;</code>).
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche ~/git-working/git (git)-[master &gt;] $</pre>
</div>
</div>
<div class="paragraph">
<p>This function is implemented with the <code>--count</code> option of the <code>git rev-list</code> plumbing command, which does not exist in old git versions, like 1.7.1.
If you have such an old git version, but a current script and want to use this display anyway, set the value of the environment variable to <code>legacy</code> - the script will then use an alternative implementation that works without the said option.
If you also want to know how far ahead or behind the branch is, add the value <code>verbose</code>.
The prompt will also show the number of different commits:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche ~/git-working/git (git)-[master u+2] $</pre>
</div>
</div>
<div class="paragraph">
<p>The desired values are to be assigned to the environment variable as a list:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GIT_PS1_SHOWUPSTREAM="legacy verbose git"</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.zsh-integration"><a class="anchor" href="#sec.zsh-integration"></a>10.2. Git and the Z-Shell</h3>
<div class="paragraph">
<p>Both completion and prompt functions are always included with the Z-Shell.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Z-Shell has a very useful feature to call man pages: the <code>run-help</code> function.
It is called by default with <code>Esc+H</code> in Emacs mode and displays the man page for the command that is already on the command line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>man[ESC]+[h]</strong>
#Man-Page man(1) is displayed</pre>
</div>
</div>
<div class="paragraph">
<p>However, since Git consists of subcommands and each subcommand has its own man page, <code>run-help</code> does not work very well - only the man page <code>git(1)</code> is displayed.
The included <code>run-help-git</code> function can help here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git rebase[ESC][h]
#Man-Page git(1) is displayed
$ unalias run-help
$ autoload run-help
$ autoload run-help-git
$ git rebase[ESC][h]
#Man-Page git-rebase(1) is displayed</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sec.zsh-completion"><a class="anchor" href="#sec.zsh-completion"></a>10.2.1. Completion</h4>
<div class="paragraph">
<p>To activate completion for Git, first load the completion system:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>autoload -Uz compinit &amp;&amp; compinit</strong></pre>
</div>
</div>
<div class="paragraph">
<p>The completion completes among other things:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Git subcommands</dt>
<dd>
<p>Subcommands are also completed in the Z-Shell.
The difference to Bash is that the Z-Shell displays a short description in addition to the actual command:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git pu[TAB]</strong>
pull     -- fetch from and merge with a remote repository
push     -- update remote refs along with associated objects</pre>
</div>
</div>
<div class="paragraph">
<p>The same applies to subcommands, which themselves have subcommands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git remote [TAB]</strong>
add      -- add a new remote
prune    -- delete all stale tracking branches for a given remote
rename   -- rename a remote from .git/config and update all...
rm       -- remove a remote from .git/config and all...
show     -- show information about a given remote
update   -- fetch updates for a set of remotes</pre>
</div>
</div>
<div class="paragraph">
<p>As well as user aliases:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git t[TAB]</strong>
tag           -- create tag object signed with GPG
tree          -- alias for _log --oneline --graph --decorate -23_</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Local Branches and Tags</dt>
<dd>
<p>The Z-Shell also completes local branches and tags - no difference to Bash.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Configured Remotes</dt>
<dd>
<p>Configured remotes are known to the Z-Shell.
For subcommands where only a configured remote is possible, e.g.&#160;<code>git remote show</code>, only configured remotes are displayed.
If this is not clear, e.g. <code>git pull</code>, additional mechanisms of the Z-Shell take effect and usually a long list is displayed, which consists of the entries in the files <code>.ssh/config</code> (the configured SSH hosts) and <code>.ssh/known_hosts</code> (hosts you have already logged in to).</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Options</dt>
<dd>
<p>Unlike Bash, Z-Shell knows both long and short options and shows them including a short description of the option.
Here is an excerpt:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git branch -[TAB]</strong>
-a              -- list both remote-tracking branches and local branches
--contains      -- only list branches which contain the specified commit
--force     -f  -- force the creation of a new branch</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Files</dt>
<dd>
<p>The Z-Shell is also able to complete file names - but it is a bit smarter than Bash.
For example, for <code>git add</code> and <code>git checkout</code>, only files that actually have changes are offered - files that can either be added to the index or reset.
Files that do not qualify are not offered either.</p>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Git configuration options</dt>
<dd>
<p>Like Bash, the Z-Shell completion for Git completes all configuration options for Git.
The difference is that it also includes a short description of the options:</p>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git config user.[TAB]</strong>
email        -- email address used for commits
name         -- full name used for commits
signingkey   -- default GPG key to use when creating signed tags</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A big difference with the Z-Shell is the way it is completed.
The Z-Shell uses the so-called <em>menu completion</em>.
This means that the Z-Shell offers you the next possible completion by pressing the Tab key again.&#8288;<sup class="footnote">[<a id="_footnoteref_135" class="footnote" href="#_footnotedef_135" title="View footnote.">135</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git pu[TAB]</strong>
pull  -- fetch from and merge with another repository or local branch
push  -- update remote refs along with associated objects
$ <strong>git pu[TAB]</strong>
$ <strong>git pull[TAB]</strong>
$ git push</pre>
</div>
</div>
<div class="paragraph">
<p>The Z-Shell is not (yet) able to complete references on the remote side - but this is on the to-do list.
But the Z-Shell is already able to complete files over an SSH connection.
This is especially useful in connection with public key authentication and preconfigured SSH hosts.
Assume you have configured the following host in <code>.ssh/config</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Host example
    HostName git.example.com
    User max</pre>
</div>
</div>
<div class="paragraph">
<p>On the server in your home directory your projects are located as bare repositories: <code>project1.git</code> and <code>project2.git</code>.
You also generated an SSH key and stored it in the <code>.ssh/authorized_keys</code> file on the server.
You can now use completion across the SSH connection.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git clone example:[TAB]</strong>
projekt1.git/ projekt2.git/</pre>
</div>
</div>
<div class="paragraph">
<p>This is made possible by the completion functions of the Z-shell for <code>ssh</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.zsh-prompt"><a class="anchor" href="#sec.zsh-prompt"></a>10.2.2. Prompt</h4>
<div class="paragraph">
<p>The Z-Shell contains functions to add git info to the prompt.
The functionality is part of the extensive <code>vcs_info</code> system, which knows about a dozen other version control programs besides Git, including Subversion, CVS and Mercurial.
Detailed documentation can be found in the <code>zshcontrib(1)</code> man page, in the &#8220;Gathering Information From Version Control Systems&#8221; section.
Here we will only present the settings and customization options relevant to Git.</p>
</div>
<div class="paragraph">
<p>First, you need to load <code>vcs_info</code> and adjust the prompt to display Git info.
It&#8217;s important that the Z-Shell option <code>prompt_subst</code> is set; it ensures that variables in the prompt are actually replaced, and you must call <code>vcs_info</code> in the <code>precmd</code> function.
<code>precmd</code> is called just before the prompt is displayed.
The call <code>vcs_info</code> in it makes sure that the git info is actually stored in the variable <code>${vcs_info_msg_0_}</code>.
Add the following lines to your <code>.zshrc</code> if they are not already included:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># load vcs_info
autoload -Uz vcs_info
# activate prompt_subst
setopt prompt_subst
# define precmd
precmd () { vcs_info }
# Set prompt
PS1=_%n@%m %~${vcs_info_msg_0_} $ _</pre>
</div>
</div>
<div class="paragraph">
<p>The prompt is composed as follows: <code>%n</code> is the username, <code>%m</code> is the hostname, <code>%~</code> is the current working directory, and the variable <code>${vcs_info_msg_0_}</code> contains the git info.
It is important that the prompt is specified with single quotes.
This saves the <em>string</em>&#160;<code>${vcs_info_msg_0_}</code> and not the value of the variable.
Only when the prompt is displayed is the value of the variable - i.e. the git info - substituted.</p>
</div>
<div class="paragraph">
<p>The above setting for <code>PS1</code> looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche ~/git-working/git (git)-[master]- $</pre>
</div>
</div>
<div class="paragraph">
<p>Since <code>vcs_info</code> works with a lot of version control systems, it&#8217;s worth activating only those you actually use:&#8288;<sup class="footnote">[<a id="_footnoteref_136" class="footnote" href="#_footnotedef_136" title="View footnote.">136</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>zstyle _:vcs_info:*_ enable git</pre>
</div>
</div>
<div class="paragraph">
<p>To customize <code>vcs_info</code>, use a so-called <code>zstyle</code>, a hierarchical configuration mechanism of the z-shell described in the <code>zshmodules(1)</code> man page.</p>
</div>
<div class="paragraph">
<p>Special states like merge or rebase operations are signaled accordingly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche ~/git-working/git (git)-[master|bisect]- $</pre>
</div>
</div>
<div class="paragraph">
<p>Also in case of a Detached-HEAD either the tag or the abbreviated SHA-1 sum is displayed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche ~/git-working/git (git)-[v1.7.1.4] $
esc@creche ~/git-working/git (git)-[e760924...] $</pre>
</div>
</div>
<div class="paragraph">
<p>The Z-Shell, like the Bash, can display states of the working tree.
Switch this on with the following line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>zstyle _:vcs_info:git*:*_ check-for-changes true</pre>
</div>
</div>
<div class="paragraph">
<p>For example, <code>vcs_info</code> shows a <code>U</code> for changes that are not yet in the index (<em>unstaged</em>) and an <code>S</code> for changes that you have included in the index (<em>staged</em>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche ~/git-working/git (git)-[master]US- $</pre>
</div>
</div>
<div class="paragraph">
<p>A big advantage of <code>vcs_info</code> is that it can be adapted very easily.
For example, if you do not like the letters <code>U</code> and <code>S</code>, you can replace them with other characters, e.g.&#160;<code>*</code> and <code>+</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>zstyle _:vcs_info:git*:*_ unstagedstr _*_
zstyle _:vcs_info:git*:*_ stagedstr _+_</pre>
</div>
</div>
<div class="paragraph">
<p>Thus the Zsh prompt now looks more and more like the example from the section on bash:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche ~/git-working/git (git)-[master]*+- $</pre>
</div>
</div>
<div class="paragraph">
<p>To display such not yet stored information <code>vcs_info</code> must always examine the working tree. Since this is known to cause problems with large repositories, you can exclude certain patterns:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>zstyle _:vcs_info:*_ disable-patterns "/home/esc/git-working/linux-2.6(|/*)"</pre>
</div>
</div>
<div class="paragraph">
<p>Maybe you want to change the order of the characters.
In this case you need to adjust two format string expressions: <code>formats</code> and <code>actionformats</code>.
The first is the default format, the second is the format when you are in the middle of a merge, rebase or similar process:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>zstyle _:vcs_info:git*:*_ formats " (%s)-[%b%u%c]"
zstyle _:vcs_info:git*:*_ actionformats " (%s)-[%b|%a%u%c]"</pre>
</div>
</div>
<div class="paragraph">
<p>A selection of the most important characters can be found in the following table.
For a detailed list, please refer to the above mentioned man page.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>%s</code></dt>
<dd>
<p>version management system, in our case always <code>git</code></p>
</dd>
<dt class="hdlist1"><code>%b</code></dt>
<dd>
<p>Current branch, e.g.&#160;<code>master</code></p>
</dd>
<dt class="hdlist1"><code>%a</code></dt>
<dd>
<p>Current process, e.g.&#160;<code>merge</code> or <code>rebase-i</code> (only for <code>actionformats</code>)</p>
</dd>
<dt class="hdlist1"><code>%u</code></dt>
<dd>
<p>Character to indicate changes that are not yet in the index, e.g.&#160;<code>U</code></p>
</dd>
<dt class="hdlist1"><code>%c</code></dt>
<dd>
<p>Character to indicate changes that are already in the index, e.g.&#160;<code>S</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>With the above setting the prompt will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche ~/git-working/git (git)-[master*+] $</pre>
</div>
</div>
<div class="paragraph">
<p>Unfortunately <code>vcs_info</code> cannot signal the existence of unknown files and created stashes by default.
But since Z-Shell version 4.3.11 the system supports so called <em>hooks</em>&#8201;&#8212;&#8201;extensions, which inject additional information into the prompt.
We will now introduce two such hooks, which implement the two missing features mentioned above.</p>
</div>
<div class="paragraph">
<p>The hooks for <code>vcs_info</code> are written as shell functions.
Note that the function name has the prefix <code>+vi-</code> to avoid possible collisions.
For a hook to really work it has to change a value in the associative array <code>hook_com</code>.
In both examples we change the value of the entry <code>staged</code> by appending additional characters to mark certain states.
We use the percent sign (<code>%</code>) to indicate unknown files and the dollar sign (<code>$</code>) for created stashes.
The percent sign must be specified twice to prevent the Z-Shell from mistakenly interpreting it as formatting.
For the hooks we use various plumbing commands (see <a href="#sec.scripting">Section 8.3, &#8220;Writing your own Git commands&#8221;</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>+vi-untracked(){
    if [[ $(git rev-parse --is-inside-work-tree 2&gt; /dev/null) == _true_ ]] &amp;&amp; \
        [[ -n $(git ls-files --others --exclude-standard) ]] ; then
        hook_com[staged]+=_%%_
    fi
}
+vi-stashed(){
    if git rev-parse --verify refs/stash &amp;&gt; /dev/null ; then
        hook_com[staged]+=_$_
    fi
}</pre>
</div>
</div>
<div class="paragraph">
<p>We activate the hooks so that they are evaluated when the git info is set (<code>+set-message</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>zstyle _:vcs_info:git*+set-message:*_ hooks stashed untracked</pre>
</div>
</div>
<div class="paragraph">
<p>As in the bash example above, four additional characters (<code>*</code>, <code>+</code>, <code>$</code> and <code>%</code>) may be displayed in the prompt (<em>unstaged</em>, <em>staged</em>, <em>stashed</em> and <em>untracked</em>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>esc@creche ~/git-working/git (git)-[master*+$%] $</pre>
</div>
</div>
<div class="paragraph">
<p>With such hooks it is possible to extend the prompt as desired.
For example, <code>vcs_info</code> does not show by default whether you are inside the <code>$GIT_DIR</code> or in a bare repository.
With an appropriate hook you can include these signals in the prompt.</p>
</div>
<div class="paragraph">
<p>For more examples, see the <code>Misc/vcs_info-examples</code> file in the Z-Shell repository, including a hook that indicates the upstream branch relationship (section &#8220;Compare local changes to remote changes&#8221;).
A minimal configuration for the Z-Shell according to the examples in this section can be found in the Scripts Collection for this book.&#8288;<sup class="footnote">[<a id="_footnoteref_137" class="footnote" href="#_footnotedef_137" title="View footnote.">137</a>]</sup></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch.github"><a class="anchor" href="#ch.github"></a>11. GitHub</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are currently several hosting sites that offer free git hosting for open source projects.
By far the best known of all is <em>Github</em>.&#8288;<sup class="footnote">[<a id="_footnoteref_138" class="footnote" href="#_footnotedef_138" title="View footnote.">138</a>]</sup>
Two other well-known pure git hosters are <em>Gitorious</em>&#8288;<sup class="footnote">[<a id="_footnoteref_139" class="footnote" href="#_footnotedef_139" title="View footnote.">139</a>]</sup> and <em>repo.or.cz</em>.&#8288;<sup class="footnote">[<a id="_footnoteref_140" class="footnote" href="#_footnotedef_140" title="View footnote.">140</a>]</sup>
But also already established hosting sites like <em>Sourceforge</em>&#8288;<sup class="footnote">[<a id="_footnoteref_141" class="footnote" href="#_footnotedef_141" title="View footnote.">141</a>]</sup> and <em>Berlios</em>&#8288;<sup class="footnote">[<a id="_footnoteref_142" class="footnote" href="#_footnotedef_142" title="View footnote.">142</a>]</sup> now offer Git hosting.</p>
</div>
<div class="paragraph">
<p>Github was founded in 2008 by Chris Wanstrath, P.J. Hyett and Tom Preston-Werner.
The platform developed in Ruby on Rails has over three million users and hosts over ten million repositories.
Even if you consider that many of these repositories are so-called <em>Forks</em> (clones) of other repositories or so-called <em>Gists</em> (source code snippets), this is still a considerable number.
Many well-known projects use Github nowadays to manage their source code, among others the command line tool <em>Curl</em>,&#8288;<sup class="footnote">[<a id="_footnoteref_143" class="footnote" href="#_footnotedef_143" title="View footnote.">143</a>]</sup> the web framework <em>Ruby on Rails</em>&#8288;<sup class="footnote">[<a id="_footnoteref_144" class="footnote" href="#_footnotedef_144" title="View footnote.">144</a>]</sup> and the JavaScript library <em>jQuery</em>.&#8288;<sup class="footnote">[<a id="_footnoteref_145" class="footnote" href="#_footnotedef_145" title="View footnote.">145</a>]</sup></p>
</div>
<div class="paragraph">
<p>The free offer includes unlimited Git repositories&#8201;&#8212;&#8201;with the restriction that these are publicly available (<em>public repositories</em>).
In addition, Github offers paid options for individuals and companies to create and use restricted access repositories (private repositories).
For large companies, Github offers a solution called <em>GitHub Enterprise</em>.</p>
</div>
<div class="paragraph">
<p>GitHub offers all the essential features you expect from a project hosting platform, including project wikis and issue trackers.
But the special thing about it is that the wiki system <em>Gollum</em>&#8288;<sup class="footnote">[<a id="_footnoteref_146" class="footnote" href="#_footnotedef_146" title="View footnote.">146</a>]</sup> does not use a database as backend, but only a Git repository.
As markup, Github offers several syntax options,&#8288;<sup class="footnote">[<a id="_footnoteref_147" class="footnote" href="#_footnotedef_147" title="View footnote.">147</a>]</sup> including <em>Markdown</em>, <em>Textile</em>, <em>Mediawiki</em> and <em>AsciiDoc</em>.</p>
</div>
<div class="paragraph">
<p>The issue tracker is designed for Git and also lists pull requests created via the web interface.
Additionally, an email backend has been integrated into the issue tracker.
Your responses to the incoming emails are automatically processed by GitHub and also displayed in the web interface.
But what GitHub does not offer are mailing lists&#8201;&#8212;&#8201;for that you have to use alternatives.</p>
</div>
<div id="fig.github-gollum" class="imageblock">
<div class="content">
<img src="images/github-gollum.png" alt="github gollum" width="100%">
</div>
<div class="title">Figure 58. GitHub page from Gollum</div>
</div>
<div class="paragraph">
<p><a href="#fig.github-gollum">Figure 58, &#8220;GitHub page from Gollum&#8221;</a> shows a section of the Gollum project page.
Important are the menu items <em>Source</em> (source code overview), <em>Commits</em>, <em>Network</em> (forums of the project with changes), <em>Pull-Requests</em>, <em>Issues</em>, <em>Wiki</em> and <em>Graphs</em> (statistical graphs).
Other important controls are the button <em>Fork</em> as well as <em>Downloads</em> and also the display of the clone URL.</p>
</div>
<div class="paragraph">
<p>With GitHub, the developer is the focus of attention: repositories are always assigned to users.
This is a big difference to established hosting platforms, where projects are always the main focus and users are subordinate to them.
(However, it is also possible to create project accounts in GitHub, to which users are then assigned in turn&#8201;&#8212;&#8201;popular with private repositories and larger projects).</p>
</div>
<div class="paragraph">
<p>GitHub offers many ways to share changes.
While it is possible to take a centralized approach with GitHub (see <a href="#fig.central-workflow">Figure 30, &#8220;Central workflow with distributed version management&#8221;</a>) by giving others access to your own repositories, the most common form of sharing is an Integration Manager workflow (see <a href="#fig.developer-public-workflow">Figure 37, &#8220;Integration Manager Workflow&#8221;</a>).</p>
</div>
<div id="fig.github-workflow" class="imageblock text-center">
<div class="content">
<img src="images/github-workflow.svg" alt="github workflow" width="70%">
</div>
<div class="title">Figure 59. Workflow at GitHub</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A potential contributor <em>forks</em>&#8288;<sup class="footnote">[<a id="_footnoteref_148" class="footnote" href="#_footnotedef_148" title="View footnote.">148</a>]</sup> a repository at GitHub.</p>
</li>
<li>
<p>The public repository is then cloned and changes are made.</p>
</li>
<li>
<p>Commits are uploaded to the public repository.</p>
</li>
<li>
<p>A pull request is sent to the project author.
As already mentioned, these can be created and sent directly in the web interface.</p>
</li>
<li>
<p>The author loads the changes from the public repository, checks whether they meet his quality standards and integrates them locally via merge or cherry pick if necessary.</p>
</li>
<li>
<p>The contributor&#8217;s changes are uploaded to the author&#8217;s public repository and thus merged with the software.</p>
</li>
<li>
<p>The contributor synchronizes his local repository with the author&#8217;s public repository.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The GitHub web interface offers a lot of Web 2.0 comfort.
For example, instead of steps 5. and 6. you can merge directly via the web interface with a single click.
Of course the system checks if the merge can be done without conflicts&#8201;&#8212;&#8201;if not, a warning will appear instead of the merge option.</p>
</div>
<div class="paragraph">
<p>Since recently it is also possible to perform steps 1, 2, 3 and 4 completely in the web interface.
To do this, click on the button <em>Fork and edit this file</em> in a foreign repository&#8201;&#8212;&#8201;the repository will be automatically forked for your user account, and a web-based editor will open, where you can enter your changes and a commit message.
You will then be automatically redirected to the pull-request page.</p>
</div>
<div class="paragraph">
<p>Since you can quickly lose track of many forks, GitHub provides a graphical representation of the forks with pending changes, the so-called <em>network graph</em>:</p>
</div>
<div id="fig.github-network" class="imageblock">
<div class="content">
<img src="images/github-network.png" alt="github network" width="100%">
</div>
<div class="title">Figure 60. The GitHub Network-Graph</div>
</div>
<div class="paragraph">
<p>Github offers even more visualizations under <em>Graphs</em>.
Under <em>Languages</em> you can see which programming languages the project uses.
The <em>Impact</em> graph shows which developer has done when and how much.
<em>Punchcard</em> shows the commit activity for weekdays and times of day.
<em>Traffic</em> finally lists the number of project page views during the last three months.</p>
</div>
<div class="paragraph">
<p>As the slogan <em>Social Coding</em> suggests, GitHub has several features that you can also find in social networks.
For example, you can follow both individual users and repositories.
You will then receive a kind of GitHub news ticker in your <em>dashboard</em>: messages about new and closed pull requests, new commits that have been uploaded, forks, etc.
The news feeds of the users and repositories are also available as RSS feeds, if you prefer external newsreaders.</p>
</div>
<div class="paragraph">
<p>A small, still relatively unknown project can therefore become known very quickly via GitHub when a critical number of &#8220;followers&#8221; is reached.</p>
</div>
<div class="paragraph">
<p>GitHub also offers a pastebin service, the <em>Gist</em>.
However, unlike other Pastebin services, GiThub&#8217;s gist is a full-fledged Git repository.
Especially for code snippets this is an interesting innovation.</p>
</div>
<div class="paragraph">
<p>GitHub also does a good job when connecting to external services.
There are 50 so-called <em>service hooks</em> that you can use to forward messages concerning a repository to external services.
Among them are old classics like e-mail and IRC, but also more modern alternatives like Twitter and Jabber.</p>
</div>
<div class="paragraph">
<p>But GitHub also offers additional &#8220;gimmicks&#8221; that are very handy.
So tags automatically become source code archives for download.
As you can see in <a href="#fig.github-downloads">Figure 61, &#8220;Downloads created from tags&#8221;</a>, both as <code>.tar.gz</code> and <code>.zip</code> archives.</p>
</div>
<div id="fig.github-downloads" class="imageblock">
<div class="content">
<img src="images/github-download.png" alt="github download" width="65%">
</div>
<div class="title">Figure 61. Downloads created from tags</div>
</div>
<div class="paragraph">
<p>For developers who often work with images, GitHub offers so-called <em>Image View Modes</em>.&#8288;<sup class="footnote">[<a id="_footnoteref_149" class="footnote" href="#_footnotedef_149" title="View footnote.">149</a>]</sup>
They show differences between two versions of an image, similar to the script introduced in <a href="#sec.external-diff">Section 8.1.3, &#8220;Own diff programs&#8221;</a>.
There are the following modes:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>2-up</em> </dt>
<dd>
<p>The two different versions are displayed side by side, see <a href="#fig.github-2up">Figure 62, &#8220;The <em>2-up</em> image mode&#8221;</a>.
Differences in size are also visible.</p>
<div id="fig.github-2up" class="imageblock">
<div class="content">
<img src="images/github-image-diff-2up.png" alt="github image diff 2up" width="90%">
</div>
<div class="title">Figure 62. The <em>2-up</em> image mode</div>
</div>
</dd>
<dt class="hdlist1"><em>Swipe</em> </dt>
<dd>
<p>The image is split in the middle.
On the left you see the old version and on the right the new one.
Move the slider back and forth to see the changes.
See <a href="#fig.github-swipe">Figure 63, &#8220;The <em>swipe</em> image mode&#8221;</a>.</p>
<div id="fig.github-swipe" class="imageblock">
<div class="content">
<img src="images/github-image-diff-swipe.png" alt="github image diff swipe" width="90%">
</div>
<div class="title">Figure 63. The <em>swipe</em> image mode</div>
</div>
</dd>
<dt class="hdlist1"><em>Onion Skin</em> </dt>
<dd>
<p>A slider is also used here, but this time the new version is faded in, so there is a smooth transition between old and new.</p>
</dd>
<dt class="hdlist1"><em>Difference</em> </dt>
<dd>
<p>Displays only the pixels that have been modified.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The programmers behind GitHub continue to refine the web interface and so innovative improvements are added regularly.
The site has its own help page,&#8288;<sup class="footnote">[<a id="_footnoteref_150" class="footnote" href="#_footnotedef_150" title="View footnote.">150</a>]</sup> where steps with the webinterface are explained in detail with screenshots.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="app.installation"><a class="anchor" href="#app.installation"></a>Appendix A: Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Installing Git is easy and fast, as it comes with pre-configured packages for most systems.
For the sake of completeness, however, we&#8217;ll document the most important steps under Linux, Mac OS X, and Windows.</p>
</div>
<div class="sect2">
<h3 id="linux"><a class="anchor" href="#linux"></a>A.1. Linux</h3>
<div class="paragraph">
<p>Due to the large number of Linux distributions only the installation on Debian, Fedora and Gentoo systems is described here.
For other distributions, please refer to the documentation or the package management system, if necessary; of course, you can also compile and install Git from source code.</p>
</div>
<div class="sect3">
<h4 id="sec.debian-ubuntu"><a class="anchor" href="#sec.debian-ubuntu"></a>A.1.1. Debian/Ubuntu</h4>
<div class="paragraph">
<p>Debian and Ubuntu provide ready-to-use packages that can be installed comfortably and quickly with the Debian package management system.
The git installation is modularized, so you can install only certain parts of git if necessary.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>git</code></dt>
<dd>
<p>main package, contains core commands (formerly <code>git-core</code>)</p>
</dd>
<dt class="hdlist1"><code>git-email</code> </dt>
<dd>
<p>Add-on for sending patches by e-mail</p>
</dd>
<dt class="hdlist1"><code>git-gui</code> </dt>
<dd>
<p>Graphical user interface</p>
</dd>
<dt class="hdlist1"><code>git-svn</code></dt>
<dd>
<p>subcommand <code>svn</code> to interact with Subversion repositories</p>
</dd>
<dt class="hdlist1"><code>git-cvs</code> </dt>
<dd>
<p>Interaction with CVS</p>
</dd>
<dt class="hdlist1"><code>git-doc</code></dt>
<dd>
<p>documentation (will be installed under <code>/usr/share/doc</code>)</p>
</dd>
<dt class="hdlist1"><code>gitk</code> </dt>
<dd>
<p>Program Gitk</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>There is also a meta-package <code>git-all</code> which installs all relevant packages.
So on a regular workstation you should install Git as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>sudo aptitude install git-all</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Under Ubuntu you can install the package <code>git-all</code> via the graphical package manager <em>Synaptic</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.fedora"><a class="anchor" href="#sec.fedora"></a>A.1.2. Fedora</h4>
<div class="paragraph">
<p>On a Fedora system, you should install Git using the package manager <code>yum</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>sudo yum install git</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Analogous to the division into smaller packages as in Debian, certain additional features for Git are available in separate packages.
To install all commands, you should install the <code>git-all</code> package.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec.gentoo"><a class="anchor" href="#sec.gentoo"></a>A.1.3. Gentoo</h4>
<div class="paragraph">
<p>Gentoo provides the ebuild <code>dev-vcs/git</code>.
The graphical tool for creating commits (<code>git gui</code>) and the add-on for sending emails (<code>git send-email</code>) are installed by default.
If you want to have a graphical user interface for viewing and editing the history (<code>gitk</code>) in addition, enable the <em>USE flag</em>&#160;`tk`.
If you plan to use the Subversion interface, enable the <code>subversion</code> USE flag.
To install via Portage, type the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>sudo emerge dev-vcs/git</strong></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec.quellcode-installation"><a class="anchor" href="#sec.quellcode-installation"></a>A.1.4. Installation from the sources</h4>
<div class="paragraph">
<p>If your distribution doesn&#8217;t provide a package for Git, it&#8217;s outdated, or you don&#8217;t have root privileges on the system, you should install Git directly from source.</p>
</div>
<div class="paragraph">
<p>Git depends on the five libraries <code>expat</code> (XML parser), <code>curl</code> (data transfer), <code>zlib</code> (compression), <code>pcre</code> (regular expressions) and <code>openssl</code> (encryption/hashing).
You may need to compile their sources and install the libraries accordingly before proceeding.</p>
</div>
<div class="paragraph">
<p>First download the tarball of the current Git version&#8288;<sup class="footnote">[<a id="_footnoteref_151" class="footnote" href="#_footnotedef_151" title="View footnote.">151</a>]</sup> and unzip it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>wget https://www.kernel.org/pub/software/scm/git/git-2.1.0.tar.gz</strong>
$ <strong>tar xvf git-2.1.0.tar.gz</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Now change to the <code>git-2.1.0/</code> directory and compile the source code; then run <code>make install</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>cd git-2.1.0/</strong>
$ <strong>make -j8</strong>
$ <strong>make install</strong></pre>
</div>
</div>
<div class="paragraph">
<p>With <code>make prefix=&lt;prefix&gt;</code> you can install Git to <code>&lt;prefix&gt;</code> (default: <code>$HOME</code>).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.osx"><a class="anchor" href="#sec.osx"></a>A.2. Mac OS X</h3>
<div class="paragraph">
<p>The <em>Git for OS X</em> project provides an installation program in disk image format (DMG).&#8288;<sup class="footnote">[<a id="_footnoteref_152" class="footnote" href="#_footnotedef_152" title="View footnote.">152</a>]</sup>
So you can install it as usual.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec.windows"><a class="anchor" href="#sec.windows"></a>A.3. Windows</h3>
<div class="paragraph">
<p>The project <em>Git for Windows</em> provides an installation program for Microsoft Windows: <em>msysGit</em>.
You can download the program&#8288;<sup class="footnote">[<a id="_footnoteref_153" class="footnote" href="#_footnotedef_153" title="View footnote.">153</a>]</sup> and install it as usual.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="app.git-repository-layout"><a class="anchor" href="#app.git-repository-layout"></a>Appendix B: Repository Structure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Git stores the object database, the associated references, etc. in the so-called <em>Git directory</em>, often referred to as <code>$GIT_DIR</code>.
By default, this is <code>.git/</code>.
It exists only once for each Git repository, i.e. no additional <code>.git/</code> directories are created in subdirectories.&#8288;<sup class="footnote">[<a id="_footnoteref_154" class="footnote" href="#_footnotedef_154" title="View footnote.">154</a>]</sup>
Among other things, it contains the following entries:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>HEAD</code> 
</td>
<td class="hdlist2">
<p>The <code>HEAD</code>, see <a href="#sec.branch-refs">Section 3.1.1, &#8220;HEAD and Other Symbolic References&#8221;</a>.
Besides <code>HEAD</code>, other important symbolic references may be stored on the top level, e.g.&#160;<code>ORIG_HEAD</code> or <code>FETCH_HEAD</code>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>config</code> 
</td>
<td class="hdlist2">
<p>The repository configuration file, see <a href="#chap.git-config">Section 1.3, &#8220;Configuring Git&#8221;</a>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>hooks/</code> 
</td>
<td class="hdlist2">
<p>Contains the hooks set for this repository, see <a href="#sec.hooks">Section 8.2, &#8220;Hooks&#8221;</a>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>index</code> 
</td>
<td class="hdlist2">
<p>The index or stage, see <a href="#sec.index">Section 2.1.1, &#8220;Index&#8221;</a>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>info/</code> 
</td>
<td class="hdlist2">
<p>Additional repository information, such as patterns to be ignored (see <a href="#sec.ignore">Section 4.4, &#8220;Ignore files&#8221;</a>) and also grafts (see <a href="#sec.fb-grafts">Section 8.4.3, &#8220;Grafts: Subsequent Merges&#8221;</a>).
You can put your own information there if other tools can handle it (see e.g. the section on caching of CGit, <a href="#sec.cgit-cache">Section 7.5.4, &#8220;Exploiting Caching&#8221;</a>).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>logs/</code> 
</td>
<td class="hdlist2">
<p>Log of changes to references; accessible via Reflog, see <a href="#sec.reflog">Section 3.7, &#8220;Reflog&#8221;</a>.
Contains a log file for each reference under <code>refs/</code> and <code>HEAD</code>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>objects/</code> 
</td>
<td class="hdlist2">
<p>The object database, see <a href="#sec.od">Section 2.2.3, &#8220;The Object Database&#8221;</a>.
For performance reasons, the objects are sorted into subdirectories that correspond to a two-character prefix of their SHA-1 sum (the commit <code>0a7ba55&#8230;&#8203;</code> is stored below <code>0a/7ba55&#8230;&#8203;</code>).
In the subdirectory <code>pack/</code> you will find the packfiles and associated indices, which are created by the garbage collection (see below).
In the <code>info/</code> subdirectory, Git will store a list of existing pack files if required.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>refs/</code> 
</td>
<td class="hdlist2">
<p>All references, including branches in <code>refs/heads/</code>, see <a href="#sec.branch-refs">Section 3.1.1, &#8220;HEAD and Other Symbolic References&#8221;</a>, tags in <code>refs/tags/</code>, see <a href="#sec.tags">Section 3.1.3, &#8220;Tags&#8201;&#8212;&#8201;Marking Important Versions&#8221;</a>, and remote tracking branches under <code>refs/remotes/</code>, see <a href="#sec.remote-tracking-branches">Section 5.2.2, &#8220;Remote-Tracking-Branches&#8221;</a>.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A detailed technical description can be found in the man page <code>gitrepository-layout(5)</code>.</p>
</div>
<div id="fig.git-dir-listing" class="imageblock">
<div class="content">
<img src="images/git-dir-crop.png" alt="git dir crop" width="20%">
</div>
<div class="title">Figure 64. The most important entries in <code>.git/</code></div>
</div>
<div class="sect2">
<h3 id="sec.gc"><a class="anchor" href="#sec.gc"></a>B.1. Cleaning up</h3>
<div class="paragraph">
<p>As mentioned in <a href="#sec.branch-management">Section 3.1.2, &#8220;Managing Branches&#8221;</a>, for example, commits that are no longer referenced (whether by branches or other commits) are no longer accessible.
This is usually the case if you wanted to delete a commit (or have rebuilt commits with Rebase).
Git does not delete them from the object database immediately, but leaves them there for two weeks by default, even if they are no longer accessible.</p>
</div>
<div class="paragraph">
<p>Internally, Git uses the commands <code>prune</code>, <code>prune-packed</code>, <code>fsck</code>, <code>repack</code>, etc.
However, the tools are automatically executed by the <em>garbage collection</em> with appropriate options: <code>git gc</code>.
The tool performs the following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Delete <em>Dangling</em> and <em>Unreachable Objects</em>.
These occur during various operations and can usually be deleted after some time to save space (default: after two weeks).</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Re-pack <em>Loose Objects</em>.
Git uses so-called <em>packfiles</em> to pack several Git objects together.
(Then there is no longer one file under <code>.git/objects/</code> per blob, tree and commit&#8201;&#8212;&#8201;these are combined into one large, <em>zlib</em>-compressed file).</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Search existing packfiles for old (unreachable) objects and &#8220;thin out&#8221; the packfiles accordingly.
If necessary, several small packfiles are combined to large ones.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Packing references.
This results in so-called <em>Packed Refs</em>, see also <a href="#sec.branches">Section 3.1, &#8220;References: Branches and Tags&#8221;</a>.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Delete old Reflog entries.
By default this happens after 90 days.</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Old conflict resolutions (see Rerere, <a href="#sec.rerere">Section 3.4.2, &#8220;rerere: Reuse Recorded Resolution&#8221;</a>) are discarded (15/60 days hold time for unresolved/solved).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The garbage collection has three modes: automatic, normal and aggressive.
You call the automatic mode via <code>git gc --auto</code>&#8201;&#8212;&#8201;the mode checks if there are really blatant flaws in the Git repository.
What &#8220;blatant&#8221; means is configurable.
The following configuration settings allow you to determine (globally or per repository) when, i.e. how many &#8220;small&#8221; files the automatic mode will clean up, i.e. how many files will be grouped into large archives.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>gc.auto</code> (Default: 6700 objects) </dt>
<dd>
<p>Combine objects into a packfile.</p>
</dd>
<dt class="hdlist1"><code>gc.autopacklimit</code> (Default: 50 packs) </dt>
<dd>
<p>Combine packs into one large pack file.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The automatic mode is often called, among others by <code>receive-pack</code> and <code>rebase</code> (interactive).
In most cases the automatic mode does nothing, because the defaults are very conservative.
If it does, it looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git gc --auto</strong>
Auto packing the repository for optimum performance. You may also
run "git gc" manually. See "git help gc" for more information.
...</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec.gc-performance"><a class="anchor" href="#sec.gc-performance"></a>B.2. Performance</h3>
<div class="paragraph">
<p>You should either significantly lower the thresholds above which the automatic garbage collection takes effect, or call <code>git gc</code> from time to time.
This has one obvious advantage, namely that disk space is saved:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>du -sh .git</strong>
20M     .git
$ <strong>git gc</strong>
Counting objects: 3726, done.
Compressing objects: 100% (1639/1639), done.
Writing objects: 100% (3726/3726), done.
Total 3726 (delta 1961), reused 2341 (delta 1279)
Removing duplicate objects: 100% (256/256), done.
$ <strong>du -sh .git</strong>
6.3M    .git</pre>
</div>
</div>
<div class="paragraph">
<p>Individual objects under <code>.git/objects/</code> have been combined into a packfile:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>ls -lh .git/objects/pack/pack-a97624dd23&lt;...&gt;.pack</strong>
-r-------- 1 feh feh 4.6M Jun  1 10:20 .git/objects/pack/pack-a97624dd23&lt;...&gt;.pack
$ <strong>file .git/objects/pack/pack-a97624dd23&lt;...&gt;.pack</strong>
.git/objects/pack/pack-a97624dd23&lt;...&gt;.pack: Git pack, version 2, 3726 objects</pre>
</div>
</div>
<div class="paragraph">
<p>You can use <code>git count-objects</code> to output how many files the object database consists of.
Here side by side before and after the above packing process:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git count-objects -v</strong>
count: 1905                             count: 58
size: 12700                             size: 456
in-pack: 3550                           in-pack: 3726
packs: 7                                packs: 1
size-pack: 4842                         size-pack: 4716
prune-packable: 97                      prune-packable: 0
garbage: 0                              garbage: 0</pre>
</div>
</div>
<div class="paragraph">
<p>Nowadays disk space is cheap, so a repository compressed to 30% is not a big gain.
But the performance gain is not to be scoffed at.
Usually one object (e.g. a commit) will result in further objects (blobs, trees).
So if Git has to open one file per object (i.e. at least <em>n</em> blob objects for <em>n</em> managed files), this means <em>n</em> read operations on the file system.</p>
</div>
<div class="paragraph">
<p>Packfiles have two major advantages: First, Git creates an index for each pack file, which indicates which object is found in which offset of the file.
In addition, the packing routine has a certain heuristic to optimize object placement within the file (so that, for example, a tree object and the blob objects it references are stored &#8220;close&#8221; to each other).
This allows Git to simply map the packfile into memory (keyword: &#8220;sliding mmap&#8221;).
The &#8220;search object X&#8221; operation is then nothing more than a lookup operation in the pack index and a corresponding readout of the location in the pack file, i.e. in memory.
This relieves the file and operating system considerably.</p>
</div>
<div class="paragraph">
<p>The second advantage of packfiles is the delta compression.
This way, objects are stored as <em>deltas</em> (changes) of other objects, if possible.&#8288;<sup class="footnote">[<a id="_footnoteref_155" class="footnote" href="#_footnotedef_155" title="View footnote.">155</a>]</sup>
This saves memory space, but on the other hand also enables commands like <code>git blame</code> to detect copies of code pieces between files &#8220;inexpensively&#8221;, i.e. without much computing effort.</p>
</div>
<div class="paragraph">
<p>The aggressive mode should only be used in justified exceptional cases.&#8288;<sup class="footnote">[<a id="_footnoteref_156" class="footnote" href="#_footnotedef_156" title="View footnote.">156</a>]</sup></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Run a <code>git gc</code> on your publicly accessible repositories on a regular basis, e.g. via cron.
Commits are always transmitted via the git protocol as packfiles, which are generated <em>on demand</em>, i.e. at the time of retrieval.
If the entire repository is already available as one large packfile, parts of it can be extracted more quickly, and a complete clone of the repository does not require any additional computational operations (no huge packfile has to be packed).
A regular garbage collection can therefore reduce the load on your server, and the user cloning process is also accelerated.</p>
</div>
<div class="paragraph">
<p>If the repository is particularly large, it can take a long time for the server to count all objects in a <code>git clone</code>.
You can speed this up by regularly calling <code>git repack -A -d -b</code> from the cron-job: Git will then create a bitmap file in addition to the pack files, speeding up this process by one or two orders of magnitude.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. <a href="https://git-scm.com" class="bare" target="_blank" rel="noopener">https://git-scm.com</a>
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. <a href="http://vger.kernel.org/vger-lists.html#git" class="bare" target="_blank" rel="noopener">http://vger.kernel.org/vger-lists.html#git</a>
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. <a href="https://git.wiki.kernel.org/index.php/Main_Page" class="bare" target="_blank" rel="noopener">https://git.wiki.kernel.org/index.php/Main_Page</a>
</div>
<div class="footnote" id="_footnotedef_4">
<a href="#_footnoteref_4">4</a>. <a href="https://git.wiki.kernel.org/index.php/InterfacesFrontendsAndTools" class="bare" target="_blank" rel="noopener">https://git.wiki.kernel.org/index.php/InterfacesFrontendsAndTools</a>
</div>
<div class="footnote" id="_footnotedef_5">
<a href="#_footnoteref_5">5</a>. <a href="https://git.wiki.kernel.org/index.php/GitFaq" class="bare" target="_blank" rel="noopener">https://git.wiki.kernel.org/index.php/GitFaq</a>
</div>
<div class="footnote" id="_footnotedef_6">
<a href="#_footnoteref_6">6</a>. <a href="https://git.wiki.kernel.org/index.php/GitSvnCrashCourse" class="bare" target="_blank" rel="noopener">https://git.wiki.kernel.org/index.php/GitSvnCrashCourse</a>
</div>
<div class="footnote" id="_footnotedef_7">
<a href="#_footnoteref_7">7</a>. <a href="https://stackoverflow.com" class="bare" target="_blank" rel="noopener">https://stackoverflow.com</a>
</div>
<div class="footnote" id="_footnotedef_8">
<a href="#_footnoteref_8">8</a>. Even if you follow the example exactly, you will not get the same SHA-1 checksums, since they are calculated from the contents of the commit, the author, and the commit time, among other things.
</div>
<div class="footnote" id="_footnotedef_9">
<a href="#_footnoteref_9">9</a>. Alternatively, you can store the user-specific configuration under the XDG-compliant path <code>.config/git/config</code> in your home directory (or relative to your set environment variable <code>$XDG_CONFIG_HOME</code>).
</div>
<div class="footnote" id="_footnotedef_10">
<a href="#_footnoteref_10">10</a>. If available, settings from <code>/etc/gitconfig</code> are also read in (with lowest priority). You can set options in this file using the <code>--system parameter</code>, but you need root privileges to do this. Setting git options system-wide is unusual.
</div>
<div class="footnote" id="_footnotedef_11">
<a href="#_footnoteref_11">11</a>. &#8220;i18n&#8221; is a common abbreviation for the word &#8220;internationalization&#8221;&#8201;&#8212;&#8201;the 18 stands for the number of omitted letters between the first and last letter of the word.
</div>
<div class="footnote" id="_footnotedef_12">
<a href="#_footnoteref_12">12</a>. By default, words are separated by one or more spaces, but you can specify another regular expression to determine what a word is: <code>git diff --word-diff-regex=<regex></code>. See also the <code>git-diff(1)</code> man page.
</div>
<div class="footnote" id="_footnotedef_13">
<a href="#_footnoteref_13">13</a>. This is an instruction for the Kernel, telling it which program to use to interpret the script. Typical shebang lines include <code>&num;!/bin/sh</code> or <code>&num;!/usr/bin/perl</code>.
</div>
<div class="footnote" id="_footnotedef_14">
<a href="#_footnoteref_14">14</a>. Strictly speaking, the <code>-p</code> option leads directly to the <em>patch mode</em> of <code>git add</code>&#8288;&#8217;s <em>interactive mode</em>. However, the interactive mode is rarely used in practice&#8201;&#8212;&#8201;in contrast to the patch mode&#8201;&#8212;&#8201;and is therefore not described further here. The documentation for this can be found in the <code>git add(1)</code> man page in the &#8220;Interactive Mode&#8221; section.
</div>
<div class="footnote" id="_footnotedef_15">
<a href="#_footnoteref_15">15</a>. Git then opens the hunk in an editor; below is a guide to editing the hunk: To delete deleted lines (prefixed with <code>-</code>)&#8201;&#8212;&#8201;i.e. not add them to the index, but keep them in the working tree!&#8201;&#8212;&#8201;replace the minus sign with a space (the line becomes &#8220;context&#8221;). To delete <code>+</code> lines, simply remove them from the hunk.
</div>
<div class="footnote" id="_footnotedef_16">
<a href="#_footnoteref_16">16</a>. However, you can usually not split hunks arbitrarily. At least one line of <em>context</em>, i.e. a line without prefix <code>+</code> or <code>-</code>, must be in between. If you still want to split the hunk, you have to use <code>e</code> for <em>edit</em>.
</div>
<div class="footnote" id="_footnotedef_17">
<a href="#_footnoteref_17">17</a>. You can see this information in <code>gitk</code> or with the command <code>git log --pretty=fuller</code>.
</div>
<div class="footnote" id="_footnotedef_18">
<a href="#_footnoteref_18">18</a>. In fact, Git creates a new commit whose changes are a combination of the changes made to the old commit and the index. The new commit then <em>replaces</em> the old one.
</div>
<div class="footnote" id="_footnotedef_19">
<a href="#_footnoteref_19">19</a>. <code>git rm</code> deletes a file with the next commit, but it remains in the commit history. For information on how to delete a file completely, including from the version history, see <a href="#sec.fb-censor">Section 8.4.1, &#8220;Remove sensitive information afterwards&#8221;</a>.
</div>
<div class="footnote" id="_footnotedef_20">
<a href="#_footnoteref_20">20</a>. This and the following examples are from the Git repository.
</div>
<div class="footnote" id="_footnotedef_21">
<a href="#_footnoteref_21">21</a>. You can download the Git repository, which is examined in detail on the following pages, with the command:<br> <code>git clone git://github.com/gitbuch/objektmodell-beispiel.git</code>
</div>
<div class="footnote" id="_footnotedef_22">
<a href="#_footnoteref_22">22</a>. <a href="https://en.wikipedia.org/wiki/SHA-1" class="bare" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/SHA-1</a>, &#8220;Attacks&#8221;.
</div>
<div class="footnote" id="_footnotedef_23">
<a href="#_footnoteref_23">23</a>. <a href="https://web.archive.org/web/20120701221412/http://kerneltrap.org/mailarchive/git/2006/8/27/211001" class="bare" target="_blank" rel="noopener">https://web.archive.org/web/20120701221412/http://kerneltrap.org/mailarchive/git/2006/8/27/211001</a>
</div>
<div class="footnote" id="_footnotedef_24">
<a href="#_footnoteref_24">24</a>. The technical documentation is provided in the man page <code>gittutorial-2(7)</code>.
</div>
<div class="footnote" id="_footnotedef_25">
<a href="#_footnoteref_25">25</a>. The tag object is not shown here because it is not necessary for understanding the object structure. Instead, you will find it in <a href="#fig.tag-object">Figure 12, &#8220;The Tag Object&#8221;</a>.
</div>
<div class="footnote" id="_footnotedef_26">
<a href="#_footnoteref_26">26</a>. Git stores all objects under <code>.git/objects</code>. A distinction is made between <em>loose objects</em> and <em>packfiles</em>. &#8220;Loose&#8221; objects store the content in a file whose name corresponds to the SHA-1 sum of the content (Git stores one file per object). In contrast, packfiles are compressed <em>archives</em> of many objects. This is done for performance reasons: Not only is the transfer or storage of these archives more efficient, but the file system is also relieved.
</div>
<div class="footnote" id="_footnotedef_27">
<a href="#_footnoteref_27">27</a>. Internally, of course, Git has mechanisms to recognize blobs as deltas of other blobs and to tie them together to <em>packfiles</em> to save space.
</div>
<div class="footnote" id="_footnotedef_28">
<a href="#_footnoteref_28">28</a>. These two properties, <em>directional</em> and <em>acyclic</em>, are the only necessary constraint to be placed on a graph that represents changes over time: Neither can future changes be referenced (the direction of the edges always points to the past), nor can you arrive at a point from which the path is already marked (circular reasoning).
</div>
<div class="footnote" id="_footnotedef_29">
<a href="#_footnoteref_29">29</a>. Of course, this does not prevent you from setting a branch to a commit &#8220;somewhere in the middle,&#8221; which can also be useful.
</div>
<div class="footnote" id="_footnotedef_30">
<a href="#_footnoteref_30">30</a>. Due to the fact that the order of the direct ancestors is stored during a merge, it is important to always merge from the smaller <em>to</em> the larger branch, e.g. <code>topic</code> to <code>master</code>. If you then want to use <code>master^^</code> to examine commits in the master branch, don&#8217;t land on commits from the topic branch all at once (see also <a href="#sec.merge">Section 3.3, &#8220;Merging Branches&#8221;</a>).
</div>
<div class="footnote" id="_footnotedef_31">
<a href="#_footnoteref_31">31</a>. To find out how Git checks a reference for validity, see the <code>git-check-ref-format(1)</code> man page.
</div>
<div class="footnote" id="_footnotedef_32">
<a href="#_footnoteref_32">32</a>. How long they stay there is determined by corresponding settings for the <em>garbage collection</em> (maintenance mechanisms), see <a href="#sec.gc">Section B.1, &#8220;Cleaning up&#8221;</a>.
</div>
<div class="footnote" id="_footnotedef_33">
<a href="#_footnoteref_33">33</a>. A detailed overview of the advantages and disadvantages of both schemes as well as a description of the release process etc. can be found in chapter 6 of the book <em>Open Source Projektmanagement</em> by Michael Prokop (Open Source Press, Munich, 2010).
</div>
<div class="footnote" id="_footnotedef_34">
<a href="#_footnoteref_34">34</a>. To add such a tagged blob to a repository, use the following command: <code>git tag -am "&lt;description&gt;" &lt;tag-name&gt; $(git hash-object -w &lt;file&gt;)</code>.
</div>
<div class="footnote" id="_footnotedef_35">
<a href="#_footnoteref_35">35</a>. These are the commits captured with <code>git log v1.7.1..28ba96a</code>.
</div>
<div class="footnote" id="_footnotedef_36">
<a href="#_footnoteref_36">36</a>. To verify that the changes in your new branch are the same as the old one, use <code>git diff &lt;reorder-feature&gt; &lt;feature&gt;</code>&#8201;&#8212;&#8201;if the command does not produce output, the branches will contain identical changes.
</div>
<div class="footnote" id="_footnotedef_37">
<a href="#_footnoteref_37">37</a>. It is not absolutely necessary that a merge base exists; for example, if you manage multiple root commits in a repository (see <a href="#sec.multi-root">Section 4.7, &#8220;Multiple root commits&#8221;</a>) and then merge the branches built on top of them, there will be no common base if no merge has taken place before. In this case, a file that exists in different versions on both sides creates a conflict.
</div>
<div class="footnote" id="_footnotedef_38">
<a href="#_footnoteref_38">38</a>. The following description explains the approach of the <code>resolve</code> strategy. It differs only slightly from the standard <code>recursive</code> strategy, see also the detailed description of this strategy in <a href="#sec.merge-strategies">Section 3.3.3, &#8220;Merging Strategies&#8221;</a>.
</div>
<div class="footnote" id="_footnotedef_39">
<a href="#_footnoteref_39">39</a>. The <code>recursive</code> strategy is therefore only much more intelligent than <code>resolve</code> if the <em>topology</em> of the commits (i.e., the order in which they branched and merged) is much more complicated than simply branching and then merging.
</div>
<div class="footnote" id="_footnotedef_40">
<a href="#_footnoteref_40">40</a>. Die für den Merge relevanten Commits, die etwas an der Datei <code>output.c</code> geändert haben, kann Beatrice mit <code>git log --merge -p&#8201;&#8212;&#8201;output.c</code> auflisten.
</div>
<div class="footnote" id="_footnotedef_41">
<a href="#_footnoteref_41">41</a>. <a href="http://kdiff3.sourceforge.net" class="bare" target="_blank" rel="noopener">http://kdiff3.sourceforge.net</a>
</div>
<div class="footnote" id="_footnotedef_42">
<a href="#_footnoteref_42">42</a>. <a href="https://meld.sourceforge.net" class="bare" target="_blank" rel="noopener">https://meld.sourceforge.net</a>
</div>
<div class="footnote" id="_footnotedef_43">
<a href="#_footnoteref_43">43</a>. In Vimdiff you can use <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>W</kbd></span> followed by movement with the arrow keys or <kbd>h</kbd>, <kbd>j</kbd>, <kbd>k</kbd>, <kbd>l</kbd> to move the window in the appropriate direction. With <kbd>d</kbd><kbd>p</kbd> or <kbd>d</kbd><kbd>o</kbd> you move changes to the other side or apply them from there (<em>diff put</em>&#8201;&#8212;&#8201;<em>diff obtain</em>).
</div>
<div class="footnote" id="_footnotedef_44">
<a href="#_footnoteref_44">44</a>. The message <code>Automatic merge failed</code> simply means that a conflict occurred that could <em>not</em> be solved by a 3-way merge. Since Rerere cannot guarantee a meaningful solution, the solution is only &#8220;provided,&#8221; but not considered the ultimate solution of the conflict.
</div>
<div class="footnote" id="_footnotedef_45">
<a href="#_footnoteref_45">45</a>. More useful tips can be found in <a href="#ch.workflows">Chapter 6, <em>Workflows</em></a>.
</div>
<div class="footnote" id="_footnotedef_46">
<a href="#_footnoteref_46">46</a>. AsciiDoc is a simple, wiki-like markup language: <a href="https://asciidoc.org" class="bare" target="_blank" rel="noopener">https://asciidoc.org</a>. The Git documentation is in this format and is converted to HTML pages and man pages, and this book was also written in AsciiDoc!
</div>
<div class="footnote" id="_footnotedef_47">
<a href="#_footnoteref_47">47</a>. For example, the repository of the Git project itself manages the autogenerated HTML documentation in a branch <code>html</code>, which is completely separated from the development branches. This way, merges between the code branches cannot lead to conflicts due to differently compiled HTML documentation. How to create such &#8220;decoupled&#8221; branches is described in <a href="#sec.multi-root">Section 4.7, &#8220;Multiple root commits&#8221;</a>.
</div>
<div class="footnote" id="_footnotedef_48">
<a href="#_footnoteref_48">48</a>. This is because the merge command does not examine each commit individually. Instead, it compares three trees that contain these changes <em>among others</em>, see <a href="#sec.merge-detail">Section 3.3.1, &#8220;Two-Branches Merge&#8221;</a>.
</div>
<div class="footnote" id="_footnotedef_49">
<a href="#_footnoteref_49">49</a>. This is because rebase works internally with <code>cherry-pick</code>, which recognizes when the changes that would be introduced by the commit are already present. A similar functionality is provided by <code>git cherry</code> or <code>git patch-id</code>, which can detect almost identical patches.
</div>
<div class="footnote" id="_footnotedef_50">
<a href="#_footnoteref_50">50</a>. Maybe the character <code>^</code> has a special meaning in your shell (this is for example the case in the Z-Shell or rc-Shell). In this case you have to mask the character, i.e. enclose the argument in quotation marks or prefix it with a backslash. In the Z-Shell, there is also the command <code>noglob</code>, which you use to precede <code>git</code> to remove the special meaning of <code>^</code>.
</div>
<div class="footnote" id="_footnotedef_51">
<a href="#_footnoteref_51">51</a>. This is not necessarily a commit&#8201;&#8212;&#8201;these can also be tags or blobs.
</div>
<div class="footnote" id="_footnotedef_52">
<a href="#_footnoteref_52">52</a>. Whether or not the commits have fallen out because of their age depends, of course, on how often you perform a <em>garbage collection</em> via <code>git gc</code>. See also <a href="#sec.gc">Section B.1, &#8220;Cleaning up&#8221;</a>.
</div>
<div class="footnote" id="_footnotedef_53">
<a href="#_footnoteref_53">53</a>. If you want to list all commits in the last two weeks, use <code>git log --since='two weeks ago'</code> instead.
</div>
<div class="footnote" id="_footnotedef_54">
<a href="#_footnoteref_54">54</a>. If you&#8217;re managing patch stacks with Git that have potential conflicts, you should definitely take a look at the <em>Reuse Recorded Resolution</em> feature, in short, <em>rerere</em>. <em>Rerere</em> saves conflict resolutions and automatically corrects conflicts if a resolution has already been saved, see also <a href="#sec.rerere">Section 3.4.2, &#8220;rerere: Reuse Recorded Resolution&#8221;</a>.
</div>
<div class="footnote" id="_footnotedef_55">
<a href="#_footnoteref_55">55</a>. For example, by uploading the branch to a publicly available repository, see <a href="#sec.uploading-commits">Section 5.4, &#8220;Uploading Commits: git push&#8221;</a>.
</div>
<div class="footnote" id="_footnotedef_56">
<a href="#_footnoteref_56">56</a>. In the latter case, for example, you simply do a <code>git remote update</code> (the new commits are loaded into the <code>origin/master</code> branch) and then build your own branch from scratch to <code>origin/master</code>. See also <a href="#sec.distributed-systems">Section 5.1, &#8220;How Does Distributed Version Control Work?&#8221;</a>.
</div>
<div class="footnote" id="_footnotedef_57">
<a href="#_footnoteref_57">57</a>. You can find the source code at <a href="https://repo.or.cz/w/topgit.git" class="bare" target="_blank" rel="noopener">https://repo.or.cz/w/topgit.git</a>.
</div>
<div class="footnote" id="_footnotedef_58">
<a href="#_footnoteref_58">58</a>. Short <code>stg</code> or StGit, reachable under <a href="https://stacked-git.github.io" class="bare" target="_blank" rel="noopener">https://stacked-git.github.io</a>.
</div>
<div class="footnote" id="_footnotedef_59">
<a href="#_footnoteref_59">59</a>. This also works fine as long as all branches and merges are <em>above</em> the new reference (i.e. only commits are included from which you can reach the new base). Otherwise, rebase will fail for every commit already in history (error message: &#8220;nothing to commit&#8221;); these must always be skipped with a <code>git rebase --continue</code>.
</div>
<div class="footnote" id="_footnotedef_60">
<a href="#_footnoteref_60">60</a>. More examples can be found on the <code>gitignore(5)</code> man page and at <a href="https://docs.github.com/en/free-pro-team@latest/github/using-git/ignoring-files" class="bare" target="_blank" rel="noopener">https://docs.github.com/en/free-pro-team@latest/github/using-git/ignoring-files</a>.
</div>
<div class="footnote" id="_footnotedef_61">
<a href="#_footnoteref_61">61</a>. This behavior can be prevented by setting the <code>clean.requireForce</code> setting to <code>false</code>.
</div>
<div class="footnote" id="_footnotedef_62">
<a href="#_footnoteref_62">62</a>. The command first selects all commit objects that are no longer accessible, and then restricts the list to those that are merge commits and whose commit message contains the string <code>WIP</code>&#8201;&#8212;&#8201;the properties that a commit object created as a stash has, see <a href="#sec.stash-implementation">Section 4.5.7, &#8220;How is the stash implemented?&#8221;</a>.
</div>
<div class="footnote" id="_footnotedef_63">
<a href="#_footnoteref_63">63</a>. That&#8217;s not quite true; you can only store one note per commit under <code>refs/notes/commits</code>, but you can store additional notes under e.g. <code>refs/notes/bts</code> that relate to the bug tracking system, and only one per commit there.
</div>
<div class="footnote" id="_footnotedef_64">
<a href="#_footnoteref_64">64</a>. Of course, this commit need not be the core of the regression, it may have been prepared by a completely different commit.
</div>
<div class="footnote" id="_footnotedef_65">
<a href="#_footnoteref_65">65</a>. We developed the cheat sheet in connection with various Git workshops. It is licensed under a Creative Commons License and is managed with the Git hosting platform GitHub, which we describe in <a href="#ch.github">Chapter 11, <em>GitHub</em></a> beschreiben, verwaltet.
</div>
<div class="footnote" id="_footnotedef_66">
<a href="#_footnoteref_66">66</a>. Strictly speaking, Git does not &#8220;blindly&#8221; check out the <code>master</code> branch. In fact, Git looks up which branch the <code>HEAD</code> of the other side references and checks it out.
</div>
<div class="footnote" id="_footnotedef_67">
<a href="#_footnoteref_67">67</a>. For more information on the Git protocol, see <a href="#sec.git-protocol">Section 7.1.1, &#8220;The Git Protocol&#8221;</a> (see also <a href="#sec.branch-refs">Section 3.1.1, &#8220;HEAD and Other Symbolic References&#8221;</a>).
</div>
<div class="footnote" id="_footnotedef_68">
<a href="#_footnoteref_68">68</a>. For a complete list of possible URLs, see the <code>git-clone(1)</code> man page in the &#8220;Git URLs&#8221; section.
</div>
<div class="footnote" id="_footnotedef_69">
<a href="#_footnoteref_69">69</a>. The asterisk (<code>*</code>) is also interpreted as a <em>wildcard</em> like the Shell and considers all files in a directory.
</div>
<div class="footnote" id="_footnotedef_70">
<a href="#_footnoteref_70">70</a>. Remote tracking branches are only intended to track the branches in a remote. Checking out a remote tracking branch will result in a detached head state and warning.
</div>
<div class="footnote" id="_footnotedef_71">
<a href="#_footnoteref_71">71</a>. Merging from <code>origin/master</code> to <code>master</code> is a normal merging process. In the example above, no further local commits have been made in the meantime and therefore no merge commits have been created. The <code>master</code> has been fast-forwarded to <code>origin/master</code>.
</div>
<div class="footnote" id="_footnotedef_72">
<a href="#_footnoteref_72">72</a>. But the &#8220;forcing&#8221; only takes place locally: The recipient server can prevent the upload despite the specification of the option <code>-f</code>. This is done with the <code>receive.denyNonFastForwards</code> option, or the <code>RW</code> rights assignment for Gitolite (see <a href="#sec.gitolite-config">Section 7.2.2, &#8220;Configuring Gitolite&#8221;</a>).
</div>
<div class="footnote" id="_footnotedef_73">
<a href="#_footnoteref_73">73</a>. This is the default behavior since version 2.0 (<code>push.default=simple</code>). Earlier Git versions used the <code>push.default=matching</code> setting without any further configuration, which can be buggy, especially for beginners.
</div>
<div class="footnote" id="_footnotedef_74">
<a href="#_footnoteref_74">74</a>. In Git jargon such remotes are called <em>anonymous</em>.
</div>
<div class="footnote" id="_footnotedef_75">
<a href="#_footnoteref_75">75</a>. The syntax <code>&lt;tag&gt;^{}</code> dereferences a tag object, so returns the commit, tree or blob object to which the tag points.
</div>
<div class="footnote" id="_footnotedef_76">
<a href="#_footnoteref_76">76</a>. For example with the alias <code>push = push --tags</code>.
</div>
<div class="footnote" id="_footnotedef_77">
<a href="#_footnoteref_77">77</a>. See the <code>git-format-patch(1)</code> man page for information on how to customize the numbering, text and file suffix.
</div>
<div class="footnote" id="_footnotedef_78">
<a href="#_footnoteref_78">78</a>. The number <code>n</code> is the total number of patches exported and <code>m</code> is the number of the current patch. For example, the subject line of the third patch of five would read <code>[PATCH 3/5]</code>.
</div>
<div class="footnote" id="_footnotedef_79">
<a href="#_footnoteref_79">79</a>. You can see in <a href="#fig.mail-thread">Figure 39, &#8220;Patch series as mail thread&#8221;</a> a slightly different order of patches than in the previous examples. This is because the first version of the patch series consisted of only two patches, and the third one was added after feedback from the Git mailing list. The series was then expanded and rebased to the state as shown in this section.
</div>
<div class="footnote" id="_footnotedef_80">
<a href="#_footnoteref_80">80</a>. If no <em>Mail Transfer Agent</em> (MTA) is installed on your system or configured to send e-mail, you can also use an external SMTP server. To do so, adjust the settings described in the section &#8220;Use GMail as the SMTP server&#8221; of the already mentioned man page.
</div>
<div class="footnote" id="_footnotedef_81">
<a href="#_footnoteref_81">81</a>. <a href="https://dpaste.com" class="bare" target="_blank" rel="noopener">https://dpaste.com</a>
</div>
<div class="footnote" id="_footnotedef_82">
<a href="#_footnoteref_82">82</a>. <a href="https://gist.github.com" class="bare" target="_blank" rel="noopener">https://gist.github.com</a>
</div>
<div class="footnote" id="_footnotedef_83">
<a href="#_footnoteref_83">83</a>. Useful tips and tricks for various MUAs can be found in the <code>Documentation/SubmittingPatches</code> file in the Git-via-Git repository in the &#8220;MUA specific hints&#8221; section, and in the <code>git-format-patch(1)</code> man page in the &#8220;MUA specific hints&#8221; and &#8220;Discussion&#8221; sections.
</div>
<div class="footnote" id="_footnotedef_84">
<a href="#_footnoteref_84">84</a>. For the Git project, you can find them at <code>Documentation/SubmittingPatches</code> in the source code repository.
</div>
<div class="footnote" id="_footnotedef_85">
<a href="#_footnoteref_85">85</a>. The <code>libgit.a</code> is created when compiling Git and gathers all functions that are &#8220;public&#8221; in Git. However, it is not <em>reentrant</em> or thread-safe, so its use is limited. <code>libgit2</code> does not have these restrictions.
</div>
<div class="footnote" id="_footnotedef_86">
<a href="#_footnoteref_86">86</a>. The command is not a standard command of Git, but is installed automatically by some Linux distributions (e.g. Debian, Archlinux) and in the Windows Git installer. Check by calling <code>git subtree</code> whether the command is installed. If not, you can search for the script under <code>/usr/share/doc/git/contrib/subtree/</code>, or copy it from the source code of Git (under <code>contrib/subtree</code>).
</div>
<div class="footnote" id="_footnotedef_87">
<a href="#_footnoteref_87">87</a>. Therefore, make sure that you only include content that you are <em>allowed</em> to pass on using this technology. Depending on the license, the use of a software may be allowed, but not the distribution.
</div>
<div class="footnote" id="_footnotedef_88">
<a href="#_footnoteref_88">88</a>. Among others, the third chapter of <em>Open Source Projektmanagement</em> by Michael Prokop (Open Source Press, Munich, 2010) is recommended. The Manifesto for Agile Software Development also provides informative information at <a href="http://agilemanifesto.org" class="bare" target="_blank" rel="noopener">http://agilemanifesto.org</a>.
</div>
<div class="footnote" id="_footnotedef_89">
<a href="#_footnoteref_89">89</a>. An exception is if you need a new development in the mainline in your topic branch, but in that case you can consider rebuilding the topic branch via rebase so that it already contains the required functionality.
</div>
<div class="footnote" id="_footnotedef_90">
<a href="#_footnoteref_90">90</a>. You can find further suggestions in chapter 6 of the book <em>Open Source Projektmanagement</em> by Michael Prokop (Open Source Press, Munich, 2010).
</div>
<div class="footnote" id="_footnotedef_91">
<a href="#_footnoteref_91">91</a>. Each commit references exactly one tree. However, <code>git archive</code> behaves differently depending on whether you specify a commit (which references a tree) or a tree directly: For trees, the time of the last modification included in the archive is the system time&#8201;&#8212;&#8201;but for a commit, the time of the commit is set.
</div>
<div class="footnote" id="_footnotedef_92">
<a href="#_footnoteref_92">92</a>. A more detailed description can be found in the Git source repository in the <code>Documentation/technical</code> directory. There you can find three files that explain the packfile format, partly based on explanations by Linus Torvalds on IRC: <code>pack-format.txt</code>, <code>pack-heuristics.txt</code>, <code>pack-protocol.txt</code>. Modern versions of Git also use an additional &#8220;Bitmap Reachability Index,&#8221; which is explained in <code>bitmap-format.txt</code>.
</div>
<div class="footnote" id="_footnotedef_93">
<a href="#_footnoteref_93">93</a>. The installation and configuration described here refers to Gitolite version 3.6. Since Gitolite version 1.5, which was described in the first edition of this book, there have been some incompatible changes, which you can read about here: <a href="https://gitolite.com/gitolite/migr.html" class="bare" target="_blank" rel="noopener">https://gitolite.com/gitolite/migr.html</a>
</div>
<div class="footnote" id="_footnotedef_94">
<a href="#_footnoteref_94">94</a>. A user can only authenticate to an SSH server with his private key if he can decrypt a message encrypted with his public (and Gitolite&#8217;s) key. Gitolite can derive the internal user name from the key the user authenticates against.
</div>
<div class="footnote" id="_footnotedef_95">
<a href="#_footnoteref_95">95</a>. Some distributions also provide ready-made packages of Gitolite. However, it is not recommended to use them because they are usually outdated and are installed globally and with a certain configuration. If you then choose a different username than the one chosen by the developers, you will have to spend a lot of extra effort to get Gitolite working.
</div>
<div class="footnote" id="_footnotedef_96">
<a href="#_footnoteref_96">96</a>. A <em>release candidate</em> of a software is a pre-release version of a new release that is made available to the public (and not only to a small group of beta testers). Only bug fixes are then incorporated into the final release. Version 1.0 RC 1 (<code>v1.0-rc1</code>) is followed by RC 2 (<code>v1.0-rc2</code>) etc. until version 1.0 is released (<code>v1.0</code>).
</div>
<div class="footnote" id="_footnotedef_97">
<a href="#_footnoteref_97">97</a>. Of course, Gitolite cannot prohibit <em>read-only</em> access to a subdirectory; this would make the concept of the Git object model with its cryptographically guaranteed integrity absurd.
</div>
<div class="footnote" id="_footnotedef_98">
<a href="#_footnoteref_98">98</a>. Please also note that this may again cause problems when creating branches, see above.
</div>
<div class="footnote" id="_footnotedef_99">
<a href="#_footnoteref_99">99</a>. The documentation can be found at <a href="https://gitolite.com" class="bare" target="_blank" rel="noopener">https://gitolite.com</a>. The author has also published the book <em>Gitolite Essentials</em> (Packt Publishing, 2014).
</div>
<div class="footnote" id="_footnotedef_100">
<a href="#_footnoteref_100">100</a>. Strictly speaking, it is necessary for the copied <code>HEAD</code> to match that of the opposite side. Better still, check a version tag signed by a developer.
</div>
<div class="footnote" id="_footnotedef_101">
<a href="#_footnoteref_101">101</a>. In some distributions, such as Debian, the daemon is called <code>openbsd-inetd</code>.
</div>
<div class="footnote" id="_footnotedef_102">
<a href="#_footnoteref_102">102</a>. The program <code>sv</code> is part of the init framework <em>runit</em> (<a href="http://smarden.org/runit/" class="bare" target="_blank" rel="noopener">http://smarden.org/runit/</a>). It replaces the functionality of SysV-Init, but can also be integrated into it.
</div>
<div class="footnote" id="_footnotedef_103">
<a href="#_footnoteref_103">103</a>. Note that an instance of the Git daemon is not &#8220;expensive.&#8221; Packing the requested objects together is, however. So just because your server can handle dozens of HTTP requests per second doesn&#8217;t mean it can handle the same number of Git connections.
</div>
<div class="footnote" id="_footnotedef_104">
<a href="#_footnoteref_104">104</a>. Note that the order in the <code>alias.url</code> directive is important. If you use the line <code>&#34;/&#34; => &#8230;&#8203;</code> to the top, Lighttpd will no longer start or the alias assignment will not be the desired one.
</div>
<div class="footnote" id="_footnotedef_105">
<a href="#_footnoteref_105">105</a>. The tool <code>checkinstall</code> automatically builds Debian or RPM packages containing all files that would have been installed by <code>make install</code>. Homepage of the program: <a href="https://www.asic-linux.com.mx/~izto/checkinstall/" class="bare" target="_blank" rel="noopener">https://www.asic-linux.com.mx/~izto/checkinstall/</a>
</div>
<div class="footnote" id="_footnotedef_106">
<a href="#_footnoteref_106">106</a>. You can download the program <code>indent</code> from the GNU project from <a href="https://www.gnu.org/software/indent/" class="bare" target="_blank" rel="noopener">https://www.gnu.org/software/indent/</a>.
</div>
<div class="footnote" id="_footnotedef_107">
<a href="#_footnoteref_107">107</a>. The <code>convert</code> command is part of the ImageMagick suite. If you replace <code>-clone 1-2</code> with <code>-clone 0.2</code>, the different areas are copied from the <em>old</em> image.
</div>
<div class="footnote" id="_footnotedef_108">
<a href="#_footnoteref_108">108</a>. The graphics were created for the release of Kernel 2.0 by Larry Ewing and can be found at <a href="https://www.isc.tamu.edu/~lewing/linux/" class="bare" target="_blank" rel="noopener">https://www.isc.tamu.edu/~lewing/linux/</a>.
</div>
<div class="footnote" id="_footnotedef_109">
<a href="#_footnoteref_109">109</a>. &#8220;Server-side&#8221; here only means that they are not executed in the local repository, but on the &#8220;opposite side&#8221;.
</div>
<div class="footnote" id="_footnotedef_110">
<a href="#_footnoteref_110">110</a>. If Git were to include full permissions, then a file with the same contents would not be the same blob for two different developers using different <code>umask(2)</code> settings. To prevent this from happening, Git uses a simplified permission management system.
</div>
<div class="footnote" id="_footnotedef_111">
<a href="#_footnoteref_111">111</a>. For example, you can have your shell scripts automatically checked at <a href="https://www.shellcheck.net/" class="bare" target="_blank" rel="noopener">https://www.shellcheck.net/</a>.
</div>
<div class="footnote" id="_footnotedef_112">
<a href="#_footnoteref_112">112</a>. The <em>Debian Alquimist Shell</em>, a fork of the <em>Alquimist Shell</em>, is a very small, fast shell which is POSIX compatible. It provides the standard Shell <code>/bin/sh</code> on many modern Debian systems as well as on Ubuntu.
</div>
<div class="footnote" id="_footnotedef_113">
<a href="#_footnoteref_113">113</a>. <a href="https://github.com/gitbuch/buch-scripte" class="bare" target="_blank" rel="noopener">https://github.com/gitbuch/buch-scripte</a>
</div>
<div class="footnote" id="_footnotedef_114">
<a href="#_footnoteref_114">114</a>. There are other flags (<code>U</code>, <code>T</code> and <code>B</code>), but in practice they usually play no role.
</div>
<div class="footnote" id="_footnotedef_115">
<a href="#_footnoteref_115">115</a>. <a href="https://git.wiki.kernel.org/index.php/Aliases" class="bare" target="_blank" rel="noopener">https://git.wiki.kernel.org/index.php/Aliases</a>
</div>
<div class="footnote" id="_footnotedef_116">
<a href="#_footnoteref_116">116</a>. In principle, you <em>cannot</em> specify a predecessor. Then the corresponding commit becomes a root commit.
</div>
<div class="footnote" id="_footnotedef_117">
<a href="#_footnoteref_117">117</a>. <a href="https://git.wiki.kernel.org/index.php/Interfaces,_frontends,_and_tools#Interaction_with_other_Revision_Control_Systems" class="bare" target="_blank" rel="noopener">https://git.wiki.kernel.org/index.php/Interfaces,_frontends,_and_tools#Interaction_with_other_Revision_Control_Systems</a>
</div>
<div class="footnote" id="_footnotedef_118">
<a href="#_footnoteref_118">118</a>. <a href="http://rsvndump.sourceforge.net/" class="bare" target="_blank" rel="noopener">http://rsvndump.sourceforge.net/</a>
</div>
<div class="footnote" id="_footnotedef_119">
<a href="#_footnoteref_119">119</a>. If there exist several directories, which contain branches and/or tags, you specify them by several arguments <code>-t</code> or <code>-b</code>.
</div>
<div class="footnote" id="_footnotedef_120">
<a href="#_footnoteref_120">120</a>. If you did not specify a trunk per <code>-T</code> or <code>--stdlayout</code> during conversion, a single branch called <code>remote/git-svn</code> will be generated.
</div>
<div class="footnote" id="_footnotedef_121">
<a href="#_footnoteref_121">121</a>. The script is included in the script collection for this book. See: <a href="https://github.com/gitbuch/buch-scripte" class="bare" target="_blank" rel="noopener">https://github.com/gitbuch/buch-scripte</a>.
</div>
<div class="footnote" id="_footnotedef_122">
<a href="#_footnoteref_122">122</a>. Basically you can also perform these operations directly with the command <code>mv</code> below <code>.git/refs/</code>. However, the plumbing commands make it possible to handle &#8220;exotic&#8221; cases like &#8220;Packed Refs&#8221; or references that are symlinks correctly. In addition, <code>git update-ref</code> writes corresponding entries in the reflog and issues error messages if something goes wrong. See also <a href="#sec.scripting">Section 8.3, &#8220;Writing your own Git commands&#8221;</a>.
</div>
<div class="footnote" id="_footnotedef_123">
<a href="#_footnoteref_123">123</a>. You can also find this script in the script collection: <a href="https://github.com/gitbuch/buch-scripte" class="bare" target="_blank" rel="noopener">https://github.com/gitbuch/buch-scripte</a>.
</div>
<div class="footnote" id="_footnotedef_124">
<a href="#_footnoteref_124">124</a>. <a href="https://github.com/nothingmuch/git-svn-abandon" class="bare" target="_blank" rel="noopener">https://github.com/nothingmuch/git-svn-abandon</a>
</div>
<div class="footnote" id="_footnotedef_125">
<a href="#_footnoteref_125">125</a>. <a href="https://gist.github.com/hartwork/fa275bedf8c2addeeb57" class="bare" target="_blank" rel="noopener">https://gist.github.com/hartwork/fa275bedf8c2addeeb57</a>
</div>
<div class="footnote" id="_footnotedef_126">
<a href="#_footnoteref_126">126</a>. <a href="https://web.archive.org/web/20160118021532/http://gitorious.org/svn2git/svn2git" class="bare" target="_blank" rel="noopener">https://web.archive.org/web/20160118021532/http://gitorious.org/svn2git/svn2git</a>
</div>
<div class="footnote" id="_footnotedef_127">
<a href="#_footnoteref_127">127</a>. In the Git-via-Git repository under <code>contrib/svn-fe</code>
</div>
<div class="footnote" id="_footnotedef_128">
<a href="#_footnoteref_128">128</a>. Compare the command: <code>svn copy trunk tags/v2.0</code>
</div>
<div class="footnote" id="_footnotedef_129">
<a href="#_footnoteref_129">129</a>. Compare the Subversion command: <code>svn merge -r 23:25 branches/feature trunk</code>
</div>
<div class="footnote" id="_footnotedef_130">
<a href="#_footnoteref_130">130</a>. For detailed technical documentation, see the <code>git-fast-import(1)</code> man page.
</div>
<div class="footnote" id="_footnotedef_131">
<a href="#_footnoteref_131">131</a>. You can use the <code>--date-format</code> option to allow other date formats if required.
</div>
<div class="footnote" id="_footnotedef_132">
<a href="#_footnoteref_132">132</a>. Although this leads to a little more computing effort, it simplifies the structure of the import program considerably. From the point of view that import software is usually rarely executed and time does not play a critical role, this approach makes sense.
</div>
<div class="footnote" id="_footnotedef_133">
<a href="#_footnoteref_133">133</a>. The script is available as part of our script collection at <a href="https://github.com/gitbuch/buch-scripte" class="bare" target="_blank" rel="noopener">https://github.com/gitbuch/buch-scripte</a>.
</div>
<div class="footnote" id="_footnotedef_134">
<a href="#_footnoteref_134">134</a>. If you use <code>git-svn</code>, you can tell the script to use the SVN upstream (<code>remotes/git-svn</code>) for comparison (if it exists) instead of the upstream branch by setting the variable to the value <code>auto</code>.
</div>
<div class="footnote" id="_footnotedef_135">
<a href="#_footnoteref_135">135</a>. The <code>zshcompsys(1)</code> man page describes how to further customize the completion. Especially the options <code>group-name</code> and <code>menu-select</code> are recommended.
</div>
<div class="footnote" id="_footnotedef_136">
<a href="#_footnoteref_136">136</a>. A list of available systems can be obtained by calling the <code>vcs_info_printsys</code> function.
</div>
<div class="footnote" id="_footnotedef_137">
<a href="#_footnoteref_137">137</a>. <a href="https://github.com/gitbuch/buch-scripte" class="bare" target="_blank" rel="noopener">https://github.com/gitbuch/buch-scripte</a>
</div>
<div class="footnote" id="_footnotedef_138">
<a href="#_footnoteref_138">138</a>. <a href="https://github.com" class="bare" target="_blank" rel="noopener">https://github.com</a>
</div>
<div class="footnote" id="_footnotedef_139">
<a href="#_footnoteref_139">139</a>. <a href="https://web.archive.org/web/20150303192558/http://gitorious.org" class="bare" target="_blank" rel="noopener">https://web.archive.org/web/20150303192558/http://gitorious.org</a>
</div>
<div class="footnote" id="_footnotedef_140">
<a href="#_footnoteref_140">140</a>. <a href="https://repo.or.cz" class="bare" target="_blank" rel="noopener">https://repo.or.cz</a>
</div>
<div class="footnote" id="_footnotedef_141">
<a href="#_footnoteref_141">141</a>. <a href="https://sourceforge.net" class="bare" target="_blank" rel="noopener">https://sourceforge.net</a>
</div>
<div class="footnote" id="_footnotedef_142">
<a href="#_footnoteref_142">142</a>. <a href="https://www.berlios.de" class="bare" target="_blank" rel="noopener">https://www.berlios.de</a>
</div>
<div class="footnote" id="_footnotedef_143">
<a href="#_footnoteref_143">143</a>. <a href="https://curl.se" class="bare" target="_blank" rel="noopener">https://curl.se</a>
</div>
<div class="footnote" id="_footnotedef_144">
<a href="#_footnoteref_144">144</a>. <a href="https://rubyonrails.org" class="bare" target="_blank" rel="noopener">https://rubyonrails.org</a>
</div>
<div class="footnote" id="_footnotedef_145">
<a href="#_footnoteref_145">145</a>. <a href="https://jquery.com" class="bare" target="_blank" rel="noopener">https://jquery.com</a>
</div>
<div class="footnote" id="_footnotedef_146">
<a href="#_footnoteref_146">146</a>. <a href="https://github.com/gollum/gollum" class="bare" target="_blank" rel="noopener">https://github.com/gollum/gollum</a>
</div>
<div class="footnote" id="_footnotedef_147">
<a href="#_footnoteref_147">147</a>. <a href="https://github.com/github/markup" class="bare" target="_blank" rel="noopener">https://github.com/github/markup</a>
</div>
<div class="footnote" id="_footnotedef_148">
<a href="#_footnoteref_148">148</a>. Not to be misunderstood as a project fork, where a project splits due to internal differences.
</div>
<div class="footnote" id="_footnotedef_149">
<a href="#_footnoteref_149">149</a>. <a href="https://github.com/blog/817-behold-image-view-modes" class="bare" target="_blank" rel="noopener">https://github.com/blog/817-behold-image-view-modes</a>
</div>
<div class="footnote" id="_footnotedef_150">
<a href="#_footnoteref_150">150</a>. <a href="https://help.github.com" class="bare" target="_blank" rel="noopener">https://help.github.com</a>
</div>
<div class="footnote" id="_footnotedef_151">
<a href="#_footnoteref_151">151</a>. <a href="https://www.kernel.org/pub/software/scm/git/" class="bare" target="_blank" rel="noopener">https://www.kernel.org/pub/software/scm/git/</a>
</div>
<div class="footnote" id="_footnotedef_152">
<a href="#_footnoteref_152">152</a>. <a href="https://code.google.com/p/git-osx-installer/" class="bare" target="_blank" rel="noopener">https://code.google.com/p/git-osx-installer/</a>
</div>
<div class="footnote" id="_footnotedef_153">
<a href="#_footnoteref_153">153</a>. <a href="https://gitforwindows.org" class="bare" target="_blank" rel="noopener">https://gitforwindows.org</a>
</div>
<div class="footnote" id="_footnotedef_154">
<a href="#_footnoteref_154">154</a>. Since a bare repository (see <a href="#sec.bare-repos">Section 7.1.3, &#8220;Bare Repositories: Repositories Without Working Tree&#8221;</a>) does not have a working tree, the contents normally located in <code>.git</code> form the top level in the directory structure, and there is no additional <code>.git</code> directory.
</div>
<div class="footnote" id="_footnotedef_155">
<a href="#_footnoteref_155">155</a>. This is not to be confused with version control systems that store incremental versions of a file. Within packfiles, objects are packed independently of their semantic context, i.e. especially their temporal sequence.
</div>
<div class="footnote" id="_footnotedef_156">
<a href="#_footnoteref_156">156</a>. A detailed discussion of the topic can be found at <a href="https://metalinguist.wordpress.com/2007/12/06/the-woes-of-git-gc-aggressive-and-how-git-deltas-work/" class="bare" target="_blank" rel="noopener">https://metalinguist.wordpress.com/2007/12/06/the-woes-of-git-gc-aggressive-and-how-git-deltas-work/</a>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 3.0<br>
</div>
</div>
</body>
</html>